import{u as S,r as b,c as k,G as T,f as N,g as w,h as _,k as m,j as e,D as U,l as h,i as f,t as R,m as y,d as B,o as j,H as F,I as $,n as p,V as O,J as E,x as H}from"./app-bdb013bd.js";/* empty css                   */const J={class:"h-full w-full text-center content-center"},K={class:"va-h3"},M={__name:"DeleteFactory",props:["params"],setup(V){const{init:x}=S(),c=b(!1),{t:a}=k(),v=V,u=T("ondeleted"),n=async()=>{try{const{data:t}=await y.delete(`/factory/${v.params.data.id}`);t.status===200?(u(v.params.data),c.value=!1,x({message:a("login.successMessage"),color:"success"})):console.error("Error deleting data:",t.message)}catch(t){console.error("Error deleting data:",t)}};return(t,r)=>{const s=N("VaModal");return w(),_("main",J,[m(e(U),{round:"",icon:"delete",color:"red",preset:"primary",class:"mt-1",onClick:r[0]||(r[0]=g=>c.value=!0)}),m(s,{modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=g=>c.value=g),"ok-text":e(a)("modals.apply"),"cancel-text":e(a)("modals.cancel"),onClose:r[2]||(r[2]=g=>c.value=!1),onOk:n,"close-button":""},{default:h(()=>[f("h3",K,R(e(a)("modals.title")),1),f("p",null,R(e(a)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},L={class:"h-full w-full text-center content-center"},Q={class:"va-h3"},q={__name:"EditFactory",props:{params:Object,canUpdate:Boolean},setup(V){const{init:x}=S(),c=V,a=b(!1),v=T("onupdated"),{t:u}=k(),n=B({Name:"",NameRus:"",ShortName:"",ShortNameRus:"",Comment:"",id:c.params.data.id});j(()=>{y.get(`factory/${c.params.data.id}`).then(r=>{Object.assign(n,r.data)}).catch(r=>{console.error("Error fetching data:",r)})});const t=async()=>{try{const{data:r}=await y.put("/factory",n);r.status===200?(v(c.params.node,r.unit),a.value=!1,x({message:u("login.successMessage"),color:"success"})):console.error("Error saving data:",r.message)}catch(r){console.error("Error saving data:",r)}};return(r,s)=>{const g=N("VaTextarea"),C=N("VaModal");return w(),_("main",L,[V.canUpdate?(w(),F(e(U),{key:0,round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:s[0]||(s[0]=o=>V.canUpdate?a.value=!0:null)})):$("",!0),V.canUpdate?(w(),F(C,{key:1,modelValue:a.value,"onUpdate:modelValue":s[6]||(s[6]=o=>a.value=o),"ok-text":e(u)("modals.apply"),"cancel-text":e(u)("modals.cancel"),onOk:t,onClose:s[7]||(s[7]=o=>a.value=!1),"close-button":""},{default:h(()=>[f("h3",Q,R(e(u)("modals.editFactory")),1),f("div",null,[m(e(O),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:h(()=>[m(e(p),{class:"w-full",modelValue:n.Name,"onUpdate:modelValue":s[1]||(s[1]=o=>n.Name=o),rules:[o=>!!o||e(u)("validation.required")],label:e(u)("form.name")},null,8,["modelValue","rules","label"]),m(e(p),{class:"w-full",modelValue:n.NameRus,"onUpdate:modelValue":s[2]||(s[2]=o=>n.NameRus=o),rules:[o=>!!o||e(u)("validation.required")],label:e(u)("form.nameRus")},null,8,["modelValue","rules","label"]),m(e(p),{class:"w-full",modelValue:n.ShortName,"onUpdate:modelValue":s[3]||(s[3]=o=>n.ShortName=o),rules:[o=>!!o||e(u)("validation.required")],label:e(u)("form.shortName")},null,8,["modelValue","rules","label"]),m(e(p),{class:"w-full",modelValue:n.ShortNameRus,"onUpdate:modelValue":s[4]||(s[4]=o=>n.ShortNameRus=o),rules:[o=>!!o||e(u)("validation.required")],label:e(u)("form.shortNameRus")},null,8,["modelValue","rules","label"]),m(g,{class:"w-full",modelValue:n.Comment,"onUpdate:modelValue":s[5]||(s[5]=o=>n.Comment=o),"max-length":125,label:e(u)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])):$("",!0)])}}};const W={class:"grid grid-rows-[55px,1fr]"},X={class:"flex justify-between"},Y=f("span",{class:"flex w-full"},null,-1),Z={class:"va-h3"},ee={class:"flex-grow"},te={__name:"FactoriesPage",setup(V){const{init:x}=S(),{locale:c,t:a}=k(),v=b([]),u=b(null),n=b(!1),t=B({Name:"",NameRus:"",ShortName:"",ShortNameRus:"",Comment:""});function r(i){u.value.applyTransaction({remove:[i]})}function s(i,d){i.setData(d)}E("ondeleted",r),E("onupdated",s);const g=H(()=>[{headerName:a("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:a("table.name"),field:o(),flex:1},{headerName:a("table.shortName"),field:I()},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:q},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:M}]),C={sortable:!0,filter:!0},o=()=>c.value==="uz"?"Name":"NameRus",I=()=>c.value==="uz"?"ShortName":"ShortNameRus",D=async()=>{try{const i=await y.get("/factory");v.value=Array.isArray(i.data)?i.data:i.data.items}catch(i){console.error("Error fetching data:",i)}},A=async()=>{try{const{data:i}=await y.post("/factory",t);i.status===200?(n.value=!1,t.Name="",t.NameRus="",t.ShortName="",t.ShortNameRus="",t.Comment="",await D(),x({message:a("login.successMessage"),color:"success"})):console.error("Error saving data:",i.message)}catch(i){console.error("Error saving data:",i)}};return j(()=>{D()}),(i,d)=>{const G=N("VaTextarea"),z=N("VaModal"),P=N("ag-grid-vue");return w(),_("div",W,[f("main",null,[f("div",X,[Y,m(e(U),{onClick:d[0]||(d[0]=l=>n.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),m(z,{modelValue:n.value,"onUpdate:modelValue":d[6]||(d[6]=l=>n.value=l),"ok-text":e(a)("buttons.save"),"cancel-text":e(a)("buttons.cancel"),onOk:A,"close-button":""},{default:h(()=>[f("h3",Z,R(e(a)("modals.addUnitTitle")),1),f("div",null,[m(e(O),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:h(()=>[m(e(p),{class:"w-full",modelValue:t.Name,"onUpdate:modelValue":d[1]||(d[1]=l=>t.Name=l),rules:[l=>l&&l.length>0||e(a)("validation.requiredField")],label:e(a)("form.name")},null,8,["modelValue","rules","label"]),m(e(p),{class:"w-full",modelValue:t.NameRus,"onUpdate:modelValue":d[2]||(d[2]=l=>t.NameRus=l),rules:[l=>l&&l.length>0||e(a)("validation.requiredField")],label:e(a)("form.nameRus")},null,8,["modelValue","rules","label"]),m(e(p),{class:"w-full",modelValue:t.ShortName,"onUpdate:modelValue":d[3]||(d[3]=l=>t.ShortName=l),rules:[l=>l&&l.length>0||e(a)("validation.requiredField")],label:e(a)("form.shortName")},null,8,["modelValue","rules","label"]),m(e(p),{class:"w-full",modelValue:t.ShortNameRus,"onUpdate:modelValue":d[4]||(d[4]=l=>t.ShortNameRus=l),rules:[l=>l&&l.length>0||e(a)("validation.requiredField")],label:e(a)("form.shortNameRus")},null,8,["modelValue","rules","label"]),m(G,{class:"w-full",modelValue:t.Comment,"onUpdate:modelValue":d[5]||(d[5]=l=>t.Comment=l),"max-length":"125",label:e(a)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),f("main",ee,[m(P,{rowData:v.value,columnDefs:g.value,defaultColDef:C,animateRows:"true",class:"ag-theme-material h-full",onGridReady:d[7]||(d[7]=l=>u.value=l.api),frameworkComponents:{EditFactory:q,DeleteFactory:M}},null,8,["rowData","columnDefs","frameworkComponents"])])])}}};export{te as default};
