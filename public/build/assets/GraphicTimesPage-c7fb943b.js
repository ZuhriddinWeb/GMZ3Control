import{u as $,r as f,G as H,d as O,c as k,f as x,o as S,g as M,j as d,i as l,D as U,k as C,h as m,t as G,V as R,l as v,H as P,v as j,y as A}from"./app-4d998b01.js";/* empty css                   */import{f as E}from"./format-45c98358.js";const L={class:"h-full w-full text-center content-center"},q={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},z={class:"grid grid-cols-2 md:grid-cols-3 gap-3 items-end"},J={__name:"EditGraphicTimesModal",props:["params"],setup(N){const{init:T}=$(),a=N,u=f(!1),h=f([]),y=f([]),b=H("onupdated"),t=O({GraphicId:"",ChangeId:"",Name:"",StartTime:"",EndTime:"",id:a.params.data.id}),{t:r}=k(),o=async()=>{try{const p=await v.get("/graphics"),s=await v.get("/changes");h.value=p.data.map(g=>({value:g.id,text:g.Name})),y.value=s.data.map(g=>({value:g.Change,text:g.Change}));const w=await v.get(`graphictimes/${a.params.data.id}`);t.GraphicId=+w.data.Gid,t.ChangeId=+w.data.Chid}catch(p){console.error("Error fetching data:",p)}},_=async()=>{try{const{data:p}=await v.put("/graphictimes",t);p.status===200?(u.value=!1,b(a.params.node,p.unit),T({message:r("login.successMessage"),color:"success"})):console.error("Error saving data:",p.message)}catch(p){console.error("Error saving data:",p)}};return(p,s)=>{const w=x("VaSelect"),g=x("VaTimeInput"),I=x("VaModal");return S(),M("main",L,[d(l(U),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:s[0]||(s[0]=i=>u.value=!0)}),d(I,{modelValue:u.value,"onUpdate:modelValue":s[6]||(s[6]=i=>u.value=i),"ok-text":l(r)("modals.apply"),"cancel-text":l(r)("modals.cancel"),onOk:_,onClose:s[7]||(s[7]=i=>u.value=!1),"close-button":""},{default:C(()=>[m("h3",{class:"va-h3",onVnodeMounted:o},G(l(r)("modals.editFactory")),513),m("div",null,[d(l(R),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:C(()=>[m("div",q,[d(w,{modelValue:t.GraphicId,"onUpdate:modelValue":s[1]||(s[1]=i=>t.GraphicId=i),"value-by":"value",class:"mb-6",label:l(r)("form.selectGraphic"),options:h.value,clearable:""},null,8,["modelValue","label","options"]),d(w,{modelValue:t.ChangeId,"onUpdate:modelValue":s[2]||(s[2]=i=>t.ChangeId=i),"value-by":"value",class:"mb-6",label:l(r)("form.selectChange"),options:y.value,clearable:""},null,8,["modelValue","label","options"])]),m("div",z,[d(g,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(r)("form.name"),modelValue:t.Name,"onUpdate:modelValue":s[3]||(s[3]=i=>t.Name=i)},null,8,["label","modelValue"]),d(g,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(r)("form.startTime"),modelValue:t.Name,"onUpdate:modelValue":s[4]||(s[4]=i=>t.Name=i)},null,8,["label","modelValue"]),d(g,{modelValue:t.EndTime,"onUpdate:modelValue":s[5]||(s[5]=i=>t.EndTime=i),clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(r)("form.endTime")},null,8,["modelValue","label"])])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},K={class:"h-full w-full text-center content-center"},Q={class:"va-h3"},W={__name:"DeleteGraphicTimesModal",props:["params"],setup(N){const{init:T}=$(),{t:a}=k(),u=f(!1),h=N,y=H("ondeleted"),b=async()=>{try{const{data:t}=await v.delete(`/graphictimes/${h.params.data.id}`);t.status===200?(y(h.params.data),T({message:a("login.successMessage"),color:"success"}),u.value=!1):console.error("Error deleting data:",t.message)}catch(t){console.error("Error deleting data:",t)}};return(t,r)=>{const o=x("VaModal");return S(),M("main",K,[d(l(U),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:r[0]||(r[0]=_=>u.value=!0)}),d(o,{modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=_=>u.value=_),"ok-text":l(a)("modals.apply"),"cancel-text":l(a)("modals.cancel"),onClose:r[2]||(r[2]=_=>u.value=!1),onOk:b,"close-button":""},{default:C(()=>[m("h3",Q,G(l(a)("modals.title")),1),m("p",null,G(l(a)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}};const X={class:"grid grid-rows-[55px,1fr]"},Y={class:"flex justify-between"},Z=m("span",{class:"flex w-full"},null,-1),ee={class:"va-h3"},ae={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},le={class:"grid grid-cols-2 md:grid-cols-3 gap-3 items-end"},te={class:"flex-grow"},re={__name:"GraphicTimesPage",setup(N){const{locale:T,t:a}=k(),{init:u}=$(),h=f([]),y=f(null),b=f(!1),t=f([]),r=f([]),o=O({GraphicId:"",ChangeId:"",Name:"",StartTime:"",EndTime:""});function _(e){y.value.applyTransaction({remove:[e]})}function p(e,n){e.setData(n)}P("ondeleted",_),P("onupdated",p);const s=j(()=>[{headerName:a("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:"ID",field:"id",width:80},{headerName:a("table.change"),field:"Change",width:120},{headerName:a("table.graphicName"),field:"GName",flex:1},{headerName:a("table.name"),field:"Name",flex:1,valueFormatter:e=>E(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:a("table.startTime"),field:"StartTime",valueFormatter:e=>E(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:a("table.endTime"),field:"EndTime",valueFormatter:e=>E(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:a("table.comment"),field:"Comment",flex:1},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:J},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:W}]),w={sortable:!0,filter:!0},g=async()=>{try{const e=await v.get("/graphictimes");h.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},I=async()=>{try{const e=await v.get("/graphics"),n=await v.get("/changes");t.value=e.data.map(V=>({value:V.id,text:V.Name})),r.value=n.data.map(V=>({value:V.Change,text:V.Change}))}catch(e){console.error("Error fetching graphics data:",e)}},i=async()=>{try{const{data:e}=await v.post("/graphictimes",o);e.status===200?(b.value=!1,o.GraphicId="",o.ChangeId="",o.Name="",o.StartTime="",o.EndTime="",await g(),u({message:a("login.successMessage"),color:"success"})):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return A(()=>{const e=localStorage.getItem("locale");e&&(T.value=e),g(),I()}),(e,n)=>{const V=x("VaSelect"),D=x("VaTimeInput"),F=x("VaModal"),B=x("ag-grid-vue");return S(),M("div",X,[m("main",null,[m("div",Y,[Z,d(l(U),{onClick:n[0]||(n[0]=c=>b.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),d(F,{modelValue:b.value,"onUpdate:modelValue":n[6]||(n[6]=c=>b.value=c),"ok-text":l(a)("buttons.save"),"cancel-text":l(a)("buttons.cancel"),onOk:i,"close-button":""},{default:C(()=>[m("h3",ee,G(l(a)("modals.addGraphicTimesTitle")),1),m("div",null,[d(l(R),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:C(()=>[m("div",ae,[d(V,{modelValue:o.GraphicId,"onUpdate:modelValue":n[1]||(n[1]=c=>o.GraphicId=c),"value-by":"value",class:"mb-6",label:l(a)("form.selectGraphic"),options:t.value,clearable:""},null,8,["modelValue","label","options"]),d(V,{modelValue:o.ChangeId,"onUpdate:modelValue":n[2]||(n[2]=c=>o.ChangeId=c),"value-by":"value",class:"mb-6",label:l(a)("form.selectChange"),options:r.value,clearable:""},null,8,["modelValue","label","options"])]),m("div",le,[d(D,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(a)("form.name"),modelValue:o.Name,"onUpdate:modelValue":n[3]||(n[3]=c=>o.Name=c)},null,8,["label","modelValue"]),d(D,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(a)("form.startTime"),modelValue:o.StartTime,"onUpdate:modelValue":n[4]||(n[4]=c=>o.StartTime=c)},null,8,["label","modelValue"]),d(D,{modelValue:o.EndTime,"onUpdate:modelValue":n[5]||(n[5]=c=>o.EndTime=c),clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(a)("form.endTime")},null,8,["modelValue","label"])])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),m("main",te,[d(B,{rowData:h.value,columnDefs:s.value,defaultColDef:w,animateRows:"true",class:"ag-theme-material h-full",onGridReady:n[7]||(n[7]=c=>y.value=c.api)},null,8,["rowData","columnDefs"])])])}}};export{re as default};
