import{u as b,c as x,r as d,s as i,K as V,o as I,R as S,f as R,g as k,h as O,i as s,j as m,l as z,k as v,m as C,n as B}from"./app-HKqWyzPM.js";/* empty css                   */import{V as F}from"./VueShiftCalendar-DVnG7cRB.js";const T={class:"grid grid-rows-[55px,1fr]"},$={class:"flex-grow"},A={class:"m-2"},G={__name:"OperatorResultPage",props:{id:Number},setup(g){const{init:P}=b(),{locale:n,t:r}=x(),_=g,c=d([]),w=d(null),a=d({smena:null,day:null}),y=i(()=>[{headerName:r("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:r("table.structure"),field:N(),flex:1},{headerName:r("table.namePage"),field:D(),flex:1},{headerName:"Operator",field:"multiplied_manual_count"},{headerName:"Formula",field:"multiplied_formula_count"},{headerName:r("table.want"),field:"multiplied_parameter_count"},{headerName:r("table.be"),field:"kiritilgan"},{headerName:"%",field:"foiz",valueFormatter:t=>`${t.value}%`},{headerName:r("table.operator"),field:"kiritgan_operator"}]),f=i(()=>a.value.day?`${a.value.day} - ${a.value.smena}`:""),h={sortable:!0,filter:!0},D=()=>(n.value==="uz","page_name"),N=()=>(n.value==="uz","factory_structure_name"),p=async()=>{try{const t={day:a.value.day,smena:a.value.smena},e=await B.get(`/getRowPageResult/${_.id}`,{params:t});c.value=Array.isArray(e.data)?e.data:e.data.items}catch(t){console.error("Error fetching data:",t)}};V(()=>a.value,()=>{p()},{deep:!0});let u=null;return I(()=>{const t=localStorage.getItem("locale");t&&(n.value=t);const e=new Date,o=e.getHours();if(o>=8&&o<20)a.value.smena=1,a.value.day=e.toISOString().split("T")[0];else if(a.value.smena=2,o<8){const l=new Date(e);l.setDate(e.getDate()-1),a.value.day=l.toISOString().split("T")[0]}else a.value.day=e.toISOString().split("T")[0];u=setInterval(()=>{p()},3e5)}),S(()=>{u&&clearInterval(u)}),i(()=>n.value==="uz"?"Русский":"O‘zbek"),(t,e)=>{const o=R("ag-grid-vue");return O(),k("div",T,[e[3]||(e[3]=s("main",null,[s("div",{class:"flex justify-between"},[s("span",{class:"flex w-full"})])],-1)),s("main",$,[s("div",A,[m(v(F),{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value=l),"with-slot":!0},{default:z(()=>[m(v(C),{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),label:"Smena",readonly:""},null,8,["modelValue"])]),_:1},8,["modelValue"])]),m(o,{rowData:c.value,columnDefs:y.value,defaultColDef:h,animateRows:"true",class:"ag-theme-material h-full",onGridReady:e[2]||(e[2]=l=>w.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{G as default};
