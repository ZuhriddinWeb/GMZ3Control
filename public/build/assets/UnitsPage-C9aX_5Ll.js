import{a as I,u as G,c as $,r as v,s as n,d as j,o as O,n as N,f as g,g as P,h as V,i as u,j as r,F as A,G as H,k as t,z as L,l as w,t as J,V as K,m as c,H as b}from"./app-Cp5kX0cG.js";/* empty css                   */import{_ as Q,a as W}from"./EditUnitsModal-BLYrm7ko.js";const X={class:"grid grid-rows-[55px,1fr]"},Y={class:"flex justify-between"},Z={class:"va-h3"},ee={class:"flex-grow"},se={__name:"UnitsPage",setup(ae){const x=I(),{init:R}=G(),{locale:d,t:o}=$(),f=v([]),h=v(null),m=v(!1),S=n(()=>x.state.user.roles[6]),p=l=>{var e,i;return((i=(e=S.value)==null?void 0:e.pivot)==null?void 0:i[l])==="1"},C=n(()=>p("create")),_=n(()=>p("update")),D=n(()=>p("delete")),s=j({Name:"",ShortName:"",NameRus:"",ShortNameRus:"",Comment:""});function y(l){h.value.applyTransaction({remove:[l]})}function k(l,e){l.setData(e)}b("ondeleted",y),b("onupdated",k);const U=n(()=>{const l=[{headerName:o("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:o("table.name"),field:z(),flex:1},{headerName:o("table.shortName"),field:B()},{headerName:o("table.comment"),field:"Comment",flex:1}];return _.value&&l.push({headerName:"",field:"",width:70,cellClass:["px-0"],cellRenderer:Q}),D.value&&l.push({headerName:"",field:"",width:70,cellClass:["px-0"],cellRenderer:W}),l}),F={sortable:!0,filter:!0},z=()=>d.value==="uz"?"Name":"NameRus",B=()=>d.value==="uz"?"ShortName":"ShortNameRus",E=async()=>{try{const l=await N.get("/units");console.log(l.data),f.value=l.data}catch(l){console.error("Error fetching data:",l)}},M=async()=>{try{const{data:l}=await N.post("/units",s);l.status===200?(m.value=!1,s.Name="",s.ShortName="",s.NameRus="",s.ShortNameRus="",s.Comment="",await E(),R({message:o("login.successMessage"),color:"success"})):console.error("Error saving data:",l.message)}catch(l){console.error("Error saving data:",l)}};return O(()=>{const l=localStorage.getItem("locale");l&&(d.value=l),(async()=>{try{const e=await N.get("/units");f.value=e.data}catch(e){console.error("Error fetching data:",e)}})()}),n(()=>d.value==="uz"?"Русский":"O‘zbek"),(l,e)=>{const i=g("VaTextarea"),T=g("VaModal"),q=g("ag-grid-vue");return V(),P("div",X,[u("main",null,[u("div",Y,[e[8]||(e[8]=u("span",{class:"flex w-full"},null,-1)),C.value?(V(),A(t(L),{key:0,onClick:e[0]||(e[0]=a=>m.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):H("",!0)]),r(T,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=a=>m.value=a),"ok-text":t(o)("buttons.save"),"cancel-text":t(o)("buttons.cancel"),onOk:M,"close-button":""},{default:w(()=>[u("h3",Z,J(t(o)("modals.addUnitTitle")),1),u("div",null,[r(t(K),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:w(()=>[r(t(c),{class:"w-full",modelValue:s.Name,"onUpdate:modelValue":e[1]||(e[1]=a=>s.Name=a),rules:[a=>a&&a.length>0||t(o)("validation.requiredField")],label:t(o)("form.name")},null,8,["modelValue","rules","label"]),r(t(c),{class:"w-full",modelValue:s.NameRus,"onUpdate:modelValue":e[2]||(e[2]=a=>s.NameRus=a),rules:[a=>a&&a.length>0||t(o)("validation.requiredField")],label:t(o)("form.nameRus")},null,8,["modelValue","rules","label"]),r(t(c),{class:"w-full",modelValue:s.ShortName,"onUpdate:modelValue":e[3]||(e[3]=a=>s.ShortName=a),rules:[a=>a&&a.length>0||t(o)("validation.requiredField")],label:t(o)("form.shortName")},null,8,["modelValue","rules","label"]),r(t(c),{class:"w-full",modelValue:s.ShortNameRus,"onUpdate:modelValue":e[4]||(e[4]=a=>s.ShortNameRus=a),rules:[a=>a&&a.length>0||t(o)("validation.requiredField")],label:t(o)("form.shortNameRus")},null,8,["modelValue","rules","label"]),r(i,{class:"w-full",modelValue:s.Comment,"onUpdate:modelValue":e[5]||(e[5]=a=>s.Comment=a),"max-length":"125",label:t(o)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),u("main",ee,[r(q,{rowData:f.value,columnDefs:U.value,defaultColDef:F,animateRows:"true",class:"ag-theme-material h-full",onGridReady:e[7]||(e[7]=a=>h.value=a.api)},null,8,["rowData","columnDefs"])])])}}};export{se as default};
