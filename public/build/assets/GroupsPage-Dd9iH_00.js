import{u as E,r as V,E as G,c as $,f as x,g as I,h as R,j as c,k as a,z as S,l as D,i as g,t as y,n as N,d as P,V as U,m as _,a as Y,s as v,o as Z,F as ee,G as ae,H as F}from"./app-BM3QMFa0.js";/* empty css                   */const te={class:"h-full w-full text-center content-center"},le={class:"va-h3"},oe={__name:"DeleteGroup",props:["params"],setup(b){const{init:w}=E(),p=V(!1),d=b,s=G("ondeleted"),{t:o}=$(),r=async()=>{try{const{data:f}=await N.delete(`/groups/${d.params.data.id}`);f.status===200?(s(d.params.data),p.value=!1,w({message:o("login.successMessage"),color:"success"})):console.error("Error deleting data:",f.message)}catch(f){console.error("Error deleting data:",f)}};return(f,i)=>{const n=x("VaModal");return R(),I("main",te,[c(a(S),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:i[0]||(i[0]=e=>p.value=!0)}),c(n,{modelValue:p.value,"onUpdate:modelValue":i[1]||(i[1]=e=>p.value=e),"ok-text":a(o)("modals.apply"),"cancel-text":a(o)("modals.cancel"),onClose:i[2]||(i[2]=e=>p.value=!1),onOk:r,"close-button":""},{default:D(()=>[g("h3",le,y(a(o)("modals.title")),1),g("p",null,y(a(o)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},se={class:"h-full w-full text-center content-center"},ne={__name:"EditGroup",props:["params"],setup(b){const{init:w}=E(),p=b,d=V(!1),s=G("onupdated"),{t:o}=$(),r=P({Name:"",NameRus:"",Comment:"",StructureID:"",PageID:"",id:p.params.data.id}),f=async()=>{N.get(`/getRowGroupEdit/${p.params.data.id}`).then(n=>{r.Name=n.data[0].Name,r.NameRus=n.data[0].NameRus,r.Comment=n.data[0].Comment,r.StructureID=n.data[0].StructureID,r.PageID=n.data[0].PageID}).catch(n=>{console.error("Error fetching data:",n)})},i=async()=>{try{const{data:n}=await N.put("/groups",r);n.status===200?(s(p.params.node,n.unit),d.value=!1,w({message:o("login.successMessage"),color:"success"})):console.error("Error saving data:",n.message)}catch(n){console.error("Error saving data:",n)}};return(n,e)=>{const k=x("VaTextarea"),h=x("VaModal");return R(),I("main",se,[c(a(S),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:e[0]||(e[0]=u=>d.value=!0)}),c(h,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=u=>d.value=u),"ok-text":a(o)("modals.apply"),"cancel-text":a(o)("modals.cancel"),onOk:i,onClose:e[5]||(e[5]=u=>d.value=!1),"close-button":""},{default:D(()=>[g("h3",{class:"va-h3",onVnodeMounted:f},y(a(o)("modals.editFactory")),513),g("div",null,[c(a(U),{ref:"formRef",class:"flex flex-col items-baseline gap-1"},{default:D(()=>[c(a(_),{class:"w-full",modelValue:r.Name,"onUpdate:modelValue":e[1]||(e[1]=u=>r.Name=u),rules:[u=>u&&u.length>0||a(o)("validation.requiredField")],label:a(o)("form.name")},null,8,["modelValue","rules","label"]),c(a(_),{class:"w-full",modelValue:r.NameRus,"onUpdate:modelValue":e[2]||(e[2]=u=>r.NameRus=u),rules:[u=>u&&u.length>0||a(o)("validation.requiredField")],label:a(o)("form.nameRus")},null,8,["modelValue","rules","label"]),c(k,{class:"w-full",modelValue:r.Comment,"onUpdate:modelValue":e[3]||(e[3]=u=>r.Comment=u),"max-length":"125",label:a(o)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},re={class:"grid grid-rows-[55px,1fr]"},ue={class:"flex justify-between"},de={class:"va-h3"},me={class:"flex-grow"},pe={__name:"GroupsPage",props:["id","page"],setup(b){const{init:w}=E(),p=Y(),{locale:d,t:s}=$(),o=b,r=V([]),f=V(null),i=V(!1),n=V([]),e=P({StructureID:o.id,PageID:o.page,Name:"",NameRus:"",Comment:""}),k=v(()=>p.state.user.roles[22]),h=t=>{var l,C;return((C=(l=k.value)==null?void 0:l.pivot)==null?void 0:C[t])==="1"},u=v(()=>h("create")),z=v(()=>h("update")),B=v(()=>h("delete"));function T(t){f.value.applyTransaction({remove:[t]})}function O(t,l){t.setData(l)}F("ondeleted",T),F("onupdated",O);const q=v(()=>{const t=[{headerName:s("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:s("table.structure"),field:L(),flex:1},{headerName:s("table.page"),field:J(),flex:1},{headerName:s("table.name"),field:A(),flex:1},{headerName:s("table.comment"),field:H()}];return z.value&&t.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:ne}),B.value&&t.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:oe}),t}),j={sortable:!0,filter:!0},A=()=>d.value==="uz"?"Name":"NameRus",H=()=>(d.value==="uz","Comment"),L=()=>d.value==="uz"?"SName":"NameRus",J=()=>(d.value==="uz","NName"),M=async()=>{try{const t=await N.get(`/getRowGroup/${o.id}/${o.page}`);r.value=Array.isArray(t.data)?t.data:t.data.items}catch(t){console.error("Error fetching data:",t)}},K=async()=>{try{const t=await N.get("/structure");n.value=t.data.map(l=>({value:l.id,text:d.value==="uz"?l.Name:l.NameRus}))}catch(t){console.error("Error fetching graphics data:",t)}},Q=async()=>{try{const{data:t}=await N.post("/groups",e);t.status===200?(i.value=!1,e.StructureID="",e.Name="",e.NameRus="",e.NumberPage="",e.Comment="",await M(),w({message:s("login.successMessage"),color:"success"})):console.error("Error saving data:",t.message)}catch(t){console.error("Error saving data:",t)}};return Z(()=>{const t=localStorage.getItem("locale");t&&(d.value=t),M()}),v(()=>d.value==="uz"?"Русский":"O‘zbek"),(t,l)=>{const C=x("VaTextarea"),W=x("VaModal"),X=x("ag-grid-vue");return R(),I("div",re,[g("main",null,[g("div",ue,[l[6]||(l[6]=g("span",{class:"flex w-full"},null,-1)),u.value?(R(),ee(a(S),{key:0,onClick:l[0]||(l[0]=m=>(i.value=!0,K)),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):ae("",!0)]),c(W,{modelValue:i.value,"onUpdate:modelValue":l[4]||(l[4]=m=>i.value=m),"ok-text":a(s)("buttons.save"),"cancel-text":a(s)("buttons.cancel"),onOk:Q,"close-button":""},{default:D(()=>[g("h3",de,y(a(s)("modals.addPageGroup")),1),g("div",null,[c(a(U),{ref:"formRef",class:"flex flex-col items-baseline gap-1"},{default:D(()=>[c(a(_),{class:"w-full",modelValue:e.Name,"onUpdate:modelValue":l[1]||(l[1]=m=>e.Name=m),rules:[m=>m&&m.length>0||a(s)("validation.requiredField")],label:a(s)("form.name")},null,8,["modelValue","rules","label"]),c(a(_),{class:"w-full",modelValue:e.NameRus,"onUpdate:modelValue":l[2]||(l[2]=m=>e.NameRus=m),rules:[m=>m&&m.length>0||a(s)("validation.requiredField")],label:a(s)("form.nameRus")},null,8,["modelValue","rules","label"]),c(C,{class:"w-full",modelValue:e.Comment,"onUpdate:modelValue":l[3]||(l[3]=m=>e.Comment=m),"max-length":"125",label:a(s)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),g("main",me,[c(X,{rowData:r.value,columnDefs:q.value,defaultColDef:j,animateRows:"true",class:"ag-theme-material h-full",onGridReady:l[5]||(l[5]=m=>f.value=m.api)},null,8,["rowData","columnDefs"])])])}}};export{pe as default};
