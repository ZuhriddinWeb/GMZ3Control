import{u as q,c as E,s as C,b as L,r as d,o as M,D as P,n as _,g as D,h as I,i as e,I as H,J,t as c,k as v,j as F,z as N}from"./app-D-ltx6wV.js";/* empty css                   */const G={class:"grid grid-rows-[55px,1fr]"},K={class:"flex justify-between"},Q={class:"w-4/6"},U={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 my-6 shadow-sm border border-slate-200 mt-24 p-4"},W=["onClick"],X={class:"mb-2 text-slate-800 text-xl font-semibold flex items-start"},Y={class:"flex-grow leading-none w-5/6"},Z={class:"flex justify-between"},tt={class:"flex justify-between flex-col"},et={class:"flex justify-end"},at={class:"absolute top-2 right-2 w-24 grid grid-cols-[min-content,1fr] gap-x-2 gap-y-1 text-xl font-semibold text-right"},st={class:"text-green-600 text-base"},lt={class:"text-red-600 text-base"},ot={class:"text-blue-600 text-base"},nt={class:"text-teal-600 text-base"},mt={__name:"OperatorsCountInputValueCard",setup(rt){const{init:it}=q(),{locale:m,t:ut}=E(),O=C(()=>route.query.type),p=L(),x=d([]);d(null);const y=d(null);function j(a){p.push({name:"OperatorDetail",params:{id:a}})}function T(a){y.value=a,R()}function V(a){p.push({name:"OperatorDetail",params:{id:a},query:{type:"inputed"}})}function z(a){p.push({name:"OperatorDetail",params:{id:a},query:{type:"not_inputed"}})}C(()=>O.value==="inputed"?allData.value.filter(a=>a.Value!==null):O.value==="not_inputed"?allData.value.filter(a=>a.Value===null):allData.value);const b=d(0),h=d(0);async function R(){const a=new Date,t=a.toISOString().split("T")[0],s=a.getHours(),f=s>=8&&s<20?1:2;if(b.value=0,h.value=0,y.value){const{data:r}=await _.get(`/getRowPageResult/${y.value}`,{params:{day:t,smena:f}}),g=r.reduce((l,o)=>(l.total+=o.multiplied_parameter_count,l.filled+=o.kiritilgan,l.formula+=o.multiplied_formula_count,l.manual+=o.multiplied_manual_count,l),{total:0,filled:0,formula:0,manual:0});b.value=g.formula,h.value=g.manual}else{const{data:r}=await _.get("/structure"),g=[];for(const l of r){const o=await _.get(`/getRowPageResult/${l.id}`,{params:{day:t,smena:f}}),w=o.data.reduce((n,i)=>n+i.multiplied_parameter_count,0),k=o.data.reduce((n,i)=>n+i.kiritilgan,0),S=o.data.reduce((n,i)=>n+i.multiplied_formula_count,0),$=o.data.reduce((n,i)=>n+i.multiplied_manual_count,0),A=w-k;b.value+=S,h.value+=$;const u=x.value.find(n=>n.id===l.id);u&&(u.filled=k,u.notFilled=A,u.formula=S,u.manual=$);const B=w>0?k/w*100:0;g.push({name:m.value==="uz"?l.Name:l.NameRus,y:parseFloat(B.toFixed(2))})}}}return M(async()=>{const a=localStorage.getItem("locale");a&&(m.value=a);try{const t=P.state.user.structure_id;if(Array.isArray(t)&&t.length===1){const s=t[0];p.push({name:"OperatorDetail",params:{id:s}})}else if(Array.isArray(t)&&t.length>1){const s=await _.get(`/structures/${t.join(",")}`);x.value=s.data}else console.warn("structure_id bo'sh yoki noto'g'ri formatda")}catch(t){console.error("Error fetching data:",t)}await R()}),C(()=>m.value==="uz"?"Русский":"O‘zbek"),(a,t)=>(I(),D("div",G,[e("div",K,[e("div",Q,[e("div",U,[(I(!0),D(H,null,J(x.value,(s,f)=>(I(),D("div",{onClick:r=>T(s.id),key:f,class:"relative p-4 border-2 bg-white shadow-xl border-slate-400 cursor-pointer"},[e("h5",X,[t[0]||(t[0]=e("span",{class:"material-symbols-outlined w-1 mr-3"},"circles_ext",-1)),e("span",Y,c(v(m)==="ru"?s.NameRus:s.Name),1)]),e("div",Z,[e("div",tt,[e("div",et,[e("div",null,[F(v(N),{onClick:r=>j(s.id),preset:"primary",icon:"va-warning",class:"mr-2 mt-8",round:"","border-color":"primary"},null,8,["onClick"]),F(v(N),{onClick:r=>V(s.id),round:"",icon:"va-check",class:"mr-2 mt-8",color:"success"},null,8,["onClick"]),F(v(N),{onClick:r=>z(s.id),round:"",icon:"clear",class:"mr-2 mt-8",color:"danger"},null,8,["onClick"])]),e("div",null,[e("div",at,[t[1]||(t[1]=e("span",{class:"text-green-600 material-symbols-outlined"},"edit",-1)),e("span",st,c(s.filled),1),t[2]||(t[2]=e("span",{class:"material-symbols-outlined text-red-600"},"warning",-1)),e("span",lt,c(s.notFilled),1),t[3]||(t[3]=e("span",{class:"material-symbols-outlined text-blue-600"},"support_agent",-1)),e("span",ot,c(s.manual),1),t[4]||(t[4]=e("span",{class:"material-symbols-outlined text-teal-600"},"function",-1)),e("span",nt,c(s.formula),1)])])])])])],8,W))),128))])])])]))}};export{mt as default};
