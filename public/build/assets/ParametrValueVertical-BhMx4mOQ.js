import{Q as dt,R as pt,_ as ht,s as H,c as ut,r as M,L as et,f as tt,F as at,h as Ce,l as Fe,i as T,g as We,G as ct,t as Ve,j as Y,k as Q,S as rt,n as X,a as mt,b as gt,d as it,o as ft,T as vt,m as yt,x as ot,z as Ge,I as xt,J as bt,w as wt,U as Ct,W as Ze,X as Nt}from"./app-B5o22c3C.js";/* empty css                   */import{_ as St}from"./EditValue-Cnf-F0jO.js";import{V as Et}from"./VueShiftCalendar-B9v_ul_G.js";import{f as Le}from"./format-D9pTN3Kd.js";var Tt=pt();const st=dt(Tt);var _e={exports:{}},kt=_e.exports,lt;function Ot(){return lt||(lt=1,function(De,K){(function(S,ce){De.exports=ce(S._Highcharts,S._Highcharts.AST,S._Highcharts.Chart)})(typeof window>"u"?kt:window,(S,ce,Ne)=>(()=>{var J,me,j={660:o=>{o.exports=ce},944:o=>{o.exports=S},960:o=>{o.exports=Ne}},de={};function P(o){var e=de[o];if(e!==void 0)return e.exports;var t=de[o]={exports:{}};return j[o](t,t.exports,P),t.exports}P.n=o=>{var e=o&&o.__esModule?()=>o.default:()=>o;return P.d(e,{a:e}),e},P.d=(o,e)=>{for(var t in e)P.o(e,t)&&!P.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:e[t]})},P.o=(o,e)=>Object.prototype.hasOwnProperty.call(o,e);var L={};P.d(L,{default:()=>q});var Z=P(944),U=P.n(Z),w=P(660),ee=P.n(w),ge=P(960),Se=P.n(ge);(function(o){o.compose=function(t){return t.navigation||(t.navigation=new e(t)),t};class e{constructor(r){this.updates=[],this.chart=r}addUpdate(r){this.chart.navigation.updates.push(r)}update(r,n){this.updates.forEach(a=>{a.call(this.chart,r,n)})}}o.Additions=e})(J||(J={}));let te=J,{isSafari:Pe,win:g,win:{document:ae}}=U(),{error:_}=U(),fe=g.URL||g.webkitURL||g;function Re(o){let e=o.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(e&&e.length>3&&g.atob&&g.ArrayBuffer&&g.Uint8Array&&g.Blob&&fe.createObjectURL){let t=g.atob(e[3]),r=new g.ArrayBuffer(t.length),n=new g.Uint8Array(r);for(let a=0;a<n.length;++a)n[a]=t.charCodeAt(a);return fe.createObjectURL(new g.Blob([n],{type:e[1]}))}}let{isTouchDevice:d}=U(),p={exporting:{allowTableSorting:!0,libURL:"https://code.highcharts.com/12.3.0/lib/",local:!0,type:"image/png",url:`https://export-svg.highcharts.com?v=${U().version}`,pdfFont:{normal:void 0,bold:void 0,bolditalic:void 0,italic:void 0},printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",titleKey:"contextButtonTitle",menuItems:["viewFullscreen","printChart","separator","downloadPNG","downloadJPEG","downloadSVG"]}},menuItemDefinitions:{viewFullscreen:{textKey:"viewFullscreen",onclick:function(){var o;(o=this.fullscreen)==null||o.toggle()}},printChart:{textKey:"printChart",onclick:function(){var o;(o=this.exporting)==null||o.print()}},separator:{separator:!0},downloadPNG:{textKey:"downloadPNG",onclick:async function(){var o;await((o=this.exporting)==null?void 0:o.exportChart())}},downloadJPEG:{textKey:"downloadJPEG",onclick:async function(){var o;await((o=this.exporting)==null?void 0:o.exportChart({type:"image/jpeg"}))}},downloadPDF:{textKey:"downloadPDF",onclick:async function(){var o;await((o=this.exporting)==null?void 0:o.exportChart({type:"application/pdf"}))}},downloadSVG:{textKey:"downloadSVG",onclick:async function(){var o;await((o=this.exporting)==null?void 0:o.exportChart({type:"image/svg+xml"}))}}}},lang:{viewFullscreen:"View in full screen",exitFullscreen:"Exit from full screen",printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"},navigation:{buttonOptions:{symbolSize:14,symbolX:14.5,symbolY:13.5,align:"right",buttonSpacing:5,height:28,y:-5,verticalAlign:"top",width:28,symbolFill:"#666666",symbolStroke:"#666666",symbolStrokeWidth:3,theme:{fill:"#ffffff",padding:5,stroke:"none","stroke-linecap":"round"}},menuStyle:{border:"none",borderRadius:"3px",background:"#ffffff",padding:"0.5em"},menuItemStyle:{background:"none",borderRadius:"3px",color:"#333333",padding:"0.5em",fontSize:d?"0.9em":"0.8em",transition:"background 250ms, color 250ms"},menuItemHoverStyle:{background:"#f2f2f2"}}};(function(o){let e=[];function t(n,a,i,c){return[["M",n,a+2.5],["L",n+i,a+2.5],["M",n,a+c/2+.5],["L",n+i,a+c/2+.5],["M",n,a+c-1.5],["L",n+i,a+c-1.5]]}function r(n,a,i,c){let h=c/3-2;return[].concat(this.circle(i-h,a,h,h),this.circle(i-h,a+h+4,h,h),this.circle(i-h,a+2*(h+4),h,h))}o.compose=function(n){if(e.indexOf(n)===-1){e.push(n);let a=n.prototype.symbols;a.menu=t,a.menuball=r.bind(a)}}})(me||(me={}));let O=me,{composed:ve}=U(),{addEvent:B,fireEvent:oe,pushUnique:Ie}=U();function Ee(){this.fullscreen=new He(this)}class He{static compose(e){Ie(ve,"Fullscreen")&&B(e,"beforeRender",Ee)}constructor(e){this.chart=e,this.isOpen=!1;let t=e.renderTo;!this.browserProps&&(typeof t.requestFullscreen=="function"?this.browserProps={fullscreenChange:"fullscreenchange",requestFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen"}:t.mozRequestFullScreen?this.browserProps={fullscreenChange:"mozfullscreenchange",requestFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen"}:t.webkitRequestFullScreen?this.browserProps={fullscreenChange:"webkitfullscreenchange",requestFullscreen:"webkitRequestFullScreen",exitFullscreen:"webkitExitFullscreen"}:t.msRequestFullscreen&&(this.browserProps={fullscreenChange:"MSFullscreenChange",requestFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen"}))}close(){let e=this,t=e.chart,r=t.options.chart;oe(t,"fullscreenClose",null,function(){e.isOpen&&e.browserProps&&t.container.ownerDocument instanceof Document&&t.container.ownerDocument[e.browserProps.exitFullscreen](),e.unbindFullscreenEvent&&(e.unbindFullscreenEvent=e.unbindFullscreenEvent()),t.setSize(e.origWidth,e.origHeight,!1),e.origWidth=void 0,e.origHeight=void 0,r.width=e.origWidthOption,r.height=e.origHeightOption,e.origWidthOption=void 0,e.origHeightOption=void 0,e.isOpen=!1,e.setButtonText()})}open(){let e=this,t=e.chart,r=t.options.chart;oe(t,"fullscreenOpen",null,function(){if(r&&(e.origWidthOption=r.width,e.origHeightOption=r.height),e.origWidth=t.chartWidth,e.origHeight=t.chartHeight,e.browserProps){let n=B(t.container.ownerDocument,e.browserProps.fullscreenChange,function(){e.isOpen?(e.isOpen=!1,e.close()):(t.setSize(null,null,!1),e.isOpen=!0,e.setButtonText())}),a=B(t,"destroy",n);e.unbindFullscreenEvent=()=>{n(),a()};let i=t.renderTo[e.browserProps.requestFullscreen]();i&&i.catch(function(){alert("Full screen is not supported inside a frame.")})}})}setButtonText(){var i;let e=this.chart,t=(i=e.exporting)==null?void 0:i.divElements,r=e.options.exporting,n=r&&r.buttons&&r.buttons.contextButton.menuItems,a=e.options.lang;if(r&&r.menuItemDefinitions&&a&&a.exitFullscreen&&a.viewFullscreen&&n&&t){let c=t[n.indexOf("viewFullscreen")];c&&ee().setElementHTML(c,this.isOpen?a.exitFullscreen:r.menuItemDefinitions.viewFullscreen.text||a.viewFullscreen)}}toggle(){this.isOpen?this.close():this.open()}}let{win:Ue}=U(),{discardElement:je,objectEach:qe}=U(),Ae={ajax:function(o){var n;let e={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},t=new XMLHttpRequest;function r(a,i){o.error&&o.error(a,i)}if(!o.url)return!1;t.open((o.type||"get").toUpperCase(),o.url,!0),(n=o.headers)!=null&&n["Content-Type"]||t.setRequestHeader("Content-Type",e[o.dataType||"json"]||e.text),qe(o.headers,function(a,i){t.setRequestHeader(i,a)}),o.responseType&&(t.responseType=o.responseType),t.onreadystatechange=function(){var i;let a;if(t.readyState===4){if(t.status===200){if(o.responseType!=="blob"&&(a=t.responseText,o.dataType==="json"))try{a=JSON.parse(a)}catch(c){if(c instanceof Error)return r(t,c)}return(i=o.success)==null?void 0:i.call(o,a,t)}r(t,t.responseText)}},o.data&&typeof o.data!="string"&&(o.data=JSON.stringify(o.data)),t.send(o.data)},getJSON:function(o,e){Ae.ajax({url:o,success:e,dataType:"json",headers:{"Content-Type":"text/plain"}})},post:async function(o,e,t){let r=new Ue.FormData;qe(e,function(a,i){r.append(i,a)}),r.append("b64","true");let n=await Ue.fetch(o,{method:"POST",body:r,...t});if(n.ok){let a=await n.text(),i=document.createElement("a");i.href=`data:${e.type};base64,${a}`,i.download=e.filename,i.click(),je(i)}}},{defaultOptions:ze,setOptions:Ke}=U(),{downloadURL:Me,getScript:Je}={downloadURL:function(o,e){let t=g.navigator,r=ae.createElement("a");if(typeof o!="string"&&!(o instanceof String)&&t.msSaveOrOpenBlob)return void t.msSaveOrOpenBlob(o,e);if(o=""+o,t.userAgent.length>1e3)throw Error("Input too long");let n=/Edge\/\d+/.test(t.userAgent);if((Pe&&typeof o=="string"&&o.indexOf("data:application/pdf")===0||n||o.length>2e6)&&!(o=Re(o)||""))throw Error("Failed to convert to blob");if(r.download!==void 0)r.href=o,r.download=e,ae.body.appendChild(r),r.click(),ae.body.removeChild(r);else try{if(!g.open(o,"chart"))throw Error("Failed to open window")}catch{g.location.href=o}},getScript:function(o){return new Promise((e,t)=>{let r=ae.getElementsByTagName("head")[0],n=ae.createElement("script");n.type="text/javascript",n.src=o,n.onload=()=>{e()},n.onerror=()=>{t(_(`Error loading script ${o}`))},r.appendChild(n)})}},{composed:Xe,doc:ne,isFirefox:Qe,isMS:ye,isSafari:Te,SVG_NS:Ye,win:k}=U(),{addEvent:G,clearTimeout:pe,createElement:he,css:W,discardElement:ke,error:$e,extend:se,find:s,fireEvent:l,isObject:m,merge:f,objectEach:C,pick:F,pushUnique:re,removeEvent:ie,splat:Oe,uniqueKey:xe}=U();ee().allowedAttributes.push("data-z-index","fill-opacity","filter","preserveAspectRatio","rx","ry","stroke-dasharray","stroke-linejoin","stroke-opacity","text-anchor","transform","transform-origin","version","viewBox","visibility","xmlns","xmlns:xlink"),ee().allowedTags.push("desc","clippath","fedropshadow","femorphology","g","image");let le=k.URL||k.webkitURL||k;class b{constructor(e,t){this.options={},this.chart=e,this.options=t,this.btnCount=0,this.buttonOffset=0,this.divElements=[],this.svgElements=[]}static hyphenate(e){return e.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})}static async imageToDataURL(e,t,r){let n=await b.loadImage(e),a=ne.createElement("canvas"),i=a==null?void 0:a.getContext("2d");if(i)return a.height=n.height*t,a.width=n.width*t,i.drawImage(n,0,0,a.width,a.height),a.toDataURL(r);throw Error("No canvas found!")}static loadImage(e){return new Promise((t,r)=>{let n=new k.Image;n.crossOrigin="Anonymous",n.onload=()=>{setTimeout(()=>{t(n)},b.loadEventDeferDelay)},n.onerror=a=>{r(a)},n.src=e})}static prepareImageOptions(e){var n;let t=(e==null?void 0:e.type)||"image/png",r=(e==null?void 0:e.libURL)||((n=ze.exporting)==null?void 0:n.libURL);return{type:t,filename:((e==null?void 0:e.filename)||"chart")+"."+(t==="image/svg+xml"?"svg":t.split("/")[1]),scale:(e==null?void 0:e.scale)||1,libURL:(r==null?void 0:r.slice(-1))!=="/"?r+"/":r}}static sanitizeSVG(e,t){var i;let r=e.indexOf("</svg>")+6,n=e.indexOf("<foreignObject")>-1,a=e.substr(r);return e=e.substr(0,r),n?e=e.replace(/(<(?:img|br).*?(?=\>))>/g,"$1 />"):a&&((i=t==null?void 0:t.exporting)!=null&&i.allowHTML)&&(a='<foreignObject x="0" y="0" width="'+t.chart.width+'" height="'+t.chart.height+'"><body xmlns="http://www.w3.org/1999/xhtml">'+a.replace(/(<(?:img|br).*?(?=\>))>/g,"$1 />")+"</body></foreignObject>",e=e.replace("</svg>",a+"</svg>")),e=e.replace(/zIndex="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery\d+="[^"]+"/g,"").replace(/url\(("|&quot;)(.*?)("|&quot;)\;?\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (NS\d+\:)?href=/g," xlink:href=").replace(/\n+/g," ").replace(/&nbsp;/g," ").replace(/&shy;/g,"­")}static svgToDataURL(e){let t=k.navigator.userAgent,r=t.indexOf("WebKit")>-1&&0>t.indexOf("Chrome");try{if(!r&&e.indexOf("<foreignObject")===-1)return le.createObjectURL(new k.Blob([e],{type:"image/svg+xml;charset-utf-16"}))}catch{}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(e)}addButton(e){var V;let t,r=this,n=r.chart,a=n.renderer,i=f((V=n.options.navigation)==null?void 0:V.buttonOptions,e),c=i.onclick,h=i.menuItems,u=i.symbolSize||12;if(i.enabled===!1||!i.theme)return;let v=n.styledMode?{}:i.theme,R=()=>{};c?R=function(E){E&&E.stopPropagation(),c.call(n,E)}:h&&(R=function(E){E&&E.stopPropagation(),r.contextMenu(y.menuClassName,h,y.translateX||0,y.translateY||0,y.width||0,y.height||0,y),y.setState(2)}),i.text&&i.symbol?v.paddingLeft=F(v.paddingLeft,30):i.text||se(v,{width:i.width,height:i.height,padding:0});let y=a.button(i.text||"",0,0,R,v,void 0,void 0,void 0,void 0,i.useHTML).addClass(e.className||"").attr({title:F(n.options.lang[i._titleKey||i.titleKey],"")});y.menuClassName=e.menuClassName||"highcharts-menu-"+r.btnCount++,i.symbol&&(t=a.symbol(i.symbol,Math.round((i.symbolX||0)-u/2),Math.round((i.symbolY||0)-u/2),u,u,{width:u,height:u}).addClass("highcharts-button-symbol").attr({zIndex:1}).add(y),n.styledMode||t.attr({stroke:i.symbolStroke,fill:i.symbolFill,"stroke-width":i.symbolStrokeWidth||1})),y.add(r.group).align(se(i,{width:y.width,x:F(i.x,r.buttonOffset)}),!0,"spacingBox"),r.buttonOffset+=((y.width||0)+(i.buttonSpacing||0))*(i.align==="right"?-1:1),r.svgElements.push(y,t)}afterPrint(){let e=this.chart;if(!this.printReverseInfo)return;let{childNodes:t,origDisplay:r,resetParams:n}=this.printReverseInfo;this.moveContainers(e.renderTo),[].forEach.call(t,function(a,i){a.nodeType===1&&(a.style.display=r[i]||"")}),this.isPrinting=!1,n&&e.setSize.apply(e,n),delete this.printReverseInfo,b.printingChart=void 0,l(e,"afterPrint")}beforePrint(){var a;let e=this.chart,t=ne.body,r=this.options.printMaxWidth,n={childNodes:t.childNodes,origDisplay:[],resetParams:void 0};this.isPrinting=!0,(a=e.pointer)==null||a.reset(void 0,0),l(e,"beforePrint"),r&&e.chartWidth>r&&(n.resetParams=[e.options.chart.width,void 0,!1],e.setSize(r,void 0,!1)),[].forEach.call(n.childNodes,function(i,c){i.nodeType===1&&(n.origDisplay[c]=i.style.display,i.style.display="none")}),this.moveContainers(t),this.printReverseInfo=n}contextMenu(e,t,r,n,a,i,c){var A,D,be;let h=this,u=h.chart,v=u.options.navigation,R=u.chartWidth,y=u.chartHeight,V="cache-"+e,E=Math.max(a,i),$,N=u[V];N||(h.contextMenuEl=u[V]=N=he("div",{className:e},{position:"absolute",zIndex:1e3,padding:E+"px",pointerEvents:"auto",...u.renderer.style},((A=u.scrollablePlotArea)==null?void 0:A.fixedDiv)||u.container),$=he("ul",{className:"highcharts-menu"},u.styledMode?{}:{listStyle:"none",margin:0,padding:0},N),u.styledMode||W($,se({MozBoxShadow:"3px 3px 10px #0008",WebkitBoxShadow:"3px 3px 10px #0008",boxShadow:"3px 3px 10px #0008"},(v==null?void 0:v.menuStyle)||{})),N.hideMenu=function(){W(N,{display:"none"}),c&&c.setState(0),u.exporting&&(u.exporting.openMenu=!1),W(u.renderTo,{overflow:"hidden"}),W(u.container,{overflow:"hidden"}),pe(N.hideTimer),l(u,"exportMenuHidden")},(D=h.events)==null||D.push(G(N,"mouseleave",function(){N.hideTimer=k.setTimeout(N.hideMenu,500)}),G(N,"mouseenter",function(){pe(N.hideTimer)}),G(ne,"mouseup",function(I){var ue;(ue=u.pointer)!=null&&ue.inClass(I.target,e)||N.hideMenu()}),G(N,"click",function(){var I;(I=u.exporting)!=null&&I.openMenu&&N.hideMenu()})),t.forEach(function(I){var ue;if(typeof I=="string"&&((ue=h.options.menuItemDefinitions)!=null&&ue[I])&&(I=h.options.menuItemDefinitions[I]),m(I,!0)){let we;I.separator?we=he("hr",void 0,void 0,$):(I.textKey==="viewData"&&h.isDataTableVisible&&(I.textKey="hideData"),we=he("li",{className:"highcharts-menu-item",onclick:function(nt){nt&&nt.stopPropagation(),N.hideMenu(),typeof I!="string"&&I.onclick&&I.onclick.apply(u,arguments)}},void 0,$),ee().setElementHTML(we,I.text||u.options.lang[I.textKey]),u.styledMode||(we.onmouseover=function(){W(this,(v==null?void 0:v.menuItemHoverStyle)||{})},we.onmouseout=function(){W(this,(v==null?void 0:v.menuItemStyle)||{})},W(we,se({cursor:"pointer"},(v==null?void 0:v.menuItemStyle)||{})))),h.divElements.push(we)}}),h.divElements.push($,N),h.menuHeight=N.offsetHeight,h.menuWidth=N.offsetWidth);let x={display:"block"};r+(h.menuWidth||0)>R?x.right=R-r-a-E+"px":x.left=r-E+"px",n+i+(h.menuHeight||0)>y&&((be=c.alignOptions)==null?void 0:be.verticalAlign)!=="top"?x.bottom=y-n-E+"px":x.top=n+i-E+"px",W(N,x),W(u.renderTo,{overflow:""}),W(u.container,{overflow:""}),u.exporting&&(u.exporting.openMenu=!0),l(u,"exportMenuShown")}destroy(e){let t,r=e?e.target:this.chart,{divElements:n,events:a,svgElements:i}=this;i.forEach((c,h)=>{c&&(c.onclick=c.ontouchstart=null,r[t="cache-"+c.menuClassName]&&delete r[t],i[h]=c.destroy())}),i.length=0,this.group&&(this.group.destroy(),delete this.group),n.forEach(function(c,h){c&&(pe(c.hideTimer),ie(c,"mouseleave"),n[h]=c.onmouseout=c.onmouseover=c.ontouchstart=c.onclick=null,ke(c))}),n.length=0,a&&(a.forEach(function(c){c()}),a.length=0)}async downloadSVG(e,t){let r,n={svg:e,exportingOptions:t,exporting:this};if(l(b.prototype,"downloadSVG",n),n.defaultPrevented)return;let{type:a,filename:i,scale:c,libURL:h}=b.prepareImageOptions(t);if(a==="application/pdf")throw Error("Offline exporting logic for PDF type is not found.");if(a==="image/svg+xml"){if(k.MSBlobBuilder!==void 0){let u=new k.MSBlobBuilder;u.append(e),r=u.getBlob("image/svg+xml")}else r=b.svgToDataURL(e);Me(r,i)}else{r=b.svgToDataURL(e);try{b.objectURLRevoke=!0;let u=await b.imageToDataURL(r,c,a);Me(u,i)}catch(u){if(u.message==="No canvas found!")throw u;if(e.length>1e8)throw Error("Input too long");let v=ne.createElement("canvas"),R=v.getContext("2d"),y=e.match(/^<svg[^>]*\s{,1000}width\s{,1000}=\s{,1000}\"?(\d+)\"?[^>]*>/),V=e.match(/^<svg[^>]*\s{0,1000}height\s{,1000}=\s{,1000}\"?(\d+)\"?[^>]*>/);if(R&&y&&V){let E=y[1]*c,$=V[1]*c;v.width=E,v.height=$,k.canvg||(b.objectURLRevoke=!0,await Je(h+"canvg.js")),k.canvg.Canvg.fromString(R,e).start(),Me(k.navigator.msSaveOrOpenBlob?v.msToBlob():v.toDataURL(a),i)}}finally{if(b.objectURLRevoke)try{le.revokeObjectURL(r)}catch{}}}}async exportChart(e,t){if((e=f(this.options,e)).local)await this.localExport(e,t||{});else{let r=this.getSVGForExport(e,t);e.url&&await Ae.post(e.url,{filename:e.filename?e.filename.replace(/\//g,"-"):this.getFilename(),type:e.type,width:e.width,scale:e.scale,svg:r},e.fetchOptions)}}async fallbackToServer(e,t){e.fallbackToExportServer===!1?e.error?e.error(e,t):$e(28,!0):e.type==="application/pdf"&&(e.local=!1,await this.exportChart(e))}getChartHTML(e){let t=this.chart;return e&&this.inlineStyles(),this.resolveCSSVariables(),t.container.innerHTML}getFilename(){var r;let e=(r=this.chart.userOptions.title)==null?void 0:r.text,t=this.options.filename;return t?t.replace(/\//g,"-"):(typeof e=="string"&&(t=e.toLowerCase().replace(/<\/?[^>]+(>|$)/g,"").replace(/[\s_]+/g,"-").replace(/[^a-z\d\-]/g,"").replace(/^[\-]+/g,"").replace(/[\-]+/g,"-").substr(0,24).replace(/[\-]+$/g,"")),(!t||t.length<5)&&(t="chart"),t)}getSVG(e){var V,E,$,N;let t=this.chart,r,n,a=f(t.options,e);a.plotOptions=f(t.userOptions.plotOptions,e==null?void 0:e.plotOptions),a.time=f(t.userOptions.time,e==null?void 0:e.time);let i=he("div",void 0,{position:"absolute",top:"-9999em",width:t.chartWidth+"px",height:t.chartHeight+"px"},ne.body),c=t.renderTo.style.width,h=t.renderTo.style.height,u=((V=a.exporting)==null?void 0:V.sourceWidth)||a.chart.width||/px$/.test(c)&&parseInt(c,10)||(a.isGantt?800:600),v=((E=a.exporting)==null?void 0:E.sourceHeight)||a.chart.height||/px$/.test(h)&&parseInt(h,10)||400;se(a.chart,{animation:!1,renderTo:i,forExport:!0,renderer:"SVGRenderer",width:u,height:v}),a.exporting&&(a.exporting.enabled=!1),delete a.data,a.series=[],t.series.forEach(function(x){var A;(n=f(x.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:x.visible})).isInternal||((A=a==null?void 0:a.series)==null||A.push(n))});let R={};t.axes.forEach(function(x){x.userOptions.internalKey||(x.userOptions.internalKey=xe()),a&&!x.options.isInternal&&(R[x.coll]||(R[x.coll]=!0,a[x.coll]=[]),a[x.coll].push(f(x.userOptions,{visible:x.visible,type:x.type,uniqueNames:x.uniqueNames})))}),a.colorAxis=t.userOptions.colorAxis;let y=new t.constructor(a,t.callback);return e&&["xAxis","yAxis","series"].forEach(function(x){e[x]&&y.update({[x]:e[x]})}),t.axes.forEach(function(x){let A=s(y.axes,D=>D.options.internalKey===x.userOptions.internalKey);if(A){let D=x.getExtremes(),be=Oe((e==null?void 0:e[x.coll])||{})[0],I="min"in be?be.min:D.userMin,ue="max"in be?be.max:D.userMax;(I!==void 0&&I!==A.min||ue!==void 0&&ue!==A.max)&&A.setExtremes(I??void 0,ue??void 0,!0,!1)}}),r=((N=y.exporting)==null?void 0:N.getChartHTML(t.styledMode||(($=a.exporting)==null?void 0:$.applyStyleSheets)))||"",l(t,"getSVG",{chartCopy:y}),r=b.sanitizeSVG(r,a),a=void 0,y.destroy(),ke(i),r}getSVGForExport(e,t){let r=this.options;return this.getSVG(f({chart:{borderRadius:0}},r.chartOptions,t,{exporting:{sourceWidth:(e==null?void 0:e.sourceWidth)||r.sourceWidth,sourceHeight:(e==null?void 0:e.sourceHeight)||r.sourceHeight}}))}inlineStyles(){var c;let e,t=b.inlineDenylist,r=b.inlineAllowlist,n={},a=he("iframe",void 0,{width:"1px",height:"1px",visibility:"hidden"},ne.body),i=(c=a.contentWindow)==null?void 0:c.document;i&&i.body.appendChild(i.createElementNS(Ye,"svg")),function h(u){let v,R,y,V,E,$,N={};if(i&&u.nodeType===1&&b.unstyledElements.indexOf(u.nodeName)===-1){if(v=k.getComputedStyle(u,null),R=u.nodeName==="svg"?{}:k.getComputedStyle(u.parentNode,null),!n[u.nodeName]){e=i.getElementsByTagName("svg")[0],y=i.createElementNS(u.namespaceURI,u.nodeName),e.appendChild(y);let x=k.getComputedStyle(y,null),A={};for(let D in x)D.length<1e3&&typeof x[D]=="string"&&!/^\d+$/.test(D)&&(A[D]=x[D]);n[u.nodeName]=A,u.nodeName==="text"&&delete n.text.fill,e.removeChild(y)}for(let x in v)(Qe||ye||Te||Object.hasOwnProperty.call(v,x))&&function(A,D){if(V=E=!1,r.length){for($=r.length;$--&&!E;)E=r[$].test(D);V=!E}for(D==="transform"&&A==="none"&&(V=!0),$=t.length;$--&&!V;){if(D.length>1e3)throw Error("Input too long");V=t[$].test(D)||typeof A=="function"}!V&&(R[D]!==A||u.nodeName==="svg")&&n[u.nodeName][D]!==A&&(b.inlineToAttributes&&b.inlineToAttributes.indexOf(D)===-1?N[D]=A:A&&u.setAttribute(b.hyphenate(D),A))}(v[x],x);if(W(u,N),u.nodeName==="svg"&&u.setAttribute("stroke-width","1px"),u.nodeName==="text")return;[].forEach.call(u.children||u.childNodes,h)}}(this.chart.container.querySelector("svg")),e.parentNode.removeChild(e),a.parentNode.removeChild(a)}async localExport(e,t){let r=this.chart,n,a,i=null,c;if(ye&&r.styledMode&&!b.inlineAllowlist.length&&b.inlineAllowlist.push(/^blockSize/,/^border/,/^caretColor/,/^color/,/^columnRule/,/^columnRuleColor/,/^cssFloat/,/^cursor/,/^fill$/,/^fillOpacity/,/^font/,/^inlineSize/,/^length/,/^lineHeight/,/^opacity/,/^outline/,/^parentRule/,/^rx$/,/^ry$/,/^stroke/,/^textAlign/,/^textAnchor/,/^textDecoration/,/^transform/,/^vectorEffect/,/^visibility/,/^x$/,/^y$/),ye&&(e.type==="application/pdf"||r.container.getElementsByTagName("image").length&&e.type!=="image/svg+xml")||e.type==="application/pdf"&&[].some.call(r.container.getElementsByTagName("image"),function(u){let v=u.getAttribute("href");return v!==""&&typeof v=="string"&&v.indexOf("data:")!==0}))return void await this.fallbackToServer(e,Error("Image type not supported for this chart/browser."));let h=G(r,"getSVG",u=>{a=u.chartCopy.options,c=(n=u.chartCopy.container.cloneNode(!0))&&n.getElementsByTagName("image")||[]});try{let u;for(let R of(this.getSVGForExport(e,t),c?Array.from(c):[]))if(i=R.getAttributeNS("http://www.w3.org/1999/xlink","href")){b.objectURLRevoke=!1;let y=await b.imageToDataURL(i,(e==null?void 0:e.scale)||1,(e==null?void 0:e.type)||"image/png");R.setAttributeNS("http://www.w3.org/1999/xlink","href",y)}else R.parentNode.removeChild(R);let v=(u=n==null?void 0:n.innerHTML,b.sanitizeSVG(u||"",a));if(v.indexOf("<foreignObject")>-1&&e.type!=="image/svg+xml"&&(ye||e.type==="application/pdf"))throw Error("Image type not supported for charts with embedded HTML");return await this.downloadSVG(v,se({filename:this.getFilename()},e)),v}catch(u){await this.fallbackToServer(e,u)}finally{h()}}moveContainers(e){let t=this.chart,{scrollablePlotArea:r}=t;(r?[r.fixedDiv,r.scrollingContainer]:[t.container]).forEach(function(n){e.appendChild(n)})}print(){let e=this.chart;this.isPrinting||(b.printingChart=e,Te||this.beforePrint(),setTimeout(()=>{k.focus(),k.print(),Te||setTimeout(()=>{var t;(t=e.exporting)==null||t.afterPrint()},1e3)},1))}render(){let e=this,{chart:t,options:r}=e,n=(e==null?void 0:e.isDirty)||!(e!=null&&e.svgElements.length);e.buttonOffset=0,e.isDirty&&e.destroy(),n&&r.enabled!==!1&&(e.events=[],e.group||(e.group=t.renderer.g("exporting-group").attr({zIndex:3}).add()),C(r==null?void 0:r.buttons,function(a){e.addButton(a)}),e.isDirty=!1)}resolveCSSVariables(){Array.from(this.chart.container.querySelectorAll("*")).forEach(e=>{["color","fill","stop-color","stroke"].forEach(t=>{var a;let r=e.getAttribute(t);r!=null&&r.includes("var(")&&e.setAttribute(t,getComputedStyle(e).getPropertyValue(t));let n=(a=e.style)==null?void 0:a[t];n!=null&&n.includes("var(")&&(e.style[t]=getComputedStyle(e).getPropertyValue(t))})})}update(e,t){this.isDirty=!0,f(!0,this.options,e),F(t,!0)&&this.chart.redraw()}}b.inlineAllowlist=[],b.inlineDenylist=[/-/,/^(clipPath|cssText|d|height|width)$/,/^font$/,/[lL]ogical(Width|Height)$/,/^parentRule$/,/^(cssRules|ownerRules)$/,/perspective/,/TapHighlightColor/,/^transition/,/^length$/,/^\d+$/],b.inlineToAttributes=["fill","stroke","strokeLinecap","strokeLinejoin","strokeWidth","textAnchor","x","y"],b.loadEventDeferDelay=150*!!ye,b.unstyledElements=["clipPath","defs","desc"],function(o){function e(n){let a=n.exporting;a&&(a.render(),G(n,"redraw",function(){var i;(i=this.exporting)==null||i.render()}),G(n,"destroy",function(){var i;(i=this.exporting)==null||i.destroy()}))}function t(){let n=this;n.options.exporting&&(n.exporting=new o(n,n.options.exporting),te.compose(n).navigation.addUpdate((a,i)=>{n.exporting&&(n.exporting.isDirty=!0,f(!0,n.options.navigation,a),F(i,!0)&&n.redraw())}))}function r({alignTo:n,key:a,textPxLength:i}){var E,$,N;let c=this.options.exporting,{align:h,buttonSpacing:u=0,verticalAlign:v,width:R=0}=f((E=this.options.navigation)==null?void 0:E.buttonOptions,($=c==null?void 0:c.buttons)==null?void 0:$.contextButton),y=n.width-i,V=R+u;((c==null?void 0:c.enabled)??!0)&&a==="title"&&h==="right"&&v==="top"&&y<2*V&&(y<V?n.width-=V:((N=this.title)==null?void 0:N.alignValue)!=="left"&&(n.x-=V-y/2))}o.compose=function(n,a){O.compose(a),He.compose(n),re(Xe,"Exporting")&&(se(Se().prototype,{exportChart:async function(i,c){var h;await((h=this.exporting)==null?void 0:h.exportChart(i,c))},getChartHTML:function(i){var c;return(c=this.exporting)==null?void 0:c.getChartHTML(i)},getFilename:function(){var i;return(i=this.exporting)==null?void 0:i.getFilename()},getSVG:function(i){var c;return(c=this.exporting)==null?void 0:c.getSVG(i)},print:function(){var i;return(i=this.exporting)==null?void 0:i.print()}}),n.prototype.callbacks.push(e),G(n,"afterInit",t),G(n,"layOutTitle",r),Te&&k.matchMedia("print").addListener(function(i){var c,h;o.printingChart&&(i.matches?(c=o.printingChart.exporting)==null||c.beforePrint():(h=o.printingChart.exporting)==null||h.afterPrint())}),Ke(p))}}(b||(b={}));let Be=b,z=U();z.Exporting=Be,z.HttpUtilities=z.HttpUtilities||Ae,z.ajax=z.HttpUtilities.ajax,z.getJSON=z.HttpUtilities.getJSON,z.post=z.HttpUtilities.post,Be.compose(z.Chart,z.Renderer);let q=U();return L.default})())}(_e)),_e.exports}Ot();const Ft={class:"va-h3"},Vt={class:"dash-kpi"},Dt={class:"kpi-card"},Pt={class:"kval"},Rt={class:"kpi-card"},It={class:"kval"},At={class:"kpi-card"},Mt={class:"kval"},$t={class:"kpi-card"},Lt={class:"kval"},Ht={class:"chart-card"},Ut={class:"chart-card"},jt={key:0,class:"loading"},qt={key:1,class:"empty"},Bt={__name:"DashboardModal",props:{modelValue:{type:Boolean,default:!1},page:{type:Object,default:null},day:{type:String,required:!0},smena:{type:[String,Number],required:!0},factoryId:{type:[String,Number],required:!0},structureId:{type:[String,Number],required:!0}},emits:["update:modelValue"],setup(De,{emit:K}){const S=De,ce=K,Ne=H({get:()=>S.modelValue,set:d=>ce("update:modelValue",d)}),{locale:J}=ut(),me=d=>{if(!d)return 0;const[p,O]=String(d).split(":").map(Number);return isNaN(p)||isNaN(O)?0:p*60+O},j=(d="")=>/ph/i.test(d)?"pH":/nacn/i.test(d)?"NaCN":/\bAg\b/i.test(d)?"Ag":/\bAu\b/i.test(d)?"Au":"Other",de=d=>d.length?+(d.reduce((p,O)=>p+O,0)/d.length).toFixed(2):0,P=M(!1),L=M([]),Z=H(()=>S.page?`Dashboard — ${S.page.Name}`:"Dashboard"),U=async()=>{if(!(!S.page||!S.day||!S.smena)){P.value=!0;try{const[d,p]=await Promise.all([X.get(`/get-params-for-user/${S.factoryId}/${S.smena}/${S.day}/${S.page.NumberPage}`),X.get(`/vparams-value/${S.structureId}/${S.day}/${S.smena}`)]),O=Array.isArray(d.data)?d.data:[],ve=Array.isArray(p.data)?p.data:[];L.value=O.map(B=>{const oe=ve.find(Ee=>Ee.TimeStr===B.GTName&&Ee.ParametersID===B.ParametersID),Ie=J.value==="ru"?B.PNameRus:B.PName;return{...B,...oe||{},PNameAny:Ie,Type:j(B.PName||B.PNameRus||""),ValueNum:oe&&oe.Value!=null?Number(oe.Value):null,EndMin:me(B.ETime)}})}catch(d){console.error("DashboardModal fetch error:",d),L.value=[]}finally{P.value=!1}}};et([()=>S.modelValue,()=>{var d;return(d=S.page)==null?void 0:d.NumberPage},()=>S.day,()=>S.smena,()=>J.value],([d])=>{d&&U()},{immediate:!1});const w=H(()=>L.value.filter(d=>d.ValueNum!=null&&!Number.isNaN(d.ValueNum)).sort((d,p)=>d.EndMin-p.EndMin||d.OrderNumber-p.OrderNumber)),ee=H(()=>{const d=w.value.map(p=>p.ValueNum);return d.length?Math.min(...d):NaN}),ge=H(()=>{const d=w.value.map(p=>p.ValueNum);return d.length?Math.max(...d):NaN}),Se=H(()=>de(w.value.map(d=>d.ValueNum))),te=H(()=>w.value.map(d=>`${String(d.ETime||"").slice(0,5)} • ${d.PNameAny||""}`)),Pe=H(()=>w.value.map(d=>d.ValueNum));H(()=>{const d={};return w.value.forEach(p=>{d[p.Type]||(d[p.Type]=[]),d[p.Type].push(p.ValueNum)}),Object.entries(d).map(([p,O])=>({type:p,avg:de(O)}))});const g=H(()=>({chart:{type:"line",height:320},title:{text:null},xAxis:{categories:te.value,labels:{rotation:-35}},yAxis:{title:{text:"Qiymat"}},tooltip:{shared:!0},series:[{name:"Qiymat",data:Pe.value}]})),ae=H(()=>{const d={};return w.value.forEach(p=>{const O=p.ParametersID||p.PNameAny||"Unknown";d[O]||(d[O]={name:p.PNameAny||O,sum:0,cnt:0}),d[O].sum+=Number(p.ValueNum),d[O].cnt+=1}),Object.values(d).map(p=>({name:p.name,avg:+(p.sum/p.cnt).toFixed(2)})).sort((p,O)=>O.avg-p.avg)}),_=H(()=>ae.value.map(d=>d.name)),fe=H(()=>ae.value.map(d=>d.avg)),Re=H(()=>({chart:{type:"column",height:320},title:{text:null},xAxis:{categories:_.value,labels:{rotation:-35}},yAxis:{title:{text:"O'rtacha qiymat"}},tooltip:{shared:!0,pointFormat:"<b>{point.y}</b>"},series:[{name:"O'rtacha",data:fe.value}]}));return(d,p)=>{const O=tt("VaModal");return Ce(),at(O,{modelValue:Ne.value,"onUpdate:modelValue":p[0]||(p[0]=ve=>Ne.value=ve),"close-button":"",fullscreen:"","hide-default-actions":""},{default:Fe(()=>[T("h3",Ft,Ve(Z.value),1),T("div",Vt,[T("div",Dt,[p[1]||(p[1]=T("div",{class:"kcap"},"Yozuvlar",-1)),T("div",Pt,Ve(w.value.length),1)]),T("div",Rt,[p[2]||(p[2]=T("div",{class:"kcap"},"O'rtacha",-1)),T("div",It,Ve(Se.value),1)]),T("div",At,[p[3]||(p[3]=T("div",{class:"kcap"},"Minimum",-1)),T("div",Mt,Ve(isFinite(ee.value)?ee.value:"—"),1)]),T("div",$t,[p[4]||(p[4]=T("div",{class:"kcap"},"Maksimum",-1)),T("div",Lt,Ve(isFinite(ge.value)?ge.value:"—"),1)])]),p[7]||(p[7]=T("div",{class:"dash-charts"},null,-1)),T("div",Ht,[p[5]||(p[5]=T("div",{class:"ctitle"},"Vaqt bo'yicha qiymatlar",-1)),Y(Q(rt.Chart),{highcharts:Q(st),options:g.value},null,8,["highcharts","options"])]),T("div",Ut,[p[6]||(p[6]=T("div",{class:"ctitle"},"Parametr turiga ko'ra o'rtacha",-1)),Y(Q(rt.Chart),{highcharts:Q(st),options:Re.value},null,8,["highcharts","options"])]),P.value?(Ce(),We("div",jt,"Yuklanmoqda…")):w.value.length?ct("",!0):(Ce(),We("div",qt,"Ma'lumot topilmadi"))]),_:1,__:[7]},8,["modelValue"])}}},Gt=ht(Bt,[["__scopeId","data-v-96a61ada"]]),_t={class:"grid grid-rows-[55px,1fr]"},Wt={class:"flex flex-col"},zt={class:"m-2 flex pt-3"},Kt={class:"flex justify-end"},Jt=["onContextmenu"],Xt=480,Qt=1199,na={__name:"ParametrValueVertical",props:{id:Number},setup(De){const K=mt(),S=M(!1),ce=M(null),Ne=s=>{ce.value=s,S.value=!0},J=De,me=gt(),{t:j,locale:de}=ut(),P=M([]),L=M(null),Z=M({}),U=M([]),w=M({smena:null,day:null}),ee=H(()=>w.value.day?`${w.value.day} - ${w.value.smena}`:"");M(null);const ge=M(null);M(null);const Se=M(null);M(null);const te=M(null),Pe=K.state.user.id;K.state.user.structure_id;const g=M("1");M([]);const ae=M([]),_=M([]),fe=M({}),Re=it({ParametersID:"",Change:"",Name:"",ShortName:"",Comment:"",GTime:"",Value:"",BlogsID:K.state.user.structure_id,SourceID:"",userId:K.state.user.id});et(()=>K.state.user.roles,s=>{Array.isArray(s)&&s.length>14&&(fe.value=s[14])},{immediate:!0});const d=s=>{var l,m;return((m=(l=fe.value)==null?void 0:l.pivot)==null?void 0:m[s])==="1"},p=async()=>{var f,C;if(!_.value.length)return;const s=Ze.book_new();for(const F of _.value)try{const re=w.value.day,ie=w.value.smena,[Oe,xe]=await X.all([X.get(`/get-params-for-user/${J.id}/${ie}/${re}/${F.NumberPage}`),X.get(`/vparams-value/${K.state.user.structure_id}/${re}/${ie}`)]),le=Array.isArray(Oe.data)?Oe.data:[],b=Array.isArray(xe.data)?xe.data:[];le.forEach((q,o)=>{const e=b.find(t=>t.TimeStr===q.GTName&&t.ParametersID===q.ParametersID);e&&(le[o]={...q,...e})});const Be=le.map((q,o)=>({"№":o+1,Smena:q.Change,"Tartib raqami":q.OrderNumber,Parametrlar:de.value==="ru"?q.PNameRus:q.PName,"Boshlanish soati":q.STime,"Tugash soati":q.ETime,Min:q.Min,Max:q.Max,Qiymat:q.Value,Izoh:q.Comment})),z=Ze.json_to_sheet(Be);Ze.book_append_sheet(s,z,F.Name.substring(0,31))}catch(re){console.error(`Xatolik sahifa "${F.Name}" uchun:`,re)}const l=((f=w.value)==null?void 0:f.day)??"unknown",m=((C=w.value)==null?void 0:C.smena)??"X";Nt(s,`Export-${l}-smena${m}.xlsx`)},O=H(()=>d("create"));H(()=>d("view"));const ve=it({id:"",Comment:"",Value:"",userId:K.state.user.id}),B=H(()=>[{headerName:j("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80,headerClass:"header-center",editable:!1,suppressNavigable:!0,cellClassRules:{"cell-green":l=>{var m;return l.data&&l.data.Value===((m=Z.value)==null?void 0:m[l.data.id])},"cell-yellow":l=>{var m,f;return l.data&&l.data.Value!==((m=Z.value)==null?void 0:m[l.data.id])&&((f=Z.value)==null?void 0:f[l.data.id])===void 0&&l.data.WithFormula!=="1"},"cell-pink":l=>l.data&&l.data.WithFormula==="1"}},{headerName:j("table.change"),field:"Change",width:80,headerClass:"header-center",editable:!1,suppressNavigable:!0},{headerName:j("table.OrderNumber"),field:"OrderNumber",width:80,headerClass:"header-center",editable:!1,suppressNavigable:!0},{headerName:j("table.parameters"),field:de.value==="ru"?"PNameRus":"PName",flex:1,headerClass:"header-center",editable:!1,suppressNavigable:!0},{headerName:j("table.graphictimes"),headerClass:"header-center",children:[{headerName:j("table.startingTime"),field:"STime",width:120,valueFormatter:l=>Le(new Date(`1970-01-01T${l.value}`),"HH:mm"),headerClass:"header-center",editable:!1,suppressNavigable:!0},{headerName:j("table.endingTime"),field:"ETime",width:120,valueFormatter:l=>Le(new Date(`1970-01-01T${l.value}`),"HH:mm"),headerClass:"header-center",editable:!1,suppressNavigable:!0}]},{headerName:j("table.interval"),headerClass:"header-center",children:[{headerName:j("table.min"),field:"Min",width:100,headerClass:"header-center",editable:!1,suppressNavigable:!0},{headerName:j("table.max"),field:"Max",width:100,headerClass:"header-center",editable:!1,suppressNavigable:!0}]},{headerName:j("table.value"),field:"Value",width:150,editable:l=>O.value&&l.data.WithFormula!=="1",suppressNavigable:!1,cellEditor:"agNumberCellEditor",cellEditorPopup:!1,cellClassRules:{"cell-green":l=>{var m;return l.data&&l.data.Value===((m=Z.value)==null?void 0:m[l.data.id])},"cell-yellow":l=>{var m,f;return l.data&&l.data.Value!==((m=Z.value)==null?void 0:m[l.data.id])&&((f=Z.value)==null?void 0:f[l.data.id])===void 0&&l.data.WithFormula!=="1"},"cell-pink":l=>l.data&&l.data.WithFormula==="1"},cellStyle:()=>({"font-size":"16px","text-align":"center"}),headerClass:"header-center"},{headerName:j("table.comment"),field:"Comment",flex:1,editable:()=>O.value,suppressNavigable:!1,cellEditor:"agLargeTextCellEditor",cellEditorPopup:!0,headerClass:"header-center"}]),oe=s=>{s.key===" "&&(s.preventDefault(),s.shiftKey?parseInt(g.value)>1?g.value=String(parseInt(g.value)-1):g.value=String(_.value.length):parseInt(g.value)<_.value.length?g.value=String(parseInt(g.value)+1):g.value="1")},Ie=s=>{(s.key==="ArrowUp"||s.key==="ArrowDown"||s.key==="ArrowLeft"||s.key==="ArrowRight")&&(s.preventDefault(),document.activeElement.classList.contains("ag-cell")&&L.navigateToNextCell({key:s.key}))},Ee=()=>{window.addEventListener("keydown",s=>{s.key===" "&&He(s),["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(s.key)&&Ie(s)})},He=s=>{s.key===" "&&(s.preventDefault(),s.shiftKey?parseInt(g.value)>1?g.value=String(parseInt(g.value)-1):g.value=String(_.value.length):parseInt(g.value)<_.value.length?g.value=String(parseInt(g.value)+1):g.value="1")};function Ue(){const s=Se.value;document.fullscreenElement?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():s.requestFullscreen?s.requestFullscreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.webkitRequestFullscreen?s.webkitRequestFullscreen():s.msRequestFullscreen&&s.msRequestFullscreen()}const je=async()=>{try{const s=await X.get("/changes"),l=await X.get(`/pages-select/${J.id}`);_.value=l.data;const m=await X.get(`/paramWithId/${J.id}`);U.value=s.data.map(f=>({value:f.Change,text:f.Change})),ae.value=m.data.map(f=>({value:f.Pid,text:f.PName}))}catch(s){console.error("Error fetching graphics data:",s)}},qe={sortable:!0,filter:!0,resizable:!0},Ae=s=>s.data.STime&&s.data.ETime&&s.data.Value?"row-green":"",ze={columnDefs:B.value,suppressScrollOnNewData:!0,getRowClass:Ae,headerHeight:27,rowHeight:30,navigateToNextCell:s=>{const{key:l}=s.event;return l==="ArrowUp"||l==="ArrowDown"||l==="ArrowLeft"||l==="ArrowRight"?!0:s.previousCellDef}},Ke=s=>{},Me=()=>{const s=new Date;return s.getHours()*60+s.getMinutes()},Je=()=>{const s=Me();return s>=Xt&&s<=Qt?1:2},Xe=()=>{me.push("/vparamsget")};Re.Change=Je();async function ne(s){try{const l=w.value.day,m=w.value.smena,[f,C]=await X.all([X.get(`/get-params-for-user/${J.id}/${m}/${l}/${s}`),X.get(`/vparams-value/${K.state.user.structure_id}/${l}/${m}`)]),F=Array.isArray(f.data)?f.data:[],re=Array.isArray(C.data)?C.data:[];F.forEach((ie,Oe)=>{const xe=re.find(le=>le.TimeStr==ie.GTName&&le.ParametersID==ie.ParametersID);xe&&(F[Oe]={...ie,...xe})}),P.value=Array.isArray(F)?F:[]}catch(l){console.error("Error fetching data:",l),P.value=[]}}et([()=>w.value.day,()=>w.value.smena,()=>g.value],([s,l,m],[f,C,F])=>{s&&l&&m&&(s!==f||l!==C||m!==F)&&ne(m)},{immediate:!0});const Qe=async s=>{const{data:l,colDef:m,newValue:f,oldValue:C}=s;if(f!==C)try{await ye(l,g.value);const F=s.rowIndex,re=L.value.getDisplayedRowCount();if(L.value&&L.value.ensureIndexVisible(F,"bottom"),F<re-1){L.value.stopEditing();const ie=m.field==="Value"?"Value":"Comment";L.value.setFocusedCell(F+1,ie)}}catch(F){console.error("Error saving data",F)}},ye=async(s,l)=>{const m=w.value.smena,f=w.value.day;try{const C=await X.post("/vparams",{...s,userId:Pe,change:m,daySelect:f});return Te(),await ne(l),C}catch(C){console.error("Error saving data",C)}},Te=()=>{L.value&&L.value.clearFocusedCell()},Ye=()=>{pe.value&&L.value&&(L.value.stopEditing(),pe.value=!1)};let k=null,G=null,pe=M(!1);const he=s=>{const{column:l}=s;if(l){const m=l.getColId();m==="Value"||m==="Comment"?($e(),pe.value=!0,te.value&&clearTimeout(te.value),te.value=setTimeout(Ye,6e4)):ke()}},W=s=>{const{column:l}=s;if(l){const m=l.getColId();(m==="Value"||m==="Comment")&&($e(),pe.value=!1,te.value&&(clearTimeout(te.value),te.value=null))}},ke=()=>{k||(k=setInterval(()=>{g.value&&ne(g.value)},6e4)),G||(G=setInterval(je,6e4))},$e=()=>{k&&(clearInterval(k),k=null),G&&(clearInterval(G),G=null)},se=s=>{console.log(s),L.value=s.api,s.api.addEventListener("cellFocused",he),s.api.addEventListener("cellBlurred",W),ke()};return ft(()=>{const s=new Date,l=s.getHours(),m=s.getMinutes();if(l>=8&&l<20||l===19&&m<=59)w.value.smena=1,w.value.day=Le(s,"yyyy-MM-dd");else if(w.value.smena=2,l<8){const f=new Date(s);f.setDate(s.getDate()-1),w.value.day=Le(f,"yyyy-MM-dd")}else w.value.day=Le(s,"yyyy-MM-dd");je().then(()=>{_.value.length>0&&(g.value=_.value[0].NumberPage)}),ke(),Ee()}),vt(()=>{$e()}),(s,l)=>{const m=tt("VaTab"),f=tt("ag-grid-vue");return Ce(),We("div",_t,[l[6]||(l[6]=T("main",null,null,-1)),T("main",Wt,[T("div",zt,[Y(Q(Et),{modelValue:w.value,"onUpdate:modelValue":l[1]||(l[1]=C=>w.value=C),"with-slot":!0},{default:Fe(()=>[Y(Q(yt),{modelValue:ee.value,"onUpdate:modelValue":l[0]||(l[0]=C=>ee.value=C),label:"Smena",readonly:""},null,8,["modelValue"])]),_:1},8,["modelValue"]),T("div",Kt,[Y(Q(Ge),{onClick:p,class:"btn btn-primary items-center justify-center mt-3 ml-3 w-10",icon:"file_download"},{default:Fe(()=>l[4]||(l[4]=[ot(" Export Excel ",-1)])),_:1,__:[4]}),Y(Q(Ge),{onClick:s.printTable,icon:"print",class:"btn btn-primary items-center justify-center mt-3 ml-3 w-10"},{default:Fe(()=>l[5]||(l[5]=[ot(" Pechat",-1)])),_:1,__:[5]},8,["onClick"]),Y(Q(Ge),{onClick:Ue,class:"btn btn-primary items-center justify-center mt-3 ml-3 w-10",icon:"fullscreen"}),Y(Q(Ge),{onClick:Xe,class:"btn btn-primary items-center justify-center mt-3 ml-3",icon:"grade"})])]),T("div",{ref_key:"gridContainer",ref:Se,class:"ag-grid-container h-full"},[Y(Q(Ct),{modelValue:g.value,"onUpdate:modelValue":l[2]||(l[2]=C=>g.value=C),stateful:"",grow:"",onKeydown:oe,tabindex:"0"},{tabs:Fe(()=>[(Ce(!0),We(xt,null,bt(_.value,C=>(Ce(),at(m,{key:C.NumberPage,name:C.NumberPage},{default:Fe(()=>[T("span",{onContextmenu:wt(F=>Ne(C),["prevent","stop"])},Ve(C.Name),41,Jt)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),Y(f,{rowData:P.value,columnDefs:B.value,defaultColDef:qe,gridOptions:ze,animateRows:"true",class:"ag-theme-material h-full",onGridReady:se,onCellValueChanged:Qe},null,8,["rowData","columnDefs"])],512),ge.value?(Ce(),at(St,{key:0,showModalEdit:ge.value,resultEdit:ve,onUpdate:Ke},null,8,["showModalEdit","resultEdit"])):ct("",!0)]),Y(Gt,{modelValue:S.value,"onUpdate:modelValue":l[3]||(l[3]=C=>S.value=C),page:ce.value,day:w.value.day,smena:w.value.smena,"factory-id":J.id,"structure-id":Q(K).state.user.structure_id},null,8,["modelValue","page","day","smena","factory-id","structure-id"])])}}};export{na as default};
