import{P as getDefaultExportFromCjs,r as ref,o as onMounted,K as watch,f as resolveComponent,g as createElementBlock,h as openBlock,i as createBaseVNode,j as createVNode,l as withCtx,I as Fragment,J as renderList,F as createBlock,x as createTextVNode,t as toDisplayString}from"./app-CMWF8Qbk.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules-TDtrdbi3.js";var dist$1={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(n,s){(function(c,d){n.exports=d()})(jsuites,function(){var c;return function(){var d={195:function(b){(function(u,f){b.exports=f()})(this,function(){return function(_e){function f(Ae,Te){this.highOrder=Ae,this.lowOrder=Te}var k=[new f(1779033703,4089235720),new f(3144134277,2227873595),new f(1013904242,4271175723),new f(2773480762,1595750129),new f(1359893119,2917565137),new f(2600822924,725511199),new f(528734635,4215389547),new f(1541459225,327033209)],_=[new f(1116352408,3609767458),new f(1899447441,602891725),new f(3049323471,3964484399),new f(3921009573,2173295548),new f(961987163,4081628472),new f(1508970993,3053834265),new f(2453635748,2937671579),new f(2870763221,3664609560),new f(3624381080,2734883394),new f(310598401,1164996542),new f(607225278,1323610764),new f(1426881987,3590304994),new f(1925078388,4068182383),new f(2162078206,991336113),new f(2614888103,633803317),new f(3248222580,3479774868),new f(3835390401,2666613458),new f(4022224774,944711139),new f(264347078,2341262773),new f(604807628,2007800933),new f(770255983,1495990901),new f(1249150122,1856431235),new f(1555081692,3175218132),new f(1996064986,2198950837),new f(2554220882,3999719339),new f(2821834349,766784016),new f(2952996808,2566594879),new f(3210313671,3203337956),new f(3336571891,1034457026),new f(3584528711,2466948901),new f(113926993,3758326383),new f(338241895,168717936),new f(666307205,1188179964),new f(773529912,1546045734),new f(1294757372,1522805485),new f(1396182291,2643833823),new f(1695183700,2343527390),new f(1986661051,1014477480),new f(2177026350,1206759142),new f(2456956037,344077627),new f(2730485921,1290863460),new f(2820302411,3158454273),new f(3259730800,3505952657),new f(3345764771,106217008),new f(3516065817,3606008344),new f(3600352804,1432725776),new f(4094571909,1467031594),new f(275423344,851169720),new f(430227734,3100823752),new f(506948616,1363258195),new f(659060556,3750685593),new f(883997877,3785050280),new f(958139571,3318307427),new f(1322822218,3812723403),new f(1537002063,2003034995),new f(1747873779,3602036899),new f(1955562222,1575990012),new f(2024104815,1125592928),new f(2227730452,2716904306),new f(2361852424,442776044),new f(2428436474,593698344),new f(2756734187,3733110249),new f(3204031479,2999351573),new f(3329325298,3815920427),new f(3391569614,3928383900),new f(3515267271,566280711),new f(3940187606,3454069534),new f(4118630271,4000239992),new f(116418474,1914138554),new f(174292421,2731055270),new f(289380356,3203993006),new f(460393269,320620315),new f(685471733,587496836),new f(852142971,1086792851),new f(1017036298,365543100),new f(1126000580,2618297676),new f(1288033470,3409855158),new f(1501505948,4234509866),new f(1607167915,987167468),new f(1816402316,1246189591)],g=new Array(64),o,m,j,h,C,L,I,B,D,A,S,J,q=8;function ie(Ae){return unescape(encodeURIComponent(Ae))}function pe(Ae){for(var Te=[],He=(1<<q)-1,Ve=Ae.length*q,Ge=0;Ge<Ve;Ge+=q)Te[Ge>>5]|=(Ae.charCodeAt(Ge/q)&He)<<32-q-Ge%32;return Te}function se(Ae){for(var Te="0123456789abcdef",He="",Ve=Ae.length*4,Ge,et=0;et<Ve;et+=1)Ge=Ae[et>>2]>>(3-et%4)*8,He+=Te.charAt(Ge>>4&15)+Te.charAt(Ge&15);return He}function be(Ae,Te){var He,Ve,Ge,et;return He=(Ae.lowOrder&65535)+(Te.lowOrder&65535),Ve=(Ae.lowOrder>>>16)+(Te.lowOrder>>>16)+(He>>>16),Ge=(Ve&65535)<<16|He&65535,He=(Ae.highOrder&65535)+(Te.highOrder&65535)+(Ve>>>16),Ve=(Ae.highOrder>>>16)+(Te.highOrder>>>16)+(He>>>16),et=(Ve&65535)<<16|He&65535,new f(et,Ge)}function Me(Ae,Te,He,Ve){var Ge,et,at,dt;return Ge=(Ae.lowOrder&65535)+(Te.lowOrder&65535)+(He.lowOrder&65535)+(Ve.lowOrder&65535),et=(Ae.lowOrder>>>16)+(Te.lowOrder>>>16)+(He.lowOrder>>>16)+(Ve.lowOrder>>>16)+(Ge>>>16),at=(et&65535)<<16|Ge&65535,Ge=(Ae.highOrder&65535)+(Te.highOrder&65535)+(He.highOrder&65535)+(Ve.highOrder&65535)+(et>>>16),et=(Ae.highOrder>>>16)+(Te.highOrder>>>16)+(He.highOrder>>>16)+(Ve.highOrder>>>16)+(Ge>>>16),dt=(et&65535)<<16|Ge&65535,new f(dt,at)}function me(Ae,Te,He,Ve,Ge){var et,at,dt,mt;return et=(Ae.lowOrder&65535)+(Te.lowOrder&65535)+(He.lowOrder&65535)+(Ve.lowOrder&65535)+(Ge.lowOrder&65535),at=(Ae.lowOrder>>>16)+(Te.lowOrder>>>16)+(He.lowOrder>>>16)+(Ve.lowOrder>>>16)+(Ge.lowOrder>>>16)+(et>>>16),dt=(at&65535)<<16|et&65535,et=(Ae.highOrder&65535)+(Te.highOrder&65535)+(He.highOrder&65535)+(Ve.highOrder&65535)+(Ge.highOrder&65535)+(at>>>16),at=(Ae.highOrder>>>16)+(Te.highOrder>>>16)+(He.highOrder>>>16)+(Ve.highOrder>>>16)+(Ge.highOrder>>>16)+(et>>>16),mt=(at&65535)<<16|et&65535,new f(mt,dt)}function ae(Ae,Te,He){return new f(Ae.highOrder&Te.highOrder^Ae.highOrder&He.highOrder^Te.highOrder&He.highOrder,Ae.lowOrder&Te.lowOrder^Ae.lowOrder&He.lowOrder^Te.lowOrder&He.lowOrder)}function Pe(Ae,Te,He){return new f(Ae.highOrder&Te.highOrder^~Ae.highOrder&He.highOrder,Ae.lowOrder&Te.lowOrder^~Ae.lowOrder&He.lowOrder)}function Ye(Ae,Te){return Te<=32?new f(Ae.highOrder>>>Te|Ae.lowOrder<<32-Te,Ae.lowOrder>>>Te|Ae.highOrder<<32-Te):new f(Ae.lowOrder>>>Te|Ae.highOrder<<32-Te,Ae.highOrder>>>Te|Ae.lowOrder<<32-Te)}function Ue(Ae){var Te=Ye(Ae,28),He=Ye(Ae,34),Ve=Ye(Ae,39);return new f(Te.highOrder^He.highOrder^Ve.highOrder,Te.lowOrder^He.lowOrder^Ve.lowOrder)}function Re(Ae){var Te=Ye(Ae,14),He=Ye(Ae,18),Ve=Ye(Ae,41);return new f(Te.highOrder^He.highOrder^Ve.highOrder,Te.lowOrder^He.lowOrder^Ve.lowOrder)}function Je(Ae){var Te=Ye(Ae,1),He=Ye(Ae,8),Ve=Le(Ae,7);return new f(Te.highOrder^He.highOrder^Ve.highOrder,Te.lowOrder^He.lowOrder^Ve.lowOrder)}function Y(Ae){var Te=Ye(Ae,19),He=Ye(Ae,61),Ve=Le(Ae,6);return new f(Te.highOrder^He.highOrder^Ve.highOrder,Te.lowOrder^He.lowOrder^Ve.lowOrder)}function Le(Ae,Te){return Te<=32?new f(Ae.highOrder>>>Te,Ae.lowOrder>>>Te|Ae.highOrder<<32-Te):new f(0,Ae.highOrder<<32-Te)}var _e=ie(_e),pt=_e.length*q;_e=pe(_e),_e[pt>>5]|=128<<24-pt%32,_e[(pt+128>>10<<5)+31]=pt;for(var D=0;D<_e.length;D+=32){o=k[0],m=k[1],j=k[2],h=k[3],C=k[4],L=k[5],I=k[6],B=k[7];for(var A=0;A<80;A++)A<16?g[A]=new f(_e[A*2+D],_e[A*2+D+1]):g[A]=Me(Y(g[A-2]),g[A-7],Je(g[A-15]),g[A-16]),S=me(B,Re(C),Pe(C,L,I),_[A],g[A]),J=be(Ue(o),ae(o,m,j)),B=I,I=L,L=C,C=be(h,S),h=j,j=m,m=o,o=be(S,J);k[0]=be(o,k[0]),k[1]=be(m,k[1]),k[2]=be(j,k[2]),k[3]=be(h,k[3]),k[4]=be(C,k[4]),k[5]=be(L,k[5]),k[6]=be(I,k[6]),k[7]=be(B,k[7])}for(var Qe=[],D=0;D<k.length;D++)Qe.push(k[D].highOrder),Qe.push(k[D].lowOrder);return se(Qe)}})}},M={};function R(b){var u=M[b];if(u!==void 0)return u.exports;var f=M[b]={exports:{}};return d[b].call(f.exports,f,f.exports,R),f.exports}(function(){R.n=function(b){var u=b&&b.__esModule?function(){return b.default}:function(){return b};return R.d(u,{a:u}),u}})(),function(){R.d=function(b,u){for(var f in u)R.o(u,f)&&!R.o(b,f)&&Object.defineProperty(b,f,{enumerable:!0,get:u[f]})}}(),function(){R.o=function(b,u){return Object.prototype.hasOwnProperty.call(b,u)}}();var z={};(function(){R.d(z,{default:function(){return Rt}});var b=function(w){document.dictionary||(document.dictionary={});var E=null,l=Object.keys(w);for(E=0;E<l.length;E++)document.dictionary[l[E]]=w[l[E]]},u=function(w){return typeof document<"u"&&document.dictionary&&document.dictionary[w]||w},f={setDictionary:b,translate:u},_=function(w,E){if(E===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(r){return r!==null}),setTimeout(function(){window.jSuitesStateControl.push(w)},0);else{var l=window.jSuitesStateControl.indexOf(w);l>=0&&window.jSuitesStateControl.splice(l,1)}},g={};g.two=function(w){return w=""+w,w.length==1&&(w="0"+w),w},g.focus=function(w){if(w.textContent.length){const E=document.createRange(),l=window.getSelection();let r=w;for(;r.lastChild;)r=r.lastChild;r.nodeType===Node.TEXT_NODE?E.setStart(r,r.length):E.setStart(r,r.childNodes.length),E.collapse(!0),l.removeAllRanges(),l.addRange(E),w.scrollLeft=w.scrollWidth}},g.isNumeric=function(w){return typeof w=="string"&&(w=w.trim()),!isNaN(w)&&w!==null&&w!==""},g.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(w){var E=Math.random()*16|0,l=w=="x"?E:E&3|8;return l.toString(16)})},g.getNode=function(){var w=document.getSelection().anchorNode;return w?w.nodeType==3?w.parentNode:w:null},g.hash=function(w){var E=0,l,r;if(w.length===0)return E;for(l=0;l<w.length;l++)r=w.charCodeAt(l),r>32&&(E=(E<<5)-E+r,E|=0);return E},g.randomColor=function(w){var E=-.25,l=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");l.length<6&&(l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]);var r=[],P,te;for(te=0;te<3;te++)P=parseInt(l.substr(te*2,2),16),P=Math.round(Math.min(Math.max(0,P+P*E),255)).toString(16),r.push(("00"+P).substr(P.length));return w==!0?"#"+g.two(r[0].toString(16))+g.two(r[1].toString(16))+g.two(r[2].toString(16)):r},g.getWindowWidth=function(){var w=window,E=document,l=E.documentElement,r=E.getElementsByTagName("body")[0],P=w.innerWidth||l.clientWidth||r.clientWidth;return P},g.getWindowHeight=function(){var w=window,E=document,l=E.documentElement,r=E.getElementsByTagName("body")[0],P=w.innerHeight||l.clientHeight||r.clientHeight;return P},g.getPosition=function(w){if(w.changedTouches&&w.changedTouches[0])var E=w.changedTouches[0].pageX,l=w.changedTouches[0].pageY;else var E=window.Event?w.pageX:w.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),l=window.Event?w.pageY:w.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[E,l]},g.click=function(w){if(w.click)w.click();else{var E=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});w.dispatchEvent(E)}},g.findElement=function(w,E){var l=!1;function r(P){P&&!l&&(typeof E=="function"?l=E(P):typeof E=="string"&&P.classList&&P.classList.contains(E)&&(l=P)),P.parentNode&&!l&&r(P.parentNode)}return r(w),l};var o=g;const m=function(w){return typeof w=="object"||typeof w=="function"};function j(w,E,l){if(typeof w!="string"||w.length===0)return;const r=w.split(".");if(r.length===0)return;let P=this;if(typeof E>"u"&&typeof l>"u"){for(let ee=0;ee<r.length;ee++){const O=r[ee];if(P!=null&&m(P)&&Object.prototype.hasOwnProperty.call(P,O))P=P[O];else return}return P}for(let ee=0;ee<r.length-1;ee++){const O=r[ee];if(P==null||!m(P))return console.warn(`Cannot set value: path '${w}' blocked by invalid object at '${O}'`),!1;Object.prototype.hasOwnProperty.call(P,O)&&(P[O]==null||!m(P[O]))?P[O]={}:Object.prototype.hasOwnProperty.call(P,O)||(P[O]={}),P=P[O]}const te=r[r.length-1];return P==null||!m(P)?!1:l===!0?Object.prototype.hasOwnProperty.call(P,te)?(delete P[te],!0):!1:(P[te]=E,!0)}function h(w,E){var l={};l.options={};var r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},P=null;for(var te in r)E&&E.hasOwnProperty(te)?l.options[te]=E[te]:l.options[te]=r[te];w.classList.add("jsorting"),w.addEventListener("dragstart",function(N){let V=N.target;if(V.nodeType===3)if(V.parentNode.getAttribute("draggable")==="true")V=V.parentNode;else{N.preventDefault(),N.stopPropagation();return}if(V.getAttribute("draggable")==="true"){let G=Array.prototype.indexOf.call(V.parentNode.children,V);P={element:V,o:G,d:G},V.style.opacity="0.25",typeof l.options.ondragstart=="function"&&l.options.ondragstart(w,V,N),N.dataTransfer.setDragImage(V,0,0)}}),w.addEventListener("dragover",function(N){if(N.preventDefault(),P&&ee(N.target)&&N.target.getAttribute("draggable")=="true"&&P.element!=N.target){if(l.options.direction)var V=N.target.clientWidth/2>N.offsetX;else var V=N.target.clientHeight/2>N.offsetY;V?N.target.parentNode.insertBefore(P.element,N.target):N.target.parentNode.insertBefore(P.element,N.target.nextSibling),P.d=Array.prototype.indexOf.call(N.target.parentNode.children,P.element)}}),w.addEventListener("dragleave",function(N){N.preventDefault()}),w.addEventListener("dragend",function(N){N.preventDefault(),P&&(typeof l.options.ondragend=="function"&&l.options.ondragend(w,P.element,N),P.o<P.d?N.target.parentNode.insertBefore(P.element,N.target.parentNode.children[P.o]):N.target.parentNode.insertBefore(P.element,N.target.parentNode.children[P.o].nextSibling),P.element.style.opacity="",P=null)}),w.addEventListener("drop",function(N){N.preventDefault(),P&&(P.o!==P.d&&typeof l.options.ondrop=="function"&&l.options.ondrop(w,P.o,P.d,P.element,N.target,N),P.element.style.opacity="",P=null)});for(var ee=function(N){var V=!1;function G(ne){ne.className&&ne.classList.contains("jsorting")&&(V=!0),V||G(ne.parentNode)}return G(N),V},O=0;O<w.children.length;O++)w.children[O].hasAttribute("draggable")||w.children[O].setAttribute("draggable","true");return w.val=function(){for(var N=null,V=[],G=0;G<w.children.length;G++)(N=w.children[G].getAttribute("data-id"))&&V.push(N);return V},w}function C(w,E){var l={};(!E.loadUp||typeof E.loadUp!="function")&&(E.loadUp=function(){return!1}),(!E.loadDown||typeof E.loadDown!="function")&&(E.loadDown=function(){return!1}),E.timer||(E.timer=100);var r=null,P=function(te){if(r==null){var ee=!1,O=w.scrollTop;w.scrollTop+w.clientHeight*2>=w.scrollHeight?E.loadDown()&&(O==w.scrollTop&&(w.scrollTop=w.scrollTop-w.clientHeight),ee=!0):w.scrollTop<=w.clientHeight&&E.loadUp()&&(O==w.scrollTop&&(w.scrollTop=w.scrollTop+w.clientHeight),ee=!0),r=setTimeout(function(){r=null},E.timer),ee&&typeof E.onupdate=="function"&&E.onupdate()}};return w.onscroll=function(te){P()},w.onwheel=function(te){P()},l}function L(){var w=function(E,l){if(Array.isArray(E)){var r={instance:[],complete:l};if(E.length>0)for(var P=0;P<E.length;P++)E[P].multiple=r,r.instance.push(w(E[P]));return r}if(E.data||(E.data={}),E.type&&(E.method=E.type),E.method||(E.method="GET"),E.dataType||(E.dataType="json"),E.data){var te=function(ne,ge){var ce=[];if(ne){var fe=Object.keys(ne);if(fe.length)for(var Ee=0;Ee<fe.length;Ee++){if(ge)var De=ge+"["+fe[Ee]+"]";else var De=fe[Ee];if(ne[De]instanceof FileList)ce[De]=ne[fe[Ee]];else if(ne[fe[Ee]]===null||ne[fe[Ee]]===void 0)ce[De]="";else if(typeof ne[fe[Ee]]=="object")for(var Se=te(ne[fe[Ee]],De),ze=Object.keys(Se),Ke=0;Ke<ze.length;Ke++)ce[ze[Ke]]=Se[ze[Ke]];else ce[De]=ne[fe[Ee]]}}return ce},ee=te(E.data),O=Object.keys(ee);if(E.method=="GET"){if(O.length){for(var N=[],P=0;P<O.length;P++)N.push(O[P]+"="+encodeURIComponent(ee[O[P]]));E.url.indexOf("?")<0&&(E.url+="?"),E.url+=N.join("&")}}else for(var N=new FormData,P=0;P<O.length;P++)if(ee[O[P]]instanceof FileList){if(ee[O[P]].length)for(var V=0;V<ee[O[P]].length;V++)N.append(O[P],ee[O[P]][V],ee[O[P]][V].name)}else N.append(O[P],ee[O[P]])}var G=new XMLHttpRequest;return G.open(E.method,E.url,!0),E.requestedWith?G.setRequestHeader("X-Requested-With",E.requestedWith):E.requestedWith!==!1&&G.setRequestHeader("X-Requested-With","XMLHttpRequest"),E.contentType&&G.setRequestHeader("Content-Type",E.contentType),E.method==="POST"?G.setRequestHeader("Accept","application/json"):E.dataType==="blob"?G.responseType="blob":E.contentType||(E.dataType==="json"?G.setRequestHeader("Content-Type","text/json"):E.dataType==="html"&&G.setRequestHeader("Content-Type","text/html")),E.cache!==!0&&(G.setRequestHeader("pragma","no-cache"),G.setRequestHeader("cache-control","no-cache")),E.withCredentials===!0&&(G.withCredentials=!0),typeof E.beforeSend=="function"&&E.beforeSend(G),typeof w.beforeSend=="function"&&w.beforeSend(G),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(G),G.onerror=function(){E.error&&typeof E.error=="function"&&E.error({message:"Network error: Unable to reach the server.",status:0})},G.ontimeout=function(){E.error&&typeof E.error=="function"&&E.error({message:"Request timed out after "+G.timeout+"ms.",status:0})},G.onload=function(){if(G.status>=200&&G.status<300)if(E.dataType==="json")try{var ne=JSON.parse(G.responseText);E.success&&typeof E.success=="function"&&E.success(ne)}catch(ce){E.error&&typeof E.error=="function"&&E.error(ce,ne)}else{if(E.dataType==="blob")var ne=G.response;else var ne=G.responseText;E.success&&typeof E.success=="function"&&E.success(ne)}else E.error&&typeof E.error=="function"&&E.error(G.responseText,G.status);if(w.queue&&w.queue.length>0&&w.send(w.queue.shift()),w.requests&&w.requests.length){var ge=w.requests.indexOf(G);if(w.requests.splice(ge,1),w.requests.length||E.complete&&typeof E.complete=="function"&&E.complete(ne),E.group&&w.oncomplete&&typeof w.oncomplete[E.group]=="function"&&(w.pending(E.group)||(w.oncomplete[E.group](),w.oncomplete[E.group]=null)),E.multiple&&E.multiple.instance){var ge=E.multiple.instance.indexOf(G);E.multiple.instance.splice(ge,1),E.multiple.instance.length||E.multiple.complete&&typeof E.multiple.complete=="function"&&E.multiple.complete(ne)}}},G.options=E,G.data=N,E.queue===!0&&w.requests.length>0?w.queue.push(G):w.send(G),G};return w.send=function(E){E.data?Array.isArray(E.data)?E.send(E.data.join("&")):E.send(E.data):E.send(),w.requests.push(E)},w.exists=function(E,l){var r=new XMLHttpRequest;r.open("HEAD",E,!1),r.send(),r.status&&l(r.status)},w.pending=function(E){var l=0,r=w.requests;if(r&&r.length)for(var P=0;P<r.length;P++)(!E||E==r[P].options.group)&&l++;return l},w.oncomplete={},w.requests=[],w.queue=[],w}var I=L();function B(){const w={loading:{}};return w.loading.show=function(E){w.loading.element||(w.loading.element=document.createElement("div"),w.loading.element.className="jloading"),document.body.appendChild(w.loading.element),E>0&&setTimeout(function(){w.loading.hide()},E*1e3)},w.loading.hide=function(){w.loading.element&&w.loading.element.parentNode&&document.body.removeChild(w.loading.element)},w.slideLeft=function(E,l,r){l==!0?(E.classList.add("jslide-left-in"),setTimeout(function(){E.classList.remove("jslide-left-in"),typeof r=="function"&&r()},400)):(E.classList.add("jslide-left-out"),setTimeout(function(){E.classList.remove("jslide-left-out"),typeof r=="function"&&r()},400))},w.slideRight=function(E,l,r){l===!0?(E.classList.add("jslide-right-in"),setTimeout(function(){E.classList.remove("jslide-right-in"),typeof r=="function"&&r()},400)):(E.classList.add("jslide-right-out"),setTimeout(function(){E.classList.remove("jslide-right-out"),typeof r=="function"&&r()},400))},w.slideTop=function(E,l,r){l===!0?(E.classList.add("jslide-top-in"),setTimeout(function(){E.classList.remove("jslide-top-in"),typeof r=="function"&&r()},400)):(E.classList.add("jslide-top-out"),setTimeout(function(){E.classList.remove("jslide-top-out"),typeof r=="function"&&r()},400))},w.slideBottom=function(E,l,r){l===!0?(E.classList.add("jslide-bottom-in"),setTimeout(function(){E.classList.remove("jslide-bottom-in"),typeof r=="function"&&r()},400)):(E.classList.add("jslide-bottom-out"),setTimeout(function(){E.classList.remove("jslide-bottom-out"),typeof r=="function"&&r()},100))},w.fadeIn=function(E,l){E.style.display="",E.classList.add("jfade-in"),setTimeout(function(){E.classList.remove("jfade-in"),typeof l=="function"&&l()},2e3)},w.fadeOut=function(E,l){E.classList.add("jfade-out"),setTimeout(function(){E.style.display="none",E.classList.remove("jfade-out"),typeof l=="function"&&l()},1e3)},w}var D=B();function A(){var w={};w.now=function(ee,O){var N=null,V=null,G=null,ne=null,ge=null,ce=null;return Array.isArray(ee)?(N=ee[0],V=ee[1],G=ee[2],ne=ee[3],ge=ee[4],ce=ee[5]):(ee||(ee=new Date),N=ee.getFullYear(),V=ee.getMonth()+1,G=ee.getDate(),ne=ee.getHours(),ge=ee.getMinutes(),ce=ee.getSeconds()),O==!0?o.two(N)+"-"+o.two(V)+"-"+o.two(G):o.two(N)+"-"+o.two(V)+"-"+o.two(G)+" "+o.two(ne)+":"+o.two(ge)+":"+o.two(ce)},w.toArray=function(ee){var N=ee.split(ee.indexOf("T")!==-1?"T":" "),O=N[1],N=N[0].split("-"),V=parseInt(N[0]),G=parseInt(N[1]),ne=parseInt(N[2]),ge=0,ce=0;return O&&(O=O.split(":"),ge=parseInt(O[0]),ce=parseInt(O[1])),[V,G,ne,ge,ce,0]};var E=Date.UTC(1900,0,0),l=Date.UTC(1900,1,29),r=864e5;w.dateToNum=function(ee){typeof ee=="string"&&(ee=new Date(ee+"  GMT+0"));var O=ee.getTime();return O>=l&&(O+=r),O-=E,O/r},w.numToDate=function(ee){var O=E+ee*r;O>=l&&(O-=r);const N=new Date(O);var V=[N.getUTCFullYear(),N.getUTCMonth()+1,N.getUTCDate(),N.getUTCHours(),N.getUTCMinutes(),N.getUTCSeconds()];return w.now(V)};let P=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],te=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(w,"weekdays",{get:function(){return P.map(function(ee){return f.translate(ee)})}}),Object.defineProperty(w,"weekdaysShort",{get:function(){return P.map(function(ee){return f.translate(ee).substring(0,3)})}}),Object.defineProperty(w,"months",{get:function(){return te.map(function(ee){return f.translate(ee)})}}),Object.defineProperty(w,"monthsShort",{get:function(){return te.map(function(ee){return f.translate(ee).substring(0,3)})}}),w}var S=A();function J(){var w={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},E=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var v=0;this.date[4]&&(v=parseFloat(this.date[4]/60));var F=parseInt(this.date[3])+v;F/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?F=o.two(this.date[3])+":"+o.two(this.date[4])+":"+o.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),F=o.two(this.date[0])+"-"+o.two(this.date[1])+"-"+o.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(F+=" "+o.two(this.date[3])+":"+o.two(this.date[4])+":"+o.two(this.date[5])));return F},l=function(){var v="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)v=parseInt(this.date[3]);else{let X=parseInt(this.date[3]);X<13&&this.values.indexOf("PM")!==-1?v=(X+12)%24:v=X%24}this.date[4]&&(v+=parseFloat(this.date[4]/60)),this.date[5]&&(v+=parseFloat(this.date[5]/3600)),v/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var F=S.now(this.date);v=S.dateToNum(F)}return isNaN(v)&&(v=""),v},r=function(v){return v===null||v===""||v===void 0},P=function(v){var F=(""+v)[0];return F=="="},te=function(v){return v==="currency"||v==="percentage"||v==="scientific"||v==="numeric"},ee=function(v){if(v&&Number(v)==v)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var F=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=F[1]}else{v||(v=this.mask);var X=new RegExp("0{1}(.{1})0+","ig"),F=X.exec(v);if(F&&F[1]&&F[1].length==1)return this.options.decimal=F[1],F[1];var X=new RegExp("#{1}(.{1})#+","ig"),F=X.exec(v);F&&F[1]&&F[1].length==1?F[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},O=function(v,F){if(v=="")return"";F||(F=ee.call(this)),v=(""+v).split(F);var X=v[0].match(/[-]+/g);if(X&&X.length?X=!0:X=!1,v[0]=v[0].match(/[0-9]+/g),v[0]?(X&&v[0].unshift("-"),v[0]=v[0].join("")):X&&(v[0]="-"),v[0]||v[1])v[1]!==void 0&&(v[1]=v[1].match(/[0-9]+/g),v[1]?v[1]=v[1].join(""):v[1]="");else return"";return v},N=function(v,F){if(v==="")return"";var X=ee.call(this),ue=this.options;if(v=O.call(this,v),v==="")return"";var K=null;if(v[0]&&(ue.style==="percent"?K=parseFloat(v[0])/100:K=parseFloat(v[0]+".1")),(v[0]==="-"||v[0]==="-00")&&!v[1]&&F&&F.inputType=="deleteContentBackward")return"";var le=new Intl.NumberFormat(this.locale,ue).format(K);if(le=le.split(X),ue.style==="percent"&&le[0].indexOf("%")!==-1&&(le[0]=le[0].replace("%",""),le[2]="%"),typeof le[1]<"u"){var je=le[1].replace(/[0-9]*/g,"");je&&(le[2]=je)}return v[1]!==void 0?le[1]=X+v[1]:le[1]="",le.join("")},V=function(v,F){var X=ge.call(v);if(X){var ue=N.call(this,X,F),K=ue.length-X.length,le=ne.call(v)+K;ge.call(v,ue,le,!0)}},G=function(v){var F=O.call(this,v);return F?(F[0]==="-"&&(F[0]="-0"),parseFloat(F.join("."))):null},ne=function(v,F){if(v===void 0)if(this.tagName=="DIV"){var X=0,ue=window.getSelection();if(ue&&ue.rangeCount!==0){var K=ue.getRangeAt(0),le=K.cloneRange();le.selectNodeContents(this),le.setEnd(K.endContainer,K.endOffset),X=le.toString().length}return X}else return this.selectionStart;else{var je=ge.call(this);if(F){for(var le=null,Ne=0;Ne<je.length;Ne++)(je[Ne].match(/[\-0-9]/g)||je[Ne]==="."||je[Ne]===",")&&(le=Ne);le===null&&(le=je.indexOf(" ")),v>=le&&(v=le+1)}if(v>je.length&&(v=je.length),v)if(this.tagName=="DIV"){var ue=window.getSelection(),K=document.createRange();this.childNodes[0]&&(K.setStart(this.childNodes[0],v),ue.removeAllRanges(),ue.addRange(K))}else this.selectionStart=v,this.selectionEnd=v}},ge=function(v,F,X){if(this.tagName=="DIV")if(v===void 0){var v=this.innerText;return this.value&&this.value.length>v.length&&(v=this.value),v}else this.innerText!==v&&(this.innerText=v,F&&ne.call(this,F,X));else{if(v===void 0)return this.value;this.value!==v&&(this.value=v,F&&ne.call(this,F,X))}},ce=S.weekdays,fe=S.weekdaysShort,Ee=S.months,De=S.monthsShort,Se={YEAR:function(v,F){var X=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<=10&&this.values[this.index].length<F&&(this.values[this.index]+=v),this.values[this.index].length==F){if(F==2)var X=X.substr(0,2)+this.values[this.index];else if(F==3)var X=X.substr(0,1)+this.values[this.index];else if(F==4)var X=this.values[this.index];this.date[0]=X,this.index++}},YYYY:function(v){Se.YEAR.call(this,v,4)},YYY:function(v){Se.YEAR.call(this,v,3)},YY:function(v){Se.YEAR.call(this,v,2)},FIND:function(v,F){if(r(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=v;return}for(var X=0,ue=0,K=(this.values[this.index]+v).toLowerCase(),le=0;le<F.length;le++)F[le].toLowerCase().indexOf(K)==0&&(X=le,ue++);if(ue>1)this.values[this.index]+=v;else if(ue==1){var je=F[X].length-this.values[this.index].length-1;return this.position+=je,this.values[this.index]=F[X],this.index++,X}},MMM:function(v){var F=Se.FIND.call(this,v,De);F!==void 0&&(this.date[1]=F+1)},MON:function(v){Se.MMM.call(this,v)},MMMM:function(v){var F=Se.FIND.call(this,v,Ee);F!==void 0&&(this.date[1]=F+1)},MONTH:function(v){Se.MMMM.call(this,v)},MMMMM:function(v){r(this.values[this.index])&&(this.values[this.index]="");for(var F=(this.values[this.index]+v).toLowerCase(),X=0;X<Ee.length;X++)if(Ee[X][0].toLowerCase().indexOf(F)==0){this.values[this.index]=Ee[X][0],this.date[1]=X+1,this.index++;break}},MM:function(v){r(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(this.date[1]=this.values[this.index]="0"+v,this.index++):parseInt(v)<2&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[1]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[1]=this.values[this.index]+=v,this.index++)},M:function(v){var F=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))this.values[this.index]=v,v>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[1]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[1]=this.values[this.index]+=v,this.index++;else var F=!0;else var F=!0;if(F==!0){var X=parseInt(this.values[this.index]);X>0&&X<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(v){var F=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))this.values[this.index]=v,parseInt(v)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(v)<2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[2]=this.values[this.index]+=v,this.index++;else var F=!0;else var F=!0;if(F==!0){var X=parseInt(this.values[this.index]);X>0&&X<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(v){r(this.values[this.index])?parseInt(v)>3&&parseInt(v)<10?(this.date[2]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==3&&parseInt(v)<2?(this.date[2]=this.values[this.index]+=v,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(v)<10?(this.date[2]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[2]=this.values[this.index]+=v,this.index++)},DDD:function(v){Se.FIND.call(this,v,fe)},DY:function(v){Se.DDD.call(this,v)},DDDD:function(v){Se.FIND.call(this,v,ce)},DAY:function(v){Se.DDDD.call(this,v)},HH12:function(v,F){var X=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))parseInt(v)>1&&parseInt(v)<10?(F&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[3]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]<1&&parseInt(v)<10)this.date[3]=this.values[this.index]+=v,this.index++;else var X=!0;else var X=!0;if(X==!0){var ue=parseInt(this.values[this.index]);ue>=0&&ue<=12&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH24:function(v,F){var X=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(this.values[this.index]==null||this.values[this.index]=="")parseInt(v)>2&&parseInt(v)<10?(F&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v);else if(this.values[this.index]==2&&parseInt(v)<4)!F&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]<2&&parseInt(v)<10)!F&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++;else var X=!0;else var X=!0;if(X==!0){var ue=parseInt(this.values[this.index]);ue>=0&&ue<24&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH:function(v){Se.HH24.call(this,v,1)},H:function(v){Se.HH24.call(this,v,0)},"\\[H\\]":function(v){this.values[this.index]==null&&(this.values[this.index]=""),v.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=v:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(v,F){this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>5&&parseInt(v)<10?(this.date[F]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):parseInt(v)<10&&(this.date[F]=this.values[this.index]+=v,this.index++)},MI:function(v){Se.N60.call(this,v,4)},SS:function(v){Se.N60.call(this,v,5)},"AM/PM":function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?v.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":v.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<7&&(this.values[this.index]=v),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(v){var F=ee.call(this),X=!1;r(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(X=!0);var ue=O.call(this,this.values[this.index],F);ue&&(this.values[this.index]=ue.join(F)),parseInt(v)>=0&&parseInt(v)<10?(this.values[this.index]=="0"&&v>0?this.values[this.index]="":this.values[this.index]=="-0"&&v>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||v==F)&&(this.values[this.index]+=v)):F&&v==F?this.values[this.index].indexOf(F)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=v):v=="-"&&(X=!0),X===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(v){Se["0{1}(.{1}0+)?"].call(this,v)},"0{1}(.{1}0+)?%":function(v){Se["0{1}(.{1}0+)?"].call(this,v),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(v){Se["0{1}(.{1}0+)?"].call(this,v);var F=ee.call(this),X=this.tokens[this.index].substr(1,1),ue=this.values[this.index][0]==="-",K=O.call(this,this.values[this.index],F);if(K!==""){var le=K[0].match(/[0-9]/g);if(le){le=le.join("");for(var je=[],Ne=0,ve=le.length-1;ve>=0;ve--)je.push(le[ve]),Ne++,Ne%3||je.push(X);je=je.reverse(),K[0]=je.join(""),K[0].substr(0,1)==X&&(K[0]=K[0].substr(1))}else K[0]="";this.values[this.index]=K.join(F),ue&&(this.values[this.index]="-"+this.values[this.index])}},0:function(v){v.match(/[0-9]/g)&&(this.values[this.index]=v,this.index++)},"[0-9a-zA-Z$]+":function(v){r(this.values[this.index])&&(this.values[this.index]="");var F=this.tokens[this.index],X=this.values[this.index],ue=X.length;F[ue]==v?(this.values[this.index]+=v,this.values[this.index]==F&&this.index++):(this.values[this.index]=F,this.index++,v.match(/[\-0-9]/g)&&this.position--)},A:function(v){v.match(/[a-zA-Z]/gi)&&(this.values[this.index]=v,this.index++)},".":function(v){Se["[0-9a-zA-Z$]+"].call(this,v)},"@":function(v){r(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=v}},ze=function(v){if(this.type=="general")var F=[].concat(w.general);else var F=[].concat(w.currency,w.datetime,w.percentage,w.scientific,w.numeric,w.text,w.general);var X=new RegExp(F.join("|"),"gi");return v.match(X)},Ke=function(v){if(this.type)if(this.type=="text")var F=["text"];else if(this.type=="general")var F=["general"];else if(this.type=="datetime")var F=["numeric","datetime","general"];else var F=["currency","percentage","scientific","numeric","general"];else var F=Object.keys(w);for(var X=0;X<F.length;X++)for(var ue=F[X],K=0;K<w[ue].length;K++){var le=new RegExp(w[ue][K],"gi"),je=v.match(le);if(je)return{type:ue,method:w[ue][K]}}},Q=function(v){for(var F=[],X=0;X<v.length;X++){var ue=Ke.call(this,v[X]);ue?F.push(ue.method):F.push(null)}for(var X=0;X<F.length;X++)F[X]=="MM"&&(F[X-1]&&F[X-1].indexOf("H")>=0||F[X-2]&&F[X-2].indexOf("H")>=0||F[X+1]&&F[X+1].indexOf("S")>=0||F[X+2]&&F[X+2].indexOf("S")>=0)&&(F[X]="MI");return F},he=function(v){var F=Ke.call(this,v);if(F)var X=F.type;if(X){for(var ue=0,K=ze.call(this,v),le=0;le<K.length;le++)F=Ke.call(this,K[le]),F&&te(F.type)&&ue++;ue>1&&(X="general")}return X},we=function(){typeof Se[this.methods[this.index]]=="function"?(Se[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},U=function(v){return(""+ +v).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(F,X,ue,K,le){return le<0?X+"0."+Array(1-le-ue.length).join(0)+ue+K:X+ue+K+Array(le-K.length+1).join(0)})},Z=function(v,F,X){var ue=null,K={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof v=="object"){if(K.input=v.target,K.value=ge.call(v.target),K.caret=ne.call(v.target),(ue=v.target.getAttribute("data-mask"))&&(K.mask=ue),(ue=v.target.getAttribute("data-type"))&&(K.type=ue),v.target.mask?(v.target.mask.options&&(K.options=v.target.mask.options),v.target.mask.locale&&(K.locale=v.target.mask.locale)):(ue=v.target.getAttribute("data-locale"))&&(K.locale=ue,K.mask&&(K.options.style=K.mask)),v.target.attributes&&v.target.attributes.length)for(var le=0;le<v.target.attributes.length;le++){var je=v.target.attributes[le].name,Ne=v.target.attributes[le].value;je.substr(0,4)=="data"&&(K.options[je.substr(5)]=Ne)}}else{if(typeof F=="string")K.mask=F;else for(var je=Object.keys(F),le=0;le<je.length;le++)K[je[le]]=F[je[le]];typeof v=="number"&&(ee.call(K,K.mask),v=(""+v).replace(".",K.options.decimal)),K.value=v,K.input&&(ge.call(K.input,v),o.focus(K.input),K.caret=ne.call(K.input))}if(!P(K.value)&&(K.mask||K.locale)){if(K.mask){if(K.mask=K.mask.replace(new RegExp(/\[h]/),"|h|"),K.mask=K.mask.replace(new RegExp(/\[.*?\]/),""),K.mask=K.mask.replace(new RegExp(/\|h\|/),"[h]"),K.mask.indexOf(";")!==-1){var ue=K.mask.split(";");K.mask=ue[0]}if(K.mask.indexOf("##")!==-1){var ve=K.mask.split(";");ve[0]&&(typeof v=="object"&&(ve[0]=ve[0].replace(new RegExp(/_\)/g),""),ve[0]=ve[0].replace(new RegExp(/_\(/g),"")),ve[0]=ve[0].replace("*","	"),ve[0]=ve[0].replace(new RegExp(/_-/g),""),ve[0]=ve[0].replace(new RegExp(/_/g),""),ve[0]=ve[0].replace(new RegExp(/"/g),""),ve[0]=ve[0].replace("##0.###","##0.000"),ve[0]=ve[0].replace("##0.##","##0.00"),ve[0]=ve[0].replace("##0.#","##0.0"),ve[0]=ve[0].replace("##0,###","##0,000"),ve[0]=ve[0].replace("##0,##","##0,00"),ve[0]=ve[0].replace("##0,#","##0,0")),K.mask=ve[0]}if(K.mask.indexOf("\\")!==-1){var ve=K.mask.split(";");ve[0]=ve[0].replace(new RegExp(/\\/g),""),K.mask=ve[0]}K.type||(K.type=he.call(K,K.mask)),K.tokens=ze.call(K,K.mask)}if(typeof v!="object"||!v.inputType||!v.inputType.indexOf("insert")||!v.inputType.indexOf("delete"))if(K.locale)if(K.input)V.call(K,K.input,v);else var Ie=N.call(K,K.value);else{for(K.methods=Q.call(K,K.tokens),K.event=v;K.position<K.value.length&&typeof K.tokens[K.index]<"u";)we.call(K);var Ie=K.values.join("");if(te(K.type)&&Ie!==""){for(;typeof K.tokens[K.index]<"u";){var ue=Ke.call(K,K.tokens[K.index]);ue&&ue.type=="general"&&(K.values[K.index]=K.tokens[K.index]),K.index++}var Fe=!0}else var Fe=!1;if(Ie=K.values.join(""),K.input){if(ue=Ie.length-K.value.length,ue>0)var nt=K.caret+ue;else var nt=K.caret;ge.call(K.input,Ie,nt,Fe)}}if(K.input){var re=null;if(te(K.type)){let ye=ge.call(K.input);K.number=G.call(K,ye),K.type=="percentage"&&(""+ye).indexOf("%")!==-1?re=Z.adjustPrecision(K.number/100):re=K.number}else K.type=="datetime"&&(re=E.call(K),K.date[0]&&K.date[1]&&K.date[2]&&K.input.setAttribute("data-completed",!0));re&&K.input.setAttribute("data-value",re)}if(Ie!==void 0)return X?K:Ie}};return Z.adjustPrecision=function(v){if(typeof v=="number"&&!Number.isInteger(v)){const F=v.toString().split(".");if(F[1]&&F[1].length>10){let X=0;const ue=F[1][F[1].length-2];if(ue==0||ue==9){for(let K=F[1].length-2;K>0;K--)if(X>=0&&F[1][K]==ue){if(X++,X>6)break}else{X=0;break}if(X)return parseFloat(parseFloat(v).toFixed(F[1].length-1))}}}return v},Z.getType=he,Z.prepare=function(v,F){return F||(F={}),ze.call(F,v)},Z.apply=function(v){var F=ge.call(v.target);v.key.length==1&&(F+=v.key),ge.call(v.target,Z(F,v.target.getAttribute("data-mask")))},Z.run=function(v,F,X){return Z(v,{mask:F,decimal:X})},Z.extract=function(v,F,X){if(r(v)||typeof F!="object")return v;if(F=Object.assign({},F),F.options||(F.options={}),!F.mask&&F.format&&(F.mask=F.format),F.mask){if(F.mask.indexOf(";")!==-1){var ue=F.mask.split(";");F.mask=ue[0]}F.mask=F.mask.replace(new RegExp(/\[h]/),"|h|"),F.mask=F.mask.replace(new RegExp(/\[.*?\]/),""),F.mask=F.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(F,F.mask);var K=null,le=null;if(F.type=="percent"||F.options.style=="percent"?K="percentage":F.mask&&(K=he.call(F,F.mask)),K==="text"){var je={};le=v}else if(K==="general"){var je=Z(v,F,!0);le=v}else if(K==="datetime"){v instanceof Date&&(v=Z.getDateString(v,F.mask));var je=Z(v,F,!0);o.isNumeric(v)?le=v:le=l.call(je)}else if(K==="scientific"){le=v,typeof v=="string"&&(le=Number(le));var je=F}else{le=G.call(F,v),K==="percentage"&&(""+v).indexOf("%")!==-1&&(le/=100);var je=F}return je.value=le,!je.type&&K&&(je.type=K),X?je:le},Z.render=function(v,F,X,ue){if(r(v)||typeof F!="object")return v;if(F=Object.assign({},F),F.options||(F.options={}),!F.mask&&F.format&&(F.mask=F.format),F.mask){if(F.mask.indexOf(";")!==-1){var K=F.mask.split(";");X||(K[0]=K[0].replace(new RegExp(/_\)/g),""),K[0]=K[0].replace(new RegExp(/_\(/g),"")),F.mask=K[0]}F.mask=F.mask.replace(new RegExp(/\[h]/),"|h|"),F.mask=F.mask.replace(new RegExp(/\[.*?\]/),""),F.mask=F.mask.replace(new RegExp(/\|h\|/),"[h]")}var le=null;F.type=="percent"||F.options.style=="percent"?le="percentage":F.mask?le=he.call(F,F.mask):v instanceof Date&&(le="datetime");var je=!1;if(le=="datetime"||F.type=="calendar"){var K=Z.getDateString(v,F.mask);K&&(v=K),F.mask&&X&&(je=!0)}else if(le==="text")typeof v=="number"&&(v=v.toString());else if(typeof v=="string"&&c.isNumeric(v)&&(v=Number(v)),le==="percentage"&&(v=Z.adjustPrecision(v*100)),typeof v=="number"){var K=null;if(F.mask&&X){var Ne=ee.call(F,F.mask);if(le==="scientific")if(F.mask.indexOf(Ne)!==-1){let xe=F.mask.split("E");xe=xe[0].split(Ne),xe=""+xe[1].match(/[0-9]+/g),xe=xe.length,K=v.toExponential(xe)}else K=v.toExponential(0);else{if(F.mask.indexOf(Ne)!==-1){Ne=F.mask.split(Ne),Ne=""+Ne[1].match(/[0-9]+/g),Ne=Ne.length,K=v.toFixed(Ne);let xe=v.toString().split("."),Oe=xe[1];Oe&&Oe.length>Ne&&Oe[Oe.length-1]==="5"&&(K=parseFloat(xe[0]+"."+Oe+"1").toFixed(Ne))}else K=v.toFixed(0);(""+K).indexOf("e")!==-1&&(K=U(K))}}else if(F.locale&&X){var Ne=(""+v).split(".");if(F.options){typeof Ne[1]>"u"&&(Ne[1]="");var Ie=Ne[1].length;if(F.options.minimumFractionDigits>Ie)for(var ve=0;ve<F.options.minimumFractionDigits-Ie;ve++)Ne[1]+="0"}Ne[1].length?K=Ne.join("."):K=Ne[0];var Ie=Ne[1].length;F.options&&F.options.maximumFractionDigits<Ie&&(K=parseFloat(K).toFixed(F.options.maximumFractionDigits))}else K=U(v);K!==null&&(v=K,ee.call(F,F.mask),F.options.decimal&&(v=v.replace(".",F.options.decimal)))}else F.mask&&X&&(je=!0);if(je){var Fe=F.mask.length-v.length;if(Fe>0)for(var ve=0;ve<Fe;ve++)v+=" "}if(le==="scientific")if(!X)v=U(v);else return v;if(le==="numeric"&&ue===!1&&typeof v=="string")return v;if(v=Z(v,F),X&&le==="numeric"){var nt=F.mask.match(new RegExp(/^[0]+$/gm));if(nt&&nt.length===1){var re=nt[0].length;if(re>3)for(v=""+v;v.length<re;)v="0"+v}}return v},Z.set=function(v,F){if(F){v.setAttribute("data-mask",F);var X=new Event("input",{bubbles:!0,cancelable:!0});v.dispatchEvent(X)}},Z.extractDateFromString=function(v,F){var X=Z(v,{mask:F},!0);if(v>0&&Number(v)==v&&(X.values.join("")!==X.value||X.type=="numeric")){var ue=new Date(Math.round((v-25569)*86400*1e3));return ue.getFullYear()+"-"+o.two(ue.getMonth())+"-"+o.two(ue.getDate())+" 00:00:00"}var K=!1;return X.values&&X.values.length===X.tokens.length&&X.values[X.values.length-1].length>=X.tokens[X.tokens.length-1].length&&(K=!0),X.date[0]&&X.date[1]&&(X.date[2]||K)?(X.date[2]||(X.date[2]=1),X.date[0]+"-"+o.two(X.date[1])+"-"+o.two(X.date[2])+" "+o.two(X.date[3])+":"+o.two(X.date[4])+":"+o.two(X.date[5])):""},Z.getDateString=function(v,F){if(!F)var F={};if(F&&typeof F=="object"){if(F.format)var X=F.format;else if(F.mask)var X=F.mask}else var X=F;if(X||(X="YYYY-MM-DD"),X.indexOf("[h]")>=0){var ue=0;if(v&&o.isNumeric(v)&&(ue=parseFloat(24*Number(v)),X.indexOf("mm")>=0)){var K=(""+ue).split(".");if(K[1]){var le=60*parseFloat("0."+K[1]);le=parseFloat(le.toFixed(2))}else var le=0;ue=parseInt(K[0])+":"+o.two(le)}return ue}v instanceof Date?v=S.now(v):v&&o.isNumeric(v)&&(v=S.numToDate(v));for(var je=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Ne=new RegExp(je.join("|"),"gi"),ve=X.match(Ne),Ie=0;Ie<ve.length;Ie++)ve[Ie].toUpperCase()=="MM"&&(ve[Ie-1]&&ve[Ie-1].toUpperCase().indexOf("H")>=0||ve[Ie-2]&&ve[Ie-2].toUpperCase().indexOf("H")>=0||ve[Ie+1]&&ve[Ie+1].toUpperCase().indexOf("S")>=0||ve[Ie+2]&&ve[Ie+2].toUpperCase().indexOf("S")>=0)&&(ve[Ie]="mi");var Fe={tokens:ve};if(v){var le=""+v,nt=le.indexOf("T")!==-1?"T":" ";le=le.split(nt);var K=0,re=0,ye=0;le[1]&&(K=le[1].split(":"),re=K[1]?K[1]:0,ye=K[2]?K[2]:0,K=K[0]?K[0]:0),le=le[0].split("-");let it=new Date(le[0],le[1],0).getDate();if(le[0]&&le[1]&&le[2]&&le[0]>0&&le[1]>0&&le[1]<13&&le[2]>0&&le[2]<=it){Fe.data=[le[0],le[1],le[2],K,re,ye],Fe.value=[];for(var xe=new Date(Fe.data[0],Fe.data[1]-1,Fe.data[2],Fe.data[3],Fe.data[4],Fe.data[5]),Oe=function(ft){var rt=this.tokens[ft],ut=rt.toUpperCase(),Xe=null;ut==="YYYY"?Xe=this.data[0]:ut==="YYY"?Xe=this.data[0].substring(1,4):ut==="YY"?Xe=this.data[0].substring(2,4):ut==="Y"?Xe=this.data[0].substring(3,4):rt==="MON"?Xe=S.months[xe.getMonth()].substr(0,3).toUpperCase():rt==="mon"?Xe=S.months[xe.getMonth()].substr(0,3).toLowerCase():rt==="MONTH"?Xe=S.months[xe.getMonth()].toUpperCase():rt==="month"?Xe=S.months[xe.getMonth()].toLowerCase():ut==="MMMMM"?Xe=S.months[xe.getMonth()].substr(0,1):ut==="MMMM"||rt==="Month"?Xe=S.months[xe.getMonth()]:ut==="MMM"||rt=="Mon"?Xe=S.months[xe.getMonth()].substr(0,3):ut==="MM"?Xe=o.two(this.data[1]):ut==="M"?Xe=xe.getMonth()+1:rt==="DAY"?Xe=S.weekdays[xe.getDay()].toUpperCase():rt==="day"?Xe=S.weekdays[xe.getDay()].toLowerCase():ut==="DDDD"||rt=="Day"?Xe=S.weekdays[xe.getDay()]:ut==="DDD"?Xe=S.weekdays[xe.getDay()].substr(0,3):ut==="DD"?Xe=o.two(this.data[2]):ut==="D"?Xe=parseInt(this.data[2]):ut==="Q"?Xe=Math.floor((xe.getMonth()+3)/3):ut==="HH24"||ut==="HH"?(Xe=this.data[3],Xe>12&&this.tokens.indexOf("am/pm")!==-1&&(Xe-=12),Xe=o.two(Xe)):ut==="HH12"?this.data[3]>12?Xe=o.two(this.data[3]-12):Xe=o.two(this.data[3]):ut==="H"?(Xe=this.data[3],Xe>12&&this.tokens.indexOf("am/pm")!==-1&&(Xe-=12,Xe=o.two(Xe))):ut==="MI"?Xe=o.two(this.data[4]):ut==="SS"?Xe=o.two(this.data[5]):ut==="MS"?Xe=xe.getMilliseconds():ut==="AM/PM"?this.data[3]>=12?Xe="PM":Xe="AM":ut==="WD"&&(Xe=S.weekdays[xe.getDay()]),Xe===null?this.value[ft]=this.tokens[ft]:this.value[ft]=Xe},Ie=0;Ie<Fe.tokens.length;Ie++)Oe.call(Fe,Ie);v=Fe.value.join("")}else v=""}return v},Z}var q=J();function ie(){var w=function(E,l){if(E.calendar)return E.calendar.setOptions(l,!0);var r={type:"calendar"};r.options={},r.date=null,r.setOptions=function(U,Z){var v={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:S.monthsShort,monthsFull:S.months,weekdays:S.weekdays,textDone:f.translate("Done"),textReset:f.translate("Reset"),textUpdate:f.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var F in v)U&&U.hasOwnProperty(F)?r.options[F]=U[F]:(typeof r.options[F]>"u"||Z===!0)&&(r.options[F]=v[F]);if(r.options.resetButton==!1?N.style.display="none":N.style.display="",r.options.readonly?E.setAttribute("readonly","readonly"):E.removeAttribute("readonly"),r.options.placeholder?E.setAttribute("placeholder",r.options.placeholder):E.removeAttribute("placeholder"),o.isNumeric(r.options.value)&&r.options.value>0&&(r.options.value=w.numToDate(r.options.value),r.options.dataType="numeric"),N.innerHTML=r.options.textReset,V.innerHTML=r.options.textDone,Ke.innerHTML=r.options.textUpdate,r.options.format&&E.setAttribute("data-mask",r.options.format.toLowerCase()),!r.options.value&&r.options.today)var X=w.now();else var X=r.options.value;return X&&(r.options.value=null,r.setValue(X)),r},r.open=function(U){if(!O.classList.contains("jcalendar-focus")&&!O.classList.contains("jcalendar-inline")){if(w.current=r,_(r,!0),r.getDays(),r.options.type=="year-month-picker"&&r.getMonths(),r.options.time&&(Q.value=r.date[3],he.value=r.date[4]),O.classList.add("jcalendar-focus"),o.getWindowWidth()<800||r.options.fullscreen)O.classList.add("jcalendar-fullsize"),D.slideBottom(ne,1);else{O.classList.remove("jcalendar-fullsize");var Z=E.getBoundingClientRect(),v=ne.getBoundingClientRect();if(r.options.position)G.style.position="fixed",window.innerHeight<Z.bottom+v.height?G.style.top=Z.top-(v.height+2)+"px":G.style.top=Z.top+Z.height+2+"px",G.style.left=Z.left+"px";else{if(window.innerHeight<Z.bottom+v.height){var F=-1*(Z.height+v.height+2);F+Z.top<0&&(F=-1*(Z.top+Z.height)),G.style.top=F+"px"}else G.style.top="2px";if(window.innerWidth<Z.left+v.width){var F=window.innerWidth-(Z.left+v.width+20);G.style.left=F+"px"}else G.style.left="0px"}}typeof r.options.onopen=="function"&&r.options.onopen(E)}},r.close=function(U,Z){if(r.options.autoSelect!==!0&&typeof Z>"u"&&(Z=!1),O.classList.contains("jcalendar-focus")){if(Z!==!1){var v=O.querySelector(".jcalendar-selected");if(typeof Z=="string")var F=Z;else if(!v||v.classList.contains("jcalendar-disabled"))var F=r.options.value;else var F=r.getValue();r.setValue(F)}else{let X=r.options.value||"";r.options.value=null,r.setValue(X)}!U&&typeof r.options.onclose=="function"&&r.options.onclose(E),O.classList.remove("jcalendar-focus"),_(r,!1),w.current=null}return r.options.value},r.prev=function(){r.options.mode=="years"?(r.date[0]=r.date[0]-12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},r.next=function(){r.options.mode=="years"?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},r.setToday=function(){var U=new Date().toISOString().substr(0,10);return r.setValue(U),U},r.setValue=function(U){U||(U=""+U);var Z=U,v=r.options.value;if(v!=Z){if(Z){r.setLabel(Z,r.options);var X=Z.split(" ");X[1]||(X[1]="00:00:00");var F=X[1].split(":"),X=X[0].split("-"),ue=parseInt(X[0]),K=parseInt(X[1]),le=parseInt(X[2]),je=parseInt(F[0]),Ne=parseInt(F[1]);r.date=[ue,K,le,je,Ne,0];var U=r.setLabel(Z,r.options),ve=w.now(new Date(ue,K-1,le),!0);if(r.options.validRange){if(!r.options.validRange[0]||ve>=r.options.validRange[0])var Ie=!0;else var Ie=!1;if(!r.options.validRange[1]||ve<=r.options.validRange[1])var Fe=!0;else var Fe=!1;Ie&&Fe?(E.classList.remove("jcalendar_warning"),E.title=""):(E.classList.add("jcalendar_warning"),E.title=f.translate("Date outside the valid range"))}else E.classList.remove("jcalendar_warning"),E.title=""}else{r.date=null;var U="";E.classList.remove("jcalendar_warning"),E.title=""}r.options.value=Z,typeof r.options.onchange=="function"&&r.options.onchange(E,Z,v),E.value!=U&&(E.value=U,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))}r.date&&(r.getDays(),r.options.type=="year-month-picker"&&r.getMonths())},r.getValue=function(){return r.date?r.options.time?o.two(r.date[0])+"-"+o.two(r.date[1])+"-"+o.two(r.date[2])+" "+o.two(r.date[3])+":"+o.two(r.date[4])+":"+o.two(0):o.two(r.date[0])+"-"+o.two(r.date[1])+"-"+o.two(r.date[2])+" "+o.two(0)+":"+o.two(0)+":"+o.two(0):""},r.update=function(U,Z){if(!U.classList.contains("jcalendar-disabled")){var v=O.querySelector(".jcalendar-selected");v&&v.classList.remove("jcalendar-selected"),U.classList.add("jcalendar-selected"),U.classList.contains("jcalendar-set-month")?(r.date[1]=Z,r.date[2]=1):r.date[2]=U.innerText,r.options.time?(r.date[3]=Q.value,r.date[4]=he.value):r.close(null,!0)}ee()},r.reset=function(){r.setValue(""),r.date=null,r.close(!1,!1)},r.getDays=function(){r.options.mode="days";var je=new Date,U=r.date&&o.isNumeric(r.date[0])?r.date[0]:parseInt(je.getFullYear()),Z=r.date&&o.isNumeric(r.date[1])?r.date[1]:parseInt(je.getMonth())+1,v=r.date&&o.isNumeric(r.date[2])?r.date[2]:parseInt(je.getDate()),F=r.date&&o.isNumeric(r.date[3])?r.date[3]:parseInt(je.getHours()),X=r.date&&o.isNumeric(r.date[4])?r.date[4]:parseInt(je.getMinutes());r.date=[U,Z,v,F,X,0],ge.innerHTML=U,ce.innerHTML=r.options.months[Z-1];var ue=je.getMonth()==Z-1&&je.getFullYear()==U,K=je.getDate(),je=new Date(U,Z,0,0,0),le=je.getDate(),je=new Date(U,Z-1,0,0,0),Ne=je.getDay()+1,nt=r.options.startingDay||0;Ne=Ne-nt,Ee.innerHTML="";var ve=document.createElement("tr");ve.setAttribute("align","center"),Ee.appendChild(ve);for(var Ie=0;Ie<7;Ie++){var Fe=document.createElement("td");Fe.classList.add("jcalendar-weekday"),Fe.innerHTML=r.options.weekdays[nt].substr(0,1),ve.appendChild(Fe),nt++,nt>6&&(nt=0)}for(var nt=0,re=0,ye=0;ye<6;ye++){var ve=document.createElement("tr");ve.setAttribute("align","center"),ve.style.height="34px";for(var Ie=0;Ie<7;Ie++){var Fe=document.createElement("td");if(Fe.classList.add("jcalendar-set-day"),nt>=Ne&&nt<Ne+le){re++,Fe.innerHTML=re,re==v&&Fe.classList.add("jcalendar-selected"),ue&&K==re&&(Fe.style.fontWeight="bold");var xe=w.now(new Date(U,Z-1,re),!0);if(r.options.validRange){if(!r.options.validRange[0]||xe>=r.options.validRange[0])var Oe=!0;else var Oe=!1;if(!r.options.validRange[1]||xe<=r.options.validRange[1])var $e=!0;else var $e=!1;Oe&&$e||Fe.classList.add("jcalendar-disabled")}}ve.appendChild(Fe),nt++}Ee.appendChild(ve)}r.options.time?Se.style.display="":Se.style.display="none",ee()},r.getMonths=function(){r.options.mode="months";var U=r.options.months;r.options.value;var Z=new Date,v=parseInt(Z.getFullYear()),F=parseInt(Z.getMonth())+1,X=r.date&&o.isNumeric(r.date[0])?r.date[0]:v,ue=r.date&&o.isNumeric(r.date[1])?r.date[1]:F;ge.innerHTML=r.date[0],ce.innerHTML=U[ue-1];var K=document.createElement("table");K.setAttribute("width","100%");for(var le=null,je=0;je<12;je++){if(!(je%4)){var le=document.createElement("tr");le.setAttribute("align","center"),K.appendChild(le)}var Ne=document.createElement("td");if(Ne.classList.add("jcalendar-set-month"),Ne.setAttribute("data-value",je+1),Ne.innerText=U[je],r.options.validRange){var ve=X+"-"+o.two(je+1);if(!r.options.validRange[0]||ve>=r.options.validRange[0].substr(0,7))var Ie=!0;else var Ie=!1;if(!r.options.validRange[1]||ve<=r.options.validRange[1].substr(0,7))var Fe=!0;else var Fe=!1;Ie&&Fe||Ne.classList.add("jcalendar-disabled")}je+1==ue&&Ne.classList.add("jcalendar-selected"),v==X&&je+1==F&&(Ne.style.fontWeight="bold"),le.appendChild(Ne)}Ee.innerHTML='<tr><td colspan="7"></td></tr>',Ee.children[0].children[0].appendChild(K),ee()},r.getYears=function(){r.options.mode="years";for(var U=new Date,Z=U.getFullYear(),v=r.date&&o.isNumeric(r.date[0])?r.date[0]:parseInt(U.getFullYear()),F=[],X=0;X<25;X++)F[X]=parseInt(r.date[0])+(X-12);var ue=document.createElement("table");ue.setAttribute("width","100%");for(var X=0;X<25;X++){if(!(X%5)){var K=document.createElement("tr");K.setAttribute("align","center"),ue.appendChild(K)}var le=document.createElement("td");le.classList.add("jcalendar-set-year"),le.innerText=F[X],v==F[X]&&le.classList.add("jcalendar-selected"),Z==F[X]&&(le.style.fontWeight="bold"),K.appendChild(le)}Ee.innerHTML='<tr><td colspan="7"></td></tr>',Ee.firstChild.firstChild.appendChild(ue),ee()},r.setLabel=function(U,Z){return w.getDateString(U,Z)},r.fromFormatted=function(U,Z){return w.extractDateFromString(U,Z)};var P=function(U){var Z=o.findElement(U.target,"jcalendar-container");if(Z){var v=U.target.className;if(v=="jcalendar-prev")r.prev();else if(v=="jcalendar-next")r.next();else if(v=="jcalendar-month")r.getMonths();else if(v=="jcalendar-year")r.getYears();else if(v=="jcalendar-set-year")r.date[0]=U.target.innerText,r.options.type=="year-month-picker"?r.getMonths():r.getDays();else if(U.target.classList.contains("jcalendar-set-month")){var F=parseInt(U.target.getAttribute("data-value"));r.options.type=="year-month-picker"?r.update(U.target,F):(r.date[1]=F,r.getDays())}else v=="jcalendar-confirm"||v=="jcalendar-update"||v=="jcalendar-close"?r.close(null,!0):v=="jcalendar-backdrop"?r.close(!1,!1):v=="jcalendar-reset"?r.reset():U.target.classList.contains("jcalendar-set-day")&&U.target.innerText&&r.update(U.target)}else r.close(!1,!1)},te=function(U){if(U.target.value&&U.target.value.length>3){var Z=w.extractDateFromString(U.target.value,r.options.format);Z&&r.setValue(Z)}},ee=function(){var U=O.querySelector(".jcalendar-selected");U&&U.classList.contains("jcalendar-disabled")?(Ke.setAttribute("disabled","disabled"),Q.setAttribute("disabled","disabled"),he.setAttribute("disabled","disabled")):(Ke.removeAttribute("disabled"),Q.removeAttribute("disabled"),he.removeAttribute("disabled")),typeof r.options.onupdate=="function"&&r.options.onupdate(E,r.getValue())},O=null,N=null,V=null,G=null,ne=null,ge=null,ce=null,fe=null,Ee=null,De=null,Se=null,ze=null,Ke=null,Q=null,he=null,we=function(){E.tagName=="INPUT"&&E.value&&(l.value=E.value),N=document.createElement("div"),N.className="jcalendar-reset",V=document.createElement("div"),V.className="jcalendar-confirm",De=document.createElement("div"),De.className="jcalendar-controls",De.style.borderBottom="1px solid #ddd",De.appendChild(N),De.appendChild(V),G=document.createElement("div"),G.className="jcalendar-container",ne=document.createElement("div"),ne.className="jcalendar-content",G.appendChild(ne),E.tagName=="DIV"?(O=E,O.classList.add("jcalendar-inline")):(ne.appendChild(De),O=document.createElement("div"),O.className="jcalendar"),O.classList.add("jcalendar-container"),O.appendChild(G);var U=document.createElement("div");U.className="jcalendar-table",ne.appendChild(U);var Z=document.createElement("td");Z.setAttribute("colspan","2"),Z.className="jcalendar-prev",ge=document.createElement("span"),ge.className="jcalendar-year",ce=document.createElement("span"),ce.className="jcalendar-month";var v=document.createElement("td");v.className="jcalendar-header",v.setAttribute("colspan","3"),v.appendChild(ce),v.appendChild(ge);var F=document.createElement("td");F.setAttribute("colspan","2"),F.className="jcalendar-next";var X=document.createElement("thead"),ue=document.createElement("tr");ue.appendChild(Z),ue.appendChild(v),ue.appendChild(F),X.appendChild(ue),fe=document.createElement("table"),Ee=document.createElement("tbody"),fe.setAttribute("cellpadding","0"),fe.setAttribute("cellspacing","0"),fe.appendChild(X),fe.appendChild(Ee),U.appendChild(fe),Q=document.createElement("select"),Q.className="jcalendar-select",Q.onchange=function(){r.date[3]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(E,r.getValue())};for(var K=0;K<24;K++){var le=document.createElement("option");le.value=K,le.innerHTML=o.two(K),Q.appendChild(le)}he=document.createElement("select"),he.className="jcalendar-select",he.onchange=function(){r.date[4]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(E,r.getValue())};for(var K=0;K<60;K++){var le=document.createElement("option");le.value=K,le.innerHTML=o.two(K),he.appendChild(le)}var je=document.createElement("div");je.className="jcalendar-controls",Se=document.createElement("div"),Se.className="jcalendar-time",Se.style.maxWidth="140px",Se.appendChild(Q),Se.appendChild(he),Ke=document.createElement("button"),Ke.setAttribute("type","button"),Ke.className="jcalendar-update",ze=document.createElement("div"),ze.style.flexGrow="10",ze.appendChild(Ke),je.appendChild(Se),E.tagName=="INPUT"&&je.appendChild(ze),ne.appendChild(je);var Ne=document.createElement("div");Ne.className="jcalendar-backdrop",O.appendChild(Ne),E.addEventListener("keyup",te),O.addEventListener("swipeleft",function(ve){D.slideLeft(fe,0,function(){r.next(),D.slideRight(fe,1)}),ve.preventDefault(),ve.stopPropagation()}),O.addEventListener("swiperight",function(ve){D.slideRight(fe,0,function(){r.prev(),D.slideLeft(fe,1)}),ve.preventDefault(),ve.stopPropagation()}),"ontouchend"in document.documentElement?(O.addEventListener("touchend",P),E.addEventListener("touchend",r.open)):(O.addEventListener("mouseup",P),E.addEventListener("mouseup",r.open)),w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),r.setOptions(l),E.tagName=="INPUT"?(E.parentNode.insertBefore(O,E.nextSibling),E.setAttribute("autocomplete","off"),E.classList.add("jcalendar-input"),E.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(Q.value=r.date[3],he.value=r.date[4])),r.options.opened==!0&&r.open(),r.options.controls==!1&&G.classList.add("jcalendar-hide-controls"),E.change=r.setValue,E.val=function(ve){if(ve===void 0)return r.getValue();r.setValue(ve)},E.calendar=O.calendar=r};return we(),r};return w.keydown=function(E){var l=null;(l=w.current)&&(E.which==13?l.close(!1,!0):E.which==27&&l.close(!1,!1))},w.prettify=function(E,l){if(!l)var l={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};E.indexOf("GMT")===-1&&E.indexOf("Z")===-1&&(E+=" GMT");var r=new Date,P=new Date(E),te=parseInt((r-P)/1e3/60);if(String.prototype.format=function(O){return this.replace("{0}",O)},te==0)var ee=l.justNow;else if(te<90)var ee=l.xMinutesAgo.format(te);else if(te<1440)var ee=l.xHoursAgo.format(Math.round(te/60));else if(te<20160)var ee=l.xDaysAgo.format(Math.round(te/1440));else if(te<43200)var ee=l.xWeeksAgo.format(Math.round(te/10080));else if(te<1036800)var ee=l.xMonthsAgo.format(Math.round(te/43200));else var ee=l.xYearsAgo.format(Math.round(te/525600));return ee},w.prettifyAll=function(){for(var E=document.querySelectorAll(".prettydate"),l=0;l<E.length;l++)E[l].getAttribute("data-date")?E[l].innerHTML=w.prettify(E[l].getAttribute("data-date")):E[l].innerHTML&&(E[l].setAttribute("title",E[l].innerHTML),E[l].setAttribute("data-date",E[l].innerHTML),E[l].innerHTML=w.prettify(E[l].innerHTML))},w.now=S.now,w.toArray=S.toArray,w.dateToNum=S.dateToNum,w.numToDate=S.numToDate,w.weekdays=S.weekdays,w.months=S.months,w.weekdaysShort=S.weekdaysShort,w.monthsShort=S.monthsShort,w.extractDateFromString=q.extractDateFromString,w.getDateString=q.getDateString,w}var pe=ie();function se(){var w={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},E=function(l){return w[l]?w[l]:w.material};return E.get=function(l){return w[l]?w[l]:w},E.set=function(l,r){w[l]=r},E}var be=se();function Me(w,E){var l={};l.options={};var r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var P in r)E&&E.hasOwnProperty(P)?l.options[P]=E[P]:l.options[P]=r[P];w.classList.add("jtabs");var te=null,ee=null,O=null;const N=function(ce){l.options.animation&&setTimeout(function(){let fe=l.headers.children[ce].getBoundingClientRect();l.options.palette==="modern"?(O.style.width=fe.width-4+"px",O.style.left=l.headers.children[ce].offsetLeft+2+"px"):(O.style.width=fe.width+"px",O.style.left=l.headers.children[ce].offsetLeft+"px"),l.options.position==="bottom"?O.style.top="0px":O.style.bottom="0px"},50)};var V=function(ce){typeof l.headers.scrollTo=="function"?l.headers.scrollTo({left:ce,behavior:"smooth"}):l.headers.scrollLeft=ce,ce<=1?te.classList.add("disabled"):te.classList.remove("disabled"),ce>=l.headers.scrollWidth-l.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),l.headers.scrollWidth<=l.headers.offsetWidth?(te.style.display="none",ee.style.display="none"):(te.style.display="",ee.style.display="")};if(l.setBorder=N,l.open=function(ce){if(Array.from(l.content.children),!!l.content.children[ce]){for(var fe=null,Ee=0;Ee<l.headers.children.length;Ee++)l.headers.children[Ee].classList.contains("jtabs-selected")&&(fe=Ee),l.headers.children[Ee].classList.remove("jtabs-selected"),l.headers.children[Ee].removeAttribute("aria-selected"),l.content.children[Ee]&&l.content.children[Ee].classList.remove("jtabs-selected");if(l.headers.children[ce].classList.add("jtabs-selected"),l.headers.children[ce].setAttribute("aria-selected","true"),l.content.children[ce]&&l.content.children[ce].classList.add("jtabs-selected"),fe!=ce&&typeof l.options.onchange=="function"&&l.content.children[ce]&&l.options.onchange(w,l,ce,l.headers.children[ce],l.content.children[ce]),l.options.hideHeaders==!0&&l.headers.children.length<3&&l.options.allowCreate==!1)l.headers.parentNode.style.display="none";else{l.headers.parentNode.style.display="";var De=l.headers.children[ce].offsetLeft,Se=De+l.headers.children[ce].offsetWidth,ze=l.headers.scrollLeft,Ke=ze+l.headers.offsetWidth;ze<=De&&Ke>=Se||V(De-1),N(ce)}}},l.selectIndex=function(ce){var fe=Array.prototype.indexOf.call(l.headers.children,ce);return fe>=0&&l.open(fe),fe},l.rename=function(ce,fe){fe||(fe=prompt("New title",l.headers.children[ce].innerText)),l.headers.children[ce].innerText=fe,N(l.getActive())},l.create=function(ce,fe){if(typeof l.options.onbeforecreate=="function"){var Ee=l.options.onbeforecreate(w,ce);if(Ee===!1)return!1;ce=Ee}var De=l.appendElement(ce);return typeof l.options.oncreate=="function"&&l.options.oncreate(w,De),N(l.getActive()),De},l.remove=function(ce){return l.deleteElement(ce)},l.nextNumber=function(){for(var ce=0,fe=0;fe<l.headers.children.length;fe++){var Ee=l.headers.children[fe].innerText.match(/[0-9].*/);Ee>ce&&(ce=parseInt(Ee))}return ce?ce++:ce=1,ce},l.deleteElement=function(ce){let fe=l.getActive();if(l.headers.children[ce])l.headers.removeChild(l.headers.children[ce]),l.content.removeChild(l.content.children[ce]);else return!1;if(fe===ce)l.open(0);else{let Ee=l.getActive()||0;N(Ee)}typeof l.options.ondelete=="function"&&l.options.ondelete(w,ce)},l.appendElement=function(ce,fe,Ee,De){if(!ce)var ce=prompt("Title?","");if(ce){let Ke=o.guid(),Q=o.guid();var Se=document.createElement("div");Se.setAttribute("id",Q),Se.setAttribute("role","tabpanel"),Se.setAttribute("aria-labelledby",Ke);var ze=document.createElement("div");if(ze.setAttribute("id",Ke),ze.setAttribute("role","tab"),ze.setAttribute("aria-controls",Q),ze.innerHTML=ce,ze.content=Se,typeof De>"u")l.content.appendChild(Se),l.headers.insertBefore(ze,l.headers.lastChild);else{let he=l.content.children[De];he?l.content.insertBefore(Se,he):l.content.appendChild(Se),he=l.headers.children[De]||l.headers.lastChild,l.headers.insertBefore(ze,he)}return l.options.allowChangePosition&&ze.setAttribute("draggable","true"),Ee!==!1&&l.selectIndex(ze),typeof fe=="function"&&fe(Se,ze),Se}},l.getActive=function(){for(var ce=0;ce<l.headers.children.length;ce++)if(l.headers.children[ce].classList.contains("jtabs-selected"))return ce;return!1},l.updateContent=function(ce,fe){if(typeof fe!="string")var Ee=fe;else{var Ee=document.createElement("div");Ee.innerHTML=fe}l.content.children[ce].classList.contains("jtabs-selected")&&fe.classList.add("jtabs-selected"),l.content.replaceChild(fe,l.content.children[ce]),N()},l.updatePosition=function(ce,fe,Ee,De){if(ce>fe?l.content.insertBefore(l.content.children[ce],l.content.children[fe]):l.content.insertBefore(l.content.children[ce],l.content.children[fe].nextSibling),De!==!1)l.open(fe);else{const Se=l.getActive();fe<Se&&l.setBorder(Se)}!Ee&&typeof l.options.onchangeposition=="function"&&l.options.onchangeposition(l.headers,ce,fe)},l.move=function(ce,fe,Ee,De){ce>fe?l.headers.insertBefore(l.headers.children[ce],l.headers.children[fe]):l.headers.insertBefore(l.headers.children[ce],l.headers.children[fe].nextSibling),l.updatePosition(ce,fe,Ee,De)},l.setBorder=N,l.init=function(){w.innerHTML="",l.headers=document.createElement("div"),l.content=document.createElement("div"),l.headers.classList.add("jtabs-headers"),l.headers.setAttribute("role","tablist"),l.content.classList.add("jtabs-content"),l.content.setAttribute("role","region"),l.content.setAttribute("aria-label","Tab Panels"),l.options.palette?w.classList.add("jtabs-modern"):w.classList.remove("jtabs-modern"),l.options.padding&&(l.content.style.padding=parseInt(l.options.padding)+"px");var ce=document.createElement("div");ce.className="jtabs-headers-container",ce.appendChild(l.headers),l.options.maxWidth&&(ce.style.maxWidth=parseInt(l.options.maxWidth)+"px");var fe=document.createElement("div");if(fe.className="jtabs-controls",fe.setAttribute("draggable","false"),ce.appendChild(fe),l.options.position=="bottom"?(w.appendChild(l.content),w.appendChild(ce)):(w.appendChild(ce),w.appendChild(l.content)),l.options.allowCreate==!0){var Ee=document.createElement("div");Ee.className="jtabs-add",Ee.onclick=function(){l.create()},fe.appendChild(Ee)}te=document.createElement("div"),te.className="jtabs-prev",te.onclick=function(){V(l.headers.scrollLeft-l.headers.offsetWidth)},fe.appendChild(te),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){V(l.headers.scrollLeft+l.headers.offsetWidth)},fe.appendChild(ee);for(var De=0;De<l.options.data.length;De++){if(l.options.data[De].titleElement)var Se=l.options.data[De].titleElement;else var Se=document.createElement("div");if(l.options.data[De].icon){var ze=document.createElement("div"),Ke=document.createElement("i");Ke.classList.add("material-icons"),Ke.innerHTML=l.options.data[De].icon,ze.appendChild(Ke),Se.appendChild(ze)}if(l.options.data[De].title){var Q=document.createTextNode(l.options.data[De].title);Se.appendChild(Q)}if(l.options.data[De].width&&(Se.style.width=l.options.data[De].width),l.options.data[De].contentElement)var he=l.options.data[De].contentElement;else{var he=document.createElement("div");he.innerHTML=l.options.data[De].content}l.headers.appendChild(Se),l.content.appendChild(he)}O=document.createElement("div"),O.className="jtabs-border",l.headers.appendChild(O),l.options.animation&&w.classList.add("jtabs-animation"),l.headers.addEventListener("click",function(we){if(we.target.parentNode.classList.contains("jtabs-headers"))var U=we.target;else if(we.target.tagName=="I")var U=we.target.parentNode.parentNode;else var U=we.target.parentNode;var Z=l.selectIndex(U);typeof l.options.onclick=="function"&&l.options.onclick(w,l,Z,l.headers.children[Z],l.content.children[Z])}),l.headers.addEventListener("contextmenu",function(we){l.selectIndex(we.target)}),l.headers.children.length&&l.open(0),V(0),l.options.allowChangePosition==!0&&h(l.headers,{direction:1,ondrop:function(we,U,Z){l.updatePosition(U,Z)}}),typeof l.options.onload=="function"&&l.options.onload(w,l)},w.children[0]&&w.children[0].children.length)for(var G=0;G<w.children[0].children.length;G++){var ne=l.options.data&&l.options.data[G]?l.options.data[G]:{};w.children[1]&&w.children[1].children[G]?(ne.titleElement=w.children[0].children[G],ne.contentElement=w.children[1].children[G]):ne.contentElement=w.children[0].children[G],l.options.data[G]=ne}var ge=!1;if(l.options.data)for(var G=0;G<l.options.data.length;G++)l.options.data[G].url&&(I({url:l.options.data[G].url,type:"GET",dataType:"text/html",index:G,success:function(fe){l.options.data[this.index].content=fe},complete:function(){l.init()}}),ge=!0);return ge||l.init(),w.tabs=l,l}function me(w,E){if(w.color)return w.color.setOptions(E,!0);var l={type:"color"};l.options={};var r=null,P=null,te=null,ee=null,O=null,N=null,V=null;l.setOptions=function(v,F){var X={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};v||(v={}),v&&!v.palette&&(v.palette=be());for(var ue in X)v&&v.hasOwnProperty(ue)?l.options[ue]=v[ue]:(typeof l.options[ue]>"u"||F===!0)&&(l.options[ue]=X[ue]);return ee&&(ee.innerHTML=l.options.resetLabel),O&&(O.innerHTML=l.options.doneLabel),l.options.palette&&V&&V.updateContent(0,fe()),typeof l.options.value=="string"&&(w.value=l.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value)),l.options.placeholder?w.setAttribute("placeholder",l.options.placeholder):w.getAttribute("placeholder")&&w.removeAttribute("placeholder"),l},l.select=function(v){var F=r.querySelector(".jcolor-selected");F&&F.classList.remove("jcolor-selected"),l.values[v]&&l.values[v].classList.add("jcolor-selected"),l.options.value=v},l.open=function(){if(!r.classList.contains("jcolor-focus")){_(l,!0),r.classList.add("jcolor-focus"),l.options.value&&l.select(l.options.value),te.style.marginTop="",te.style.marginLeft="";var v=te.getBoundingClientRect(),F=o.getWindowWidth(),X=o.getWindowHeight();if(F<800||l.options.fullscreen==!0?(te.classList.add("jcolor-fullscreen"),D.slideBottom(te,1),P.style.display="block"):(te.classList.contains("jcolor-fullscreen")&&(te.classList.remove("jcolor-fullscreen"),P.style.display=""),l.options.position?te.style.position="fixed":te.style.position="",v.left+v.width>F&&(te.style.marginLeft=-1*(v.left+v.width-(F-20))+"px"),v.top+v.height>X&&(te.style.marginTop=-1*(v.top+v.height-(X-20))+"px")),typeof l.options.onopen=="function"&&l.options.onopen(w,l),V.setBorder(V.getActive()),l.options.value){var ue=ce(l.options.value);he.forEach(function(K,le){K.value=ue[le],K.dispatchEvent(new Event("input"))})}}},l.close=function(v){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),P.style.display="",!v&&typeof l.options.onclose=="function"&&l.options.onclose(w,l),_(l,!1)),l.options.value},l.setValue=function(v){v||(v=""),v!=l.options.value&&(l.options.value=v,Q=v,l.select(v),typeof l.options.onchange=="function"&&l.options.onchange(w,v,l),w.value!=l.options.value&&(w.value=l.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value),typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),l.options.closeOnChange==!0&&l.close())},l.getValue=function(){return l.options.value};var G=function(v){var F=v.toString(16);return F.length===1?"0"+F:F},ne=function(v,F,X){return"#"+G(v)+G(F)+G(X)},ge=function(v){return parseInt("0x"+v)},ce=function(v){return[ge(v.substr(1,2)),ge(v.substr(3,2)),ge(v.substr(5,2))]},fe=function(){var v=document.createElement("div");v.className="jcolor-grid",l.values=[];var F=document.createElement("table");F.setAttribute("cellpadding","7"),F.setAttribute("cellspacing","0");for(var X=0;X<l.options.palette.length;X++){for(var ue=document.createElement("tr"),K=0;K<l.options.palette[X].length;K++){var le=document.createElement("td"),je=l.options.palette[X][K];je.length<7&&je.substr(0,1)!=="#"&&(je="#"+je),le.style.backgroundColor=je,le.setAttribute("data-value",je),le.innerHTML="",ue.appendChild(le),l.options.value==je&&le.classList.add("jcolor-selected"),l.values[je]=le}F.appendChild(ue)}return v.appendChild(F),v},Ee=document.createElement("canvas");Ee.width=200,Ee.height=160;var De=Ee.getContext("2d"),Se=function(){var v=N.firstChild.getBoundingClientRect();Ee.width=v.width-14,ze()},ze=function(){var v=De.createLinearGradient(0,0,Ee.width,0);v.addColorStop(0,"rgb(255,0,0)"),v.addColorStop(.15,"rgb(255,0,255)"),v.addColorStop(.33,"rgb(0,0,255)"),v.addColorStop(.49,"rgb(0,255,255)"),v.addColorStop(.67,"rgb(0,255,0)"),v.addColorStop(.84,"rgb(255,255,0)"),v.addColorStop(1,"rgb(255,0,0)"),De.fillStyle=v,De.fillRect(0,0,Ee.width,Ee.height),v=De.createLinearGradient(0,0,0,Ee.height),v.addColorStop(0,"rgba(255,255,255,1)"),v.addColorStop(.5,"rgba(255,255,255,0)"),v.addColorStop(.5,"rgba(0,0,0,0)"),v.addColorStop(1,"rgba(0,0,0,1)"),De.fillStyle=v,De.fillRect(0,0,Ee.width,Ee.height)},Ke=function(){var v=document.createElement("div");v.className="jcolor-hsl";var F=document.createElement("div");F.className="jcolor-point";var X=document.createElement("div");X.appendChild(Ee),X.appendChild(F),v.appendChild(X);var ue=function(K,le,je){if(K===1){var Ne=v.getBoundingClientRect(),ve=le-Ne.left,Ie=je-Ne.top;ve<0&&(ve=0),Ie<0&&(Ie=0),ve>Ne.width&&(ve=Ne.width),Ie>Ne.height&&(Ie=Ne.height),F.style.left=ve+"px",F.style.top=Ie+"px";var Fe=De.getImageData(ve,Ie,1,1).data;Q=ne(Fe[0],Fe[1],Fe[2])}};return v.addEventListener("mousedown",function(K){ue(K.buttons,K.clientX,K.clientY)}),v.addEventListener("mousemove",function(K){ue(K.buttons,K.clientX,K.clientY)}),v.addEventListener("touchmove",function(K){ue(1,K.changedTouches[0].clientX,K.changedTouches[0].clientY)}),v},Q="",he=[],we=function(){if(Q!=="")for(var v=0;v<he.length;v++){var F=ce(Q);F[v]=0;var X="linear-gradient(90deg, rgb(";X+=F.join(", "),X+="), rgb(",F[v]=255,X+=F.join(", "),X+="))",he[v].style.backgroundImage=X}},U=function(){var v=document.createElement("div");v.className="jcolor-sliders";var F=document.createElement("div"),X=function(je){var Ne=document.createElement("div");Ne.className="jcolor-sliders-input-container";var ve=document.createElement("label");ve.innerText=je;var Ie=document.createElement("div");Ie.className="jcolor-sliders-input-subcontainer";var Fe=document.createElement("input");Fe.type="range",Fe.min=0,Fe.max=255,Fe.value=0,Fe.setAttribute("aria-label","Color value"),Fe.setAttribute("aria-valuemin","0"),Fe.setAttribute("aria-valuemax","255"),Fe.setAttribute("aria-valuenow","0"),Ne.appendChild(ve),Ie.appendChild(Fe);var nt=document.createElement("div");return nt.innerText=Fe.value,Fe.addEventListener("input",function(){nt.innerText=Fe.value}),Ie.appendChild(nt),Ne.appendChild(Ie),F.appendChild(Ne),Fe};he=[X("Red"),X("Green"),X("Blue")],v.appendChild(F);var ue=document.createElement("div");ue.className="jcolor-sliders-final-color";var K=document.createElement("div");K.style.visibility="hidden",K.innerText="a",ue.appendChild(K);var le=function(){var je=ne(parseInt(he[0].value),parseInt(he[1].value),parseInt(he[2].value));K.innerText=je,K.style.color=je,K.style.removeProperty("visibility"),Q=je};return he.forEach(function(je){je.addEventListener("input",function(){le(),we()})}),v.appendChild(ue),v},Z=function(){l.setOptions(E),w.tagName=="INPUT"&&(w.classList.add("jcolor-input"),w.readOnly=!0),r=document.createElement("div"),r.className="jcolor",P=document.createElement("div"),P.className="jcolor-backdrop",r.appendChild(P),te=document.createElement("div"),te.className="jcolor-content";var v=document.createElement("div");v.className="jcolor-controls",te.appendChild(v),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=l.options.resetLabel,v.appendChild(ee),O=document.createElement("div"),O.className="jcolor-close",O.innerHTML=l.options.doneLabel,v.appendChild(O),N=document.createElement("div"),te.appendChild(N),V=Me(N,{animation:!0,data:[{title:"Grid",contentElement:fe()},{title:"Spectrum",contentElement:Ke()},{title:"Sliders",contentElement:U()}],onchange:function(F,X,ue){if(ue===1)Se();else{var K=Q!==""?Q:l.getValue();if(ue===2&&K){var le=ce(K);he.forEach(function(je,Ne){je.value=le[Ne],je.dispatchEvent(new Event("input"))})}}},palette:"modern"}),r.appendChild(te),w.tagName=="INPUT"?w.parentNode.insertBefore(r,w.nextSibling):w.appendChild(r),r.addEventListener("click",function(F){if(F.target.tagName=="TD"){var X=F.target.getAttribute("data-value");X&&l.setValue(X)}else F.target.classList.contains("jcolor-reset")?(l.setValue(""),l.close()):F.target.classList.contains("jcolor-close")?(V.getActive()>0&&l.setValue(Q),l.close()):F.target.classList.contains("jcolor-backdrop")?l.close():l.open()}),w.addEventListener("mouseup",function(F){l.open()}),window.addEventListener("resize",function(){r.classList.contains("jcolor-focus")&&V.getActive()==1&&Se()}),l.options.opened==!0&&l.open(),w.change=l.setValue,w.val=function(F){if(F===void 0)return l.getValue();l.setValue(F)},w.color=l,r.color=l};return l.toHex=function(v){var F=function(X){return("0"+parseInt(X).toString(16)).slice(-2)};if(v)return/^#[0-9A-F]{6}$/i.test(v)?v:(v=v.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),v&&v.length?"#"+F(v[1])+F(v[2])+F(v[3]):"")},Z(),l}function ae(){var w=function(E,l){var r={type:"contextmenu"};r.options={};var P={items:null,onclick:null};for(var te in P)l&&l.hasOwnProperty(te)?r.options[te]=l[te]:r.options[te]=P[te];E.classList.add("jcontextmenu"),r.open=function(N,V){if(V&&(r.options.items=V,r.create(V)),w.current&&w.current.close(),_(r,!0),E.classList.add("jcontextmenu-focus"),w.current=r,r.options.items&&r.options.items.length>0||E.children.length){if(N.target)if(N.changedTouches&&N.changedTouches[0])G=N.changedTouches[0].clientX,ne=N.changedTouches[0].clientY;else var G=N.clientX,ne=N.clientY;else var G=N.x,ne=N.y;var ge=E.getBoundingClientRect();if(window.innerHeight<ne+ge.height){var ce=ne-ge.height;ce<0&&(ce=0),E.style.top=ce+"px"}else E.style.top=ne+"px";window.innerWidth<G+ge.width?G-ge.width>0?E.style.left=G-ge.width+"px":E.style.left="10px":E.style.left=G+"px"}},r.isOpened=function(){return!!E.classList.contains("jcontextmenu-focus")},r.close=function(){E.classList.contains("jcontextmenu-focus")&&E.classList.remove("jcontextmenu-focus"),_(r,!1)},r.create=function(N){E.innerHTML="";var V=ee();E.appendChild(V);for(var G=0;G<N.length;G++){var ne=O(N[G]);E.appendChild(ne)}};function ee(){var N=document.createElement("div");N.classList.add("header"),N.addEventListener("click",function(ne){ne.preventDefault(),ne.stopPropagation()});var V=document.createElement("a");V.classList.add("title"),V.innerHTML=f.translate("Menu"),N.appendChild(V);var G=document.createElement("a");return G.classList.add("close"),G.innerHTML=f.translate("close"),G.addEventListener("click",function(ne){r.close()}),N.appendChild(G),N}function O(N){if(N.type&&(N.type=="line"||N.type=="divisor"))var V=document.createElement("hr");else{var V=document.createElement("div"),G=document.createElement("a");if(G.innerHTML=N.title,N.tooltip&&V.setAttribute("title",N.tooltip),N.icon&&V.setAttribute("data-icon",N.icon),N.id&&(V.id=N.id),N.disabled?V.className="jcontextmenu-disabled":N.onclick&&(V.method=N.onclick,V.addEventListener("mousedown",function(ze){ze.preventDefault()}),V.addEventListener("mouseup",function(ze){this.method(this,ze)})),V.appendChild(G),N.submenu){var ne=document.createElement("span");ne.innerHTML="&#9658;",V.appendChild(ne),V.classList.add("jcontexthassubmenu");var ge=document.createElement("div");ge.classList.add("jcontextmenu"),ge.setAttribute("tabindex","900");for(var ce=N.submenu,fe=0;fe<ce.length;fe++){var Ee=O(ce[fe]);ge.appendChild(Ee)}V.appendChild(ge)}else if(N.shortcut){var De=document.createElement("span");De.innerHTML=N.shortcut,V.appendChild(De)}}return V}return typeof r.options.onclick=="function"&&E.addEventListener("click",function(N){r.options.onclick(r,N)}),r.options.items&&r.create(r.options.items),window.addEventListener("mousewheel",function(){r.close()}),E.contextmenu=r,r};return w}var Pe=ae();function Ye(){var w=function(E,l){if(E.dropdown)return E.dropdown.setOptions(l,!0);var r={type:"dropdown"};r.options={};var P=function(U,Z){U&&U.length&&(r.options.sortResults!==!1&&(typeof r.options.sortResults=="function"?U.sort(r.options.sortResults):U.sort(te)),r.setData(U)),typeof r.options.onload=="function"&&r.options.onload(E,r,U,Z),Z&&O(Z),Z==null&&(r.options.value=""),E.value=r.options.value,r.options.opened==!0&&r.open()},te=function(U,Z){var v,F;return typeof U=="string"?v=U:U.text?v=U.text:U.name&&(v=U.name),typeof Z=="string"?F=Z:Z.text?F=Z.text:Z.name&&(F=Z.name),typeof v=="string"||typeof F=="string"?(typeof v!="string"&&(v=""+v),typeof F!="string"&&(F=""+F),v.localeCompare(F)):v-F},ee=function(){r.value={};for(var U=0;U<r.items.length;U++)r.items[U].selected==!0&&(r.items[U].element&&r.items[U].element.classList.remove("jdropdown-selected"),r.items[U].selected=null);r.options.value="",E.value=""},O=function(U){if(ee(),U!==null)if(!U)typeof r.value[""]<"u"&&(r.value[""]="");else{Array.isArray(U)||(U=(""+U).split(";"));for(var Z=0;Z<U.length;Z++)r.value[U[Z]]=""}for(var Z=0;Z<r.items.length;Z++)typeof r.value[N(Z)]<"u"&&(r.items[Z].element&&r.items[Z].element.classList.add("jdropdown-selected"),r.items[Z].selected=!0,r.value[N(Z)]=V(Z));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},N=function(U,Z){if(r.options.format)var v="id";else var v="value";return r.items[U]?r.items[U].data[v]:""},V=function(U,Z){if(r.options.format)var v="name";else var v="text";return r.items[U]?r.items[U].data[v]:""},G=function(){return Object.keys(r.value)},ne=function(){for(var U=[],Z=Object.keys(r.value),v=0;v<Z.length;v++)U.push(r.value[Z[v]]);return U};r.setOptions=function(U,Z){U||(U={});var v={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var F in v)U&&U.hasOwnProperty(F)?r.options[F]=U[F]:(typeof r.options[F]>"u"||Z===!0)&&(r.options[F]=v[F]);return(r.options.remoteSearch==!0||r.options.type==="searchbar")&&(r.options.autocomplete=!0),r.options.newOptions==!0?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),r.options.autocomplete==!0?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),E.classList.remove("jdropdown-searchbar"),E.classList.remove("jdropdown-picker"),E.classList.remove("jdropdown-list"),r.options.type=="searchbar"?E.classList.add("jdropdown-searchbar"):r.options.type=="list"?E.classList.add("jdropdown-list"):r.options.type=="picker"?E.classList.add("jdropdown-picker"):o.getWindowWidth()<800?r.options.autocomplete?(E.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(E.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(E.style.width=r.options.width,E.style.minWidth=r.options.width):(E.style.removeProperty("width"),E.style.removeProperty("min-width")),E.classList.add("jdropdown-default"),r.options.type="default"),r.options.type=="searchbar"?ge.appendChild(Ee):ce.insertBefore(Ee,ce.firstChild),r.options.url&&!U.data?I({url:r.options.url,method:"GET",dataType:"json",success:function(X){X&&P(X,r.options.value)}}):P(r.options.data,r.options.value),r};var ge=null,ce=null,fe=null,Ee=null,De=null,Se=null,ze=null,Ke=function(){if(l||(l={}),E.tagName=="SELECT"){var U=w.extractFromDom(E,l);E=U.el,l=U.options}!l.placeholder&&E.getAttribute("placeholder")&&(l.placeholder=E.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,E.classList.add("jdropdown"),ge=document.createElement("div"),ge.className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header jss_object",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){typeof r.options.onfocus=="function"&&r.options.onfocus(E)},r.header.onblur=function(){typeof r.options.onblur=="function"&&r.options.onblur(E)},r.header.onkeyup=function(Z){r.options.autocomplete==!0&&!ze?(r.search!=r.header.value.trim()&&(ze=setTimeout(function(){r.find(r.header.value.trim()),ze=null},400)),E.classList.contains("jdropdown-focus")||r.open()):r.options.autocomplete||r.next(Z.key)},w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),ce=document.createElement("div"),ce.className="jdropdown-container",fe=document.createElement("div"),fe.className="jdropdown-content",Ee=document.createElement("div"),Ee.className="jdropdown-close",Ee.textContent="Done",De=document.createElement("div"),De.className="jdropdown-reset",De.textContent="x",De.onclick=function(){r.reset(),r.close()},Se=document.createElement("div"),Se.className="jdropdown-backdrop",ge.appendChild(r.header),ce.appendChild(fe),E.appendChild(ge),E.appendChild(ce),E.appendChild(Se),r.setOptions(l),"ontouchsend"in document.documentElement?E.addEventListener("touchsend",w.mouseup):E.addEventListener("mouseup",w.mouseup),r.options.lazyLoading==!0&&C(fe,{loadUp:r.loadUp,loadDown:r.loadDown}),fe.onwheel=function(Z){Z.stopPropagation()},E.change=r.setValue,E.val=function(Z){if(Z===void 0)return r.getValue(!!r.options.multiple);r.setValue(Z)},E.dropdown=r};r.getUrl=function(){return r.options.url},r.setUrl=function(U,Z){r.options.url=U,I({url:r.options.url,method:"GET",dataType:"json",success:function(v){r.setData(v),typeof Z=="function"&&Z(r)}})},r.setId=function(U,Z){if(r.options.format)var v="id";else var v="value";typeof U=="object"?U[v]=Z:r.items[U].data[v]=Z};const Q=function(U,Z){if(!U){let X=r.options.autocomplete==!0?r.header.value:"";if(U=prompt(f.translate("Add A New Option"),X),!U)return!1}if(Z||(Z=o.guid()),r.options.format)var v={id:Z,name:U};else var v={value:Z,text:U};if(typeof r.options.onbeforeinsert=="function"){let X=r.options.onbeforeinsert(r,v);if(X===!1)return!1;X&&(v=X)}r.options.data.push(v);var F=r.createItem(v);return fe.appendChild(F.element),typeof r.options.oninsert=="function"&&r.options.oninsert(r,v,F),fe.style.display=="none"&&(fe.style.display=""),r.results&&r.results.push(F),v};r.add=function(U,Z){return typeof r.options.prompt=="function"?r.options.prompt.call(r,Q):Q(U,Z)},r.createItem=function(U,Z,v){r.options.format?(!U.id&&U.value!==void 0&&(U.id=U.value),!U.name&&U.text!==void 0&&(U.name=U.text)):(!U.value&&U.id!==void 0&&(U.value=U.id),!U.text&&U.name!==void 0&&(U.text=U.name));var F={};if(F.element=document.createElement("div"),F.element.className="jdropdown-item",F.element.indexValue=r.items.length,F.data=U,Z&&(F.group=Z),U.id&&F.element.setAttribute("id",U.id),U.disabled==!0&&F.element.setAttribute("data-disabled",!0),U.tooltip&&F.element.setAttribute("title",U.tooltip),U.image){var X=document.createElement("img");X.className="jdropdown-image",X.src=U.image,U.title||X.classList.add("jdropdown-image-small"),F.element.appendChild(X)}else if(U.icon){var ue=document.createElement("span");ue.className="jdropdown-icon material-icons",ue.innerText=U.icon,U.title||ue.classList.add("jdropdown-icon-small"),U.color&&(ue.style.color=U.color),F.element.appendChild(ue)}else if(U.color){var K=document.createElement("div");K.className="jdropdown-color",K.style.backgroundColor=U.color,F.element.appendChild(K)}if(r.options.format)var le=U.name;else var le=U.text;var je=document.createElement("div");if(je.className="jdropdown-description",je.textContent=le||"&nbsp;",U.title){var Ne=document.createElement("div");Ne.className="jdropdown-title",Ne.innerText=U.title,je.appendChild(Ne)}if(r.options.format)var ve=U.id;else var ve=U.value;return r.value[ve]&&(F.element.classList.add("jdropdown-selected"),F.selected=!0),r.items.push(F),F.element.appendChild(je),F},r.appendData=function(U){if(U.length){for(var Z=[],v=[],F=0;F<U.length;F++)U[F].group?(v[U[F].group]||(v[U[F].group]=[]),v[U[F].group].push(F)):Z.push(F);var X=0,ue=Object.keys(v);if(ue.length>0)for(var F=0;F<ue.length;F++){var K=document.createElement("div");K.className="jdropdown-group";var le=document.createElement("div");le.className="jdropdown-group-name",le.textContent=ue[F];var je=document.createElement("i");je.className="jdropdown-group-arrow jdropdown-group-arrow-down",le.appendChild(je);var Ne=document.createElement("div");Ne.className="jdropdown-group-items";for(var ve=0;ve<v[ue[F]].length;ve++){var Ie=r.createItem(U[v[ue[F]][ve]],K,ue[F]);(r.options.lazyLoading==!1||X<200)&&(Ne.appendChild(Ie.element),X++)}K.appendChild(le),K.appendChild(Ne),r.groups.push(K),Ne.children.length>0&&fe.appendChild(K)}if(Z.length)for(var F=0;F<Z.length;F++){var Ie=r.createItem(U[Z[F]]);(r.options.lazyLoading==!1||X<200)&&(fe.appendChild(Ie.element),X++)}}},r.setData=function(U){if(ee(),fe.textContent="",r.header.value="",r.items=[],U&&U.length){for(var Z=0;Z<U.length;Z++)typeof U[Z]!="object"&&(r.options.format?U[Z]={id:U[Z],name:U[Z]}:U[Z]={value:U[Z],text:U[Z]});r.appendData(U),r.options.data=U}else r.options.data=[];r.close()},r.getData=function(){return r.options.data},r.getPosition=function(U){for(var Z=0;Z<r.items.length;Z++)if(N(Z)==U)return Z;return!1},r.getText=function(U){var Z=ne();return U?Z:Z.join("; ")},r.getValue=function(U){var Z=G();return U?Z:Z.join(";")};var he=function(U){E.value!=r.options.value&&(E.value=r.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),typeof r.options.onchange=="function"&&r.options.onchange(E,r,U,r.options.value)};r.setValue=function(U){var Z=r.getValue();Array.isArray(U)&&(U=U.join(";")),Z!==U&&(O(U),he(Z))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(v,Z){var v=parseInt(v);if(r.items&&r.items[v]&&(Z===!0||r.items[v].data.disabled!==!0))if(r.setCursor(v,!1),!r.options.multiple)r.items[v].selected?r.options.allowEmpty!==!1&&r.setValue(null):r.setValue(N(v)),r.close();else{var F=r.options.value;r.items[v].selected?(r.items[v].element.classList.remove("jdropdown-selected"),r.items[v].selected=!1,delete r.value[N(v)]):(r.items[v].element.classList.add("jdropdown-selected"),r.items[v].selected=!0,r.value[N(v)]=V(v)),r.options.value=Object.keys(r.value).join(";"),r.options.autocomplete==!1&&(r.header.value=ne().join("; ")),he(F)}},r.selectItem=function(U){r.selectIndex(U.indexValue)};var we=function(U,Z){for(var v=0;v<Z.length;v++)if(r.options.format){if(Z[v].id==U)return!0}else if(Z[v].value==U)return!0;return!1};return r.find=function(U){if(r.search==U.trim())return!1;if(r.search=U,r.setCursor(),r.groups.length)for(var Z=0;Z<r.groups.length;Z++)r.groups[Z].lastChild.textContent="";if(fe.textContent="",r.options.remoteSearch==!0){r.results=null;var v=r.options.url;let Ne={url:v,method:"GET",data:{q:U},dataType:"json",success:function(ve){r.items=[];var Ie=Object.keys(r.value);if(Ie.length)for(var Fe=0;Fe<Ie.length;Fe++)we(Ie[Fe],ve)||(r.options.format?ve.unshift({id:Ie[Fe],name:r.value[Ie[Fe]]}):ve.unshift({value:Ie[Fe],text:r.value[Ie[Fe]]}));r.appendData(ve),ve.length?fe.style.display="":fe.style.display="none",typeof r.options.onsearch=="function"&&r.options.onsearch(r,ve)}};if(typeof r.options.onbeforesearch=="function"){let ve=r.options.onbeforesearch(r,Ne);if(ve===!1)return;typeof ve=="object"&&(Ne=ve)}I(Ne)}else{U=new RegExp(U,"gi");for(var F=[],Z=0;Z<r.items.length;Z++){var X=V(Z),ue=r.items[Z].data.title||"",K=r.items[Z].data.group||"",le=r.items[Z].data.synonym||"";le&&(le=le.join(" ")),(U==null||r.items[Z].selected==!0||X.toString().match(U)||ue.match(U)||K.match(U)||le.match(U))&&F.push(r.items[Z])}if(!F.length)fe.style.display="none",r.results=null;else{fe.style.display="",r.results=F;var je=F.length||0;r.options.lazyLoading==!0&&je>200&&(je=200);for(var Z=0;Z<je;Z++)r.results[Z].group?(r.results[Z].group.parentNode||fe.appendChild(r.results[Z].group),r.results[Z].group.lastChild.appendChild(r.results[Z].element)):fe.appendChild(r.results[Z].element)}}r.options.autofocus==!0&&r.first()},r.open=function(){if(!E.classList.contains("jdropdown-focus")){w.current=r,_(r,!0),E.classList.add("jdropdown-focus"),o.getWindowWidth()<800&&(r.options.type==null||r.options.type=="picker")&&D.slideBottom(ce,1),r.options.autocomplete==!0&&(r.header.value=r.search,r.header.focus());var U=G();if(U[0]){var Z=r.getPosition(U[0]);Z!==!1&&r.setCursor(Z)}if(!r.options.type||r.options.type=="default"){var v=E.getBoundingClientRect(),F=ce.getBoundingClientRect();r.options.position?(ce.style.position="fixed",window.innerHeight<v.bottom+F.height?(ce.style.top="",ce.style.bottom=window.innerHeight-v.top+1+"px"):(ce.style.top=v.bottom+"px",ce.style.bottom=""),ce.style.left=v.left+"px"):window.innerHeight<v.bottom+F.height?(ce.style.top="",ce.style.bottom=v.height+1+"px"):(ce.style.top="",ce.style.bottom=""),ce.style.minWidth=v.width+"px",r.options.maxWidth&&(ce.style.maxWidth=r.options.maxWidth),!r.items.length&&r.options.autocomplete==!0?fe.style.display="none":fe.style.display=""}}typeof r.options.onopen=="function"&&r.options.onopen(E)},r.close=function(U){return E.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),!U&&typeof r.options.onclose=="function"&&r.options.onclose(E),r.header.blur&&r.header.blur(),E.classList.remove("jdropdown-focus"),_(r,!1),w.current=null),r.getValue()},r.setCursor=function(U,Z){if(r.currentIndex!=null&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),U==null)r.currentIndex=null;else if(U=parseInt(U),r.items[U].element.parentNode&&(r.items[U].element.classList.add("jdropdown-cursor"),r.currentIndex=U,Z!==!1&&r.items[r.currentIndex].element)){fe.scrollTop;var v=r.items[r.currentIndex].element;fe.scrollTop=v.offsetTop-v.scrollTop+v.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){r.options.lazyLoading===!0&&r.loadFirst();var U=fe.querySelectorAll(".jdropdown-item");if(U.length){var Z=U[0].indexValue;r.setCursor(Z)}},r.last=function(){r.options.lazyLoading===!0&&r.loadLast();var U=fe.querySelectorAll(".jdropdown-item");if(U.length){var Z=U[U.length-1].indexValue;r.setCursor(Z)}},r.next=function(U){var Z=null;if(U){if(U.length==1){var v=r.currentIndex||-1;U=U.toLowerCase();var F=null,X=null,ue=fe.querySelectorAll(".jdropdown-item");if(ue.length){for(var K=0;K<ue.length;K++)if(ue[K].indexValue>v&&(F=r.items[ue[K].indexValue])&&(X=F.element.innerText[0])&&(X=X.toLowerCase(),U==X)){Z=ue[K].indexValue;break}r.setCursor(Z)}}}else if(r.currentIndex==null||r.currentIndex==null)r.first();else{var le=r.items[r.currentIndex].element,je=le.nextElementSibling;je?(je.classList.contains("jdropdown-group")&&(je=je.lastChild.firstChild),Z=je.indexValue):le.parentNode.classList.contains("jdropdown-group-items")&&((je=le.parentNode.parentNode.nextElementSibling)&&(je.classList.contains("jdropdown-group")?je=je.lastChild.firstChild:je.classList.contains("jdropdown-item")?Z=je.indexValue:je=null),je&&(Z=je.indexValue)),Z!==null&&r.setCursor(Z)}},r.prev=function(){var U=null;if(r.currentIndex===null)r.first();else{var Z=r.items[r.currentIndex].element,v=Z.previousElementSibling;v?(v.classList.contains("jdropdown-group")&&(v=v.lastChild.lastChild),U=v.indexValue):Z.parentNode.classList.contains("jdropdown-group-items")&&((v=Z.parentNode.parentNode.previousElementSibling)&&(v.classList.contains("jdropdown-group")?v=v.lastChild.lastChild:v.classList.contains("jdropdown-item")?U=v.indexValue:v=null),v&&(U=v.indexValue))}U!==null&&r.setCursor(U)},r.loadFirst=function(){if(r.results)var U=r.results;else var U=r.items;var Z=U.length||0;r.options.lazyLoading==!0&&Z>200&&(Z=200),fe.textContent="";for(var v=0;v<Z;v++)U[v].group?(U[v].group.parentNode||fe.appendChild(U[v].group),U[v].group.lastChild.appendChild(U[v].element)):fe.appendChild(U[v].element);fe.scrollTop=0},r.loadLast=function(){if(r.results)var U=r.results;else var U=r.items;var Z=U.length;if(Z>200){Z=Z-200,fe.textContent="";for(var v=Z;v<U.length;v++)U[v].group?(U[v].group.parentNode||fe.appendChild(U[v].group),U[v].group.lastChild.appendChild(U[v].element)):fe.appendChild(U[v].element);fe.scrollTop=fe.scrollHeight}},r.loadUp=function(){var U=!1;if(r.results)var Z=r.results;else var Z=r.items;var v=fe.querySelectorAll(".jdropdown-item"),F=v[0].indexValue;F=r.items[F];var X=Z.indexOf(F)-1;if(X>0){for(var ue=0;X>0&&Z[X]&&ue<200;)Z[X].group?(Z[X].group.parentNode||fe.insertBefore(Z[X].group,fe.firstChild),Z[X].group.lastChild.insertBefore(Z[X].element,Z[X].group.lastChild.firstChild)):fe.insertBefore(Z[X].element,fe.firstChild),X--,ue++;U=!0}return U},r.loadDown=function(){var U=!1;if(r.results)var Z=r.results;else var Z=r.items;var v=fe.querySelectorAll(".jdropdown-item"),F=v[v.length-1].indexValue;F=r.items[F];var X=Z.indexOf(F)+1;if(X<Z.length){for(var ue=0;X<Z.length&&Z[X]&&ue<200;)Z[X].group?(Z[X].group.parentNode||fe.appendChild(Z[X].group),Z[X].group.lastChild.appendChild(Z[X].element)):fe.appendChild(Z[X].element),X++,ue++;U=!0}return U},Ke(),r};return w.keydown=function(E){var l=null;if(l=w.current){if(E.which==13||E.which==9)l.header.value&&l.currentIndex==null&&l.options.newOptions?l.add():(l.currentIndex==null&&l.options.autocomplete==!0&&l.header.value!=""&&l.find(l.header.value),l.selectIndex(l.currentIndex));else if(E.which==38)l.currentIndex==null?l.first():l.currentIndex>0&&l.prev(),E.preventDefault();else if(E.which==40)l.currentIndex==null?l.first():l.currentIndex+1<l.items.length&&l.next(),E.preventDefault();else if(E.which==36)l.first(),E.target.classList.contains("jdropdown-header")||E.preventDefault();else if(E.which==35)l.last(),E.target.classList.contains("jdropdown-header")||E.preventDefault();else if(E.which==27)l.close();else if(E.which==33){if(l.currentIndex==null)l.first();else if(l.currentIndex>0)for(var r=0;r<7;r++)l.prev();E.preventDefault()}else if(E.which==34){if(l.currentIndex==null)l.first();else if(l.currentIndex+1<l.items.length)for(var r=0;r<7;r++)l.next();E.preventDefault()}}},w.mouseup=function(E){var l=o.findElement(E.target,"jdropdown");if(l){var r=l.dropdown;if(E.target.classList.contains("jdropdown-header"))if(l.classList.contains("jdropdown-focus")&&l.classList.contains("jdropdown-default")){var P=l.getBoundingClientRect();if(E.changedTouches&&E.changedTouches[0]){var te=E.changedTouches[0].clientX;E.changedTouches[0].clientY}else{var te=E.clientX;E.clientY}P.width-(te-P.left)<30?E.target.classList.contains("jdropdown-add")?r.add():r.close():r.options.autocomplete==!1&&r.close()}else r.open();else if(E.target.classList.contains("jdropdown-group-name")){var ee=E.target.nextSibling.children;if(E.target.nextSibling.style.display!="none")for(var O=0;O<ee.length;O++)ee[O].style.display!="none"&&r.selectItem(ee[O])}else E.target.classList.contains("jdropdown-group-arrow")?E.target.classList.contains("jdropdown-group-arrow-down")?(E.target.classList.remove("jdropdown-group-arrow-down"),E.target.classList.add("jdropdown-group-arrow-up"),E.target.parentNode.nextSibling.style.display="none"):(E.target.classList.remove("jdropdown-group-arrow-up"),E.target.classList.add("jdropdown-group-arrow-down"),E.target.parentNode.nextSibling.style.display=""):E.target.classList.contains("jdropdown-item")?r.selectItem(E.target):E.target.classList.contains("jdropdown-image")||E.target.classList.contains("jdropdown-description")?r.selectItem(E.target.parentNode):E.target.classList.contains("jdropdown-title")?r.selectItem(E.target.parentNode.parentNode):(E.target.classList.contains("jdropdown-close")||E.target.classList.contains("jdropdown-backdrop"))&&r.close()}},w.extractFromDom=function(E,l){var r=E;if(l||(l={}),E.getAttribute("multiple")&&(!l||l.multiple==null)&&(l.multiple=!0),E.getAttribute("placeholder")&&(!l||l.placeholder==null)&&(l.placeholder=E.getAttribute("placeholder")),E.getAttribute("data-autocomplete")&&(!l||l.autocomplete==null)&&(l.autocomplete=!0),(!l||l.width==null)&&(l.width=E.offsetWidth),E.value&&(!l||l.value==null)&&(l.value=E.value),!l||l.data==null){l.data=[];for(var P=0;P<E.children.length;P++)if(E.children[P].tagName=="OPTGROUP")for(var te=0;te<E.children[P].children.length;te++)l.data.push({value:E.children[P].children[te].value,text:E.children[P].children[te].textContent,group:E.children[P].getAttribute("label")});else l.data.push({value:E.children[P].value,text:E.children[P].textContent})}(!l||l.onchange==null)&&(l.onchange=function(O,N,V,G){l.multiple==!0?obj.items[N].classList.contains("jdropdown-selected")?r.options[N].setAttribute("selected","selected"):r.options[N].removeAttribute("selected"):r.value=G});var ee=document.createElement("div");return E.parentNode.insertBefore(ee,E),E.style.display="none",E=ee,{el:E,options:l}},w}var Ue=Ye();function Re(w,E){if(w.picker)return w.picker.setOptions(E,!0);var l={type:"picker"};l.options={};var r=null,P=null,te=function(N){return N instanceof Element||N instanceof HTMLDocument},ee=function(){P.innerHTML="";for(var N=Object.keys(l.options.data),V=0;V<N.length;V++){var G=document.createElement("div");G.classList.add("jpicker-item"),G.setAttribute("role","option"),G.k=N[V],G.v=l.options.data[N[V]];var ne=l.getLabel(N[V],G);te(ne)?G.appendChild(ne):G.innerHTML=ne,P.appendChild(G)}};l.setOptions=function(N,V){var G={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};N&&N.options&&(N.data=N.options);for(var ne in G)N&&N.hasOwnProperty(ne)?l.options[ne]=N[ne]:(typeof l.options[ne]>"u"||V===!0)&&(l.options[ne]=G[ne]);return l.options.header===!1?r.style.display="none":r.style.display="",l.options.width?r.style.width=parseInt(l.options.width)+"px":r.style.width="",l.options.height?(P.style.maxHeight=l.options.height+"px",P.style.overflow="scroll"):P.style.overflow="",l.options.columns>0&&(l.options.grid?(P.classList.add("jpicker-grid"),P.style.gridTemplateColumns="repeat("+l.options.grid+", 1fr)"):(P.classList.add("jpicker-columns"),P.style.width=l.options.width?l.options.width:36*l.options.columns+"px")),isNaN(parseInt(l.options.value))&&(l.options.value=0),ee(),l.setValue(l.options.value),l},l.getValue=function(){return l.options.value},l.setValue=function(N,V){if(l.setLabel(N),l.options.value=String(N),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),P.children[N]&&P.children[N].getAttribute("type")!=="generic"&&l.close(),V&&typeof l.options.onchange=="function"){var G=l.options.data[N];l.options.onchange(w,l,G,G,N,V)}},l.getLabel=function(N,V){var G=l.options.data[N]||null;return typeof l.options.render=="function"&&(G=l.options.render(G,V)),G},l.setLabel=function(N){var V;l.options.content?V='<i class="material-icons">'+l.options.content+"</i>":V=l.getLabel(N,null),te(V)?(r.innerHTML="",r.appendChild(V)):r.innerHTML=V},l.open=function(){if(!w.classList.contains("jpicker-focus")){_(l,!0),w.classList.add("jpicker-focus"),w.focus();var N=0,V=0;P.style.marginLeft="";var G=r.getBoundingClientRect(),ne=P.getBoundingClientRect();window.innerHeight<G.bottom+ne.height||l.options.bottom?N=-1*(ne.height+4):N=G.height+4,l.options.right===!0&&(V=-1*ne.width+G.width),ne.left+V<0&&(V=V+ne.left+10),ne.left+ne.width>window.innerWidth&&(V=-1*(10+ne.left+ne.width-window.innerWidth)),P.style.marginTop=parseInt(N)+"px",P.style.marginLeft=parseInt(V)+"px",typeof l.options.onopen=="function"&&l.options.onopen(w,l)}},l.close=function(){w.classList.contains("jpicker-focus")&&(w.classList.remove("jpicker-focus"),_(l,!1),typeof l.options.onclose=="function"&&l.options.onclose(w,l))};var O=function(){let N=o.guid();w.classList.add("jpicker"),w.setAttribute("role","combobox"),w.setAttribute("aria-haspopup","listbox"),w.setAttribute("aria-expanded","false"),w.setAttribute("aria-controls",N),w.setAttribute("tabindex","0"),w.onmousedown=function(V){w.classList.contains("jpicker-focus")||l.open()},r=document.createElement("div"),r.classList.add("jpicker-header"),P=document.createElement("div"),P.setAttribute("id",N),P.setAttribute("role","listbox"),P.classList.add("jpicker-content"),P.onclick=function(V){var G=o.findElement(V.target,"jpicker-item");G&&G.parentNode===P&&l.setValue(G.k,V)},w.appendChild(r),w.appendChild(P),w.value=E.value||0,l.setOptions(E),typeof l.options.onload=="function"&&l.options.onload(w,l),w.change=l.setValue,w.val=function(V){if(V===void 0)return l.getValue();l.setValue(V)},w.picker=l};return O(),l}function Je(w,E){var l={type:"toolbar"};l.options={};var r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var P in r)E&&E.hasOwnProperty(P)?l.options[P]=E[P]:l.options[P]=r[P];!w&&E.app&&E.app.el&&(w=document.createElement("div"),E.app.el.appendChild(w));var te=document.createElement("div");te.classList.add("jtoolbar-item"),te.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),te.appendChild(ee),l.selectItem=function(N){for(var V=O.children,G=0;G<V.length;G++)N!=V[G]&&V[G].classList.remove("jtoolbar-selected");N.classList.add("jtoolbar-selected")},l.hide=function(){D.slideBottom(w,0,function(){w.style.display="none"})},l.show=function(){w.style.display="",D.slideBottom(w,1)},l.get=function(){return w},l.setBadge=function(N,V){O.children[N].children[1].firstChild.innerHTML=V},l.destroy=function(){toolbar.remove(),w.innerHTML=""},l.update=function(N,V){for(var G=0;G<O.children.length;G++){var ne=O.children[G];typeof ne.updateState=="function"&&ne.updateState(w,l,ne,N,V)}for(var G=0;G<ee.children.length;G++){var ne=ee.children[G];typeof ne.updateState=="function"&&ne.updateState(w,l,ne,N,V)}},l.create=function(N){O.innerHTML="";for(var V=0;V<N.length;V++){var G=document.createElement("div");if(G.classList.add("jtoolbar-item"),N[V].width&&(G.style.width=parseInt(N[V].width)+"px"),N[V].k&&(G.k=N[V].k),N[V].tooltip&&(G.setAttribute("title",N[V].tooltip),G.setAttribute("aria-label",N[V].tooltip)),N[V].id&&G.setAttribute("id",N[V].id),N[V].updateState&&(G.updateState=N[V].updateState),N[V].active&&G.classList.add("jtoolbar-active"),N[V].disabled&&G.classList.add("jtoolbar-disabled"),N[V].type=="select"||N[V].type=="dropdown")Re(G,N[V]);else if(N[V].type=="divisor")G.classList.add("jtoolbar-divisor");else if(N[V].type=="label")G.classList.add("jtoolbar-label"),G.innerHTML=N[V].content;else{var ne=document.createElement("i");if(typeof N[V].class>"u")ne.classList.add("material-icons");else for(var ge=N[V].class.split(" "),ce=0;ce<ge.length;ce++)ne.classList.add(ge[ce]);if(ne.innerHTML=N[V].content?N[V].content:"",G.setAttribute("role","button"),G.appendChild(ne),l.options.badge==!0){var fe=document.createElement("div");fe.classList.add("jbadge");var Ee=document.createElement("div");Ee.innerHTML=N[V].badge?N[V].badge:"",fe.appendChild(Ee),G.appendChild(fe)}if(N[V].title)if(l.options.title==!0){var De=document.createElement("span");De.innerHTML=N[V].title,G.appendChild(De)}else G.setAttribute("title",N[V].title);l.options.app&&N[V].route&&(G.route=N[V].route,G.onclick=function(){l.options.app.pages(this.route)},l.options.app.pages(N[V].route,{toolbarItem:G,closed:!0})),typeof N[V].render=="function"&&N[V].render(G,N[V])}N[V].onclick&&(G.onclick=N[V].onclick.bind(N[V],w,l,G)),O.appendChild(G)}setTimeout(function(){l.refresh()},0)},l.open=function(){te.classList.add("jtoolbar-arrow-selected"),w.getBoundingClientRect();var N=ee.getBoundingClientRect();N.bottom>window.innerHeight||l.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",te.children[0].focus(),_(l,!0)},l.close=function(){te.classList.remove("jtoolbar-arrow-selected"),_(l,!1)},l.refresh=function(){if(l.options.responsive==!0){var N=w.parentNode.getBoundingClientRect();l.options.maxWidth||(l.options.maxWidth=N.width);var V=parseInt(l.options.maxWidth);for(te.parentNode&&te.parentNode.removeChild(te);ee.firstChild;)O.appendChild(ee.firstChild);if(V<O.offsetWidth)for(V-=50;O.lastChild&&V<O.offsetWidth;)ee.insertBefore(O.lastChild,ee.firstChild);ee.children.length>0&&O.appendChild(te)}},l.setReadonly=function(N){N=N?"add":"remove",w.classList[N]("jtoolbar-disabled")},w.onclick=function(N){var V=o.findElement(N.target,"jtoolbar-item");V&&l.selectItem(V),N.target.classList.contains("jtoolbar-arrow")&&l.open()},window.addEventListener("resize",function(){l.refresh()}),w.classList.add("jtoolbar"),w.innerHTML="",l.options.container==!0&&w.classList.add("jtoolbar-container");var O=document.createElement("div");return w.appendChild(O),l.options.app&&w.classList.add("jtoolbar-mobile"),l.create(l.options.items),w.toolbar=l,l}function Y(){var w=function(E,l){var r={type:"editor"};r.options={};var P={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var te in P)l&&l.hasOwnProperty(te)?r.options[te]=l[te]:r.options[te]=P[te];var ee=null,O=null,N=[];r.el=E,typeof r.options.onclick=="function"&&(E.onclick=function(re){r.options.onclick(E,r,re)}),E.classList.add("jeditor-container");var V=document.createElement("div");V.className="jsnippet",V.setAttribute("contenteditable",!1);var G=document.createElement("div");if(G.className="jeditor-toolbar",r.editor=document.createElement("div"),r.editor.setAttribute("contenteditable",!0),r.editor.setAttribute("spellcheck",!1),r.editor.classList.add("jeditor"),r.options.placeholder&&r.editor.setAttribute("data-placeholder",r.options.placeholder),(r.options.maxHeight||r.options.height)&&(r.editor.style.overflowY="auto",r.options.maxHeight&&(r.editor.style.maxHeight=r.options.maxHeight),r.options.height&&(r.editor.style.height=r.options.height)),r.options.url)I({url:r.options.url,dataType:"html",success:function(re){r.editor.innerHTML=re,w.setCursor(r.editor,r.options.focus=="initial")}});else if(r.options.value)r.editor.innerHTML=r.options.value;else for(var ne=0;ne<E.children.length;ne++)r.editor.appendChild(E.children[ne]);E.innerHTML="";var ge=function(re){typeof r.options.onchange=="function"&&r.options.onchange(E,r,re),r.options.value=r.getData(),E.value!=r.options.value&&(E.value=r.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},ce=function(re){var ye=document.createElement("div");ye.innerHTML=re;var xe=ye.querySelectorAll("img");if(xe.length)for(var Oe=0;Oe<xe.length;Oe++)r.addImage(xe[Oe].src)},fe=function(){var re=null;if(re=V.children[0]){re.classList.contains("jslider-grid")||re.classList.add("jslider-grid");var ye=re.children.length;re.setAttribute("data-number",ye>4?4:ye),ye>4?re.setAttribute("data-total",ye-4):re.removeAttribute("data-total")}},Ee=function(re){V.innerHTML||r.appendSnippet({}),V.children[0].appendChild(re),fe()};r.appendSnippet=function(re){V.innerHTML="";for(var ye=["image","title","description","host","url"],xe=0;xe<ye.length;xe++){var Oe=document.createElement("div");if(Oe.className="jsnippet-"+ye[xe],Oe.setAttribute("data-k",ye[xe]),V.appendChild(Oe),re[ye[xe]])if(ye[xe]=="image"){Array.isArray(re.image)||(re.image=[re.image]);for(var $e=0;$e<re.image.length;$e++){var Ze=document.createElement("img");Ze.src=re.image[$e],Oe.appendChild(Ze)}}else Oe.innerHTML=re[ye[xe]]}r.editor.appendChild(document.createElement("br")),r.editor.appendChild(V)},r.setData=function(re){typeof re=="object"?r.editor.innerHTML=re.content:r.editor.innerHTML=re,r.options.focus&&w.setCursor(r.editor,!0),N=[]},r.getFiles=function(){for(var re=r.editor.querySelectorAll(".jfile"),ye=[],xe=0;xe<re.length;xe++)N[re[xe].src]&&ye.push(N[re[xe].src]);return ye},r.getText=function(){return r.editor.innerText},r.getData=function(re){if(re){var ye={content:""};if(V.innerHTML){ye.snippet={};for(var xe=0;xe<V.children.length;xe++){var Oe=V.children[xe].getAttribute("data-k");if(Oe)if(Oe=="image"){ye.snippet.image||(ye.snippet.image=[]);for(var $e=0;$e<V.children[xe].children.length;$e++)ye.snippet.image.push(V.children[xe].children[$e].getAttribute("src"))}else ye.snippet[Oe]=V.children[xe].innerHTML}}var Ze=Object.keys(N);if(Ze.length){ye.files=[];for(var xe=0;xe<Ze.length;xe++)ye.files.push(N[Ze[xe]])}var it=document.createElement("div");it.innerHTML=r.editor.innerHTML;var ft=it.querySelector(".jsnippet");ft&&ft.remove();var rt=it.innerHTML;rt=rt.replace(/<br>/g,`
`),rt=rt.replace(/<\/div>/g,`</div>
`),rt=rt.replace(/<(?:.|\n)*?>/gm,""),ye.content=rt.trim(),Ie("getData",ye)}else var ye=r.editor.innerHTML;return ye},r.reset=function(){r.editor.innerHTML="",V.innerHTML="",N=[]},r.addPdf=function(re){if(re.result.substr(0,4)!="data")console.error("Invalid source");else{var ye=document.createElement("canvas");ye.width=60,ye.height=60;var xe=new Image,Oe=ye.getContext("2d");Oe.drawImage(xe,0,0,ye.width,ye.height),ye.toBlob(function($e){var Ze=document.createElement("img");Ze.src=window.URL.createObjectURL($e),Ze.title=re.name,Ze.className="jfile pdf",N[Ze.src]={file:Ze.src,extension:"pdf",content:re.result},document.execCommand("insertHtml",!1,Ze.outerHTML)})}},r.addImage=function(re,ye){if(r.options.acceptImages)if(re||(re=""),re.substr(0,4)!="data"&&!r.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(re.substr(0,4)=="data"){var xe=re.split(";");xe=xe[0].split("/"),xe=xe[1]}else{var xe=re.substr(re.lastIndexOf(".")+1);re=r.options.remoteParser+re}var Oe=new Image;Oe.onload=function(){var Ze=document.createElement("canvas");Ze.width=Oe.width,Ze.height=Oe.height;var it=Ze.getContext("2d");it.drawImage(Oe,0,0,Ze.width,Ze.height),Ze.toBlob(function(ft){var rt=document.createElement("img");rt.src=window.URL.createObjectURL(ft),rt.classList.add("jfile"),rt.setAttribute("tabindex","900"),rt.setAttribute("width",Oe.width),rt.setAttribute("height",Oe.height),N[rt.src]={file:rt.src,extension:xe,content:Ze.toDataURL()},r.options.dropAsSnippet||ye?(Ee(rt),N[rt.src].snippet=!0):document.execCommand("insertHtml",!1,rt.outerHTML),ge()})},Oe.src=re}},r.addFile=function(re){for(var ye=[],xe=0;xe<re.length;xe++)if(re[xe].size>r.options.maxFileSize)alert("The file is too big");else{var Oe=re[xe].type.split("/");Oe[0]=="image"?Oe=1:Oe[1]=="pdf"?Oe=2:Oe=0,Oe?(ye[xe]=new FileReader,ye[xe].index=xe,ye[xe].type=Oe,ye[xe].name=re[xe].name,ye[xe].date=re[xe].lastModified,ye[xe].size=re[xe].size,ye[xe].addEventListener("load",function($e){$e.target.type==2?r.options.acceptFiles==!0&&r.addPdf($e.target):r.addImage($e.target.result)},!1),ye[xe].readAsDataURL(re[xe])):alert("The extension is not allowed")}},r.destroy=function(){r.editor.removeEventListener("mouseup",je),r.editor.removeEventListener("mousedown",Ne),r.editor.removeEventListener("mousemove",ve),r.editor.removeEventListener("keyup",K),r.editor.removeEventListener("keydown",le),r.editor.removeEventListener("dragstart",U),r.editor.removeEventListener("dragenter",Z),r.editor.removeEventListener("dragover",v),r.editor.removeEventListener("drop",F),r.editor.removeEventListener("paste",we),r.editor.removeEventListener("blur",X),r.editor.removeEventListener("focus",ue),E.editor=null,E.classList.remove("jeditor-container"),G.remove(),V.remove(),r.editor.remove()},r.upload=function(){o.click(r.file)};const De=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Se=["width","height","align","border","src","tabindex"],ze=["color","font-weight","font-size","background","background-color","margin"],Ke=function(re){if(re.tagName&&De.indexOf(re.tagName.toLowerCase())===-1&&re.innerText&&(re.innerHTML=re.innerText),re.attributes&&re.attributes.length){let ye=null,xe=re.getAttribute("style");if(xe){ye=[];let $e=xe.split(";");for(let Ze=0;Ze<$e.length;Ze++){let it=$e[Ze].trim().split(":");if(ze.indexOf(it[0].trim())>=0){let ft=it.shift();it=it.join(":"),ye.push(ft+":"+it)}}}re.tagName.toUpperCase()==="IMG"&&(!r.options.acceptImages||!re.src?re.parentNode.removeChild(re):(re.setAttribute("tabindex","900"),r.addImage(re.src)));let Oe=[];for(let $e=0;$e<re.attributes.length;$e++)Oe.push(re.attributes[$e].name);Oe.length&&Oe.forEach(function($e){Se.indexOf($e)===-1?re.removeAttribute($e):re.attributes&&re.attributes[ne]&&re.attributes[ne].value.indexOf("<")!==-1&&re.attributes[ne].value.replace("<","&#60;")}),re.style="",ye&&ye.length&&re.setAttribute("style",ye.join(";"))}if(re.children.length)for(let ye=re.children.length;ye>0;ye--)Ke(re.children[ye-1])};var Q=function(re){var ye=window.getSelection(),xe=document.createRange();xe.selectNode(re),ye.addRange(xe)},he=function(re){re&&(re=re.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ye=new DOMParser,xe=ye.parseFromString(re,"text/html");Ke(xe);var Oe=document.createElement("div");return Oe.innerHTML=xe.firstChild.innerHTML,Oe},we=function(re){if(r.options.filterPaste==!0){if(re.clipboardData||re.originalEvent.clipboardData)var ye=(re.originalEvent||re).clipboardData.getData("text/html"),xe=(re.originalEvent||re).clipboardData.getData("text/plain"),Oe=(re.originalEvent||re).clipboardData.files;else if(window.clipboardData)var ye=window.clipboardData.getData("Html"),xe=window.clipboardData.getData("Text"),Oe=window.clipboardData.files;if(Oe.length)r.addFile(Oe);else if(!ye)ye=xe.split(`\r
`),re.target.innerText?(ye=ye.map(function(Ze){return"<div>"+Ze+"</div>"}),document.execCommand("insertText",!1,ye.join(""))):ye.map(function(Ze){var it=document.createElement("div");it.innerText=Ze,r.editor.appendChild(it)});else{var $e=he(ye);document.execCommand("insertHtml",!1,$e.innerHTML)}re.preventDefault()}},U=function(re){O&&O.e&&re.preventDefault()},Z=function(re){O||r.options.dropZone==!1||(E.classList.add("jeditor-dragging"),re.preventDefault())},v=function(re){O||r.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){E.classList.remove("jeditor-dragging")},100),re.preventDefault())},F=function(re){if(!(O||r.options.dropZone==!1)){var ye=null;document.caretRangeFromPoint?ye=document.caretRangeFromPoint(re.clientX,re.clientY):re.rangeParent&&(ye=document.createRange(),ye.setStart(re.rangeParent,re.rangeOffset));var xe=window.getSelection();xe.removeAllRanges(),xe.addRange(ye),xe.anchorNode.parentNode.focus();var Oe=(re.originalEvent||re).dataTransfer.getData("text/html"),$e=(re.originalEvent||re).dataTransfer.getData("text/plain"),Ze=(re.originalEvent||re).dataTransfer.files;Ze.length?r.addFile(Ze):$e&&ce(Oe),E.classList.remove("jeditor-dragging"),re.preventDefault()}},X=function(re){Ie("onevent",re),ge(re),typeof r.options.onblur=="function"&&r.options.onblur(E,r,re)},ue=function(re){typeof r.options.onfocus=="function"&&r.options.onfocus(E,r,re)},K=function(re){r.editor.innerHTML||(r.editor.innerHTML="<div><br></div>"),typeof r.options.onkeyup=="function"&&r.options.onkeyup(E,r,re)},le=function(re){if(Ie("onevent",re),re.key=="Delete"&&re.target.tagName=="IMG"){var ye=re.target.parentNode;Q(re.target),ye.classList.contains("jsnippet-image")&&fe()}typeof r.options.onkeydown=="function"&&r.options.onkeydown(E,r,re)},je=function(re){if(O&&O.e&&(O.e.classList.remove("resizing"),O.e.changed==!0)){var ye=O.e.cloneNode();ye.width=parseInt(O.e.style.width)||O.e.getAttribute("width"),ye.height=parseInt(O.e.style.height)||O.e.getAttribute("height"),O.e.style.width="",O.e.style.height="",Q(O.e),document.execCommand("insertHtml",!1,ye.outerHTML)}O=!1},Ne=function(re){var ye=function(Ze){var it=Ze.getBoundingClientRect();it.width-(re.clientX-it.left)<40&&re.clientY-it.top<40&&(Ze.innerHTML="",Ze.remove())};if(re.target.tagName=="IMG")if(re.target.style.cursor){var xe=re.target.getBoundingClientRect();O={e:re.target,x:re.clientX,y:re.clientY,w:xe.width,h:xe.height,d:re.target.style.cursor},re.target.getAttribute("width")||re.target.setAttribute("width",xe.width),re.target.getAttribute("height")||re.target.setAttribute("height",xe.height);var Oe=window.getSelection();if(Oe.rangeCount)for(var $e=0;$e<Oe.rangeCount;$e++)Oe.removeRange(Oe.getRangeAt($e));re.target.classList.add("resizing")}else O=!0;else re.target.classList.contains("jsnippet")?ye(re.target):re.target.parentNode.classList.contains("jsnippet")&&ye(re.target.parentNode),O=!0},ve=function(re){if(re.target.tagName=="IMG"&&!re.target.parentNode.classList.contains("jsnippet-image")&&r.options.allowImageResize==!0&&re.target.getAttribute("tabindex")){var ye=re.target.getBoundingClientRect();re.clientY-ye.top<5?ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="ne-resize":re.clientX-ye.left<5?re.target.style.cursor="nw-resize":re.target.style.cursor="n-resize":ye.height-(re.clientY-ye.top)<5?ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="se-resize":re.clientX-ye.left<5?re.target.style.cursor="sw-resize":re.target.style.cursor="s-resize":ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="e-resize":re.clientX-ye.left<5?re.target.style.cursor="w-resize":re.target.style.cursor=""}if(re.which==1&&O&&O.d){if(O.d=="e-resize"||O.d=="ne-resize"||O.d=="se-resize")if(O.e.style.width=O.w+(re.clientX-O.x),re.shiftKey){var xe=(re.clientX-O.x)*(O.h/O.w);O.e.style.height=O.h+xe}else var xe=null;xe||(O.d=="s-resize"||O.d=="se-resize"||O.d=="sw-resize")&&(re.shiftKey||(O.e.style.height=O.h+(re.clientY-O.y))),O.e.changed=!0}},Ie=function(re,ye){if(r.options.extensions){var xe=Object.keys(r.options.extensions);if(xe.length)for(var Oe=0;Oe<xe.length;Oe++)r.options.extensions[xe[Oe]]&&typeof r.options.extensions[xe[Oe]][re]=="function"&&r.options.extensions[xe[Oe]][re].call(r,ye)}},Fe=function(){if(r.options.extensions){var re=Object.keys(r.options.extensions);if(re.length)for(var ye=0;ye<re.length;ye++)r.options.extensions[re[ye]]&&typeof r.options.extensions[re[ye]]=="function"&&(r.options.extensions[re[ye]]=r.options.extensions[re[ye]](E,r))}};if(document.addEventListener("mouseup",je),document.addEventListener("mousemove",ve),r.editor.addEventListener("mousedown",Ne),r.editor.addEventListener("keyup",K),r.editor.addEventListener("keydown",le),r.editor.addEventListener("dragstart",U),r.editor.addEventListener("dragenter",Z),r.editor.addEventListener("dragover",v),r.editor.addEventListener("drop",F),r.editor.addEventListener("paste",we),r.editor.addEventListener("focus",ue),r.editor.addEventListener("blur",X),E.appendChild(r.editor),r.options.snippet&&r.appendSnippet(r.options.snippet),r.options.toolbar){if(Array.isArray(r.options.toolbar))var nt={container:!0,responsive:!0,items:r.options.toolbar};else if(r.options.toolbar===!0)var nt={container:!0,responsive:!0,items:[]};else var nt=r.options.toolbar;nt.items&&nt.items.length||(nt.items=w.getDefaultToolbar(r)),r.options.toolbarOnTop?(E.classList.add("toolbar-on-top"),E.insertBefore(G,E.firstChild)):(r.editor.style.padding="15px",E.appendChild(G)),Je(G,nt),G.addEventListener("click",function(){r.editor.focus()})}return r.file=document.createElement("input"),r.file.style.display="none",r.file.type="file",r.file.setAttribute("accept","image/*"),r.file.onchange=function(){r.addFile(this.files)},E.appendChild(r.file),r.options.focus&&w.setCursor(r.editor,r.options.focus=="initial"),E.change=r.setData,E.val=function(re){if(re===void 0){var ye=E.getAttribute("data-html")!=="true";return r.getData(ye)}else r.setData(re)},Fe(),E.editor=r,typeof r.options.onload=="function"&&r.options.onload(E,r,r.editor),r};return w.setCursor=function(E,l){E.focus(),document.execCommand("selectAll");var r=window.getSelection(),P=r.getRangeAt(0);if(l==!0)var te=P.startContainer,ee=0;else var te=P.endContainer,ee=te.length;P.setStart(te,ee),P.setEnd(te,ee),r.removeAllRanges(),r.addRange(P)},w.getDefaultToolbar=function(E){var l=function(P,te,ee){ee.color||(me(ee,{onchange:function(O,N){ee.k==="color"?document.execCommand("foreColor",!1,N):document.execCommand("backColor",!1,N)}}),ee.color.open())},r=[];return r.push({content:"undo",onclick:function(){document.execCommand("undo")}}),r.push({content:"redo",onclick:function(){document.execCommand("redo")}}),r.push({type:"divisor"}),E.options.toolbarOnTop&&(r.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(P){return'<span style="font-family:'+P+'">'+P+"</span>"},onchange:function(P,te,ee,O,N){document.execCommand("fontName",!1,O)}}),r.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(P){return'<span style="font-size:'+P+'">'+P+"</span>"},onchange:function(P,te,ee,O,N){document.execCommand("fontSize",!1,parseInt(N)+1)}}),r.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(P){return'<i class="material-icons">'+P+"</i>"},onchange:function(P,te,ee,O,N){var V=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(V[N])}}),r.push({type:"divisor"}),r.push({content:"format_color_text",k:"color",onclick:l}),r.push({content:"format_color_fill",k:"background-color",onclick:l})),r.push({content:"format_bold",onclick:function(P,te,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_italic",onclick:function(P,te,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_underline",onclick:function(P,te,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({type:"divisor"}),r.push({content:"format_list_bulleted",onclick:function(P,te,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_list_numbered",onclick:function(P,te,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_increase",onclick:function(P,te,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),E.options.toolbarOnTop&&(r.push({type:"divisor"}),r.push({content:"photo",onclick:function(){E.upload()}}),r.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(P,te){te&&(te.onmouseover=this.onmouseover,P=P.split("x"),te.setAttribute("data-x",P[0]),te.setAttribute("data-y",P[1]));var ee=document.createElement("div");return te.style.margin="1px",te.style.border="1px solid #ddd",ee},onmouseover:function(P){for(var te=parseInt(P.target.getAttribute("data-x")),ee=parseInt(P.target.getAttribute("data-y")),O=0;O<P.target.parentNode.children.length;O++){var N=P.target.parentNode.children[O],V=parseInt(N.getAttribute("data-x")),G=parseInt(N.getAttribute("data-y"));V<=te&&G<=ee?(N.style.backgroundColor="#cae1fc",N.style.borderColor="#2977ff"):(N.style.backgroundColor="",N.style.borderColor="#ddd")}},onchange:function(P,te,ee){ee=ee.split("x");for(var O=document.createElement("table"),N=document.createElement("tbody"),V=0;V<=ee[1];V++){for(var G=document.createElement("tr"),ne=0;ne<=ee[0];ne++){var ge=document.createElement("td");ge.innerHTML="",G.appendChild(ge)}N.appendChild(G)}O.appendChild(N),O.setAttribute("width","100%"),O.setAttribute("cellpadding","6"),O.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,O.outerHTML)}})),r},w}var Le=Y();function _e(){var w=function(E,l){var r={};r.options={};var P={type:"big",title:"Untitled",width:510,height:472};for(var te in P)l&&l.hasOwnProperty(te)?r.options[te]=l[te]:r.options[te]=P[te];var ee=function(){for(var V=document.createElement("div");E.children[0];)V.appendChild(E.children[0]);for(r.content=document.createElement("div"),r.content.className="jfloating_content",r.content.innerHTML=E.innerHTML;V.children[0];)r.content.appendChild(V.children[0]);r.container=document.createElement("div"),r.container.className="jfloating",r.container.appendChild(r.content),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),r.options.width&&(r.container.style.width=parseInt(r.options.width)+"px"),r.options.height&&(r.container.style.height=parseInt(r.options.height)+"px"),E.innerHTML="",E.appendChild(r.container)},O=function(){r.container&&r.container.addEventListener("click",function(V){var G=V.target.getBoundingClientRect();if(V.target.classList.contains("jfloating")){if(V.changedTouches&&V.changedTouches[0])var ne=V.changedTouches[0].clientX,ge=V.changedTouches[0].clientY;else var ne=V.clientX,ge=V.clientY;G.width-(ne-G.left)<50&&ge-G.top<50?setTimeout(function(){r.close()},100):r.setState()}})},N=function(){r.container.classList.add("jfloating-"+r.options.type)};return r.state={isMinized:!1},r.setState=function(){r.state.isMinized?r.container.classList.remove("jfloating-minimized"):r.container.classList.add("jfloating-minimized"),r.state.isMinized=!r.state.isMinized},r.close=function(){Components.elements.splice(w.elements.indexOf(r.container),1),r.updatePosition(),E.remove()},r.updatePosition=function(){for(var V=0;V<w.elements.length;V++){var G=w.elements[V],ne=w.elements[V-1];G.style.right=V*(ne?ne.offsetWidth:G.offsetWidth)*1.01+"px"}},r.init=function(){ee(),O(),N(),w.elements.push(r.container),r.updatePosition(),E.floating=r},r.init(),r};return w.elements=[],w}var pt=_e();function Qe(){const w=function(O){return!isNaN(O)&&O!==null&&(typeof O!="string"||O.trim()!=="")},E={between:function(O,N){return O>=N[0]&&O<=N[1]},"not between":function(O,N){return O<N[0]||O>N[1]},"<":function(O,N){return O<N[0]},"<=":function(O,N){return O<=N[0]},">":function(O,N){return O>N[0]},">=":function(O,N){return O>=N[0]},"=":function(O,N){return O==N[0]},"!=":function(O,N){return O!=N[0]}},l={"valid date":function(){return!0},"=":function(O,N){return O===N[0]},"!=":function(O,N){return O!==N[0]},"<":function(O,N){return O<N[0]},"<=":function(O,N){return O<=N[0]},">":function(O,N){return O>N[0]},">=":function(O,N){return O>=N[0]},between:function(O,N){return O>=N[0]&&O<=N[1]},"not between":function(O,N){return O<N[0]||O>N[1]}},r={contains:function(O,N){return O.includes(N[0])},"not contains":function(O,N){return!O.includes(N[0])},"begins with":function(O,N){return O.startsWith(N[0])},"ends with":function(O,N){return O.endsWith(N[0])},"=":function(O,N){return O===N[0]},"!=":function(O,N){return O!==N[0]},"valid email":function(O){var N=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return N.test(O)},"valid url":function(O){var N=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return N.test(O)}},P=function(O,N){return typeof P[N.type]=="function"?N.allowBlank&&(typeof O>"u"||O===""||O===null)?!0:P[N.type].call(this,O,N):null};P.url=function(O){var N=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!N.test(O)},P.email=function(O){var N=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(O&&N.test(O))},P.required=function(O){return!!(O&&O.trim())},P.empty=function(O){return typeof O>"u"||O===null||typeof O=="string"&&!O.toString().trim()},P["not exist"]=P.empty,P.notEmpty=function(O){return!P.empty(O)},P.exist=P.notEmpty,P.number=function(O,N){if(!w(O))return!1;if(!N||!N.criteria)return!0;if(!E[N.criteria])return!1;let V=N.value.map(function(G){return parseFloat(G)});return E[N.criteria](O,V)},P.login=function(O){let N=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(O&&N.test(O))},P.list=function(O,N){let V=typeof O;if(V!=="string"&&V!=="number")return!1;let G;return typeof N.value[0]=="string"?N.source?G=N.source:G=N.value[0].split(","):G=N.value[0],Array.isArray(G)?G.findIndex(function(ge){return ge==O})>-1:!1};const te=function(){let O=new Date;return O.setHours(0,0,0,0),O},ee={"one year ago":function(){let O=te();return O.setFullYear(O.getFullYear()-1),O},"one month ago":function(){let O=te();return O.setMonth(O.getMonth()-1),O},"one week ago":function(){let O=te();return O.setDate(O.getDate()-7),O},yesterday:function(){let O=te();return O.setDate(O.getDate()-1),O},today:te,tomorrow:function(){let O=te();return O.setDate(O.getDate()+1),O}};return P.date=function(O,N){if(w(O)&&O>0&&O<1e6&&(O=S.numToDate(O)),new Date(O)=="Invalid Date")return!1;if(!N||!N.criteria)return!0;if(!l[N.criteria])return!1;let V=N.value.map(function(G){return typeof G=="string"&&ee[G]?ee[G]().getTime():new Date(G).getTime()});return l[N.criteria](new Date(O).getTime(),V)},P.text=function(O,N){if(typeof O>"u"||O===null)O="";else if(typeof O!="string")return!1;return!N||!N.criteria?!0:r[N.criteria]?r[N.criteria](O,N.value):!1},P.textLength=function(O,N){let V;return typeof O=="string"?V=O.length:typeof O<"u"&&O!==null&&typeof O.toString=="function"?V=O.toString().length:V=0,P.number(V,N)},P.time=function(O,N){if(!w(O))return!1;if(!N||!N.criteria)return!0;if(!E[N.criteria])return!1;let V=N.value.map(function(G){return parseInt(parseFloat(G)*10**17)/10**17});return E[N.criteria](parseInt(parseFloat(O)*10**17)/10**17,V)},P}var Ae=Qe();function Te(){var w=function(E,l){var r={};r.options={};var P={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(N,V){alert(V)}};for(var te in P)l&&l.hasOwnProperty(te)?r.options[te]=l[te]:r.options[te]=P[te];r.options.validations||(r.options.validations={}),r.options.submitButton||(r.options.submitButton=E.querySelector("input[type=submit]")),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=Ae.email),r.options.validations.length||(r.options.validations.length=Ae.length),r.options.validations.required||(r.options.validations.required=Ae.required),r.setUrl=function(N){r.options.url=N},r.load=function(){I({url:r.options.url,method:"GET",dataType:"json",queue:!0,success:function(N){if(typeof r.options.onbeforeload=="function"){var V=r.options.onbeforeload(E,N);V&&(N=V)}w.setElements(E,N),typeof r.options.onload=="function"&&r.options.onload(E,N)}})},r.save=function(){var N=r.validate();if(N)r.options.onerror(E,N);else{var V=w.getElements(E,!0);if(typeof r.options.onbeforesave=="function"){var V=r.options.onbeforesave(E,V);if(V===!1)return}I({url:r.options.url,method:"POST",dataType:"json",data:V,success:function(G){typeof r.options.onsave=="function"&&r.options.onsave(E,V,G)}})}},r.remove=function(){if(typeof r.options.onbeforeremove=="function"){var N=r.options.onbeforeremove(E,r);if(N===!1)return!1}I({url:r.options.url,method:"DELETE",dataType:"json",success:function(V){typeof r.options.onremove=="function"&&r.options.onremove(E,r,V),r.reset()}})};var ee=function(N){N.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var V=N.getAttribute("data-error")||"There is an error in the form";return N.setAttribute("title",V),V},O=function(N){var V=!1;N.classList.remove("error"),N.removeAttribute("title");for(var G=E.querySelectorAll("input, select, textarea, div[name]"),ne=0;ne<G.length;ne++)G[ne].getAttribute("data-validation")&&G[ne].classList.contains("error")&&(V=!0);r.options.submitButton&&(V?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))};return r.validateElement=function(N){var V=!1,G=w.getValue(N),ne=N.getAttribute("data-validation");return typeof r.options.validations[ne]=="function"&&!r.options.validations[ne](G,N)?V=ee(N):N.classList.contains("error")&&O(N),V},r.reset=function(){for(var N=E.querySelectorAll("input, select, textarea, div[name]"),V=0;V<N.length;V++)N[V].getAttribute("name")&&(N[V].type=="checkbox"||N[V].type=="radio"?N[V].checked=!1:typeof N[V].val=="function"?N[V].val(""):N[V].value="")},r.validate=function(){for(var N=[],V=E.querySelectorAll("input, select, textarea, div[name]"),G=0;G<V.length;G++)if(V[G].getAttribute("data-validation")){var ne=r.validateElement(V[G]);ne&&N.push(ne)}return N.length>0?N.join("<br>"):!1},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(w.getElements(E))},r.getHash=function(N){var V=0,G,ne;if(N.length===0)return V;for(G=0;G<N.length;G++)ne=N.charCodeAt(G),V=(V<<5)-V+ne,V|=0;return V},r.isChanged=function(){var N=r.setHash();return r.options.currentHash!=N},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(N){r.options.ignore=!!N},setTimeout(function(){r.options.currentHash=r.setHash()},1e3),E.addEventListener("keyup",function(N){N.target.getAttribute("data-validation")&&r.validateElement(N.target)}),w.hasEvents||(window.addEventListener("beforeunload",function(N){if(r.isChanged()&&r.options.ignore==!1){var V=r.options.message?r.options.message:"o/";return V?(typeof N>"u"&&(N=window.event),N&&(N.returnValue=V),V):void 0}}),w.hasEvents=!0),E.form=r,r};return w.getValue=function(E){var l=null;if(E.type=="checkbox")E.checked==!0&&(l=E.value||!0);else if(E.type=="radio")E.checked==!0&&(l=E.value);else if(E.type=="file")l=E.files;else if(E.tagName=="select"&&E.multiple==!0){l=[];for(var r=E.querySelectorAll("options[selected]"),P=0;P<r.length;P++)l.push(r[P].value)}else typeof E.val=="function"?l=E.val():l=E.value||"";return l},w.getElements=function(E,l){for(var r={},P=null,te=E.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<te.length;ee++)(P=te[ee].getAttribute("name"))&&(r[P]=w.getValue(te[ee])||"");return l==!0?r:JSON.stringify(r)},w.setElements=function(E,l){for(var r=null,P=null,te=E.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<te.length;ee++){var O=te[ee].getAttribute("type");if(r=te[ee].getAttribute("name")){if(r=r.replace(new RegExp(/\[(.*?)\]/ig),".$1"),P=null,r.match(/\./)){var N=j.call(l,r)||"";typeof N<"u"&&(P=N)}else typeof l[r]<"u"&&(P=l[r]);P!==null&&(O=="checkbox"||O=="radio"?te[ee].checked=!!P:O=="file"||(typeof te[ee].val=="function"?te[ee].val(P):te[ee].value=P))}}},w}var He=Te();function Ve(){var w=function(){var l=null,r=function(O){if(O.which==27)for(var N=document.querySelectorAll(".jmodal"),V=0;V<N.length;V++)N[V].parentNode.modal.close()},P=function(O){let N=O.composedPath();var V=o.findElement(N[0],"jmodal");if(V){var G=V.getBoundingClientRect();if(O.changedTouches&&O.changedTouches[0])var ne=O.changedTouches[0].clientX,ge=O.changedTouches[0].clientY;else var ne=O.clientX,ge=O.clientY;G.width-(ne-G.left)<50&&ge-G.top<50&&V.parentNode.modal.close()}l&&(l.element.style.cursor="auto",l=null)},te=function(O){let N=O.composedPath();var V=o.findElement(N[0],"jmodal");if(V){var G=V.getBoundingClientRect();if(O.changedTouches&&O.changedTouches[0])var ne=O.changedTouches[0].clientX,ge=O.changedTouches[0].clientY;else var ne=O.clientX,ge=O.clientY;G.width-(ne-G.left)<50&&ge-G.top<50||ge-G.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),l={left:G.left,top:G.top,x:O.clientX,y:O.clientY,width:G.width,height:G.height,element:V})}},ee=function(O){if(l){if(O=O||window.event,O.buttons)var N=O.buttons;else if(O.button)var N=O.button;else var N=O.which;N?(l.element.style.top=l.top+(O.clientY-l.y)+l.height/2+"px",l.element.style.left=l.left+(O.clientX-l.x)+l.width/2+"px",l.element.style.cursor="move"):l.element.style.cursor="auto"}};document.addEventListener("keydown",r),document.addEventListener("mouseup",P),document.addEventListener("mousedown",te),document.addEventListener("mousemove",ee)},E=function(l,r){var P={};P.options={};var te={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in te)r&&r.hasOwnProperty(ee)?P.options[ee]=r[ee]:P.options[ee]=te[ee];!P.options.title&&l.getAttribute("title")&&(P.options.title=l.getAttribute("title"));for(var O=document.createElement("div");l.children[0];)O.appendChild(l.children[0]);for(P.title=document.createElement("div"),P.title.className="jmodal_title",P.options.icon&&P.title.setAttribute("data-icon",P.options.icon),P.content=document.createElement("div"),P.content.className="jmodal_content",P.content.innerHTML=l.innerHTML;O.children[0];)P.content.appendChild(O.children[0]);if(P.container=document.createElement("div"),P.container.className="jmodal",P.container.appendChild(P.title),P.container.appendChild(P.content),P.options.padding&&(P.content.style.padding=P.options.padding),P.options.width&&(P.container.style.width=P.options.width),P.options.height&&(P.container.style.height=P.options.height),P.options.title){var N=document.createElement("h4");N.innerText=P.options.title,P.title.appendChild(N)}if(l.innerHTML="",l.style.display="none",l.appendChild(P.container),P.options.backdrop){var V=document.createElement("div");V.className="jmodal_backdrop",V.onclick=function(){P.close()},l.appendChild(V)}return P.open=function(){l.style.display="block";var G=P.container.getBoundingClientRect();o.getWindowWidth()<G.width?(P.container.style.top="",P.container.style.left="",P.container.classList.add("jmodal_fullscreen"),D.slideBottom(P.container,1)):P.options.backdrop&&(V.style.display="block"),typeof P.options.onopen=="function"&&P.options.onopen(l,P)},P.resetPosition=function(){P.container.style.top="",P.container.style.left=""},P.isOpen=function(){return l.style.display!="none"},P.close=function(){P.isOpen()&&(l.style.display="none",P.options.backdrop&&(V.style.display=""),P.container.classList.remove("jmodal_fullscreen"),typeof P.options.onclose=="function"&&P.options.onclose(l,P))},P.options.url?I({url:P.options.url,method:"GET",dataType:"text/html",success:function(G){P.content.innerHTML=G,P.options.closed||P.open(),typeof P.options.onload=="function"&&P.options.onload(P)}}):(P.options.closed||P.open(),typeof P.options.onload=="function"&&P.options.onload(P)),l.modal=P,w(),w=function(){},P};return E}var Ge=Ve();function et(){var w=function(E){var l={};l.options={};var r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var P in r)E&&E.hasOwnProperty(P)?l.options[P]=E[P]:l.options[P]=r[P];var te=document.createElement("div");te.className="jnotification",l.options.error&&te.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",te.appendChild(ee);var O=document.createElement("div");O.className="jnotification-header",ee.appendChild(O);var N=document.createElement("div");if(N.className="jnotification-image",O.appendChild(N),l.options.icon){var V=document.createElement("img");V.src=l.options.icon,N.appendChild(V)}var G=document.createElement("div");if(G.className="jnotification-name",G.innerHTML=l.options.name,O.appendChild(G),l.options.closeable==!0){var ne=document.createElement("div");ne.className="jnotification-close",ne.onclick=function(){l.hide()},O.appendChild(ne)}var ge=document.createElement("div");ge.className="jnotification-date",O.appendChild(ge);var ce=document.createElement("div");if(ce.className="jnotification-content",ee.appendChild(ce),l.options.title){var fe=document.createElement("div");fe.className="jnotification-title",fe.innerHTML=l.options.title,ce.appendChild(fe)}var Ee=document.createElement("div");if(Ee.className="jnotification-message",Ee.innerHTML=l.options.message,ce.appendChild(Ee),l.show=function(){document.body.appendChild(te),o.getWindowWidth()>800?D.fadeIn(te):D.slideTop(te,1)},l.hide=function(){o.getWindowWidth()>800?D.fadeOut(te,function(){te.parentNode&&(te.parentNode.removeChild(te),De&&clearTimeout(De))}):D.slideTop(te,0,function(){te.parentNode&&(te.parentNode.removeChild(te),De&&clearTimeout(De))})},l.show(),l.options.autoHide==!0)var De=setTimeout(function(){l.hide()},l.options.timeout);return o.getWindowWidth()<800&&te.addEventListener("swipeup",function(Se){l.hide(),Se.preventDefault(),Se.stopPropagation()}),l};return w.isVisible=function(){var E=document.querySelector(".jnotification");return!!(E&&E.parentNode)},w}var at=et();function dt(w,E){var l={};l.options={};var r={value:0,onchange:null,width:null};for(var P in r)E&&E.hasOwnProperty(P)?l.options[P]=E[P]:l.options[P]=r[P];w.classList.add("jprogressbar"),w.setAttribute("tabindex",1),w.setAttribute("data-value",l.options.value);var te=document.createElement("div");te.style.width=l.options.value+"%",te.style.color="#fff",w.appendChild(te),l.options.width&&(w.style.width=l.options.width),l.setValue=function(O){O=parseInt(O),l.options.value=O,te.style.width=O+"%",w.setAttribute("data-value",O+"%"),O<6?w.style.color="#000":w.style.color="#fff",l.options.value=O,typeof l.options.onchange=="function"&&l.options.onchange(w,O),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},l.getValue=function(){return l.options.value};var ee=function(O){if(O.which){var N=w.getBoundingClientRect();if(O.changedTouches&&O.changedTouches[0]){var V=O.changedTouches[0].clientX;O.changedTouches[0].clientY}else{var V=O.clientX;O.clientY}l.setValue(Math.round((V-N.left)/N.width*100))}};return"touchstart"in document.documentElement?(w.addEventListener("touchstart",ee),w.addEventListener("touchend",ee)):(w.addEventListener("mousedown",ee),w.addEventListener("mousemove",ee)),w.change=l.setValue,w.val=function(O){if(O===void 0)return l.getValue();l.setValue(O)},w.progressbar=l,l}function mt(w,E){if(w.rating)return w.rating.setOptions(E,!0);var l={};l.options={},l.setOptions=function(P,te){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var O in ee)P&&P.hasOwnProperty(O)?l.options[O]=P[O]:(typeof l.options[O]>"u"||te===!0)&&(l.options[O]=ee[O]);w.innerHTML="";for(var N=0;N<l.options.number;N++){var V=document.createElement("div");V.setAttribute("data-index",N+1),V.setAttribute("title",l.options.tooltip[N]),w.appendChild(V)}if(l.options.value)for(var N=0;N<l.options.number;N++)N<l.options.value&&w.children[N].classList.add("jrating-selected");return l},l.setValue=function(P){for(var te=0;te<l.options.number;te++)te<P?w.children[te].classList.add("jrating-selected"):(w.children[te].classList.remove("jrating-over"),w.children[te].classList.remove("jrating-selected"));l.options.value=P,typeof l.options.onchange=="function"&&l.options.onchange(w,P),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},l.getValue=function(){return l.options.value};var r=function(){l.setOptions(E),w.classList.add("jrating"),w.addEventListener("click",function(P){var te=P.target.getAttribute("data-index");te!=null&&(te==l.options.value?l.setValue(0):l.setValue(te))}),w.addEventListener("mouseover",function(P){for(var te=P.target.getAttribute("data-index"),ee=0;ee<l.options.number;ee++)ee<te?w.children[ee].classList.add("jrating-over"):w.children[ee].classList.remove("jrating-over")}),w.addEventListener("mouseout",function(P){for(var te=0;te<l.options.number;te++)w.children[te].classList.remove("jrating-over")}),w.change=l.setValue,w.val=function(P){if(P===void 0)return l.getValue();l.setValue(P)},w.rating=l};return r(),l}function gt(w,E){if(w.search)return w.search;var l=null,r=function(V){if(V.target.classList.contains("jsearch_item"))var G=V.target;else var G=V.target.parentNode;O.selectIndex(G),V.preventDefault()},P=function(V){if(typeof O.options.onsearch=="function"){var G=O.options.onsearch(O,V);G&&(V=G)}if(N.innerHTML="",!V.length)w.style.display="";else{w.style.display="block";for(var ne=V.length<11?V.length:10,ge=0;ge<ne;ge++){if(typeof V[ge]=="string")var ce=V[ge],fe=V[ge];else{var ce=V[ge].text;!ce&&V[ge].name&&(ce=V[ge].name);var fe=V[ge].value;!fe&&V[ge].id&&(fe=V[ge].id)}var Ee=document.createElement("div");Ee.setAttribute("data-value",fe),Ee.setAttribute("data-text",ce),Ee.className="jsearch_item",V[ge].id&&Ee.setAttribute("id",V[ge].id),O.options.forceSelect&&ge==0&&Ee.classList.add("selected");var De=document.createElement("img");V[ge].image?De.src=V[ge].image:De.style.display="none",Ee.appendChild(De);var Se=document.createElement("div");Se.innerHTML=ce,Ee.appendChild(Se),N.appendChild(Ee)}}},te=function(V){if(V!=O.terms)if(O.terms=V,O.options.forceSelect?l=0:l=null,Array.isArray(O.options.data)){var G=function(ge){if(typeof ge=="string"){if((""+ge).toLowerCase().search(V.toLowerCase())>=0)return!0}else for(var ce in ge){var fe=ge[ce];if((""+fe).toLowerCase().search(V.toLowerCase())>=0)return!0}return!1},ne=O.options.data.filter(function(ge){return G(ge)});P(ne)}else I({url:O.options.data+V,method:"GET",dataType:"json",success:function(ge){P(ge)}})},ee=null,O=function(V){ee&&clearTimeout(ee),ee=setTimeout(function(){te(V)},500)};E.forceSelect===null&&(E.forceSelect=!0),O.options={data:E.data||null,input:E.input||null,searchByNode:E.searchByNode||null,onselect:E.onselect||null,forceSelect:E.forceSelect,onsearch:E.onsearch||null,onbeforesearch:E.onbeforesearch||null},O.selectIndex=function(V){var G=V.getAttribute("id"),ne=V.getAttribute("data-text"),ge=V.getAttribute("data-value"),ce=V.children[0].src||"";typeof O.options.onselect=="function"&&O.options.onselect(O,ne,ge,G,ce),O.close()},O.open=function(){w.style.display="block"},O.close=function(){ee&&clearTimeout(ee),O.terms="",N.innerHTML="",w.style.display=""},O.isOpened=function(){return!!w.style.display},O.keydown=function(V){O.isOpened()&&(V.key=="Enter"?l!==null&&N.children[l]?(O.selectIndex(N.children[l]),V.preventDefault()):O.close():V.key==="ArrowUp"?(l!==null&&N.children[0]&&(N.children[l].classList.remove("selected"),!O.options.forceSelect&&l===0?l=null:(l=Math.max(0,l-1),N.children[l].classList.add("selected"))),V.preventDefault()):V.key==="ArrowDown"&&(l==null?l=-1:N.children[l].classList.remove("selected"),l<9&&N.children[l+1]&&l++,N.children[l].classList.add("selected"),V.preventDefault()))},O.keyup=function(V){if(!O.options.searchByNode&&O.options.input)if(O.options.input.tagName==="DIV")var G=O.options.input.innerText;else var G=O.options.input.value;else{var ne=o.getNode();if(ne)var G=ne.innerText}if(typeof O.options.onbeforesearch=="function"){var ge=O.options.onbeforesearch(O,G);if(ge)G=ge;else if(ge===!1)return}O(G)},O.blur=function(V){O.close()},O.options.input&&(O.options.input.addEventListener("keyup",O.keyup),O.options.input.addEventListener("keydown",O.keydown),O.options.input.addEventListener("blur",O.blur));var N=document.createElement("div");return N.classList.add("jsearch_container"),N.onmousedown=r,w.appendChild(N),w.classList.add("jsearch"),w.search=O,O}function St(w,E){var l={};if(l.options={},l.currentImage=null,E&&(l.options=E),w.setAttribute("tabindex","900"),l.options.items=[],!w.classList.contains("jslider")){if(w.classList.add("jslider"),w.classList.add("unselectable"),l.options.height&&(w.style.minHeight=parseInt(l.options.height)+"px"),l.options.width&&(w.style.width=parseInt(l.options.width)+"px"),l.options.grid){w.classList.add("jslider-grid");var r=w.children.length;r>4&&w.setAttribute("data-total",r-4),w.setAttribute("data-number",r>4?4:r)}var P=document.createElement("div");if(P.classList.add("jslider-counter"),w.children.length>0)for(var te=0;te<w.children.length;te++){l.options.items.push(w.children[te]);var ee=document.createElement("div");ee.onclick=function(){var ne=Array.prototype.slice.call(P.children).indexOf(this);l.show(l.currentImage=l.options.items[ne])},P.appendChild(ee)}var O=document.createElement("div");O.className="jslider-caption";var N=document.createElement("div"),V=document.createElement("div");V.className="jslider-close",V.innerHTML="",V.onclick=function(){l.close()},N.appendChild(O),N.appendChild(V)}l.updateCounter=function(ne){for(var ge=0;ge<P.children.length;ge++)if(P.children[ge].classList.contains("jslider-counter-focus")){P.children[ge].classList.remove("jslider-counter-focus");break}P.children[ne].classList.add("jslider-counter-focus")},l.show=function(ne){if(!ne)var ne=w.children[0];w.classList.add("jslider-focus"),w.classList.remove("jslider-grid"),w.appendChild(N),w.appendChild(P);var ge=l.options.items.indexOf(ne);l.updateCounter(ge);for(var ce=0;ce<w.children.length;ce++)w.children[ce].style.display="";ne.style.display="block",ne.previousElementSibling?w.classList.add("jslider-left"):w.classList.remove("jslider-left"),ne.nextElementSibling&&ne.nextElementSibling.tagName=="IMG"?w.classList.add("jslider-right"):w.classList.remove("jslider-right"),l.currentImage=ne,l.currentImage.offsetHeight>l.currentImage.offsetWidth&&l.currentImage.classList.add("jslider-vertical"),N.children[0].innerText=l.currentImage.getAttribute("title")},l.open=function(){l.show(),typeof l.options.onopen=="function"&&l.options.onopen(w)},l.close=function(){w.classList.remove("jslider-focus"),w.classList.remove("jslider-left"),w.classList.remove("jslider-right"),l.options.grid&&w.classList.add("jslider-grid");for(var ne=0;ne<w.children.length;ne++)w.children[ne].style.display="";P.remove(),N.remove(),l.currentImage=null,typeof l.options.onclose=="function"&&l.options.onclose(w)},l.reset=function(){w.innerHTML=""},l.next=function(){var ne=l.currentImage.nextElementSibling;ne&&ne.tagName==="IMG"&&l.show(l.currentImage.nextElementSibling)},l.prev=function(){l.currentImage.previousElementSibling&&l.show(l.currentImage.previousElementSibling)};var G=function(ne){if(ne.target.tagName=="IMG")l.show(ne.target);else if(!ne.target.classList.contains("jslider-close")&&!(ne.target.parentNode.classList.contains("jslider-counter")||ne.target.classList.contains("jslider-counter"))){var ge=ne.offsetX||ne.changedTouches[0].clientX;ne.target.clientWidth-ge<40?l.next():ge<40&&l.prev()}};return"ontouchend"in document.documentElement?w.addEventListener("touchend",G):w.addEventListener("mouseup",G),w.addEventListener("swipeleft",function(ne){l.next(),ne.preventDefault(),ne.stopPropagation()}),w.addEventListener("swiperight",function(ne){l.prev(),ne.preventDefault(),ne.stopPropagation()}),w.addEventListener("keydown",function(ne){ne.which==27&&l.close()}),w.slider=l,l}function Ft(w,E){if(w.tags)return w.tags.setOptions(E,!0);var l={type:"tags"};l.options={};var r=function(){return!!(l.options.limit&&w.children.length>=l.options.limit)},P=null,te=null;l.setOptions=function(Q,he){var we={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var U in we)Q&&Q.hasOwnProperty(U)?l.options[U]=Q[U]:(typeof l.options[U]>"u"||he===!0)&&(l.options[U]=we[U]);return l.options.placeholder?w.setAttribute("data-placeholder",l.options.placeholder):w.removeAttribute("data-placeholder"),w.placeholder=l.options.placeholder,l.setValue(l.options.value),V(),l.options.search?te||(te=document.createElement("div"),w.parentNode.insertBefore(te,w.nextSibling),P=gt(te,{data:l.options.search,onselect:function(Z,v,F){l.selectIndex(v,F)}})):te&&(P=null,te.remove(),te=null),l},l.add=function(Q,he){if(typeof l.options.onbeforechange=="function"){var we=l.options.onbeforechange(w,l,l.options.value,Q);if(we===!1)return!1;we!=null&&(Q=we)}if(P&&P.close(),r())typeof l.options.onlimit=="function"?l.options.onlimit(l,l.options.limit):alert(f.translate("You reach the limit number of entries")+" "+l.options.limit);else{var U=o.getNode();if(U&&U.parentNode&&U.parentNode.classList.contains("jtags")&&U.nextSibling&&!(U.nextSibling.innerText&&U.nextSibling.innerText.trim()))Z=U.nextSibling;else{if(w.lastChild&&(w.lastChild.innerText.trim()||w.removeChild(w.lastChild)),!Q||typeof Q=="string")var Z=O(Q,Q,U);else for(var v=0;v<=Q.length;v++)if(!r()){if(!Q[v]||typeof Q[v]=="string")var F=Q[v]||"",X=null;else var F=Q[v].text,X=Q[v].value;var Z=O(F,X)}N()}he&&ee(Z)}},l.setLimit=function(Q){for(l.options.limit=Q,w.children.length-Q;w.children.length>Q;)w.removeChild(w.lastChild)},l.remove=function(Q){Q.parentNode.removeChild(Q),w.children.length?N():l.add("",!0),typeof l.options.onremoveitem=="function"&&l.options.onremoveitem(w,l,Q)},l.getData=function(){for(var Q=[],he=0;he<w.children.length;he++){var we=w.children[he].innerText.replace(`
`,""),U=w.children[he].getAttribute("data-value");U||(U=we),(we||U)&&Q.push({text:we,value:U})}return Q},l.getValue=function(Q){var he=null;if(Q!=null)he=w.children[Q].getAttribute("data-value"),he||(he=w.children[Q].innerText.replace(`
`,""));else{for(var we=[],U=0;U<w.children.length;U++)he=w.children[U].innerText.replace(`
`,""),he&&we.push(l.getValue(U));he=we.join(",")}return he},l.setValue=function(Q){if(!Q)l.reset();else if(w.value!=Q)if(Array.isArray(Q))l.add(Q);else{var he=(""+Q).trim(),we=ne(he);w.innerHTML="",l.add(we)}},l.reset=function(){w.classList.add("jtags-empty"),w.innerHTML="<div></div>",N()},l.isValid=function(){for(var Q=0,he=0;he<w.children.length;he++)w.children[he].classList.contains("jtags_error")&&Q++;return Q==0},l.selectIndex=function(Q,he){var we=o.getNode();we&&(we.innerText=Q,he&&we.setAttribute("data-value",he),we.classList.remove("jtags_error"),r()||l.add("",!0))},l.search=function(Q){Q.innerText},l.destroy=function(){w.removeEventListener("mouseup",De),w.removeEventListener("keydown",ce),w.removeEventListener("keyup",fe),w.removeEventListener("paste",Ee),w.removeEventListener("focus",Se),w.removeEventListener("blur",ze),w.parentNode.removeChild(w)};var ee=function(Q){if(w.children.length){var he=document.createRange(),we=window.getSelection();if(!Q)var Q=w.childNodes[w.childNodes.length-1];he.setStart(Q,Q.length),he.collapse(!0),we.removeAllRanges(),we.addRange(he),w.scrollLeft=w.scrollWidth}},O=function(Q,he,we){var U=document.createElement("div");return U.textContent=Q||"",he&&U.setAttribute("data-value",he),we&&we.parentNode.classList.contains("jtags")?w.insertBefore(U,we.nextSibling):w.appendChild(U),U},N=function(){var Q=l.getValue();Q!=l.options.value&&(l.options.value=Q,typeof l.options.onchange=="function"&&l.options.onchange(w,l,l.options.value),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))),V()},V=function(){for(var Q=0;Q<w.children.length;Q++)w.children[Q].tagName==="DIV"&&(l.getValue(Q)?(w.children[Q].classList.add("jtags_label"),typeof l.options.validation=="function"&&l.getValue(Q)?l.options.validation(w.children[Q],w.children[Q].innerText,w.children[Q].getAttribute("data-value"))?w.children[Q].classList.remove("jtags_error"):w.children[Q].classList.add("jtags_error"):w.children[Q].classList.remove("jtags_error")):w.children[Q].classList.remove("jtags_label"));G()},G=function(){w.innerText.trim()?w.classList.remove("jtags-empty"):(!w.children.length||w.children[0].tagName==="BR")&&(w.innerHTML="",ee(O()))},ne=function(Q){var he=[],we="";if(Q=Q.trim(),Q){for(var U=0;U<Q.length;U++)Q[U]==","||Q[U]==";"||Q[U]==`
`?we&&(he.push(we.trim()),we=""):we+=Q[U];we&&he.push(we)}return he},ge=0,ce=function(Q){if(ge=window.getSelection().anchorOffset,G(),Q.key==="Tab"||Q.key===";"||Q.key===","){var he=window.getSelection().anchorOffset;he>1&&(r()?typeof l.options.onlimit=="function"&&l.options.onlimit(l,l.options.limit):l.add("",!0)),Q.preventDefault()}else if(Q.key=="Enter"){if(!P||!P.isOpened()){var he=window.getSelection().anchorOffset;he>1&&(r()||l.add("",!0)),Q.preventDefault()}}else Q.key=="Backspace"&&w.children.length==1&&window.getSelection().anchorOffset<1&&Q.preventDefault();P&&P.keydown(Q),G()},fe=function(Q){if(Q.which==39){var he=window.getSelection().anchorOffset;he>1&&he==ge&&l.add("",!0)}else Q.which==13||Q.which==38||Q.which==40?Q.preventDefault():P&&P.keyup(Q);V()},Ee=function(Q){if(Q.clipboardData||Q.originalEvent.clipboardData)var he=(Q.originalEvent||Q).clipboardData.getData("text/plain");else if(window.clipboardData)var he=window.clipboardData.getData("Text");var we=ne(he);if(typeof l.options.onbeforepaste=="function"){var U=l.options.onbeforepaste(w,l,we);if(U===!1)return Q.preventDefault(),!1;U&&(we=U)}we.length>1?(l.add(we,!0),Q.preventDefault()):we[0]&&(document.execCommand("insertText",!1,we[0]),Q.preventDefault())},De=function(Q){if(Q.target.parentNode&&Q.target.parentNode.classList.contains("jtags")&&(Q.target.classList.contains("jtags_label")||Q.target.classList.contains("jtags_error"))){var he=Q.target.getBoundingClientRect();he.width-(Q.clientX-he.left)<16&&l.remove(Q.target)}Q.target==w&&ee()},Se=function(){w.classList.contains("jtags-focus")||((!w.children.length||l.getValue(w.children.length-1))&&(r()||O("")),typeof l.options.onfocus=="function"&&l.options.onfocus(w,l,l.getValue()),w.classList.add("jtags-focus"))},ze=function(){if(w.classList.contains("jtags-focus")){P&&P.close();for(var Q=0;Q<w.children.length-1;Q++)l.getValue(Q)||w.removeChild(w.children[Q]);N(),w.classList.remove("jtags-focus"),typeof l.options.onblur=="function"&&l.options.onblur(w,l,l.getValue())}},Ke=function(){"touchend"in document.documentElement?w.addEventListener("touchend",De):w.addEventListener("mouseup",De),w.addEventListener("keydown",ce),w.addEventListener("keyup",fe),w.addEventListener("paste",Ee),w.addEventListener("focus",Se),w.addEventListener("blur",ze),w.setAttribute("contenteditable",!0),w.classList.add("jtags"),l.setOptions(E),typeof l.options.onload=="function"&&l.options.onload(w,l),w.change=l.setValue,w.val=function(Q){if(Q===void 0)return l.getValue();l.setValue(Q)},w.tags=l};return Ke(),l}function Et(w,E){var l={};l.options={};var r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var P in r)E&&E.hasOwnProperty(P)?l.options[P]=E[P]:l.options[P]=r[P];l.options.multiple==!0&&w.setAttribute("data-multiple",!0),w.content=[],w.classList.add("jupload"),l.options.input==!0&&w.classList.add("input"),l.add=function(N){if(l.options.multiple==!1&&(w.content=[],w.innerText=""),l.options.type=="image"){var V=document.createElement("img");V.setAttribute("src",N.file),V.setAttribute("tabindex",-1),w.getAttribute("name")||(V.className="jfile",V.content=N),w.appendChild(V)}else{if(N.name)var G=N.name;else var G=N.file;var ne=document.createElement("div");ne.innerText=G||l.options.type,ne.classList.add("jupload-item"),ne.setAttribute("tabindex",-1),w.appendChild(ne)}N.content&&(N.file=o.guid()),w.content.push(N),typeof l.options.onchange=="function"&&l.options.onchange(w,N)},l.addFromFile=function(N){var V=N.type.split("/");if(V[0]==l.options.type){var G=new FileReader;G.addEventListener("load",function(ne){var ge={file:ne.srcElement.result,extension:N.name.substr(N.name.lastIndexOf(".")+1),name:N.name,size:N.size,lastmodified:N.lastModified,content:ne.srcElement.result};l.add(ge)}),G.readAsDataURL(N)}else alert(f.translate("This extension is not allowed"))},l.addFromUrl=function(N){if(N.substr(0,4)!="data"&&!l.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(N.substr(0,4)=="data"){var V=N.split(";");V=V[0].split("/");var G=V[0].replace("data:","");if(G==l.options.type){var ne={file:N,name:"",extension:V[1],content:N};l.add(ne)}else alert(l.options.text.extensionNotAllowed)}else{var V=N.substr(N.lastIndexOf(".")+1);N=l.options.remoteParser+N,I({url:N,type:"GET",dataType:"blob",success:function(ce){}})}};var te=l.options.type+"/"+l.options.extension,ee=document.createElement("input");ee.type="file",ee.setAttribute("accept",te),ee.onchange=function(){for(var N=0;N<this.files.length;N++)l.addFromFile(this.files[N])},l.options.multiple==!0&&ee.setAttribute("multiple",!0);var O=null;return w.addEventListener("click",function(N){O=null,!w.children.length||N.target===w?o.click(ee):N.target.parentNode==w&&(O=N.target)}),w.addEventListener("dblclick",function(N){o.click(ee)}),w.addEventListener("dragenter",function(N){w.style.border="1px dashed #000"}),w.addEventListener("dragleave",function(N){w.style.border="1px solid #eee"}),w.addEventListener("dragstop",function(N){w.style.border="1px solid #eee"}),w.addEventListener("dragover",function(N){N.preventDefault()}),w.addEventListener("keydown",function(N){if(O&&N.which==46){var V=Array.prototype.indexOf.call(w.children,O);V>=0&&(w.content.splice(V,1),O.remove(),O=null)}}),w.addEventListener("drop",function(N){N.preventDefault(),N.stopPropagation();var V=(N.originalEvent||N).dataTransfer.getData("text/html"),G=(N.originalEvent||N).dataTransfer.files;if(G.length)for(var ne=0;ne<N.dataTransfer.files.length;ne++)l.addFromFile(N.dataTransfer.files[ne]);else if(V){l.options.multiple==!1&&(w.innerText="");var ge=document.createElement("div");ge.innerHTML=V;var ce=ge.querySelectorAll("img");if(ce.length)for(var ne=0;ne<ce.length;ne++)l.addFromUrl(ce[ne].src)}return w.style.border="1px solid #eee",!1}),w.val=function(N){if(N===void 0)return w.content&&w.content.length?w.content:null;if(w.innerText="",w.content=[],N)if(Array.isArray(N))for(var V=0;V<N.length;V++)typeof N[V]=="string"?l.add({file:N[V]}):l.add(N[V]);else typeof N=="string"&&l.add({file:N})},w.upload=w.image=l,l}var Ot=R(195),Tt=R.n(Ot),bt={...f,...o,version:"5.12.0",setExtensions:function(w){if(typeof w=="object")for(var E=Object.keys(w),l=0;l<E.length;l++)bt[E[l]]=w[E[l]]},tracking:_,path:j,sorting:h,lazyLoading:C,ajax:I,animation:D,calendar:pe,color:me,contextmenu:Pe,dropdown:Ue,editor:Le,floating:pt,form:He,mask:q,modal:Ge,notification:at,palette:be,picker:Re,progressbar:dt,rating:mt,search:gt,slider:St,tabs:Me,tags:Ft,toolbar:Je,upload:Et,validations:Ae};bt.image=Et,bt.image.create=function(w){var E=document.createElement("img");return E.setAttribute("src",w.file),E.className="jfile",E.setAttribute("tabindex",-1),E.content=w,E},bt.tracker=He,bt.loading=D.loading,bt.sha512=Tt(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const w=function(Q,he){return Q[he.type]&&Q[he.type]==he||Q.component&&Q.component==he?!0:Q.parentNode?w(Q.parentNode,he):!1},E=function(Q){let he=window.jSuitesStateControl;if(he&&he.length>0)for(let we=0;we<he.length;we++)he[we]&&!w(Q,he[we])&&he[we].close()};let l=15,r=!1,P={x:null,y:null},te=document.createElement("div");te.classList.add("jtooltip");const ee=function(Q){return Q&&(Q.shadowRoot||Q.tagName&&Q.tagName.includes("-"))},O=function(Q){let he,we,U=Q.path||Q.composedPath&&Q.composedPath();return U?(we=U[0],we&&ee(we)&&!we.shadowRoot&&Q.toElement&&(we=Q.toElement)):(Q.target&&ee(Q.target)?he=Q.target.shadowRoot:he=document,we=he.elementFromPoint(x,y)),we},N=function(Q){if(Q.changedTouches&&Q.changedTouches[0])var he=Q.changedTouches[0].clientX,we=Q.changedTouches[0].clientY;else var he=Q.clientX,we=Q.clientY;let U=O(Q),Z=U&&U.tagName==="DIV"&&U.getAttribute("contentEditable"),v=bt.findElement(U,"jpanel");if(v&&!v.classList.contains("readonly")&&!Z){let F=v.getBoundingClientRect(),X=0;v.style.rotate&&(X=parseFloat(v.style.rotate));let ue="move";U.getAttribute("data-action")?ue=U.getAttribute("data-action"):v.style.cursor?ue="resize":v.style.cursor="move",r={action:ue,a:X,e:v,x:he,y:we,l:F.left,t:F.top,b:F.bottom,r:F.right,w:F.width,h:F.height,d:v.style.cursor,actioned:!1},v.style.width||(v.style.width=F.width+"px"),v.style.height||(v.style.height=F.height+"px")}else r=!1;E(U),fe(Q)},V=function(Q,he,we,U,Z,v){const F=we-Q,X=U-he,ue=Z-Q,K=v-he;let le=Math.atan2(X,F),Ne=Math.atan2(K,ue)-le;return Ne=Ne*(180/Math.PI),Ne<0&&(Ne+=360),Ne},G=function(Q){r&&r.e&&(typeof r.e.refresh=="function"&&P.actioned&&r.e.refresh(),r.e.style.cursor=""),P={x:null,y:null},r=!1},ne=function(Q){if(r){let v=Q.clientX||Q.pageX,F=Q.clientY||Q.pageY;if(P.x==null&&P.y==null&&(P.x=v,P.y=F),r.action==="move"){var he=v-P.x,we=F-P.y,U=r.e.offsetTop+we,Z=r.e.offsetLeft+he;r.e.style.top=U+"px",r.e.style.left=Z+"px",typeof r.e.refresh=="function"&&(P.actioned=!0,r.e.refresh("position",U,Z))}else if(r.action==="rotate"){let X=r.l+r.w/2,ue=r.t+r.h/2,K=V(X,ue,r.x,r.y,v,F);K=K+r.a%360,K=Math.round(K/2)*2,r.e.style.rotate=`${K}deg`,typeof r.e.refresh=="function"&&(P.actioned=!0,r.e.refresh("rotate",K))}else if(r.action==="resize"){let X=null,ue=null,K=null,le=null;r.d=="e-resize"||r.d=="ne-resize"||r.d=="se-resize"?(K=r.e.offsetWidth+(v-P.x),Q.shiftKey&&(le=r.e.offsetHeight+(v-P.x)*(r.e.offsetHeight/r.e.offsetWidth))):(r.d==="w-resize"||r.d=="nw-resize"||r.d=="sw-resize")&&(ue=r.e.offsetLeft+(v-P.x),K=r.e.offsetLeft+r.e.offsetWidth-ue,Q.shiftKey&&(le=r.e.offsetHeight-(v-P.x)*(r.e.offsetHeight/r.e.offsetWidth))),r.d=="s-resize"||r.d=="se-resize"||r.d=="sw-resize"?le||(le=r.e.offsetHeight+(F-P.y)):(r.d==="n-resize"||r.d=="ne-resize"||r.d=="nw-resize")&&(X=r.e.offsetTop+(F-P.y),le=r.e.offsetTop+r.e.offsetHeight-X),X&&(r.e.style.top=X+"px"),ue&&(r.e.style.left=ue+"px"),K&&(r.e.style.width=K+"px"),le&&(r.e.style.height=le+"px"),typeof r.e.refresh=="function"&&(P.actioned=!0,r.e.refresh("dimensions",K,le))}P.x=v,P.y=F}else{let v=O(Q),F=bt.findElement(v,"jpanel");if(F){if(F.classList.contains("jpanel-controls")){let ue=v.getAttribute("data-position");ue?F.style.cursor=ue:F.style.cursor=""}else if(F.getAttribute("tabindex")){let ue=F.getBoundingClientRect();Q.clientY-ue.top<l?ue.width-(Q.clientX-ue.left)<l?F.style.cursor="ne-resize":Q.clientX-ue.left<l?F.style.cursor="nw-resize":F.style.cursor="n-resize":ue.height-(Q.clientY-ue.top)<l?ue.width-(Q.clientX-ue.left)<l?F.style.cursor="se-resize":Q.clientX-ue.left<l?F.style.cursor="sw-resize":F.style.cursor="s-resize":ue.width-(Q.clientX-ue.left)<l?F.style.cursor="e-resize":Q.clientX-ue.left<l?F.style.cursor="w-resize":F.style.cursor=""}}}};let ge=["n","ne","e","se","s","sw","w","nw","rotate"];ge.forEach(function(Q,he){ge[he]=document.createElement("div"),ge[he].classList.add("jpanel-action"),Q==="rotate"?ge[he].setAttribute("data-action","rotate"):(ge[he].setAttribute("data-action","resize"),ge[he].setAttribute("data-position",Q+"-resize"))});let ce;const fe=function(Q){let he=O(Q),we=bt.findElement(he,"jpanel");we&&!we.classList.contains("readonly")&&we.classList.contains("jpanel-controls")?(we.append(...ge),we.classList.contains("jpanel-rotate")||ge[ge.length-1].remove(),ce=we):Ee()},Ee=function(Q){ce&&(ge.forEach(function(he){he.remove()}),ce=null)},De=function(Q){var we=O(Q).getAttribute("data-tooltip");if(we){if(te.innerText=we,Q.changedTouches&&Q.changedTouches[0])var U=Q.changedTouches[0].clientX,Z=Q.changedTouches[0].clientY;else var U=Q.clientX,Z=Q.clientY;te.style.top=Z+"px",te.style.left=U+"px",document.body.appendChild(te)}else te.innerText&&(te.innerText="",document.body.removeChild(te))},Se=function(Q){var he=document.activeElement;if(he&&typeof he.contextmenu=="function")he.contextmenu(Q),Q.preventDefault(),Q.stopImmediatePropagation();else if(he=bt.findElement(Q.target,function(U){return U.tagName&&U.getAttribute("aria-contextmenu-id")}),he){var we=document.querySelector("#"+he);we?(we.contextmenu.open(Q),Q.preventDefault(),Q.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+he)}},ze=function(Q){let he=document.activeElement;he&&Q.key==="Delete"&&typeof he.delete=="function"&&(he.delete(),Q.preventDefault(),Q.stopImmediatePropagation());let we=window.jSuitesStateControl;we&&we.length>0&&(he=we[we.length-1],he&&Q.key==="Escape"&&typeof he.isOpened=="function"&&typeof he.close=="function"&&he.isOpened()&&(he.close(),Q.preventDefault(),Q.stopImmediatePropagation()))},Ke=function(Q){(Q.target.getAttribute("data-mask")||Q.target.mask)&&bt.mask(Q)};document.addEventListener("focusin",fe),document.addEventListener("mouseup",G),document.addEventListener("mousedown",N),document.addEventListener("mousemove",ne),document.addEventListener("mouseover",De),document.addEventListener("keydown",ze),document.addEventListener("contextmenu",Se),document.addEventListener("input",Ke)}();var Rt=bt})(),c=z.default}(),c})}(jsuites$1)),jsuites$1.exports}var dist=dist$1.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();(function(n,s){module.exports=s()})(dist,function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(n){var s;n.exports=(function(){var c={765:function(z,b){var u;u=function(f){f.version="1.0.2";var k=Math;function _(me,ae){for(var Pe=0,Ye=0;Pe<me.length;++Pe)Ye=ae*Ye+me[Pe];return Ye}function g(me,ae,Pe,Ye,Ue){if(ae===0)return Pe;if(ae===1)return Ye;for(var Re=2/me,Je=Ye,Y=1;Y<ae;++Y)Je=Ye*Y*Re+Ue*Pe,Pe=Ye,Ye=Je;return Je}function o(me,ae,Pe,Ye,Ue){return function(Re,Je){if(Ye){if(Re===0)return Ye==1?-1/0:1/0;if(Re<0)return NaN}return Je===0?me(Re):Je===1?ae(Re):Je<0?NaN:g(Re,Je|=0,me(Re),ae(Re),Ue)}}var m,j,h,C,L,I,B,D,A,S,J,q,ie,pe=function(){var me=.636619772,ae=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Pe=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Ye=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ue=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Re(Qe){var Ae=0,Te=0,He=0,Ve=Qe*Qe;if(Qe<8)Ae=(Te=_(ae,Ve))/(He=_(Pe,Ve));else{var Ge=Qe-.785398164;Te=_(Ye,Ve=64/Ve),He=_(Ue,Ve),Ae=k.sqrt(me/Qe)*(k.cos(Ge)*Te-k.sin(Ge)*He*8/Qe)}return Ae}var Je=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),Y=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Le=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),_e=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function pt(Qe){var Ae=0,Te=0,He=0,Ve=Qe*Qe,Ge=k.abs(Qe)-2.356194491;return Math.abs(Qe)<8?Ae=(Te=Qe*_(Je,Ve))/(He=_(Y,Ve)):(Te=_(Le,Ve=64/Ve),He=_(_e,Ve),Ae=k.sqrt(me/k.abs(Qe))*(k.cos(Ge)*Te-k.sin(Ge)*He*8/k.abs(Qe)),Qe<0&&(Ae=-Ae)),Ae}return function Qe(Ae,Te){if(Te=Math.round(Te),!isFinite(Ae))return isNaN(Ae)?Ae:0;if(Te<0)return(Te%2?-1:1)*Qe(Ae,-Te);if(Ae<0)return(Te%2?-1:1)*Qe(-Ae,Te);if(Te===0)return Re(Ae);if(Te===1)return pt(Ae);if(Ae===0)return 0;var He=0;if(Ae>Te)He=g(Ae,Te,Re(Ae),pt(Ae),-1);else{for(var Ve=!1,Ge=0,et=0,at=1,dt=0,mt=2/Ae,gt=2*k.floor((Te+k.floor(k.sqrt(40*Te)))/2);gt>0;gt--)dt=gt*mt*at-Ge,Ge=at,at=dt,k.abs(at)>1e10&&(at*=1e-10,Ge*=1e-10,He*=1e-10,et*=1e-10),Ve&&(et+=at),Ve=!Ve,gt==Te&&(He=Ge);He/=et=2*et-at}return He}}(),se=(m=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),h=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),L=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),I=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),B=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),D=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),A=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),o(function(me){var ae=0,Pe=0,Ye=0,Ue=me*me,Re=me-.785398164;return me<8?ae=(Pe=_(j,Ue))/(Ye=_(h,Ue))+m*pe(me,0)*k.log(me):(Pe=_(C,Ue=64/Ue),Ye=_(L,Ue),ae=k.sqrt(m/me)*(k.sin(Re)*Pe+k.cos(Re)*Ye*8/me)),ae},function(me){var ae=0,Pe=0,Ye=0,Ue=me*me,Re=me-2.356194491;return me<8?ae=(Pe=me*_(I,Ue))/(Ye=_(B,Ue))+m*(pe(me,1)*k.log(me)-1/me):(Pe=_(D,Ue=64/Ue),Ye=_(A,Ue),ae=k.sqrt(m/me)*(k.sin(Re)*Pe+k.cos(Re)*Ye*8/me)),ae},0,1,-1)),be=(S=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),J=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),q=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),ie=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function me(ae,Pe){if((Pe=Math.round(Pe))===0)return function(_e){return _e<=3.75?_(S,_e*_e/14.0625):k.exp(k.abs(_e))/k.sqrt(k.abs(_e))*_(J,3.75/k.abs(_e))}(ae);if(Pe===1)return function(_e){return _e<3.75?_e*_(q,_e*_e/14.0625):(_e<0?-1:1)*k.exp(k.abs(_e))/k.sqrt(k.abs(_e))*_(ie,3.75/k.abs(_e))}(ae);if(Pe<0)return NaN;if(k.abs(ae)===0)return 0;if(ae==1/0)return 1/0;var Ye,Ue=0,Re=2/k.abs(ae),Je=0,Y=1,Le=0;for(Ye=2*k.round((Pe+k.round(k.sqrt(40*Pe)))/2);Ye>0;Ye--)Le=Ye*Re*Y+Je,Je=Y,Y=Le,k.abs(Y)>1e10&&(Y*=1e-10,Je*=1e-10,Ue*=1e-10),Ye==Pe&&(Ue=Je);return Ue*=me(ae,0)/Y,ae<0&&Pe%2?-Ue:Ue}),Me=function(){var me=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ae=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Pe=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Ye=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o(function(Ue){return Ue<=2?-k.log(Ue/2)*be(Ue,0)+_(me,Ue*Ue/4):k.exp(-Ue)/k.sqrt(Ue)*_(ae,2/Ue)},function(Ue){return Ue<=2?k.log(Ue/2)*be(Ue,1)+1/Ue*_(Pe,Ue*Ue/4):k.exp(-Ue)/k.sqrt(Ue)*_(Ye,2/Ue)},0,2,1)}();f.besselj=pe,f.bessely=se,f.besseli=be,f.besselk=Me},u(typeof DO_NOT_EXPORT_BESSEL>"u"?b:{})},162:function(z){var b;z.exports=(b=function(u,f){var k=Array.prototype.concat,_=Array.prototype.slice,g=Object.prototype.toString;function o(A,S){var J=A>S?A:S;return u.pow(10,17-~~(u.log(J>0?J:-J)*u.LOG10E))}var m=Array.isArray||function(A){return g.call(A)==="[object Array]"};function j(A){return g.call(A)==="[object Function]"}function h(A){return typeof A=="number"&&A-A==0}function C(){return new C._init(arguments)}function L(){return 0}function I(){return 1}function B(A,S){return A===S?1:0}C.fn=C.prototype,C._init=function(A){if(m(A[0]))if(m(A[0][0])){j(A[1])&&(A[0]=C.map(A[0],A[1]));for(var S=0;S<A[0].length;S++)this[S]=A[0][S];this.length=A[0].length}else this[0]=j(A[1])?C.map(A[0],A[1]):A[0],this.length=1;else if(h(A[0]))this[0]=C.seq.apply(null,A),this.length=1;else{if(A[0]instanceof C)return C(A[0].toArray());this[0]=[],this.length=1}return this},C._init.prototype=C.prototype,C._init.constructor=C,C.utils={calcRdx:o,isArray:m,isFunction:j,isNumber:h,toVector:function(A){return k.apply([],A)}},C._random_fn=u.random,C.setRandom=function(A){if(typeof A!="function")throw new TypeError("fn is not a function");C._random_fn=A},C.extend=function(A){var S,J;if(arguments.length===1){for(J in A)C[J]=A[J];return this}for(S=1;S<arguments.length;S++)for(J in arguments[S])A[J]=arguments[S][J];return A},C.rows=function(A){return A.length||1},C.cols=function(A){return A[0].length||1},C.dimensions=function(A){return{rows:C.rows(A),cols:C.cols(A)}},C.row=function(A,S){return m(S)?S.map(function(J){return C.row(A,J)}):A[S]},C.rowa=function(A,S){return C.row(A,S)},C.col=function(A,S){if(m(S)){var J=C.arange(A.length).map(function(){return new Array(S.length)});return S.forEach(function(pe,se){C.arange(A.length).forEach(function(be){J[be][se]=A[be][pe]})}),J}for(var q=new Array(A.length),ie=0;ie<A.length;ie++)q[ie]=[A[ie][S]];return q},C.cola=function(A,S){return C.col(A,S).map(function(J){return J[0]})},C.diag=function(A){for(var S=C.rows(A),J=new Array(S),q=0;q<S;q++)J[q]=[A[q][q]];return J},C.antidiag=function(A){for(var S=C.rows(A)-1,J=new Array(S),q=0;S>=0;S--,q++)J[q]=[A[q][S]];return J},C.transpose=function(A){var S,J,q,ie,pe,se=[];for(m(A[0])||(A=[A]),J=A.length,q=A[0].length,pe=0;pe<q;pe++){for(S=new Array(J),ie=0;ie<J;ie++)S[ie]=A[ie][pe];se.push(S)}return se.length===1?se[0]:se},C.map=function(A,S,J){var q,ie,pe,se,be;for(m(A[0])||(A=[A]),ie=A.length,pe=A[0].length,se=J?A:new Array(ie),q=0;q<ie;q++)for(se[q]||(se[q]=new Array(pe)),be=0;be<pe;be++)se[q][be]=S(A[q][be],q,be);return se.length===1?se[0]:se},C.cumreduce=function(A,S,J){var q,ie,pe,se,be;for(m(A[0])||(A=[A]),ie=A.length,pe=A[0].length,se=J?A:new Array(ie),q=0;q<ie;q++)for(se[q]||(se[q]=new Array(pe)),pe>0&&(se[q][0]=A[q][0]),be=1;be<pe;be++)se[q][be]=S(se[q][be-1],A[q][be]);return se.length===1?se[0]:se},C.alter=function(A,S){return C.map(A,S,!0)},C.create=function(A,S,J){var q,ie,pe=new Array(A);for(j(S)&&(J=S,S=A),q=0;q<A;q++)for(pe[q]=new Array(S),ie=0;ie<S;ie++)pe[q][ie]=J(q,ie);return pe},C.zeros=function(A,S){return h(S)||(S=A),C.create(A,S,L)},C.ones=function(A,S){return h(S)||(S=A),C.create(A,S,I)},C.rand=function(A,S){return h(S)||(S=A),C.create(A,S,C._random_fn)},C.identity=function(A,S){return h(S)||(S=A),C.create(A,S,B)},C.symmetric=function(A){var S,J,q=A.length;if(A.length!==A[0].length)return!1;for(S=0;S<q;S++)for(J=0;J<q;J++)if(A[J][S]!==A[S][J])return!1;return!0},C.clear=function(A){return C.alter(A,L)},C.seq=function(A,S,J,q){j(q)||(q=!1);var ie,pe=[],se=o(A,S),be=(S*se-A*se)/((J-1)*se),Me=A;for(ie=0;Me<=S&&ie<J;Me=(A*se+be*se*++ie)/se)pe.push(q?q(Me,ie):Me);return pe},C.arange=function(A,S,J){var q,ie=[];if(J=J||1,S===f&&(S=A,A=0),A===S||J===0)return[];if(A<S&&J<0)return[];if(A>S&&J>0)return[];if(J>0)for(q=A;q<S;q+=J)ie.push(q);else for(q=A;q>S;q+=J)ie.push(q);return ie},C.slice=function(){function A(S,J,q,ie){var pe,se=[],be=S.length;if(J===f&&q===f&&ie===f)return C.copy(S);if(ie=ie||1,(J=(J=J||0)>=0?J:be+J)===(q=(q=q||S.length)>=0?q:be+q)||ie===0)return[];if(J<q&&ie<0)return[];if(J>q&&ie>0)return[];if(ie>0)for(pe=J;pe<q;pe+=ie)se.push(S[pe]);else for(pe=J;pe>q;pe+=ie)se.push(S[pe]);return se}return function(S,J){var q,ie;return h((J=J||{}).row)?h(J.col)?S[J.row][J.col]:A(C.rowa(S,J.row),(q=J.col||{}).start,q.end,q.step):h(J.col)?A(C.cola(S,J.col),(ie=J.row||{}).start,ie.end,ie.step):(ie=J.row||{},q=J.col||{},A(S,ie.start,ie.end,ie.step).map(function(pe){return A(pe,q.start,q.end,q.step)}))}}(),C.sliceAssign=function(A,S,J){var q,ie;if(h(S.row)){if(h(S.col))return A[S.row][S.col]=J;S.col=S.col||{},S.col.start=S.col.start||0,S.col.end=S.col.end||A[0].length,S.col.step=S.col.step||1,q=C.arange(S.col.start,u.min(A.length,S.col.end),S.col.step);var pe=S.row;return q.forEach(function(be,Me){A[pe][be]=J[Me]}),A}if(h(S.col)){S.row=S.row||{},S.row.start=S.row.start||0,S.row.end=S.row.end||A.length,S.row.step=S.row.step||1,ie=C.arange(S.row.start,u.min(A[0].length,S.row.end),S.row.step);var se=S.col;return ie.forEach(function(be,Me){A[be][se]=J[Me]}),A}return J[0].length===f&&(J=[J]),S.row.start=S.row.start||0,S.row.end=S.row.end||A.length,S.row.step=S.row.step||1,S.col.start=S.col.start||0,S.col.end=S.col.end||A[0].length,S.col.step=S.col.step||1,ie=C.arange(S.row.start,u.min(A.length,S.row.end),S.row.step),q=C.arange(S.col.start,u.min(A[0].length,S.col.end),S.col.step),ie.forEach(function(be,Me){q.forEach(function(me,ae){A[be][me]=J[Me][ae]})}),A},C.diagonal=function(A){var S=C.zeros(A.length,A.length);return A.forEach(function(J,q){S[q][q]=J}),S},C.copy=function(A){return A.map(function(S){return h(S)?S:S.map(function(J){return J})})};var D=C.prototype;return D.length=0,D.push=Array.prototype.push,D.sort=Array.prototype.sort,D.splice=Array.prototype.splice,D.slice=Array.prototype.slice,D.toArray=function(){return this.length>1?_.call(this):_.call(this)[0]},D.map=function(A,S){return C(C.map(this,A,S))},D.cumreduce=function(A,S){return C(C.cumreduce(this,A,S))},D.alter=function(A){return C.alter(this,A),this},function(A){for(var S=0;S<A.length;S++)(function(J){D[J]=function(q){var ie,pe=this;return q?(setTimeout(function(){q.call(pe,D[J].call(pe))}),this):(ie=C[J](this),m(ie)?C(ie):ie)}})(A[S])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(A){for(var S=0;S<A.length;S++)(function(J){D[J]=function(q,ie){var pe=this;return ie?(setTimeout(function(){ie.call(pe,D[J].call(pe,q))}),this):C(C[J](this,q))}})(A[S])}("row col".split(" ")),function(A){for(var S=0;S<A.length;S++)(function(J){D[J]=function(){return C(C[J].apply(null,arguments))}})(A[S])}("create zeros ones rand identity".split(" ")),C}(Math),function(u,f){var k=u.utils.isFunction;function _(m,j){return m-j}function g(m,j,h){return f.max(j,f.min(m,h))}u.sum=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h];return j},u.sumsqrd=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h]*m[h];return j},u.sumsqerr=function(m){for(var j,h=u.mean(m),C=0,L=m.length;--L>=0;)C+=(j=m[L]-h)*j;return C},u.sumrow=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h];return j},u.product=function(m){for(var j=1,h=m.length;--h>=0;)j*=m[h];return j},u.min=function(m){for(var j=m[0],h=0;++h<m.length;)m[h]<j&&(j=m[h]);return j},u.max=function(m){for(var j=m[0],h=0;++h<m.length;)m[h]>j&&(j=m[h]);return j},u.unique=function(m){for(var j={},h=[],C=0;C<m.length;C++)j[m[C]]||(j[m[C]]=!0,h.push(m[C]));return h},u.mean=function(m){return u.sum(m)/m.length},u.meansqerr=function(m){return u.sumsqerr(m)/m.length},u.geomean=function(m){var j=m.map(f.log),h=u.mean(j);return f.exp(h)},u.median=function(m){var j=m.length,h=m.slice().sort(_);return 1&j?h[j/2|0]:(h[j/2-1]+h[j/2])/2},u.cumsum=function(m){return u.cumreduce(m,function(j,h){return j+h})},u.cumprod=function(m){return u.cumreduce(m,function(j,h){return j*h})},u.diff=function(m){var j,h=[],C=m.length;for(j=1;j<C;j++)h.push(m[j]-m[j-1]);return h},u.rank=function(m){var j,h=[],C={};for(j=0;j<m.length;j++)C[D=m[j]]?C[D]++:(C[D]=1,h.push(D));var L=h.sort(_),I={},B=1;for(j=0;j<L.length;j++){var D,A=C[D=L[j]],S=(B+(B+A-1))/2;I[D]=S,B+=A}return m.map(function(J){return I[J]})},u.mode=function(m){var j,h=m.length,C=m.slice().sort(_),L=1,I=0,B=0,D=[];for(j=0;j<h;j++)C[j]===C[j+1]?L++:(L>I?(D=[C[j]],I=L,B=0):L===I&&(D.push(C[j]),B++),L=1);return B===0?D[0]:D},u.range=function(m){return u.max(m)-u.min(m)},u.variance=function(m,j){return u.sumsqerr(m)/(m.length-(j?1:0))},u.pooledvariance=function(m){return m.reduce(function(j,h){return j+u.sumsqerr(h)},0)/(m.reduce(function(j,h){return j+h.length},0)-m.length)},u.deviation=function(m){for(var j=u.mean(m),h=m.length,C=new Array(h),L=0;L<h;L++)C[L]=m[L]-j;return C},u.stdev=function(m,j){return f.sqrt(u.variance(m,j))},u.pooledstdev=function(m){return f.sqrt(u.pooledvariance(m))},u.meandev=function(m){for(var j=u.mean(m),h=[],C=m.length-1;C>=0;C--)h.push(f.abs(m[C]-j));return u.mean(h)},u.meddev=function(m){for(var j=u.median(m),h=[],C=m.length-1;C>=0;C--)h.push(f.abs(m[C]-j));return u.median(h)},u.coeffvar=function(m){return u.stdev(m)/u.mean(m)},u.quartiles=function(m){var j=m.length,h=m.slice().sort(_);return[h[f.round(j/4)-1],h[f.round(j/2)-1],h[f.round(3*j/4)-1]]},u.quantiles=function(m,j,h,C){var L,I,B,D,A,S=m.slice().sort(_),J=[j.length],q=m.length;for(h===void 0&&(h=.375),C===void 0&&(C=.375),L=0;L<j.length;L++)B=q*(I=j[L])+(h+I*(1-h-C)),D=f.floor(g(B,1,q-1)),A=g(B-D,0,1),J[L]=(1-A)*S[D-1]+A*S[D];return J},u.percentile=function(m,j,h){var C=m.slice().sort(_),L=j*(C.length+(h?1:-1))+(h?0:1),I=parseInt(L),B=L-I;return I+1<C.length?C[I-1]+B*(C[I]-C[I-1]):C[I-1]},u.percentileOfScore=function(m,j,h){var C,L,I=0,B=m.length,D=!1;for(h==="strict"&&(D=!0),L=0;L<B;L++)C=m[L],(D&&C<j||!D&&C<=j)&&I++;return I/B},u.histogram=function(m,j){j=j||4;var h,C=u.min(m),L=(u.max(m)-C)/j,I=m.length,B=[];for(h=0;h<j;h++)B[h]=0;for(h=0;h<I;h++)B[f.min(f.floor((m[h]-C)/L),j-1)]+=1;return B},u.covariance=function(m,j){var h,C=u.mean(m),L=u.mean(j),I=m.length,B=new Array(I);for(h=0;h<I;h++)B[h]=(m[h]-C)*(j[h]-L);return u.sum(B)/(I-1)},u.corrcoeff=function(m,j){return u.covariance(m,j)/u.stdev(m,1)/u.stdev(j,1)},u.spearmancoeff=function(m,j){return m=u.rank(m),j=u.rank(j),u.corrcoeff(m,j)},u.stanMoment=function(m,j){for(var h=u.mean(m),C=u.stdev(m),L=m.length,I=0,B=0;B<L;B++)I+=f.pow((m[B]-h)/C,j);return I/m.length},u.skewness=function(m){return u.stanMoment(m,3)},u.kurtosis=function(m){return u.stanMoment(m,4)-3};var o=u.prototype;(function(m){for(var j=0;j<m.length;j++)(function(h){o[h]=function(C,L){var I=[],B=0,D=this;if(k(C)&&(L=C,C=!1),L)return setTimeout(function(){L.call(D,o[h].call(D,C))}),this;if(this.length>1){for(D=C===!0?this:this.transpose();B<D.length;B++)I[B]=u[h](D[B]);return I}return u[h](this[0],C)}})(m[j])})("cumsum cumprod".split(" ")),function(m){for(var j=0;j<m.length;j++)(function(h){o[h]=function(C,L){var I=[],B=0,D=this;if(k(C)&&(L=C,C=!1),L)return setTimeout(function(){L.call(D,o[h].call(D,C))}),this;if(this.length>1){for(h!=="sumrow"&&(D=C===!0?this:this.transpose());B<D.length;B++)I[B]=u[h](D[B]);return C===!0?u[h](u.utils.toVector(I)):I}return u[h](this[0],C)}})(m[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(m){for(var j=0;j<m.length;j++)(function(h){o[h]=function(){var C,L=[],I=0,B=this,D=Array.prototype.slice.call(arguments);if(k(D[D.length-1])){C=D[D.length-1];var A=D.slice(0,D.length-1);return setTimeout(function(){C.call(B,o[h].apply(B,A))}),this}C=void 0;var S=function(J){return u[h].apply(B,[J].concat(D))};if(this.length>1){for(B=B.transpose();I<B.length;I++)L[I]=S(B[I]);return L}return S(this[0])}})(m[j])}("quantiles percentileOfScore".split(" "))}(b,Math),function(u,f){u.gammaln=function(k){var _,g,o,m=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(o=(g=_=k)+5.5,o-=(_+.5)*f.log(o);m<6;m++)h+=j[m]/++g;return f.log(2.5066282746310007*h/_)-o},u.loggam=function(k){var _,g,o,m,j,h,C,L=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(_=k,C=0,k==1||k==2)return 0;for(k<=7&&(_=k+(C=f.floor(7-k))),g=1/(_*_),o=2*f.PI,j=L[9],h=8;h>=0;h--)j*=g,j+=L[h];if(m=j/_+.5*f.log(o)+(_-.5)*f.log(_)-_,k<=7)for(h=1;h<=C;h++)m-=f.log(_-1),_-=1;return m},u.gammafn=function(k){var _,g,o,m,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],C=!1,L=0,I=0,B=0,D=k;if(k>171.6243769536076)return 1/0;if(D<=0){if(!(m=D%1+36e-17))return 1/0;C=(1&D?-1:1)*f.PI/f.sin(f.PI*m),D=1-D}for(o=D,g=D<1?D++:(D-=L=(0|D)-1)-1,_=0;_<8;++_)B=(B+j[_])*g,I=I*g+h[_];if(m=B/I+1,o<D)m/=o;else if(o>D)for(_=0;_<L;++_)m*=D,D++;return C&&(m=C/m),m},u.gammap=function(k,_){return u.lowRegGamma(k,_)*u.gammafn(k)},u.lowRegGamma=function(k,_){var g,o=u.gammaln(k),m=k,j=1/k,h=j,C=_+1-k,L=1/1e-30,I=1/C,B=I,D=1,A=-~(8.5*f.log(k>=1?k:1/k)+.4*k+17);if(_<0||k<=0)return NaN;if(_<k+1){for(;D<=A;D++)j+=h*=_/++m;return j*f.exp(-_+k*f.log(_)-o)}for(;D<=A;D++)B*=(I=1/(I=(g=-D*(D-k))*I+(C+=2)))*(L=C+g/L);return 1-B*f.exp(-_+k*f.log(_)-o)},u.factorialln=function(k){return k<0?NaN:u.gammaln(k+1)},u.factorial=function(k){return k<0?NaN:u.gammafn(k+1)},u.combination=function(k,_){return k>170||_>170?f.exp(u.combinationln(k,_)):u.factorial(k)/u.factorial(_)/u.factorial(k-_)},u.combinationln=function(k,_){return u.factorialln(k)-u.factorialln(_)-u.factorialln(k-_)},u.permutation=function(k,_){return u.factorial(k)/u.factorial(k-_)},u.betafn=function(k,_){if(!(k<=0||_<=0))return k+_>170?f.exp(u.betaln(k,_)):u.gammafn(k)*u.gammafn(_)/u.gammafn(k+_)},u.betaln=function(k,_){return u.gammaln(k)+u.gammaln(_)-u.gammaln(k+_)},u.betacf=function(k,_,g){var o,m,j,h,C=1e-30,L=1,I=_+g,B=_+1,D=_-1,A=1,S=1-I*k/B;for(f.abs(S)<C&&(S=C),h=S=1/S;L<=100&&(S=1+(m=L*(g-L)*k/((D+(o=2*L))*(_+o)))*S,f.abs(S)<C&&(S=C),A=1+m/A,f.abs(A)<C&&(A=C),h*=(S=1/S)*A,S=1+(m=-(_+L)*(I+L)*k/((_+o)*(B+o)))*S,f.abs(S)<C&&(S=C),A=1+m/A,f.abs(A)<C&&(A=C),h*=j=(S=1/S)*A,!(f.abs(j-1)<3e-7));L++);return h},u.gammapinv=function(k,_){var g,o,m,j,h,C,L=0,I=_-1,B=u.gammaln(_);if(k>=1)return f.max(100,_+100*f.sqrt(_));if(k<=0)return 0;for(_>1?(h=f.log(I),C=f.exp(I*(h-1)-B),j=k<.5?k:1-k,g=(2.30753+.27061*(o=f.sqrt(-2*f.log(j))))/(1+o*(.99229+.04481*o))-o,k<.5&&(g=-g),g=f.max(.001,_*f.pow(1-1/(9*_)-g/(3*f.sqrt(_)),3))):g=k<(o=1-_*(.253+.12*_))?f.pow(k/o,1/_):1-f.log(1-(k-o)/(1-o));L<12;L++){if(g<=0)return 0;if((g-=o=(m=(u.lowRegGamma(_,g)-k)/(o=_>1?C*f.exp(-(g-I)+I*(f.log(g)-h)):f.exp(-g+I*f.log(g)-B)))/(1-.5*f.min(1,m*((_-1)/g-1))))<=0&&(g=.5*(g+o)),f.abs(o)<1e-8*g)break}return g},u.erf=function(k){var _,g,o,m,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=j.length-1,C=!1,L=0,I=0;for(k<0&&(k=-k,C=!0),g=4*(_=2/(2+k))-2;h>0;h--)o=L,L=g*L-I+j[h],I=o;return m=_*f.exp(-k*k+.5*(j[0]+g*L)-I),C?m-1:1-m},u.erfc=function(k){return 1-u.erf(k)},u.erfcinv=function(k){var _,g,o,m,j=0;if(k>=2)return-100;if(k<=0)return 100;for(m=k<1?k:2-k,_=-.70711*((2.30753+.27061*(o=f.sqrt(-2*f.log(m/2))))/(1+o*(.99229+.04481*o))-o);j<2;j++)_+=(g=u.erfc(_)-m)/(1.1283791670955126*f.exp(-_*_)-_*g);return k<1?_:-_},u.ibetainv=function(k,_,g){var o,m,j,h,C,L,I,B,D,A,S=_-1,J=g-1,q=0;if(k<=0)return 0;if(k>=1)return 1;for(_>=1&&g>=1?(j=k<.5?k:1-k,L=(2.30753+.27061*(h=f.sqrt(-2*f.log(j))))/(1+h*(.99229+.04481*h))-h,k<.5&&(L=-L),I=(L*L-3)/6,B=2/(1/(2*_-1)+1/(2*g-1)),D=L*f.sqrt(I+B)/B-(1/(2*g-1)-1/(2*_-1))*(I+.8333333333333334-2/(3*B)),L=_/(_+g*f.exp(2*D))):(o=f.log(_/(_+g)),m=f.log(g/(_+g)),L=k<(h=f.exp(_*o)/_)/(D=h+(C=f.exp(g*m)/g))?f.pow(_*D*k,1/_):1-f.pow(g*D*(1-k),1/g)),A=-u.gammaln(_)-u.gammaln(g)+u.gammaln(_+g);q<10;q++){if(L===0||L===1)return L;if((L-=h=(C=(u.ibeta(L,_,g)-k)/(h=f.exp(S*f.log(L)+J*f.log(1-L)+A)))/(1-.5*f.min(1,C*(S/L-J/(1-L)))))<=0&&(L=.5*(L+h)),L>=1&&(L=.5*(L+h+1)),f.abs(h)<1e-8*L&&q>0)break}return L},u.ibeta=function(k,_,g){var o=k===0||k===1?0:f.exp(u.gammaln(_+g)-u.gammaln(_)-u.gammaln(g)+_*f.log(k)+g*f.log(1-k));return!(k<0||k>1)&&(k<(_+1)/(_+g+2)?o*u.betacf(k,_,g)/_:1-o*u.betacf(1-k,g,_)/g)},u.randn=function(k,_){var g,o,m,j,h;if(_||(_=k),k)return u.create(k,_,function(){return u.randn()});do g=u._random_fn(),o=1.7156*(u._random_fn()-.5),h=(m=g-.449871)*m+(j=f.abs(o)+.386595)*(.196*j-.25472*m);while(h>.27597&&(h>.27846||o*o>-4*f.log(g)*g*g));return o/g},u.randg=function(k,_,g){var o,m,j,h,C,L,I=k;if(g||(g=_),k||(k=1),_)return(L=u.zeros(_,g)).alter(function(){return u.randg(k)}),L;k<1&&(k+=1),o=k-.3333333333333333,m=1/f.sqrt(9*o);do{do h=1+m*(C=u.randn());while(h<=0);h*=h*h,j=u._random_fn()}while(j>1-.331*f.pow(C,4)&&f.log(j)>.5*C*C+o*(1-h+f.log(h)));if(k==I)return o*h;do j=u._random_fn();while(j===0);return f.pow(j,1/I)*o*h},function(k){for(var _=0;_<k.length;_++)(function(g){u.fn[g]=function(){return u(u.map(this,function(o){return u[g](o)}))}})(k[_])}("gammaln gammafn factorial factorialln".split(" ")),function(k){for(var _=0;_<k.length;_++)(function(g){u.fn[g]=function(){return u(u[g].apply(null,arguments))}})(k[_])}("randn".split(" "))}(b,Math),function(u,f){function k(g,o,m,j){for(var h,C=0,L=1,I=1,B=1,D=0,A=0;f.abs((I-A)/I)>j;)A=I,L=B+(h=-(o+D)*(o+m+D)*g/(o+2*D)/(o+2*D+1))*L,I=(C=I+h*C)+(h=(D+=1)*(m-D)*g/(o+2*D-1)/(o+2*D))*I,C/=B=L+h*B,L/=B,I/=B,B=1;return I/o}function _(g,o,m){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],h=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],C=.5*g;if(C>=8)return 1;var L,I=2*u.normal.cdf(C,0,1,1,0)-1;I=I>=f.exp(-50/m)?f.pow(I,m):0;for(var B=C,D=(8-C)/(L=g>3?2:3),A=B+D,S=0,J=m-1,q=1;q<=L;q++){for(var ie=0,pe=.5*(A+B),se=.5*(A-B),be=1;be<=12;be++){var Me,me=pe+se*(6<be?j[(Me=12-be+1)-1]:-j[(Me=be)-1]),ae=me*me;if(ae>60)break;var Pe=2*u.normal.cdf(me,0,1,1,0)*.5-2*u.normal.cdf(me,g,1,1,0)*.5;Pe>=f.exp(-30/J)&&(ie+=Pe=h[Me-1]*f.exp(-.5*ae)*f.pow(Pe,J))}S+=ie*=2*se*m/f.sqrt(2*f.PI),B=A,A+=D}return(I+=S)<=f.exp(-30/o)?0:(I=f.pow(I,o))>=1?1:I}(function(g){for(var o=0;o<g.length;o++)(function(m){u[m]=function j(h,C,L){return this instanceof j?(this._a=h,this._b=C,this._c=L,this):new j(h,C,L)},u.fn[m]=function(j,h,C){var L=u[m](j,h,C);return L.data=this,L},u[m].prototype.sample=function(j){var h=this._a,C=this._b,L=this._c;return j?u.alter(j,function(){return u[m].sample(h,C,L)}):u[m].sample(h,C,L)},function(j){for(var h=0;h<j.length;h++)(function(C){u[m].prototype[C]=function(L){var I=this._a,B=this._b,D=this._c;return L||L===0||(L=this.data),typeof L!="number"?u.fn.map.call(L,function(A){return u[m][C](A,I,B,D)}):u[m][C](L,I,B,D)}})(j[h])}("pdf cdf inv".split(" ")),function(j){for(var h=0;h<j.length;h++)(function(C){u[m].prototype[C]=function(){return u[m][C](this._a,this._b,this._c)}})(j[h])}("mean median mode variance".split(" "))})(g[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),u.extend(u.beta,{pdf:function(g,o,m){return g>1||g<0?0:o==1&&m==1?1:o<512&&m<512?f.pow(g,o-1)*f.pow(1-g,m-1)/u.betafn(o,m):f.exp((o-1)*f.log(g)+(m-1)*f.log(1-g)-u.betaln(o,m))},cdf:function(g,o,m){return g>1||g<0?1*(g>1):u.ibeta(g,o,m)},inv:function(g,o,m){return u.ibetainv(g,o,m)},mean:function(g,o){return g/(g+o)},median:function(g,o){return u.ibetainv(.5,g,o)},mode:function(g,o){return(g-1)/(g+o-2)},sample:function(g,o){var m=u.randg(g);return m/(m+u.randg(o))},variance:function(g,o){return g*o/(f.pow(g+o,2)*(g+o+1))}}),u.extend(u.centralF,{pdf:function(g,o,m){var j;return g<0?0:o<=2?g===0&&o<2?1/0:g===0&&o===2?1:1/u.betafn(o/2,m/2)*f.pow(o/m,o/2)*f.pow(g,o/2-1)*f.pow(1+o/m*g,-(o+m)/2):(j=o*g/(m+g*o),o*(m/(m+g*o))/2*u.binomial.pdf((o-2)/2,(o+m-2)/2,j))},cdf:function(g,o,m){return g<0?0:u.ibeta(o*g/(o*g+m),o/2,m/2)},inv:function(g,o,m){return m/(o*(1/u.ibetainv(g,o/2,m/2)-1))},mean:function(g,o){return o>2?o/(o-2):void 0},mode:function(g,o){return g>2?o*(g-2)/(g*(o+2)):void 0},sample:function(g,o){return 2*u.randg(g/2)/g/(2*u.randg(o/2)/o)},variance:function(g,o){if(!(o<=4))return 2*o*o*(g+o-2)/(g*(o-2)*(o-2)*(o-4))}}),u.extend(u.cauchy,{pdf:function(g,o,m){return m<0?0:m/(f.pow(g-o,2)+f.pow(m,2))/f.PI},cdf:function(g,o,m){return f.atan((g-o)/m)/f.PI+.5},inv:function(g,o,m){return o+m*f.tan(f.PI*(g-.5))},median:function(g){return g},mode:function(g){return g},sample:function(g,o){return u.randn()*f.sqrt(1/(2*u.randg(.5)))*o+g}}),u.extend(u.chisquare,{pdf:function(g,o){return g<0?0:g===0&&o===2?.5:f.exp((o/2-1)*f.log(g)-g/2-o/2*f.log(2)-u.gammaln(o/2))},cdf:function(g,o){return g<0?0:u.lowRegGamma(o/2,g/2)},inv:function(g,o){return 2*u.gammapinv(g,.5*o)},mean:function(g){return g},median:function(g){return g*f.pow(1-2/(9*g),3)},mode:function(g){return g-2>0?g-2:0},sample:function(g){return 2*u.randg(g/2)},variance:function(g){return 2*g}}),u.extend(u.exponential,{pdf:function(g,o){return g<0?0:o*f.exp(-o*g)},cdf:function(g,o){return g<0?0:1-f.exp(-o*g)},inv:function(g,o){return-f.log(1-g)/o},mean:function(g){return 1/g},median:function(g){return 1/g*f.log(2)},mode:function(){return 0},sample:function(g){return-1/g*f.log(u._random_fn())},variance:function(g){return f.pow(g,-2)}}),u.extend(u.gamma,{pdf:function(g,o,m){return g<0?0:g===0&&o===1?1/m:f.exp((o-1)*f.log(g)-g/m-u.gammaln(o)-o*f.log(m))},cdf:function(g,o,m){return g<0?0:u.lowRegGamma(o,g/m)},inv:function(g,o,m){return u.gammapinv(g,o)*m},mean:function(g,o){return g*o},mode:function(g,o){if(g>1)return(g-1)*o},sample:function(g,o){return u.randg(g)*o},variance:function(g,o){return g*o*o}}),u.extend(u.invgamma,{pdf:function(g,o,m){return g<=0?0:f.exp(-(o+1)*f.log(g)-m/g-u.gammaln(o)+o*f.log(m))},cdf:function(g,o,m){return g<=0?0:1-u.lowRegGamma(o,m/g)},inv:function(g,o,m){return m/u.gammapinv(1-g,o)},mean:function(g,o){return g>1?o/(g-1):void 0},mode:function(g,o){return o/(g+1)},sample:function(g,o){return o/u.randg(g)},variance:function(g,o){if(!(g<=2))return o*o/((g-1)*(g-1)*(g-2))}}),u.extend(u.kumaraswamy,{pdf:function(g,o,m){return g===0&&o===1?m:g===1&&m===1?o:f.exp(f.log(o)+f.log(m)+(o-1)*f.log(g)+(m-1)*f.log(1-f.pow(g,o)))},cdf:function(g,o,m){return g<0?0:g>1?1:1-f.pow(1-f.pow(g,o),m)},inv:function(g,o,m){return f.pow(1-f.pow(1-g,1/m),1/o)},mean:function(g,o){return o*u.gammafn(1+1/g)*u.gammafn(o)/u.gammafn(1+1/g+o)},median:function(g,o){return f.pow(1-f.pow(2,-1/o),1/g)},mode:function(g,o){if(g>=1&&o>=1&&g!==1&&o!==1)return f.pow((g-1)/(g*o-1),1/g)},variance:function(){throw new Error("variance not yet implemented")}}),u.extend(u.lognormal,{pdf:function(g,o,m){return g<=0?0:f.exp(-f.log(g)-.5*f.log(2*f.PI)-f.log(m)-f.pow(f.log(g)-o,2)/(2*m*m))},cdf:function(g,o,m){return g<0?0:.5+.5*u.erf((f.log(g)-o)/f.sqrt(2*m*m))},inv:function(g,o,m){return f.exp(-1.4142135623730951*m*u.erfcinv(2*g)+o)},mean:function(g,o){return f.exp(g+o*o/2)},median:function(g){return f.exp(g)},mode:function(g,o){return f.exp(g-o*o)},sample:function(g,o){return f.exp(u.randn()*o+g)},variance:function(g,o){return(f.exp(o*o)-1)*f.exp(2*g+o*o)}}),u.extend(u.noncentralt,{pdf:function(g,o,m){return f.abs(m)<1e-14?u.studentt.pdf(g,o):f.abs(g)<1e-14?f.exp(u.gammaln((o+1)/2)-m*m/2-.5*f.log(f.PI*o)-u.gammaln(o/2)):o/g*(u.noncentralt.cdf(g*f.sqrt(1+2/o),o+2,m)-u.noncentralt.cdf(g,o,m))},cdf:function(g,o,m){var j=1e-14;if(f.abs(m)<j)return u.studentt.cdf(g,o);var h=!1;g<0&&(h=!0,m=-m);for(var C=u.normal.cdf(-m,0,1),L=j+1,I=L,B=g*g/(g*g+o),D=0,A=f.exp(-m*m/2),S=f.exp(-m*m/2-.5*f.log(2)-u.gammaln(1.5))*m;D<200||I>j||L>j;)I=L,D>0&&(A*=m*m/(2*D),S*=m*m/(2*(D+.5))),C+=.5*(L=A*u.beta.cdf(B,D+.5,o/2)+S*u.beta.cdf(B,D+1,o/2)),D++;return h?1-C:C}}),u.extend(u.normal,{pdf:function(g,o,m){return f.exp(-.5*f.log(2*f.PI)-f.log(m)-f.pow(g-o,2)/(2*m*m))},cdf:function(g,o,m){return .5*(1+u.erf((g-o)/f.sqrt(2*m*m)))},inv:function(g,o,m){return-1.4142135623730951*m*u.erfcinv(2*g)+o},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},sample:function(g,o){return u.randn()*o+g},variance:function(g,o){return o*o}}),u.extend(u.pareto,{pdf:function(g,o,m){return g<o?0:m*f.pow(o,m)/f.pow(g,m+1)},cdf:function(g,o,m){return g<o?0:1-f.pow(o/g,m)},inv:function(g,o,m){return o/f.pow(1-g,1/m)},mean:function(g,o){if(!(o<=1))return o*f.pow(g,o)/(o-1)},median:function(g,o){return g*(o*f.SQRT2)},mode:function(g){return g},variance:function(g,o){if(!(o<=2))return g*g*o/(f.pow(o-1,2)*(o-2))}}),u.extend(u.studentt,{pdf:function(g,o){return o=o>1e100?1e100:o,1/(f.sqrt(o)*u.betafn(.5,o/2))*f.pow(1+g*g/o,-(o+1)/2)},cdf:function(g,o){var m=o/2;return u.ibeta((g+f.sqrt(g*g+o))/(2*f.sqrt(g*g+o)),m,m)},inv:function(g,o){var m=u.ibetainv(2*f.min(g,1-g),.5*o,.5);return m=f.sqrt(o*(1-m)/m),g>.5?m:-m},mean:function(g){return g>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(g){return u.randn()*f.sqrt(g/(2*u.randg(g/2)))},variance:function(g){return g>2?g/(g-2):g>1?1/0:void 0}}),u.extend(u.weibull,{pdf:function(g,o,m){return g<0||o<0||m<0?0:m/o*f.pow(g/o,m-1)*f.exp(-f.pow(g/o,m))},cdf:function(g,o,m){return g<0?0:1-f.exp(-f.pow(g/o,m))},inv:function(g,o,m){return o*f.pow(-f.log(1-g),1/m)},mean:function(g,o){return g*u.gammafn(1+1/o)},median:function(g,o){return g*f.pow(f.log(2),1/o)},mode:function(g,o){return o<=1?0:g*f.pow((o-1)/o,1/o)},sample:function(g,o){return g*f.pow(-f.log(u._random_fn()),1/o)},variance:function(g,o){return g*g*u.gammafn(1+2/o)-f.pow(u.weibull.mean(g,o),2)}}),u.extend(u.uniform,{pdf:function(g,o,m){return g<o||g>m?0:1/(m-o)},cdf:function(g,o,m){return g<o?0:g<m?(g-o)/(m-o):1},inv:function(g,o,m){return o+g*(m-o)},mean:function(g,o){return .5*(g+o)},median:function(g,o){return u.mean(g,o)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,o){return g/2+o/2+(o/2-g/2)*(2*u._random_fn()-1)},variance:function(g,o){return f.pow(o-g,2)/12}}),u.extend(u.binomial,{pdf:function(g,o,m){return m===0||m===1?o*m===g?1:0:u.combination(o,g)*f.pow(m,g)*f.pow(1-m,o-g)},cdf:function(g,o,m){var j,h=1e-10;if(g<0)return 0;if(g>=o)return 1;if(m<0||m>1||o<=0)return NaN;var C=m,L=(g=f.floor(g))+1,I=o-g,B=L+I,D=f.exp(u.gammaln(B)-u.gammaln(I)-u.gammaln(L)+L*f.log(C)+I*f.log(1-C));return j=C<(L+1)/(B+2)?D*k(C,L,I,h):1-D*k(1-C,I,L,h),f.round(1/h*(1-j))/(1/h)}}),u.extend(u.negbin,{pdf:function(g,o,m){return g===g>>>0&&(g<0?0:u.combination(g+o-1,o-1)*f.pow(1-m,g)*f.pow(m,o))},cdf:function(g,o,m){var j=0,h=0;if(g<0)return 0;for(;h<=g;h++)j+=u.negbin.pdf(h,o,m);return j}}),u.extend(u.hypgeom,{pdf:function(g,o,m,j){if(g!=g|0)return!1;if(g<0||g<m-(o-j)||g>j||g>m)return 0;if(2*m>o)return 2*j>o?u.hypgeom.pdf(o-m-j+g,o,o-m,o-j):u.hypgeom.pdf(j-g,o,o-m,j);if(2*j>o)return u.hypgeom.pdf(m-g,o,m,o-j);if(m<j)return u.hypgeom.pdf(g,o,j,m);for(var h=1,C=0,L=0;L<g;L++){for(;h>1&&C<j;)h*=1-m/(o-C),C++;h*=(j-L)*(m-L)/((L+1)*(o-m-j+L+1))}for(;C<j;C++)h*=1-m/(o-C);return f.min(1,f.max(0,h))},cdf:function(g,o,m,j){if(g<0||g<m-(o-j))return 0;if(g>=j||g>=m)return 1;if(2*m>o)return 2*j>o?u.hypgeom.cdf(o-m-j+g,o,o-m,o-j):1-u.hypgeom.cdf(j-g-1,o,o-m,j);if(2*j>o)return 1-u.hypgeom.cdf(m-g-1,o,m,o-j);if(m<j)return u.hypgeom.cdf(g,o,j,m);for(var h=1,C=1,L=0,I=0;I<g;I++){for(;h>1&&L<j;){var B=1-m/(o-L);C*=B,h*=B,L++}h+=C*=(j-I)*(m-I)/((I+1)*(o-m-j+I+1))}for(;L<j;L++)h*=1-m/(o-L);return f.min(1,f.max(0,h))}}),u.extend(u.poisson,{pdf:function(g,o){return o<0||g%1!=0||g<0?0:f.pow(o,g)*f.exp(-o)/u.factorial(g)},cdf:function(g,o){var m=[],j=0;if(g<0)return 0;for(;j<=g;j++)m.push(u.poisson.pdf(j,o));return u.sum(m)},mean:function(g){return g},variance:function(g){return g},sampleSmall:function(g){var o=1,m=0,j=f.exp(-g);do m++,o*=u._random_fn();while(o>j);return m-1},sampleLarge:function(g){var o,m,j,h,C,L,I,B,D,A,S=g;for(h=f.sqrt(S),C=f.log(S),L=.02483*(I=.931+2.53*h)-.059,B=1.1239+1.1328/(I-3.4),D=.9277-3.6224/(I-2);;)if(m=f.random()-.5,j=f.random(),A=.5-f.abs(m),o=f.floor((2*L/A+I)*m+S+.43),A>=.07&&j<=D||!(o<0||A<.013&&j>A)&&f.log(j)+f.log(B)-f.log(L/(A*A)+I)<=o*C-S-u.loggam(o+1))return o},sample:function(g){return g<10?this.sampleSmall(g):this.sampleLarge(g)}}),u.extend(u.triangular,{pdf:function(g,o,m,j){return m<=o||j<o||j>m?NaN:g<o||g>m?0:g<j?2*(g-o)/((m-o)*(j-o)):g===j?2/(m-o):2*(m-g)/((m-o)*(m-j))},cdf:function(g,o,m,j){return m<=o||j<o||j>m?NaN:g<=o?0:g>=m?1:g<=j?f.pow(g-o,2)/((m-o)*(j-o)):1-f.pow(m-g,2)/((m-o)*(m-j))},inv:function(g,o,m,j){return m<=o||j<o||j>m?NaN:g<=(j-o)/(m-o)?o+(m-o)*f.sqrt(g*((j-o)/(m-o))):o+(m-o)*(1-f.sqrt((1-g)*(1-(j-o)/(m-o))))},mean:function(g,o,m){return(g+o+m)/3},median:function(g,o,m){return m<=(g+o)/2?o-f.sqrt((o-g)*(o-m))/f.sqrt(2):m>(g+o)/2?g+f.sqrt((o-g)*(m-g))/f.sqrt(2):void 0},mode:function(g,o,m){return m},sample:function(g,o,m){var j=u._random_fn();return j<(m-g)/(o-g)?g+f.sqrt(j*(o-g)*(m-g)):o-f.sqrt((1-j)*(o-g)*(o-m))},variance:function(g,o,m){return(g*g+o*o+m*m-g*o-g*m-o*m)/18}}),u.extend(u.arcsine,{pdf:function(g,o,m){return m<=o?NaN:g<=o||g>=m?0:2/f.PI*f.pow(f.pow(m-o,2)-f.pow(2*g-o-m,2),-.5)},cdf:function(g,o,m){return g<o?0:g<m?2/f.PI*f.asin(f.sqrt((g-o)/(m-o))):1},inv:function(g,o,m){return o+(.5-.5*f.cos(f.PI*g))*(m-o)},mean:function(g,o){return o<=g?NaN:(g+o)/2},median:function(g,o){return o<=g?NaN:(g+o)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,o){return(g+o)/2+(o-g)/2*f.sin(2*f.PI*u.uniform.sample(0,1))},variance:function(g,o){return o<=g?NaN:f.pow(o-g,2)/8}}),u.extend(u.laplace,{pdf:function(g,o,m){return m<=0?0:f.exp(-f.abs(g-o)/m)/(2*m)},cdf:function(g,o,m){return m<=0?0:g<o?.5*f.exp((g-o)/m):1-.5*f.exp(-(g-o)/m)},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},variance:function(g,o){return 2*o*o},sample:function(g,o){var m,j=u._random_fn()-.5;return g-o*((m=j)/f.abs(m))*f.log(1-2*f.abs(j))}}),u.extend(u.tukey,{cdf:function(g,o,m){var j=o,h=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(g<=0)return 0;if(m<2||j<2)return NaN;if(!Number.isFinite(g))return 1;if(m>25e3)return _(g,1,j);var L,I=.5*m,B=I*f.log(m)-m*f.log(2)-u.gammaln(I),D=I-1,A=.25*m;L=m<=100?1:m<=800?.5:m<=5e3?.25:.125,B+=f.log(L);for(var S=0,J=1;J<=50;J++){for(var q=0,ie=(2*J-1)*L,pe=1;pe<=16;pe++){var se,be;8<pe?(se=pe-8-1,be=B+D*f.log(ie+h[se]*L)-(h[se]*L+ie)*A):(se=pe-1,be=B+D*f.log(ie-h[se]*L)+(h[se]*L-ie)*A),be>=-30&&(q+=_(8<pe?g*f.sqrt(.5*(h[se]*L+ie)):g*f.sqrt(.5*(-h[se]*L+ie)),1,j)*C[se]*f.exp(be))}if(J*L>=1&&q<=1e-14)break;S+=q}if(q>1e-14)throw new Error("tukey.cdf failed to converge");return S>1&&(S=1),S},inv:function(g,o,m){if(m<2||o<2)return NaN;if(g<0||g>1)return NaN;if(g===0)return 0;if(g===1)return 1/0;var j,h=function(D,A,S){var J=.5-.5*D,q=f.sqrt(f.log(1/(J*J))),ie=q+((((-453642210148e-16*q-.204231210125)*q-.342242088547)*q-1)*q+.322232421088)/((((.0038560700634*q+.10353775285)*q+.531103462366)*q+.588581570495)*q+.099348462606);S<120&&(ie+=(ie*ie*ie+ie)/S/4);var pe=.8832-.2368*ie;return S<120&&(pe+=-1.214/S+1.208*ie/S),ie*(pe*f.log(A-1)+1.4142)}(g,o,m),C=u.tukey.cdf(h,o,m)-g;j=C>0?f.max(0,h-1):h+1;for(var L,I=u.tukey.cdf(j,o,m)-g,B=1;B<50;B++)if(L=j-I*(j-h)/(I-C),C=I,h=j,L<0&&(L=0,I=-g),I=u.tukey.cdf(L,o,m)-g,j=L,f.abs(j-h)<1e-4)return L;throw new Error("tukey.inv failed to converge")}})}(b,Math),function(u,f){var k,_,g=Array.prototype.push,o=u.utils.isArray;function m(j){return o(j)||j instanceof u}u.extend({add:function(j,h){return m(h)?(m(h[0])||(h=[h]),u.map(j,function(C,L,I){return C+h[L][I]})):u.map(j,function(C){return C+h})},subtract:function(j,h){return m(h)?(m(h[0])||(h=[h]),u.map(j,function(C,L,I){return C-h[L][I]||0})):u.map(j,function(C){return C-h})},divide:function(j,h){return m(h)?(m(h[0])||(h=[h]),u.multiply(j,u.inv(h))):u.map(j,function(C){return C/h})},multiply:function(j,h){var C,L,I,B,D,A,S,J;if(j.length===void 0&&h.length===void 0)return j*h;if(D=j.length,A=j[0].length,S=u.zeros(D,I=m(h)?h[0].length:A),J=0,m(h)){for(;J<I;J++)for(C=0;C<D;C++){for(B=0,L=0;L<A;L++)B+=j[C][L]*h[L][J];S[C][J]=B}return D===1&&J===1?S[0][0]:S}return u.map(j,function(q){return q*h})},outer:function(j,h){return u.multiply(j.map(function(C){return[C]}),[h])},dot:function(j,h){m(j[0])||(j=[j]),m(h[0])||(h=[h]);for(var C,L,I=j[0].length===1&&j.length!==1?u.transpose(j):j,B=h[0].length===1&&h.length!==1?u.transpose(h):h,D=[],A=0,S=I.length,J=I[0].length;A<S;A++){for(D[A]=[],C=0,L=0;L<J;L++)C+=I[A][L]*B[A][L];D[A]=C}return D.length===1?D[0]:D},pow:function(j,h){return u.map(j,function(C){return f.pow(C,h)})},exp:function(j){return u.map(j,function(h){return f.exp(h)})},log:function(j){return u.map(j,function(h){return f.log(h)})},abs:function(j){return u.map(j,function(h){return f.abs(h)})},norm:function(j,h){var C=0,L=0;for(isNaN(h)&&(h=2),m(j[0])&&(j=j[0]);L<j.length;L++)C+=f.pow(f.abs(j[L]),h);return f.pow(C,1/h)},angle:function(j,h){return f.acos(u.dot(j,h)/(u.norm(j)*u.norm(h)))},aug:function(j,h){var C,L=[];for(C=0;C<j.length;C++)L.push(j[C].slice());for(C=0;C<L.length;C++)g.apply(L[C],h[C]);return L},inv:function(j){for(var h,C=j.length,L=j[0].length,I=u.identity(C,L),B=u.gauss_jordan(j,I),D=[],A=0;A<C;A++)for(D[A]=[],h=L;h<B[0].length;h++)D[A][h-L]=B[A][h];return D},det:function j(h){if(h.length===2)return h[0][0]*h[1][1]-h[0][1]*h[1][0];for(var C=0,L=0;L<h.length;L++){for(var I=[],B=1;B<h.length;B++){I[B-1]=[];for(var D=0;D<h.length;D++)D<L?I[B-1][D]=h[B][D]:D>L&&(I[B-1][D-1]=h[B][D])}var A=L%2?-1:1;C+=j(I)*h[0][L]*A}return C},gauss_elimination:function(j,h){var C,L,I,B,D=0,A=0,S=j.length,J=j[0].length,q=1,ie=0,pe=[];for(C=(j=u.aug(j,h))[0].length,D=0;D<S;D++){for(L=j[D][D],A=D,B=D+1;B<J;B++)L<f.abs(j[B][D])&&(L=j[B][D],A=B);if(A!=D)for(B=0;B<C;B++)I=j[D][B],j[D][B]=j[A][B],j[A][B]=I;for(A=D+1;A<S;A++)for(q=j[A][D]/j[D][D],B=D;B<C;B++)j[A][B]=j[A][B]-q*j[D][B]}for(D=S-1;D>=0;D--){for(ie=0,A=D+1;A<=S-1;A++)ie+=pe[A]*j[D][A];pe[D]=(j[D][C-1]-ie)/j[D][D]}return pe},gauss_jordan:function(j,h){var C,L,I,B=u.aug(j,h),D=B.length,A=B[0].length,S=0;for(L=0;L<D;L++){var J=L;for(I=L+1;I<D;I++)f.abs(B[I][L])>f.abs(B[J][L])&&(J=I);var q=B[L];for(B[L]=B[J],B[J]=q,I=L+1;I<D;I++)for(S=B[I][L]/B[L][L],C=L;C<A;C++)B[I][C]-=B[L][C]*S}for(L=D-1;L>=0;L--){for(S=B[L][L],I=0;I<L;I++)for(C=A-1;C>L-1;C--)B[I][C]-=B[L][C]*B[I][L]/S;for(B[L][L]/=S,C=D;C<A;C++)B[L][C]/=S}return B},triaUpSolve:function(j,h){var C,L=j[0].length,I=u.zeros(1,L)[0],B=!1;return h[0].length!=null&&(h=h.map(function(D){return D[0]}),B=!0),u.arange(L-1,-1,-1).forEach(function(D){C=u.arange(D+1,L).map(function(A){return I[A]*j[D][A]}),I[D]=(h[D]-u.sum(C))/j[D][D]}),B?I.map(function(D){return[D]}):I},triaLowSolve:function(j,h){var C,L=j[0].length,I=u.zeros(1,L)[0],B=!1;return h[0].length!=null&&(h=h.map(function(D){return D[0]}),B=!0),u.arange(L).forEach(function(D){C=u.arange(D).map(function(A){return j[D][A]*I[A]}),I[D]=(h[D]-u.sum(C))/j[D][D]}),B?I.map(function(D){return[D]}):I},lu:function(j){var h,C=j.length,L=u.identity(C),I=u.zeros(j.length,j[0].length);return u.arange(C).forEach(function(B){I[0][B]=j[0][B]}),u.arange(1,C).forEach(function(B){u.arange(B).forEach(function(D){h=u.arange(D).map(function(A){return L[B][A]*I[A][D]}),L[B][D]=(j[B][D]-u.sum(h))/I[D][D]}),u.arange(B,C).forEach(function(D){h=u.arange(B).map(function(A){return L[B][A]*I[A][D]}),I[B][D]=j[h.length][D]-u.sum(h)})}),[L,I]},cholesky:function(j){var h,C=j.length,L=u.zeros(j.length,j[0].length);return u.arange(C).forEach(function(I){h=u.arange(I).map(function(B){return f.pow(L[I][B],2)}),L[I][I]=f.sqrt(j[I][I]-u.sum(h)),u.arange(I+1,C).forEach(function(B){h=u.arange(I).map(function(D){return L[I][D]*L[B][D]}),L[B][I]=(j[I][B]-u.sum(h))/L[I][I]})}),L},gauss_jacobi:function(j,h,C,L){for(var I,B,D,A,S=0,J=0,q=j.length,ie=[],pe=[],se=[];S<q;S++)for(ie[S]=[],pe[S]=[],se[S]=[],J=0;J<q;J++)S>J?(ie[S][J]=j[S][J],pe[S][J]=se[S][J]=0):S<J?(pe[S][J]=j[S][J],ie[S][J]=se[S][J]=0):(se[S][J]=j[S][J],ie[S][J]=pe[S][J]=0);for(D=u.multiply(u.multiply(u.inv(se),u.add(ie,pe)),-1),B=u.multiply(u.inv(se),h),I=C,A=u.add(u.multiply(D,C),B),S=2;f.abs(u.norm(u.subtract(A,I)))>L;)I=A,A=u.add(u.multiply(D,I),B),S++;return A},gauss_seidel:function(j,h,C,L){for(var I,B,D,A,S,J=0,q=j.length,ie=[],pe=[],se=[];J<q;J++)for(ie[J]=[],pe[J]=[],se[J]=[],I=0;I<q;I++)J>I?(ie[J][I]=j[J][I],pe[J][I]=se[J][I]=0):J<I?(pe[J][I]=j[J][I],ie[J][I]=se[J][I]=0):(se[J][I]=j[J][I],ie[J][I]=pe[J][I]=0);for(A=u.multiply(u.multiply(u.inv(u.add(se,ie)),pe),-1),D=u.multiply(u.inv(u.add(se,ie)),h),B=C,S=u.add(u.multiply(A,C),D),J=2;f.abs(u.norm(u.subtract(S,B)))>L;)B=S,S=u.add(u.multiply(A,B),D),J+=1;return S},SOR:function(j,h,C,L,I){for(var B,D,A,S,J,q=0,ie=j.length,pe=[],se=[],be=[];q<ie;q++)for(pe[q]=[],se[q]=[],be[q]=[],B=0;B<ie;B++)q>B?(pe[q][B]=j[q][B],se[q][B]=be[q][B]=0):q<B?(se[q][B]=j[q][B],pe[q][B]=be[q][B]=0):(be[q][B]=j[q][B],pe[q][B]=se[q][B]=0);for(S=u.multiply(u.inv(u.add(be,u.multiply(pe,I))),u.subtract(u.multiply(be,1-I),u.multiply(se,I))),A=u.multiply(u.multiply(u.inv(u.add(be,u.multiply(pe,I))),h),I),D=C,J=u.add(u.multiply(S,C),A),q=2;f.abs(u.norm(u.subtract(J,D)))>L;)D=J,J=u.add(u.multiply(S,D),A),q++;return J},householder:function(j){for(var h,C,L,I,B=j.length,D=j[0].length,A=0,S=[],J=[];A<B-1;A++){for(h=0,I=A+1;I<D;I++)h+=j[I][A]*j[I][A];for(h=(j[A+1][A]>0?-1:1)*f.sqrt(h),C=f.sqrt((h*h-j[A+1][A]*h)/2),(S=u.zeros(B,1))[A+1][0]=(j[A+1][A]-h)/(2*C),L=A+2;L<B;L++)S[L][0]=j[L][A]/(2*C);J=u.subtract(u.identity(B,D),u.multiply(u.multiply(S,u.transpose(S)),2)),j=u.multiply(J,u.multiply(j,J))}return j},QR:(k=u.sum,_=u.arange,function(j){var h,C,L,I=j.length,B=j[0].length,D=u.zeros(B,B);for(j=u.copy(j),C=0;C<B;C++){for(D[C][C]=f.sqrt(k(_(I).map(function(A){return j[A][C]*j[A][C]}))),h=0;h<I;h++)j[h][C]=j[h][C]/D[C][C];for(L=C+1;L<B;L++)for(D[C][L]=k(_(I).map(function(A){return j[A][C]*j[A][L]})),h=0;h<I;h++)j[h][L]=j[h][L]-j[h][C]*D[C][L]}return[j,D]}),lstsq:function(j,h){var C=!1;h[0].length===void 0&&(h=h.map(function(ie){return[ie]}),C=!0);var L=u.QR(j),I=L[0],B=L[1],D=j[0].length,A=u.slice(I,{col:{end:D}}),S=function(ie){var pe=(ie=u.copy(ie)).length,se=u.identity(pe);return u.arange(pe-1,-1,-1).forEach(function(be){u.sliceAssign(se,{row:be},u.divide(u.slice(se,{row:be}),ie[be][be])),u.sliceAssign(ie,{row:be},u.divide(u.slice(ie,{row:be}),ie[be][be])),u.arange(be).forEach(function(Me){var me=u.multiply(ie[Me][be],-1),ae=u.slice(ie,{row:Me}),Pe=u.multiply(u.slice(ie,{row:be}),me);u.sliceAssign(ie,{row:Me},u.add(ae,Pe));var Ye=u.slice(se,{row:Me}),Ue=u.multiply(u.slice(se,{row:be}),me);u.sliceAssign(se,{row:Me},u.add(Ye,Ue))})}),se}(u.slice(B,{row:{end:D}})),J=u.transpose(A);J[0].length===void 0&&(J=[J]);var q=u.multiply(u.multiply(S,J),h);return q.length===void 0&&(q=[[q]]),C?q.map(function(ie){return ie[0]}):q},jacobi:function(j){for(var h,C,L,I,B,D,A,S=1,J=j.length,q=u.identity(J,J),ie=[];S===1;){for(B=j[0][1],L=0,I=1,h=0;h<J;h++)for(C=0;C<J;C++)h!=C&&B<f.abs(j[h][C])&&(B=f.abs(j[h][C]),L=h,I=C);for(D=j[L][L]===j[I][I]?j[L][I]>0?f.PI/4:-f.PI/4:f.atan(2*j[L][I]/(j[L][L]-j[I][I]))/2,(A=u.identity(J,J))[L][L]=f.cos(D),A[L][I]=-f.sin(D),A[I][L]=f.sin(D),A[I][I]=f.cos(D),q=u.multiply(q,A),j=u.multiply(u.multiply(u.inv(A),j),A),S=0,h=1;h<J;h++)for(C=1;C<J;C++)h!=C&&f.abs(j[h][C])>.001&&(S=1)}for(h=0;h<J;h++)ie.push(j[h][h]);return[q,ie]},rungekutta:function(j,h,C,L,I,B){var D,A,S;if(B===2)for(;L<=C;)I+=((D=h*j(L,I))+(A=h*j(L+h,I+D)))/2,L+=h;if(B===4)for(;L<=C;)I+=((D=h*j(L,I))+2*(A=h*j(L+h/2,I+D/2))+2*(S=h*j(L+h/2,I+A/2))+h*j(L+h,I+S))/6,L+=h;return I},romberg:function(j,h,C,L){for(var I,B,D,A,S,J=0,q=(C-h)/2,ie=[],pe=[],se=[];J<L/2;){for(S=j(h),D=h,A=0;D<=C;D+=q,A++)ie[A]=D;for(I=ie.length,D=1;D<I-1;D++)S+=(D%2!=0?4:2)*j(ie[D]);S=q/3*(S+j(C)),se[J]=S,q/=2,J++}for(B=se.length,I=1;B!==1;){for(D=0;D<B-1;D++)pe[D]=(f.pow(4,I)*se[D+1]-se[D])/(f.pow(4,I)-1);B=pe.length,se=pe,pe=[],I++}return se},richardson:function(j,h,C,L){function I(be,Me){for(var me,ae=0,Pe=be.length;ae<Pe;ae++)be[ae]===Me&&(me=ae);return me}for(var B,D,A,S,J,q=f.abs(C-j[I(j,C)+1]),ie=0,pe=[],se=[];L>=q;)B=I(j,C+L),D=I(j,C),pe[ie]=(h[B]-2*h[D]+h[2*D-B])/(L*L),L/=2,ie++;for(S=pe.length,A=1;S!=1;){for(J=0;J<S-1;J++)se[J]=(f.pow(4,A)*pe[J+1]-pe[J])/(f.pow(4,A)-1);S=se.length,pe=se,se=[],A++}return pe},simpson:function(j,h,C,L){for(var I,B=(C-h)/L,D=j(h),A=[],S=h,J=0,q=1;S<=C;S+=B,J++)A[J]=S;for(I=A.length;q<I-1;q++)D+=(q%2!=0?4:2)*j(A[q]);return B/3*(D+j(C))},hermite:function(j,h,C,L){for(var I,B=j.length,D=0,A=0,S=[],J=[],q=[],ie=[];A<B;A++){for(S[A]=1,I=0;I<B;I++)A!=I&&(S[A]*=(L-j[I])/(j[A]-j[I]));for(J[A]=0,I=0;I<B;I++)A!=I&&(J[A]+=1/(j[A]-j[I]));q[A]=(1-2*(L-j[A])*J[A])*(S[A]*S[A]),ie[A]=(L-j[A])*(S[A]*S[A]),D+=q[A]*h[A]+ie[A]*C[A]}return D},lagrange:function(j,h,C){for(var L,I,B=0,D=0,A=j.length;D<A;D++){for(I=h[D],L=0;L<A;L++)D!=L&&(I*=(C-j[L])/(j[D]-j[L]));B+=I}return B},cubic_spline:function(j,h,C){for(var L,I,B=j.length,D=0,A=[],S=[],J=[],q=[],ie=[],pe=[];D<B-1;D++)q[D]=j[D+1]-j[D];for(J[0]=0,D=1;D<B-1;D++)J[D]=3/q[D]*(h[D+1]-h[D])-3/q[D-1]*(h[D]-h[D-1]);for(D=1;D<B-1;D++)A[D]=[],S[D]=[],A[D][D-1]=q[D-1],A[D][D]=2*(q[D-1]+q[D]),A[D][D+1]=q[D],S[D][0]=J[D];for(I=u.multiply(u.inv(A),S),L=0;L<B-1;L++)ie[L]=(h[L+1]-h[L])/q[L]-q[L]*(I[L+1][0]+2*I[L][0])/3,pe[L]=(I[L+1][0]-I[L][0])/(3*q[L]);for(L=0;L<B&&!(j[L]>C);L++);return h[L-=1]+(C-j[L])*ie[L]+u.sq(C-j[L])*I[L]+(C-j[L])*u.sq(C-j[L])*pe[L]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var h,C,L,I,B,D=j.length,A=j[0].length,S=0,J=[],q=[],ie=[],pe=[],se=[],be=[],Me=[];for(S=0;S<D;S++)J[S]=u.sum(j[S])/A;for(S=0;S<A;S++)for(se[S]=[],h=0;h<D;h++)se[S][h]=j[h][S]-J[h];for(se=u.transpose(se),S=0;S<D;S++)for(be[S]=[],h=0;h<D;h++)be[S][h]=u.dot([se[S]],[se[h]])/(A-1);for(B=(L=u.jacobi(be))[0],q=L[1],Me=u.transpose(B),S=0;S<q.length;S++)for(h=S;h<q.length;h++)q[S]<q[h]&&(C=q[S],q[S]=q[h],q[h]=C,ie=Me[S],Me[S]=Me[h],Me[h]=ie);for(I=u.transpose(se),S=0;S<D;S++)for(pe[S]=[],h=0;h<I.length;h++)pe[S][h]=u.dot([Me[S]],[I[h]]);return[j,q,Me,pe]}}),function(j){for(var h=0;h<j.length;h++)(function(C){u.fn[C]=function(L,I){var B=this;return I?(setTimeout(function(){I.call(B,u.fn[C].call(B,L))},15),this):typeof u[C](this,L)=="number"?u[C](this,L):u(u[C](this,L))}})(j[h])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(b,Math),function(u,f){var k=[].slice,_=u.utils.isNumber,g=u.utils.isArray;function o(m,j,h,C){if(m>1||h>1||m<=0||h<=0)throw new Error("Proportions should be greater than 0 and less than 1");var L=(m*j+h*C)/(j+C);return(m-h)/f.sqrt(L*(1-L)*(1/j+1/C))}u.extend({zscore:function(){var m=k.call(arguments);return _(m[1])?(m[0]-m[1])/m[2]:(m[0]-u.mean(m[1]))/u.stdev(m[1],m[2])},ztest:function(){var m,j=k.call(arguments);return g(j[1])?(m=u.zscore(j[0],j[1],j[3]),j[2]===1?u.normal.cdf(-f.abs(m),0,1):2*u.normal.cdf(-f.abs(m),0,1)):j.length>2?(m=u.zscore(j[0],j[1],j[2]),j[3]===1?u.normal.cdf(-f.abs(m),0,1):2*u.normal.cdf(-f.abs(m),0,1)):(m=j[0],j[1]===1?u.normal.cdf(-f.abs(m),0,1):2*u.normal.cdf(-f.abs(m),0,1))}}),u.extend(u.fn,{zscore:function(m,j){return(m-this.mean())/this.stdev(j)},ztest:function(m,j,h){var C=f.abs(this.zscore(m,h));return j===1?u.normal.cdf(-C,0,1):2*u.normal.cdf(-C,0,1)}}),u.extend({tscore:function(){var m=k.call(arguments);return m.length===4?(m[0]-m[1])/(m[2]/f.sqrt(m[3])):(m[0]-u.mean(m[1]))/(u.stdev(m[1],!0)/f.sqrt(m[1].length))},ttest:function(){var m,j=k.call(arguments);return j.length===5?(m=f.abs(u.tscore(j[0],j[1],j[2],j[3])),j[4]===1?u.studentt.cdf(-m,j[3]-1):2*u.studentt.cdf(-m,j[3]-1)):_(j[1])?(m=f.abs(j[0]),j[2]==1?u.studentt.cdf(-m,j[1]-1):2*u.studentt.cdf(-m,j[1]-1)):(m=f.abs(u.tscore(j[0],j[1])),j[2]==1?u.studentt.cdf(-m,j[1].length-1):2*u.studentt.cdf(-m,j[1].length-1))}}),u.extend(u.fn,{tscore:function(m){return(m-this.mean())/(this.stdev(!0)/f.sqrt(this.cols()))},ttest:function(m,j){return j===1?1-u.studentt.cdf(f.abs(this.tscore(m)),this.cols()-1):2*u.studentt.cdf(-f.abs(this.tscore(m)),this.cols()-1)}}),u.extend({anovafscore:function(){var m,j,h,C,L,I,B,D,A=k.call(arguments);if(A.length===1){for(L=new Array(A[0].length),B=0;B<A[0].length;B++)L[B]=A[0][B];A=L}for(j=new Array,B=0;B<A.length;B++)j=j.concat(A[B]);for(h=u.mean(j),m=0,B=0;B<A.length;B++)m+=A[B].length*f.pow(u.mean(A[B])-h,2);for(m/=A.length-1,I=0,B=0;B<A.length;B++)for(C=u.mean(A[B]),D=0;D<A[B].length;D++)I+=f.pow(A[B][D]-C,2);return m/(I/(j.length-A.length))},anovaftest:function(){var m,j,h,C,L=k.call(arguments);if(_(L[0]))return 1-u.centralF.cdf(L[0],L[1],L[2]);var I=u.anovafscore(L);for(m=L.length-1,h=0,C=0;C<L.length;C++)h+=L[C].length;return j=h-m-1,1-u.centralF.cdf(I,m,j)},ftest:function(m,j,h){return 1-u.centralF.cdf(m,j,h)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){var m,j=0;for(m=0;m<this.length;m++)j+=this[m].length;return u.ftest(this.anovafscore(),this.length-1,j-this.length)}}),u.extend({qscore:function(){var m,j,h,C,L,I=k.call(arguments);return _(I[0])?(m=I[0],j=I[1],h=I[2],C=I[3],L=I[4]):(m=u.mean(I[0]),j=u.mean(I[1]),h=I[0].length,C=I[1].length,L=I[2]),f.abs(m-j)/(L*f.sqrt((1/h+1/C)/2))},qtest:function(){var m,j=k.call(arguments);j.length===3?(m=j[0],j=j.slice(1)):j.length===7?(m=u.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(m=u.qscore(j[0],j[1],j[2]),j=j.slice(3));var h=j[0],C=j[1];return 1-u.tukey.cdf(m,C,h-C)},tukeyhsd:function(m){for(var j=u.pooledstdev(m),h=m.map(function(A){return u.mean(A)}),C=m.reduce(function(A,S){return A+S.length},0),L=[],I=0;I<m.length;++I)for(var B=I+1;B<m.length;++B){var D=u.qtest(h[I],h[B],m[I].length,m[B].length,j,C,m.length);L.push([[I,B],D])}return L}}),u.extend({normalci:function(){var m,j=k.call(arguments),h=new Array(2);return m=j.length===4?f.abs(u.normal.inv(j[1]/2,0,1)*j[2]/f.sqrt(j[3])):f.abs(u.normal.inv(j[1]/2,0,1)*u.stdev(j[2])/f.sqrt(j[2].length)),h[0]=j[0]-m,h[1]=j[0]+m,h},tci:function(){var m,j=k.call(arguments),h=new Array(2);return m=j.length===4?f.abs(u.studentt.inv(j[1]/2,j[3]-1)*j[2]/f.sqrt(j[3])):f.abs(u.studentt.inv(j[1]/2,j[2].length-1)*u.stdev(j[2],!0)/f.sqrt(j[2].length)),h[0]=j[0]-m,h[1]=j[0]+m,h},significant:function(m,j){return m<j}}),u.extend(u.fn,{normalci:function(m,j){return u.normalci(m,j,this.toArray())},tci:function(m,j){return u.tci(m,j,this.toArray())}}),u.extend(u.fn,{oneSidedDifferenceOfProportions:function(m,j,h,C){var L=o(m,j,h,C);return u.ztest(L,1)},twoSidedDifferenceOfProportions:function(m,j,h,C){var L=o(m,j,h,C);return u.ztest(L,2)}})}(b,Math),b.models=function(){function u(f,k){var _=f.length,g=k[0].length-1,o=_-g-1,m=b.lstsq(k,f),j=b.multiply(k,m.map(function(D){return[D]})).map(function(D){return D[0]}),h=b.subtract(f,j),C=b.mean(f),L=b.sum(j.map(function(D){return Math.pow(D-C,2)})),I=b.sum(f.map(function(D,A){return Math.pow(D-j[A],2)})),B=L+I;return{exog:k,endog:f,nobs:_,df_model:g,df_resid:o,coef:m,predict:j,resid:h,ybar:C,SST:B,SSE:L,SSR:I,R2:L/B}}return{ols:function(f,k){var _=u(f,k),g=function(j){var h,C,L=(h=j.exog,C=h[0].length,b.arange(C).map(function(q){var ie=b.arange(C).filter(function(pe){return pe!==q});return u(b.col(h,q).map(function(pe){return pe[0]}),b.col(h,ie))})),I=Math.sqrt(j.SSR/j.df_resid),B=L.map(function(q){var ie=q.SST,pe=q.R2;return I/Math.sqrt(ie*(1-pe))}),D=j.coef.map(function(q,ie){return(q-0)/B[ie]}),A=D.map(function(q){var ie=b.studentt.cdf(q,j.df_resid);return 2*(ie>.5?1-ie:ie)}),S=b.studentt.inv(.975,j.df_resid),J=j.coef.map(function(q,ie){var pe=S*B[ie];return[q-pe,q+pe]});return{se:B,t:D,p:A,sigmaHat:I,interval95:J}}(_),o=function(j){var h,C,L,I=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:I,pvalue:1-(h=I,C=j.df_model,L=j.df_resid,b.beta.cdf(h/(L/C+h),C/2,L/2))}}(_),m=1-(1-_.R2)*((_.nobs-1)/_.df_resid);return _.t=g,_.f=o,_.adjust_R2=m,_}}}(),b.extend({buildxmatrix:function(){for(var u=new Array(arguments.length),f=0;f<arguments.length;f++)u[f]=[1].concat(arguments[f]);return b(u)},builddxmatrix:function(){for(var u=new Array(arguments[0].length),f=0;f<arguments[0].length;f++)u[f]=[1].concat(arguments[0][f]);return b(u)},buildjxmatrix:function(u){for(var f=new Array(u.length),k=0;k<u.length;k++)f[k]=u[k];return b.builddxmatrix(f)},buildymatrix:function(u){return b(u).transpose()},buildjymatrix:function(u){return u.transpose()},matrixmult:function(u,f){var k,_,g,o,m;if(u.cols()==f.rows()){if(f.rows()>1){for(o=[],k=0;k<u.rows();k++)for(o[k]=[],_=0;_<f.cols();_++){for(m=0,g=0;g<u.cols();g++)m+=u.toArray()[k][g]*f.toArray()[g][_];o[k][_]=m}return b(o)}for(o=[],k=0;k<u.rows();k++)for(o[k]=[],_=0;_<f.cols();_++){for(m=0,g=0;g<u.cols();g++)m+=u.toArray()[k][g]*f.toArray()[_];o[k][_]=m}return b(o)}},regress:function(u,f){var k=b.xtranspxinv(u),_=u.transpose(),g=b.matrixmult(b(k),_);return b.matrixmult(g,f)},regresst:function(u,f,k){var _=b.regress(u,f),g={anova:{}},o=b.jMatYBar(u,_);g.yBar=o;var m=f.mean();g.anova.residuals=b.residuals(f,o),g.anova.ssr=b.ssr(o,m),g.anova.msr=g.anova.ssr/(u[0].length-1),g.anova.sse=b.sse(f,o),g.anova.mse=g.anova.sse/(f.length-(u[0].length-1)-1),g.anova.sst=b.sst(f,m),g.anova.mst=g.anova.sst/(f.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=b.anovaftest(g.anova.fratio,u[0].length-1,f.length-(u[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(u[0].length);for(var j,h,C,L=b.xtranspxinv(u),I=0;I<_.length;I++)j=Math.sqrt(g.anova.mse*Math.abs(L[I][I])),h=Math.abs(_[I]/j),C=b.ttest(h,f.length-u[0].length-1,k),g.stats[I]=[_[I],j,h,C];return g.regress=_,g},xtranspx:function(u){return b.matrixmult(u.transpose(),u)},xtranspxinv:function(u){var f=b.matrixmult(u.transpose(),u);return b.inv(f)},jMatYBar:function(u,f){var k=b.matrixmult(u,f);return new b(k)},residuals:function(u,f){return b.matrixsubtract(u,f)},ssr:function(u,f){for(var k=0,_=0;_<u.length;_++)k+=Math.pow(u[_]-f,2);return k},sse:function(u,f){for(var k=0,_=0;_<u.length;_++)k+=Math.pow(u[_]-f[_],2);return k},sst:function(u,f){for(var k=0,_=0;_<u.length;_++)k+=Math.pow(u[_]-f,2);return k},matrixsubtract:function(u,f){for(var k=new Array(u.length),_=0;_<u.length;_++){k[_]=new Array(u[_].length);for(var g=0;g<u[_].length;g++)k[_][g]=u[_][g]-f[_][g]}return b(k)}}),b.jStat=b,b)},960:function(z,b,u){const f=u(592);z.exports=function(k){function _(I,B){const D=B.split(".");let A=I;for(const S of D){if(A==null)return;A=A[S]}return A}for(let I=0;I<Object.keys(f).length;I++){let B,D=Object.keys(f)[I],A=[];if(typeof f[D]=="object"){A=Object.keys(f[D]),B=Object.values(f[D]);for(let S=0;S<B.length;S++)if(typeof B[S]=="object"){let J=A[S];f[D][J]&&(A=[...A,...Object.keys(f[D][J]).map(q=>J+"."+q)],A.splice(A.indexOf(J),1))}}if(A.length<1)k[D]=f[D];else for(let S=0;S<A.length;S++)typeof _(f[D],A[S])=="function"&&(k[D]=_(f[D],A[S]))}let g=function(I){return typeof I=="number"&&(I=parseInt(I)),I},o=null,m=null,j=null;k.TABLE=function(){return j},k.COLUMN=k.COL=function(){return j.tracking&&j.tracking.push(L.getColumnNameFromCoords(g(o),g(m))),g(o)+1},k.ROW=function(){return j.tracking&&j.tracking.push(L.getColumnNameFromCoords(g(o),g(m))),g(m)+1},k.CELL=function(){return L.getColumnNameFromCoords(o,m)},k.VALUE=function(I,B,D){return j.getValueFromCoords(g(I)-1,g(B)-1,D)},k.THISROWCELL=function(I){return j.getValueFromCoords(g(I)-1,g(m))};const h=function(I,B){for(let D=0;D<I.length;D++){let A=L.getTokensFromRange(I[D]);B=B.replace(I[D],"["+A.join(",")+"]")}return B},C=function(I){return typeof I=="string"&&(I=I.trim()),!isNaN(I)&&I!==null&&I!==""},L=function(I,B,D,A,S){j=S,o=D,m=A;let J="",q={};if(B)if(B.size){let se,be=null;B.forEach(function(Me,me){se=me.replace(/!/g,"."),se.indexOf(".")!==-1&&(se=se.split("."),q[se[0]]=!0)}),se=Object.keys(q);for(let Me=0;Me<se.length;Me++)J+="var "+se[Me]+" = {};";B.forEach(function(Me,me){se=me.replace(/!/g,"."),Me===null||C(Me)||(be=Me.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),be&&be.length&&(Me=updateRanges(be,Me))),se.indexOf(".")>0?J+=se+" = "+B.get(me)+`;
`:J+="var "+se+" = "+Me+`;
`})}else{let se=Object.keys(B);if(se.length){let be,Me={};for(let me=0;me<se.length;me++)if(be=se[me].replace(/\!/g,"."),be.indexOf(".")>0){let ae=ae.split(".");Me[ae[0]]={}}be=Object.keys(Me);for(let me=0;me<be.length;me++)J+="var "+be[me]+" = {};";for(let me=0;me<se.length;me++){if(be=se[me].replace(/!/g,"."),B[se[me]]!==null&&!C(B[se[me]])){let ae=B[se[me]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ae&&ae.length&&(B[se[me]]=h(ae,B[se[me]]))}be.indexOf(".")>0?J+=be+" = "+B[se[me]]+`;
`:J+="var "+be+" = "+B[se[me]]+`;
`}}}let ie=(I=function(se,be){let Me="",me=0,ae=["=","!",">","<"];for(let Pe=0;Pe<se.length;Pe++)se[Pe]==='"'&&(me=me===0?1:0),me===1?Me+=se[Pe]:(Me+=se[Pe].toUpperCase(),Pe>0&&se[Pe]==="="&&ae.indexOf(se[Pe-1])===-1&&ae.indexOf(se[Pe+1])===-1&&(Me+="="));return Me=Me.replace(/\^/g,"**"),Me=Me.replace(/<>/g,"!="),Me=Me.replace(/&/g,"+"),Me=Me.replace(/\$/g,""),Me}(I=(I=I.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ie&&ie.length&&(I=h(ie,I));let pe=new Function(J+"; return "+I)();return pe===null&&(pe=0),pe};return L.getColumnNameFromCoords=function(I,B){return A="",(D=parseInt(I))>701?(A+=String.fromCharCode(64+parseInt(D/676)),A+=String.fromCharCode(64+parseInt(D%676/26))):D>25&&(A+=String.fromCharCode(64+parseInt(D/26))),A+String.fromCharCode(65+D%26)+(parseInt(B)+1);var D,A},L.getCoordsFromColumnName=function(I){var B=/^[a-zA-Z]+/.exec(I);if(B){for(var D=0,A=0;A<B[0].length;A++)D+=parseInt(B[0].charCodeAt(A)-64)*Math.pow(26,B[0].length-1-A);--D<0&&(D=0);var S=parseInt(/[0-9]+$/.exec(I))||null;return S>0&&S--,[D,S]}},L.getRangeFromTokens=function(I){I=I.filter(function(S){return S!="#REF!"});for(var B="",D="",A=0;A<I.length;A++)I[A].indexOf(".")>=0?B=".":I[A].indexOf("!")>=0&&(B="!"),B&&(D=I[A].split(B),I[A]=D[1],D=D[0]+B);return I.sort(function(S,J){var q=Helpers.getCoordsFromColumnName(S),ie=Helpers.getCoordsFromColumnName(J);return q[1]>ie[1]?1:q[1]<ie[1]?-1:q[0]>ie[0]?1:q[0]<ie[0]?-1:0}),I.length?D+(I[0]+":")+I[I.length-1]:"#REF!"},L.getTokensFromRange=function(I){if(I.indexOf(".")>0){var B=I.split(".");I=B[1],B=B[0]+"."}else I.indexOf("!")>0?(B=I.split("!"),I=B[1],B=B[0]+"!"):B="";I=I.split(":");var D=L.getCoordsFromColumnName(I[0]),A=L.getCoordsFromColumnName(I[1]);if(D[0]<=A[0])var S=D[0],J=A[0];else S=A[0],J=D[0];if(D[1]===null&&A[1]==null)for(var q=null,ie=null,pe=Object.keys(vars),se=0;se<pe.length;se++){var be=L.getCoordsFromColumnName(pe[se]);be[0]===D[0]&&(q===null||be[1]<q)&&(q=be[1]),be[0]===A[0]&&(ie===null||be[1]>ie)&&(ie=be[1])}else D[1]<=A[1]?(q=D[1],ie=A[1]):(q=A[1],ie=D[1]);for(var Me=[],me=q;me<=ie;me++){var ae=[];for(se=S;se<=J;se++)ae.push(B+L.getColumnNameFromCoords(se,me));Me.push(ae)}return Me},L.setFormula=function(I){let B=Object.keys(I);for(let D=0;D<B.length;D++)typeof I[B[D]]=="function"&&(k[B[D]]=I[B[D]])},L.basic=!0,L}(typeof window>"u"?u.g:window)},592:function(z,b,u){var f=u(162),k=u(765);const _=new Error("#NULL!"),g=new Error("#DIV/0!"),o=new Error("#VALUE!"),m=new Error("#REF!"),j=new Error("#NAME?"),h=new Error("#NUM!"),C=new Error("#N/A"),L=new Error("#ERROR!"),I=new Error("#GETTING_DATA");var B=Object.freeze({__proto__:null,data:I,div0:g,error:L,na:C,name:j,nil:_,num:h,ref:m,value:o});function D(e){const t=[];return A(e,a=>{t.push(a)}),t}function A(e,t){let a=-1;const p=e.length;for(;++a<p&&t(e[a],a,e)!==!1;);return e}function S(e){let t,a=e.length;for(;a--;)if(t=e[a],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const p=Y(t);e[a]=p instanceof Error?0:p}}else e[a]=0;else e[a]=1;return e}function J(e,t){if(!e)return o;e.every(T=>Array.isArray(T))&&e.length!==0||(e=[[...e]]),e.map((T,H)=>{T.map((W,oe)=>{W||(e[H][oe]=0)})});const a=e.reduce((T,H,W)=>H.length>e[T].length?W:T,0),p=e[a].length;return e.map(T=>[...T,...Array(p-T.length).fill(0)])}function q(){let e;if(arguments.length===1){const a=arguments[0];e=(t=a)!=null&&typeof t.length=="number"&&typeof t!="string"?D.apply(null,arguments):[a]}else e=Array.from(arguments);for(var t;!pe(e);)e=ie(e);return e}function ie(e){return e&&e.reduce?e.reduce((t,a)=>{const p=Array.isArray(t),T=Array.isArray(a);return p&&T?t.concat(a):p?(t.push(a),t):T?[t].concat(a):[t,a]}):[e]}function pe(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function se(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function be(e){return e?e[0].map((t,a)=>e.map(p=>p[a])):o}function Me(e,t){let a=null;return A(e,(p,T)=>{if(p[0]===t)return a=T,!1}),a??o}function me(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ae(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function Pe(e){return Math.round(e*1e14)/1e14}function Ye(){return q.apply(null,arguments).filter(e=>typeof e=="number")}function Ue(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||o}function Re(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?h:function(a){a<60&&(a+=1);const p=Math.floor(a-25569),T=new Date(86400*p*1e3),H=a-Math.floor(a)+1e-7;let W=Math.floor(86400*H);const oe=W%60;W-=oe;const de=Math.floor(W/3600),Ce=Math.floor(W/60)%60;let ke=T.getUTCDate(),qe=T.getUTCMonth();return a>=60&&a<61&&(ke=29,qe=1),new Date(T.getUTCFullYear(),qe,ke,de,Ce,oe)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?o:e}function Je(e){let t,a=e.length;for(;a--;){if(t=Re(e[a]),t===o)return t;e[a]=t}return e}function Y(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?o:parseFloat(e))}function Le(e){let t,a;if(!e||(t=e.length)===0)return o;for(;t--;){if(e[t]instanceof Error)return e[t];if(a=Y(e[t]),a instanceof Error)return a;e[t]=a}return e}function _e(e){return e instanceof Error?e:e==null?"":e.toString()}function pt(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function Qe(e){return e!=null}const Ae="=",Te=[">",">=","<","<=","=","<>"],He="operator",Ve="literal",Ge=[He,Ve],et=He,at=Ve;function dt(e,t){if(Ge.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function mt(e){return function(t){let a="";const p=[];for(let T=0;T<t.length;T++){const H=t[T];T===0&&Te.indexOf(H)>=0?p.push(dt(H,et)):a+=H}return a.length>0&&p.push(dt(function(T){return typeof T!="string"||/^\d+(\.\d+)?$/.test(T)&&(T=T.indexOf(".")===-1?parseInt(T,10):parseFloat(T)),T}(a),at)),p.length>0&&p[0].type!==et&&p.unshift(dt(Ae,et)),p}(function(t){const a=t.length,p=[];let T=0,H="",W="";for(;T<a;){const oe=t.charAt(T);switch(oe){case">":case"<":case"=":W+=oe,H.length>0&&(p.push(H),H="");break;default:W.length>0&&(p.push(W),W=""),H+=oe}T++}return H.length>0&&p.push(H),W.length>0&&p.push(W),p}(e))}const gt=function(e){const t=[];let a;for(let p=0;p<e.length;p++){const T=e[p];switch(T.type){case et:a=T.value;break;case at:t.push(T.value)}}return function(p,T){let H=!1;switch(T){case">":H=p[0]>p[1];break;case">=":H=p[0]>=p[1];break;case"<":H=p[0]<p[1];break;case"<=":H=p[0]<=p[1];break;case"=":H=p[0]==p[1];break;case"<>":H=p[0]!=p[1]}return H}(t,a)},St={};function Ft(e){return[o,m,g,h,j,_].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Et(e){return Ft(e)||e===C}function Ot(e){return e===!0||e===!1}function Tt(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function bt(e){return typeof e=="string"}function kt(){const e=[];for(let t=0;t<arguments.length;++t){let a=!1;const p=arguments[t];for(let T=0;T<e.length&&(a=e[T]===p,!a);++T);a||e.push(p)}return e}function Rt(e,t,a,p){if(!t||!a)return C;p=!(p===0||p===!1);let T=C;const H=typeof e=="number";let W=!1;for(let oe=0;oe<t.length;oe++){const de=t[oe];if(de[0]===e){T=a<de.length+1?de[a-1]:m;break}!W&&(H&&p&&de[0]<=e||p&&typeof de[0]=="string"&&de[0].localeCompare(e)<0)&&(T=a<de.length+1?de[a-1]:m),H&&de[0]>e&&(W=!0)}return T}function w(){const e=q(arguments).filter(Qe);if(e.length===0)return g;const t=me.apply(void 0,e);if(t)return t;const a=Ye(e),p=a.length;let T,H=0,W=0;for(let oe=0;oe<p;oe++)H+=a[oe],W+=1;return T=H/W,isNaN(T)&&(T=h),T}function E(){const e=q(arguments).filter(Qe);if(e.length===0)return g;const t=me.apply(void 0,e);if(t)return t;const a=e,p=a.length;let T,H=0,W=0;for(let oe=0;oe<p;oe++){const de=a[oe];typeof de=="number"&&(H+=de),de===!0&&H++,de!==null&&W++}return T=H/W,isNaN(T)&&(T=h),T}St.TYPE=e=>{switch(e){case _:return 1;case g:return 2;case o:return 3;case m:return 4;case j:return 5;case h:return 6;case C:return 7;case I:return 8}return C};const l={DIST:function(e,t,a,p,T,H){return arguments.length<4?o:(T=T===void 0?0:T,H=H===void 0?1:H,ae(e=Y(e),t=Y(t),a=Y(a),T=Y(T),H=Y(H))?o:(e=(e-T)/(H-T),p?f.beta.cdf(e,t,a):f.beta.pdf(e,t,a)))},INV:(e,t,a,p,T)=>(p=p===void 0?0:p,T=T===void 0?1:T,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T))?o:f.beta.inv(e,t,a)*(T-p)+p)},r={DIST:(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p))?o:p?f.binomial.cdf(e,t,a):f.binomial.pdf(e,t,a)};r.DIST.RANGE=(e,t,a,p)=>{if(p=p===void 0?a:p,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p)))return o;let T=0;for(let H=a;H<=p;H++)T+=$e(e,H)*Math.pow(t,H)*Math.pow(1-t,e-H);return T},r.INV=(e,t,a)=>{if(ae(e=Y(e),t=Y(t),a=Y(a)))return o;let p=0;for(;p<=e;){if(f.binomial.cdf(p,e,t)>=a)return p;p++}};const P={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?o:a?f.chisquare.cdf(e,t):f.chisquare.pdf(e,t)};P.DIST.RT=(e,t)=>!e|!t?C:e<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?o:1-f.chisquare.cdf(e,t),P.INV=(e,t)=>ae(e=Y(e),t=Y(t))?o:f.chisquare.inv(e,t),P.INV.RT=(e,t)=>!e|!t?C:e<0||e>1||t<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?o:f.chisquare.inv(1-e,t),P.TEST=function(e,t){if(arguments.length!==2)return C;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return o;const a=e.length;let p,T,H;for(T=0;T<a;T++)e[T]instanceof Array||(p=e[T],e[T]=[],e[T].push(p)),t[T]instanceof Array||(p=t[T],t[T]=[],t[T].push(p));const W=e[0].length,oe=W===1?a-1:(a-1)*(W-1);let de=0;const Ce=Math.PI;for(T=0;T<a;T++)for(H=0;H<W;H++)de+=Math.pow(e[T][H]-t[T][H],2)/t[T][H];return Math.round(1e6*function(ke,qe){let Be=Math.exp(-.5*ke);qe%2==1&&(Be*=Math.sqrt(2*ke/Ce));let We=qe;for(;We>=2;)Be=Be*ke/We,We-=2;let tt=Be,ot=qe;for(;tt>1e-10*Be;)ot+=2,tt=tt*ke/ot,Be+=tt;return 1-Be}(de,oe))/1e6};const te={};function ee(){return Ye(q(arguments)).length}function O(){const e=q(arguments);return e.length-N(e)}function N(){const e=q(arguments);let t,a=0;for(let p=0;p<e.length;p++)t=e[p],t!=null&&t!==""||a++;return a}te.NORM=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:f.normalci(1,e,t,a)[1]-1,te.T=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:f.tci(1,e,t,a)[1]-1;const V={P:(e,t)=>{if(ae(e=Le(q(e)),t=Le(q(t))))return o;const a=f.mean(e),p=f.mean(t);let T=0;const H=e.length;for(let W=0;W<H;W++)T+=(e[W]-a)*(t[W]-p);return T/H},S:(e,t)=>ae(e=Le(q(e)),t=Le(q(t)))?o:f.covariance(e,t)},G={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?o:a?f.exponential.cdf(e,t):f.exponential.pdf(e,t)},ne={};function ge(e,t,a){if(ae(e=Y(e),t=Le(q(t)),a=Le(q(a))))return o;const p=f.mean(a),T=f.mean(t),H=a.length;let W=0,oe=0;for(let Ce=0;Ce<H;Ce++)W+=(a[Ce]-p)*(t[Ce]-T),oe+=Math.pow(a[Ce]-p,2);const de=W/oe;return T-de*p+de*e}function ce(e){return(e=Y(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?h:f.gammafn(e)}function fe(e){return(e=Y(e))instanceof Error?e:f.gammaln(e)}ne.DIST=(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:p?f.centralF.cdf(e,t,a):f.centralF.pdf(e,t,a),ne.DIST.RT=function(e,t,a){return arguments.length!==3?C:e<0||t<1||a<1?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?o:1-f.centralF.cdf(e,t,a)},ne.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:e<=0||e>1?h:f.centralF.inv(e,t,a),ne.INV.RT=function(e,t,a){return arguments.length!==3?C:e<0||e>1||t<1||t>Math.pow(10,10)||a<1||a>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?o:f.centralF.inv(1-e,t,a)},ne.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return C;if(e.length<2||t.length<2)return g;const a=(H,W)=>{let oe=0;for(let de=0;de<H.length;de++)oe+=Math.pow(H[de]-W,2);return oe},p=At(e)/e.length,T=At(t)/t.length;return a(e,p)/(e.length-1)/(a(t,T)/(t.length-1))},ce.DIST=function(e,t,a,p){return arguments.length!==4?C:e<0||t<=0||a<=0||typeof e!="number"||typeof t!="number"||typeof a!="number"?o:p?f.gamma.cdf(e,t,a,!0):f.gamma.pdf(e,t,a,!1)},ce.INV=function(e,t,a){return arguments.length!==3?C:e<0||e>1||t<=0||a<=0?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?o:f.gamma.inv(e,t,a)},fe.PRECISE=function(e){return arguments.length!==1?C:e<=0?h:typeof e!="number"?o:f.gammaln(e)};const Ee={};function De(e,t){return ae(e=Le(q(e)),t=Y(t))?e:t<0||e.length<t?o:e.sort((a,p)=>p-a)[t-1]}function Se(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return o;const a=f.mean(e),p=f.mean(t),T=t.length;let H=0,W=0;for(let de=0;de<T;de++)H+=(t[de]-p)*(e[de]-a),W+=Math.pow(t[de]-p,2);const oe=H/W;return[oe,a-oe*p]}Ee.DIST=(e,t,a,p,T)=>{if(ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p)))return o;function H(W,oe,de,Ce){return $e(de,W)*$e(Ce-de,oe-W)/$e(Ce,oe)}return T?function(W,oe,de,Ce){let ke=0;for(let qe=0;qe<=W;qe++)ke+=H(qe,oe,de,Ce);return ke}(e,t,a,p):H(e,t,a,p)};const ze={};function Ke(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;const a=Ye(e);return a.length===0?0:Math.max.apply(Math,a)}function Q(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;const a=S(e);let p=f.median(a);return isNaN(p)&&(p=h),p}function he(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;const a=Ye(e);return a.length===0?0:Math.min.apply(Math,a)}ze.DIST=(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:p?f.lognormal.cdf(e,t,a):f.lognormal.pdf(e,t,a),ze.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:f.lognormal.inv(e,t,a);const we={MULT:function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=e.length,a={};let p,T=[],H=0;for(let W=0;W<t;W++)p=e[W],a[p]=a[p]?a[p]+1:1,a[p]>H&&(H=a[p],T=[]),a[p]===H&&(T[T.length]=p);return T},SNGL:function(){const e=Le(q(arguments));return e instanceof Error?e:we.MULT(e).sort((t,a)=>t-a)[0]}},U={DIST:(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:p?f.negbin.cdf(e,t,a):f.negbin.pdf(e,t,a)},Z={};function v(e,t){if(ae(t=Le(q(t)),e=Le(q(e))))return o;const a=f.mean(e),p=f.mean(t),T=e.length;let H=0,W=0,oe=0;for(let de=0;de<T;de++)H+=(e[de]-a)*(t[de]-p),W+=Math.pow(e[de]-a,2),oe+=Math.pow(t[de]-p,2);return H/Math.sqrt(W*oe)}Z.DIST=(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:a<=0?h:p?f.normal.cdf(e,t,a):f.normal.pdf(e,t,a),Z.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:f.normal.inv(e,t,a),Z.S={},Z.S.DIST=(e,t)=>(e=Y(e))instanceof Error?o:t?f.normal.cdf(e,0,1):f.normal.pdf(e,0,1),Z.S.INV=e=>(e=Y(e))instanceof Error?o:f.normal.inv(e,0,1);const F={EXC:(e,t)=>{if(ae(e=Le(q(e)),t=Y(t)))return o;const a=(e=e.sort((H,W)=>H-W)).length;if(t<1/(a+1)||t>1-1/(a+1))return h;const p=t*(a+1)-1,T=Math.floor(p);return Pe(p===T?e[p]:e[T]+(p-T)*(e[T+1]-e[T]))},INC:(e,t)=>{if(ae(e=Le(q(e)),t=Y(t)))return o;const a=t*((e=e.sort((T,H)=>T-H)).length-1),p=Math.floor(a);return Pe(a===p?e[a]:e[p]+(a-p)*(e[p+1]-e[p]))}},X={EXC:(e,t,a)=>{if(a=a===void 0?3:a,ae(e=Le(q(e)),t=Y(t),a=Y(a)))return o;e=e.sort((ke,qe)=>ke-qe);const p=kt.apply(null,e),T=e.length,H=p.length,W=Math.pow(10,a);let oe=0,de=!1,Ce=0;for(;!de&&Ce<H;)t===p[Ce]?(oe=(e.indexOf(p[Ce])+1)/(T+1),de=!0):t>=p[Ce]&&(t<p[Ce+1]||Ce===H-1)&&(oe=(e.indexOf(p[Ce])+1+(t-p[Ce])/(p[Ce+1]-p[Ce]))/(T+1),de=!0),Ce++;return Math.floor(oe*W)/W},INC:(e,t,a)=>{if(a=a===void 0?3:a,ae(e=Le(q(e)),t=Y(t),a=Y(a)))return o;e=e.sort((ke,qe)=>ke-qe);const p=kt.apply(null,e),T=e.length,H=p.length,W=Math.pow(10,a);let oe=0,de=!1,Ce=0;for(;!de&&Ce<H;)t===p[Ce]?(oe=e.indexOf(p[Ce])/(T-1),de=!0):t>=p[Ce]&&(t<p[Ce+1]||Ce===H-1)&&(oe=(e.indexOf(p[Ce])+(t-p[Ce])/(p[Ce+1]-p[Ce]))/(T-1),de=!0),Ce++;return Math.floor(oe*W)/W}},ue={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?o:a?f.poisson.cdf(e,t):f.poisson.pdf(e,t)},K={EXC:(e,t)=>{if(ae(e=Le(q(e)),t=Y(t)))return o;switch(t){case 1:return F.EXC(e,.25);case 2:return F.EXC(e,.5);case 3:return F.EXC(e,.75);default:return h}},INC:(e,t)=>{if(ae(e=Le(q(e)),t=Y(t)))return o;switch(t){case 1:return F.INC(e,.25);case 2:return F.INC(e,.5);case 3:return F.INC(e,.75);default:return h}}},le={};function je(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=f.mean(e),a=e.length;let p=0;for(let T=0;T<a;T++)p+=Math.pow(e[T]-t,3);return a*p/((a-1)*(a-2)*Math.pow(f.stdev(e,!0),3))}function Ne(e,t){return ae(e=Le(q(e)),t=Y(t))?e:e.sort((a,p)=>a-p)[t-1]}le.AVG=(e,t,a)=>{if(ae(e=Y(e),t=Le(q(t))))return o;const p=(a=a||!1)?(W,oe)=>W-oe:(W,oe)=>oe-W,T=(t=(t=q(t)).sort(p)).length;let H=0;for(let W=0;W<T;W++)t[W]===e&&H++;return H>1?(2*t.indexOf(e)+H+1)/2:t.indexOf(e)+1},le.EQ=(e,t,a)=>{if(ae(e=Y(e),t=Le(q(t))))return o;const p=(a=a||!1)?(T,H)=>T-H:(T,H)=>H-T;return(t=t.sort(p)).indexOf(e)+1},je.P=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=f.mean(e),a=e.length;let p=0,T=0;for(let H=0;H<a;H++)T+=Math.pow(e[H]-t,3),p+=Math.pow(e[H]-t,2);return T/=a,p/=a,T/Math.pow(p,1.5)};const ve={P:function(){const e=Fe.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},S:function(){const e=Fe.S.apply(this,arguments);return Math.sqrt(e)}},Ie={DIST:(e,t,a)=>a!==1&&a!==2?h:a===1?Ie.DIST.RT(e,t):Ie.DIST["2T"](e,t)};Ie.DIST["2T"]=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?o:2*(1-f.studentt.cdf(e,t))},Ie.DIST.RT=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?o:1-f.studentt.cdf(e,t)},Ie.INV=(e,t)=>ae(e=Y(e),t=Y(t))?o:f.studentt.inv(e,t),Ie.INV["2T"]=(e,t)=>(e=Y(e),t=Y(t),e<=0||e>1||t<1?h:ae(e,t)?o:Math.abs(f.studentt.inv(e/2,t))),Ie.TEST=(e,t)=>{if(ae(e=Le(q(e)),t=Le(q(t))))return o;const a=f.mean(e),p=f.mean(t);let T,H=0,W=0;for(T=0;T<e.length;T++)H+=Math.pow(e[T]-a,2);for(T=0;T<t.length;T++)W+=Math.pow(t[T]-p,2);H/=e.length-1,W/=t.length-1;const oe=Math.abs(a-p)/Math.sqrt(H/e.length+W/t.length);return Ie.DIST["2T"](oe,e.length+t.length-2)};const Fe={};function nt(){const e=q(arguments),t=e.length;let a=0,p=0;const T=E(e);for(let H=0;H<t;H++){const W=e[H];a+=Math.pow(typeof W=="number"?W-T:W===!0?1-T:0-T,2),W!==null&&p++}return a/(p-1)}function re(){const e=q(arguments),t=e.length;let a=0,p=0;const T=E(e);let H;for(let W=0;W<t;W++){const oe=e[W];a+=Math.pow(typeof oe=="number"?oe-T:oe===!0?1-T:0-T,2),oe!==null&&p++}return H=a/p,isNaN(H)&&(H=h),H}Fe.P=function(){const e=Ye(q(arguments)),t=e.length;let a=0;const p=w(e);let T;for(let H=0;H<t;H++)a+=Math.pow(e[H]-p,2);return T=a/t,isNaN(T)&&(T=h),T},Fe.S=function(){const e=Ye(q(arguments)),t=e.length;let a=0;const p=w(e);for(let T=0;T<t;T++)a+=Math.pow(e[T]-p,2);return a/(t-1)};const ye={DIST:(e,t,a,p)=>ae(e=Y(e),t=Y(t),a=Y(a))?o:p?1-Math.exp(-Math.pow(e/a,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/a,t))*t/Math.pow(a,t)},xe={};function Oe(e,t,a){const p=me(e=Y(e),t=Y(t),a=Y(a));if(p)return p;if(t===0)return 0;t=Math.abs(t);const T=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.ceil(e/t)*t,T):a===0?-xt(Math.floor(Math.abs(e)/t)*t,T):-xt(Math.ceil(Math.abs(e)/t)*t,T)}function $e(e,t){return me(e=Y(e),t=Y(t))||(e<t?h:it(e)/(it(t)*it(e-t)))}xe.TEST=(e,t,a)=>{if(ae(e=Le(q(e)),t=Y(t)))return o;a=a||ve.S(e);const p=e.length;return 1-Z.S.DIST((w(e)-t)/(a/Math.sqrt(p)),!0)},Oe.MATH=Oe,Oe.PRECISE=Oe;const Ze=[];function it(e){if((e=Y(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(Ze[t]>0||(Ze[t]=it(t-1)*t),Ze[t])}function ft(e,t){const a=me(e=Y(e),t=Y(t));if(a)return a;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return h;t=Math.abs(t);const p=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,p):-xt(Math.ceil(Math.abs(e)/t),p)}ft.MATH=(e,t,a)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const p=me(e=Y(e),t=Y(t),a=Y(a));if(p)return p;if(t===0)return 0;t=t?Math.abs(t):1;const T=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,T):a===0||a===void 0?-xt(Math.ceil(Math.abs(e)/t)*t,T):-xt(Math.floor(Math.abs(e)/t)*t,T)},ft.PRECISE=ft.MATH;const rt={CEILING:Oe};function ut(e,t){const a=me(e=Y(e),t=Y(t));if(a)return a;if(e===0&&t===0)return h;const p=Math.pow(e,t);return isNaN(p)?h:p}function Xe(){const e=q(arguments).filter(p=>p!=null);if(e.length===0)return 0;const t=Le(e);if(t instanceof Error)return t;let a=1;for(let p=0;p<t.length;p++)a*=t[p];return a}function xt(e,t){return me(e=Y(e),t=Y(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function At(){let e=0;return A(D(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const a=parseFloat(t);!isNaN(a)&&(e+=a)}else if(Array.isArray(t)){const a=At.apply(null,t);a instanceof Error?e=a:e+=a}}),e}var dn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?C:me(e=Y(e),t=Y(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?C:me(e=Y(e),t=Y(t))||(t===0?g:e/t)},EQ:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(pt(e,t)?(e=_e(e),t=_e(t)):(e=Y(e),t=Y(t)),me(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?C:(pt(e,t)?(e=_e(e),t=_e(t)):(e=Y(e),t=Y(t)),me(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?C:(pt(e,t)?(e=_e(e),t=_e(t)):(e=Y(e),t=Y(t)),me(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?C:(pt(e,t)?(e=_e(e),t=_e(t)):(e=Y(e),t=Y(t)),me(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?C:me(e=Y(e),t=Y(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?C:me(e=Y(e),t=Y(t))||e*t},NE:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?C:ut(e,t)}});const fn=new Date(Date.UTC(1900,0,1)),pn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],hn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Ht=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function It(e,t,a){a=a.toUpperCase(),e=Re(e),t=Re(t);const p=e.getFullYear(),T=e.getMonth(),H=e.getDate(),W=t.getFullYear(),oe=t.getMonth(),de=t.getDate();let Ce;switch(a){case"Y":Ce=Math.floor(zt(e,t));break;case"D":Ce=Lt(t,e);break;case"M":Ce=oe-T+12*(W-p),de<H&&Ce--;break;case"MD":H<=de?Ce=de-H:(oe===0?(e.setFullYear(W-1),e.setMonth(12)):(e.setFullYear(W),e.setMonth(oe-1)),Ce=Lt(t,e));break;case"YM":Ce=oe-T+12*(W-p),de<H&&Ce--,Ce%=12;break;case"YD":oe>T||oe===T&&de<H?e.setFullYear(W):e.setFullYear(W-1),Ce=Lt(t,e)}return Ce}function Bt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Lt(e,t){return e=Re(e),t=Re(t),e instanceof Error?e:t instanceof Error?t:nn(Bt(e))-nn(Bt(t))}function wt(e,t,a){if(a=Ue(a||"false"),e=Re(e),t=Re(t),e instanceof Error)return e;if(t instanceof Error)return t;if(a instanceof Error)return a;const p=e.getMonth();let T,H,W=t.getMonth();if(a)T=e.getDate()===31?30:e.getDate(),H=t.getDate()===31?30:t.getDate();else{const oe=new Date(e.getFullYear(),p+1,0).getDate(),de=new Date(t.getFullYear(),W+1,0).getDate();T=e.getDate()===oe?30:e.getDate(),t.getDate()===de?T<30?(W++,H=1):H=30:H=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(W-p)+(H-T)}function tn(e){if((e=Re(e))instanceof Error)return e;(e=Bt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Pt(e,t,a){return Pt.INTL(e,t,1,a)}function _t(e,t,a){return _t.INTL(e,t,1,a)}function Ut(e){return new Date(e,1,29).getMonth()===1}function Vt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function zt(e,t,a){if((e=Re(e))instanceof Error)return e;if((t=Re(t))instanceof Error)return t;a=a||0;let p=e.getDate();const T=e.getMonth()+1,H=e.getFullYear();let W=t.getDate();const oe=t.getMonth()+1,de=t.getFullYear();switch(a){case 0:return p===31&&W===31?(p=30,W=30):p===31?p=30:p===30&&W===31&&(W=30),(W+30*oe+360*de-(p+30*T+360*H))/360;case 1:{const Ce=(We,tt)=>{const ot=We.getFullYear(),jt=new Date(ot,2,1);if(Ut(ot)&&We<jt&&tt>=jt)return!0;const ct=tt.getFullYear(),Ct=new Date(ct,2,1);return Ut(ct)&&tt>=Ct&&We<Ct};let ke=365;if(H===de||H+1===de&&(T>oe||T===oe&&p>=W))return(H===de&&Ut(H)||Ce(e,t)||oe===1&&W===29)&&(ke=366),Vt(e,t)/ke;const qe=de-H+1,Be=(new Date(de+1,0,1)-new Date(H,0,1))/1e3/60/60/24/qe;return Vt(e,t)/Be}case 2:return Vt(e,t)/360;case 3:return Vt(e,t)/365;case 4:return(W+30*oe+360*de-(p+30*T+360*H))/360}}function nn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-fn)/864e5)+t}function rn(e){return(e=Y(e))===0?o:e instanceof Error?e:String.fromCharCode(e)}function on(e){if(ae(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=o),t}function an(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;let a=0;for(;(a=e.indexOf(!0))>-1;)e[a]="TRUE";let p=0;for(;(p=e.indexOf(!1))>-1;)e[p]="FALSE";return e.join("")}Pt.INTL=(e,t,a,p)=>{if((e=Re(e))instanceof Error)return e;if((t=Re(t))instanceof Error)return t;let T=!1;const H=[],W=[1,2,3,4,5,6,0],oe=new RegExp("^[0|1]{7}$");if(a===void 0)a=Ht[1];else if(typeof a=="string"&&oe.test(a)){T=!0,a=a.split("");for(let qe=0;qe<a.length;qe++)a[qe]==="1"&&H.push(W[qe])}else a=Ht[a];if(!(a instanceof Array))return o;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let qe=0;qe<p.length;qe++){const Be=Re(p[qe]);if(Be instanceof Error)return Be;p[qe]=Be}const de=Math.round((t-e)/864e5)+1;let Ce=de;const ke=e;for(let qe=0;qe<de;qe++){const Be=new Date().getTimezoneOffset()>0?ke.getUTCDay():ke.getDay();let We=T?H.includes(Be):Be===a[0]||Be===a[1];for(let tt=0;tt<p.length;tt++){const ot=p[tt];if(ot.getDate()===ke.getDate()&&ot.getMonth()===ke.getMonth()&&ot.getFullYear()===ke.getFullYear()){We=!0;break}}We&&Ce--,ke.setDate(ke.getDate()+1)}return Ce},_t.INTL=(e,t,a,p)=>{if((e=Re(e))instanceof Error)return e;if((t=Y(t))instanceof Error)return t;if(t<0)return h;if(!((a=a===void 0?Ht[1]:Ht[a])instanceof Array))return o;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let H=0;H<p.length;H++){const W=Re(p[H]);if(W instanceof Error)return W;p[H]=W}let T=0;for(;T<t;){e.setDate(e.getDate()+1);const H=e.getDay();if(H!==a[0]&&H!==a[1]){for(let W=0;W<p.length;W++){const oe=p[W];if(oe.getDate()===e.getDate()&&oe.getMonth()===e.getMonth()&&oe.getFullYear()===e.getFullYear()){T--;break}}T++}}return e};const gn=an;function sn(e,t=2,a=!1){if(e=Y(e),isNaN(e)||(t=Y(t),isNaN(t)))return o;if(t<0){const p=Math.pow(10,-t);e=Math.round(e/p)*p}else e=e.toFixed(t);if(a)e=e.toString().replace(/,/g,"");else{const p=e.toString().split(".");p[0]=p[0].replace(/\B(?=(\d{3})+$)/g,","),e=p.join(".")}return e}function vt(e,t){return me(e,t)||(e=_e(e),(t=Y(t))instanceof Error?t:new Array(t+1).join(e))}const bn=rn,mn=on;function Wt(e){return/^[01]{1,10}$/.test(e)}function ht(e,t,a){if(ae(e=Y(e),t=Y(t)))return e;if((a=a===void 0?"i":a)!=="i"&&a!=="j")return o;if(e===0&&t===0)return 0;if(e===0)return t===1?a:t.toString()+a;if(t===0)return e.toString();{const p=t>0?"+":"";return e.toString()+p+(t===1?a:t.toString()+a)}}function Xt(e,t){return t=t===void 0?0:t,ae(e=Y(e),t=Y(t))?o:f.erf(e)}function Gt(e){return isNaN(e)?o:f.erfc(e)}function $t(e){const t=lt(e),a=st(e);return ae(t,a)?o:Math.sqrt(Math.pow(t,2)+Math.pow(a,2))}function st(e){if(e===void 0||e===!0||e===!1)return o;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),a=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),a===0&&(a=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),T=p==="i"||p==="j";return t>=0||a>=0?T?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,a))||isNaN(e.substring(a+1,e.length-1))?h:-Number(e.substring(a+1,e.length-1)):h:T?isNaN(e.substring(0,e.length-1))?h:e.substring(0,e.length-1):isNaN(e)?h:0}function Kt(e){const t=lt(e),a=st(e);return ae(t,a)?o:t===0&&a===0?g:t===0&&a>0?Math.PI/2:t===0&&a<0?-Math.PI/2:a===0&&t>0?0:a===0&&t<0?-Math.PI:t>0?Math.atan(a/t):t<0&&a>=0?Math.atan(a/t)+Math.PI:Math.atan(a/t)-Math.PI}function qt(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.cos(t)*(Math.exp(a)+Math.exp(-a))/2,-Math.sin(t)*(Math.exp(a)-Math.exp(-a))/2,p)}function ln(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.cos(a)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(a)*(Math.exp(t)-Math.exp(-t))/2,p)}function Mt(e,t){const a=lt(e),p=st(e),T=lt(t),H=st(t);if(ae(a,p,T,H))return o;const W=e.substring(e.length-1),oe=t.substring(t.length-1);let de="i";if((W==="j"||oe==="j")&&(de="j"),T===0&&H===0)return h;const Ce=T*T+H*H;return ht((a*T+p*H)/Ce,(p*T-a*H)/Ce,de)}function lt(e){if(e===void 0||e===!0||e===!1)return o;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),a=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),a===0&&(a=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),T=p==="i"||p==="j";return t>=0||a>=0?T?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(0,t)):isNaN(e.substring(0,a))||isNaN(e.substring(a+1,e.length-1))?h:Number(e.substring(0,a)):h:T?isNaN(e.substring(0,e.length-1))?h:0:isNaN(e)?h:e}function Yt(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.sin(t)*(Math.exp(a)+Math.exp(-a))/2,Math.cos(t)*(Math.exp(a)-Math.exp(-a))/2,p)}function un(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.cos(a)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(a)*(Math.exp(t)+Math.exp(-t))/2,p)}Xt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Gt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const jn=l.DIST,vn=l.INV,yn=r.DIST,xn=Oe.MATH,wn=Oe.PRECISE,Cn=P.DIST,En=P.DIST.RT,An=P.INV,Ln=P.INV.RT,Mn=P.TEST,Nn=V.P,Tn=V.P,In=V.S,Dn=r.INV,Sn=Gt.PRECISE,Fn=Xt.PRECISE,On=G.DIST,kn=ne.DIST,Rn=ne.DIST.RT,Hn=ne.INV,Bn=ne.INV.RT,Pn=ft.MATH,_n=ft.PRECISE,Vn=ne.TEST,qn=ce.DIST,Yn=ce.INV,Un=fe.PRECISE,zn=Ee.DIST,Wn=ze.INV,Xn=ze.DIST,Gn=ze.INV,$n=we.MULT,Kn=we.SNGL,Jn=U.DIST,Zn=Pt.INTL,Qn=Z.DIST,er=Z.INV,tr=Z.S.DIST,nr=Z.S.INV,rr=F.EXC,or=F.INC,ir=X.EXC,ar=X.INC,sr=ue.DIST,lr=K.EXC,ur=K.INC,cr=le.AVG,dr=le.EQ,fr=je.P,pr=ve.P,hr=ve.S,gr=Ie.DIST,br=Ie.DIST.RT,mr=Ie.INV,jr=Ie.TEST,vr=Fe.P,yr=Fe.S,xr=ye.DIST,wr=_t.INTL,Cr=xe.TEST;function Jt(e){const t=[];return A(e,a=>{a&&t.push(a)}),t}function yt(e,t){const a={};for(let H=1;H<e[0].length;++H)a[H]=!0;let p=t[0].length;for(let H=1;H<t.length;++H)t[H].length>p&&(p=t[H].length);for(let H=1;H<e.length;++H)for(let W=1;W<e[H].length;++W){let oe=!1,de=!1;for(let Ce=0;Ce<t.length;++Ce){const ke=t[Ce];if(ke.length<p)continue;const qe=ke[0];if(e[H][0]===qe){de=!0;for(let Be=1;Be<ke.length;++Be)if(!oe)if(ke[Be]===void 0||ke[Be]==="*")oe=!0;else{const We=mt(ke[Be]+""),tt=[dt(e[H][W],at)].concat(We);oe=gt(tt)}}}de&&(a[W]=a[W]&&oe)}const T=[];for(let H=0;H<e[0].length;++H)a[H]&&T.push(H-1);return T}function Zt(e){return e&&e.getTime&&!isNaN(e.getTime())}function Qt(e){return e instanceof Date?e:new Date(e)}function Nt(e,t,a,p,T){if(p=p||0,T=T||0,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T)))return o;let H;if(e===0)H=p+a*t;else{const W=Math.pow(1+e,t);H=T===1?p*W+a*(1+e)*(W-1)/e:p*W+a*(W-1)/e}return-H}function cn(e,t,a,p,T,H){if(T=T||0,H=H||0,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T),H=Y(H)))return o;const W=Dt(e,a,p,T,H);return(t===1?H===1?0:-p:H===1?Nt(e,t-2,W,p,1)-W:Nt(e,t-1,W,p,0))*e}function en(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=e[0];let a=0;for(let p=1;p<e.length;p++)a+=e[p]/Math.pow(1+t,p);return a}function Dt(e,t,a,p,T){if(p=p||0,T=T||0,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T)))return o;let H;if(e===0)H=(a+p)/t;else{const W=Math.pow(1+e,t);H=T===1?(p*e/(W-1)+a*e/(1-1/W))/(1+e):p*e/(W-1)+a*e/(1-1/W)}return-H}const Er={errors:B,symbols:dn};b.ABS=function(e){return(e=Y(e))instanceof Error?e:Math.abs(e)},b.ACCRINT=function(e,t,a,p,T,H,W){return e=Qt(e),t=Qt(t),a=Qt(a),Zt(e)&&Zt(t)&&Zt(a)?p<=0||T<=0||[1,2,4].indexOf(H)===-1||[0,1,2,3,4].indexOf(W)===-1||a<=e?h:(T=T||0)*p*zt(e,a,W=W||0):o},b.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},b.ACOS=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=h),t},b.ACOSH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=h),t},b.ACOT=function(e){return(e=Y(e))instanceof Error?e:Math.atan(1/e)},b.ACOTH=function(e){if((e=Y(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=h),t},b.AGGREGATE=function(e,t,a,p){if(ae(e=Y(e),Y(e)))return o;switch(e){case 1:return w(a);case 2:return ee(a);case 3:return O(a);case 4:return Ke(a);case 5:return he(a);case 6:return Xe(a);case 7:return ve.S(a);case 8:return ve.P(a);case 9:return At(a);case 10:return Fe.S(a);case 11:return Fe.P(a);case 12:return Q(a);case 13:return we.SNGL(a);case 14:return De(a,p);case 15:return Ne(a,p);case 16:return F.INC(a,p);case 17:return K.INC(a,p);case 18:return F.EXC(a,p);case 19:return K.EXC(a,p)}},b.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},b.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},b.AND=function(){const e=q(arguments);let t=o;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===o&&(t=!0),e[a]||(t=!1))}return t},b.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return o;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,a=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),t},b.ASC=function(){throw new Error("ASC is not implemented")},b.ASIN=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=h),t},b.ASINH=function(e){return(e=Y(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},b.ATAN=function(e){return(e=Y(e))instanceof Error?e:Math.atan(e)},b.ATAN2=function(e,t){return me(e=Y(e),t=Y(t))||Math.atan2(e,t)},b.ATANH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=h),t},b.AVEDEV=function(){const e=q(arguments).filter(Qe);if(e.length===0)return h;const t=Le(e);return t instanceof Error?t:f.sum(f(t).subtract(f.mean(t)).abs()[0])/t.length},b.AVERAGE=w,b.AVERAGEA=E,b.AVERAGEIF=function(e,t,a){if(arguments.length<=1)return C;if(a=Le(q(a=a||e).filter(Qe)),e=q(e),a instanceof Error)return a;let p=0,T=0;const H=t===void 0||t==="*",W=H?null:mt(t+"");for(let oe=0;oe<e.length;oe++){const de=e[oe];if(H)T+=a[oe],p++;else{const Ce=[dt(de,at)].concat(W);gt(Ce)&&(T+=a[oe],p++)}}return T/p},b.AVERAGEIFS=function(){const e=D(arguments),t=(e.length-1)/2,a=q(e[0]);let p=0,T=0;for(let W=0;W<a.length;W++){let oe=!1;for(let de=0;de<t;de++){const Ce=e[2*de+1][W],ke=e[2*de+2];let qe=!1;if(ke===void 0||ke==="*")qe=!0;else{const Be=mt(ke+""),We=[dt(Ce,at)].concat(Be);qe=gt(We)}if(!qe){oe=!1;break}oe=!0}oe&&(T+=a[W],p++)}const H=T/p;return isNaN(H)?0:H},b.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},b.BASE=function(e,t,a){const p=me(e=Y(e),t=Y(t),a=Y(a));if(p)return p;if(t===0)return h;const T=e.toString(t);return new Array(Math.max(a+1-T.length,0)).join("0")+T},b.BESSELI=function(e,t){return ae(e=Y(e),t=Y(t))?o:k.besseli(e,t)},b.BESSELJ=function(e,t){return ae(e=Y(e),t=Y(t))?o:k.besselj(e,t)},b.BESSELK=function(e,t){return ae(e=Y(e),t=Y(t))?o:k.besselk(e,t)},b.BESSELY=function(e,t){return ae(e=Y(e),t=Y(t))?o:k.bessely(e,t)},b.BETA=l,b.BETADIST=jn,b.BETAINV=vn,b.BIN2DEC=function(e){if(!Wt(e))return h;const t=parseInt(e,2),a=e.toString();return a.length===10&&a.substring(0,1)==="1"?parseInt(a.substring(1),2)-512:t},b.BIN2HEX=function(e,t){if(!Wt(e))return h;const a=e.toString();if(a.length===10&&a.substring(0,1)==="1")return(0xfffffffe00+parseInt(a.substring(1),2)).toString(16);const p=parseInt(e,2).toString(16);return t===void 0?p:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},b.BIN2OCT=function(e,t){if(!Wt(e))return h;const a=e.toString();if(a.length===10&&a.substring(0,1)==="1")return(1073741312+parseInt(a.substring(1),2)).toString(8);const p=parseInt(e,2).toString(8);return t===void 0?p:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},b.BINOM=r,b.BINOMDIST=yn,b.BITAND=function(e,t){return ae(e=Y(e),t=Y(t))?o:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e&t},b.BITLSHIFT=function(e,t){return ae(e=Y(e),t=Y(t))?o:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e<<t:e>>-t},b.BITOR=function(e,t){return ae(e=Y(e),t=Y(t))?o:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e|t},b.BITRSHIFT=function(e,t){return ae(e=Y(e),t=Y(t))?o:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e>>t:e<<-t},b.BITXOR=function(e,t){return ae(e=Y(e),t=Y(t))?o:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e^t},b.CEILING=Oe,b.CEILINGMATH=xn,b.CEILINGPRECISE=wn,b.CELL=function(){throw new Error("CELL is not implemented")},b.CHAR=rn,b.CHIDIST=Cn,b.CHIDISTRT=En,b.CHIINV=An,b.CHIINVRT=Ln,b.CHISQ=P,b.CHITEST=Mn,b.CHOOSE=function(){if(arguments.length<2)return C;const e=arguments[0];return e<1||e>254||arguments.length<e+1?o:arguments[e]},b.CLEAN=function(e){return ae(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},b.CODE=on,b.COLUMN=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?f.col(e,t):void 0:o},b.COLUMNS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:f.cols(e):o},b.COMBIN=$e,b.COMBINA=function(e,t){return me(e=Y(e),t=Y(t))||(e<t?h:e===0&&t===0?1:$e(e+t-1,e-1))},b.COMPLEX=ht,b.CONCAT=gn,b.CONCATENATE=an,b.CONFIDENCE=te,b.CONVERT=function(e,t,a){if((e=Y(e))instanceof Error)return e;const p=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],T={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},H={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let W,oe=null,de=null,Ce=t,ke=a,qe=1,Be=1;for(let We=0;We<p.length;We++)W=p[We][2]===null?[]:p[We][2],(p[We][1]===Ce||W.indexOf(Ce)>=0)&&(oe=p[We]),(p[We][1]===ke||W.indexOf(ke)>=0)&&(de=p[We]);if(oe===null){const We=T[t.substring(0,2)];let tt=H[t.substring(0,1)];t.substring(0,2)==="da"&&(tt=["dekao",10,"da"]),We?(qe=We[2],Ce=t.substring(2)):tt&&(qe=tt[1],Ce=t.substring(tt[2].length));for(let ot=0;ot<p.length;ot++)W=p[ot][2]===null?[]:p[ot][2],(p[ot][1]===Ce||W.indexOf(Ce)>=0)&&(oe=p[ot])}if(de===null){const We=T[a.substring(0,2)];let tt=H[a.substring(0,1)];a.substring(0,2)==="da"&&(tt=["dekao",10,"da"]),We?(Be=We[2],ke=a.substring(2)):tt&&(Be=tt[1],ke=a.substring(tt[2].length));for(let ot=0;ot<p.length;ot++)W=p[ot][2]===null?[]:p[ot][2],(p[ot][1]===ke||W.indexOf(ke)>=0)&&(de=p[ot])}return oe===null||de===null||oe[3]!==de[3]?C:e*oe[6]*qe/(de[6]*Be)},b.CORREL=function(e,t){return ae(e=Le(q(e)),t=Le(q(t)))?o:f.corrcoeff(e,t)},b.COS=function(e){return(e=Y(e))instanceof Error?e:Math.cos(e)},b.COSH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},b.COT=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.tan(e)},b.COTH=function(e){if((e=Y(e))instanceof Error)return e;if(e===0)return g;const t=Math.exp(2*e);return(t+1)/(t-1)},b.COUNT=ee,b.COUNTA=O,b.COUNTBLANK=N,b.COUNTIF=function(e,t){if(e=q(e),t===void 0||t==="*")return e.length;let a=0;const p=mt(t+"");for(let T=0;T<e.length;T++){const H=[dt(e[T],at)].concat(p);gt(H)&&a++}return a},b.COUNTIFS=function(){const e=D(arguments),t=new Array(q(e[0]).length);for(let p=0;p<t.length;p++)t[p]=!0;for(let p=0;p<e.length;p+=2){const T=q(e[p]),H=e[p+1];if(H!==void 0&&H!=="*"){const W=mt(H+"");for(let oe=0;oe<T.length;oe++){const de=[dt(T[oe],at)].concat(W);t[oe]=t[oe]&&gt(de)}}}let a=0;for(let p=0;p<t.length;p++)t[p]&&a++;return a},b.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},b.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},b.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},b.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},b.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},b.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},b.COVAR=Nn,b.COVARIANCE=V,b.COVARIANCEP=Tn,b.COVARIANCES=In,b.CRITBINOM=Dn,b.CSC=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.sin(e)},b.CSCH=function(e){return(e=Y(e))instanceof Error?e:e===0?g:2/(Math.exp(e)-Math.exp(-e))},b.CUMIPMT=function(e,t,a,p,T,H){if(ae(e=Y(e),t=Y(t),a=Y(a)))return o;if(e<=0||t<=0||a<=0||p<1||T<1||p>T||H!==0&&H!==1)return h;const W=Dt(e,t,a,0,H);let oe=0;p===1&&(H===0&&(oe=-a),p++);for(let de=p;de<=T;de++)oe+=H===1?Nt(e,de-2,W,a,1)-W:Nt(e,de-1,W,a,0);return oe*=e,oe},b.CUMPRINC=function(e,t,a,p,T,H){if(ae(e=Y(e),t=Y(t),a=Y(a)))return o;if(e<=0||t<=0||a<=0||p<1||T<1||p>T||H!==0&&H!==1)return h;const W=Dt(e,t,a,0,H);let oe=0;p===1&&(oe=H===0?W+a*e:W,p++);for(let de=p;de<=T;de++)oe+=H>0?W-(Nt(e,de-2,W,a,1)-W)*e:W-Nt(e,de-1,W,a,0)*e;return oe},b.DATE=function(e,t,a){let p;return ae(e=Y(e),t=Y(t),a=Y(a))?p=o:(p=new Date(e,t-1,a),p.getFullYear()<0&&(p=h)),p},b.DATEDIF=It,b.DATEVALUE=function(e){if(typeof e!="string")return o;const t=Date.parse(e);return isNaN(t)?o:new Date(e)},b.DAVERAGE=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);let H=0;return A(p,W=>{H+=T[W]}),p.length===0?g:H/p.length},b.DAY=function(e){const t=Re(e);return t instanceof Error?t:t.getDate()},b.DAYS=Lt,b.DAYS360=wt,b.DB=function(e,t,a,p,T){if(T=T===void 0?12:T,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T)))return o;if(e<0||t<0||a<0||p<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(T)===-1||p>a)return h;if(t>=e)return 0;const H=(1-Math.pow(t/e,1/a)).toFixed(3),W=e*H*T/12;let oe=W,de=0;const Ce=p===a?a-1:p;for(let ke=2;ke<=Ce;ke++)de=(e-oe)*H,oe+=de;return p===1?W:p===a?(e-oe)*H:de},b.DBCS=function(){throw new Error("DBCS is not implemented")},b.DCOUNT=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);const H=[];return A(p,W=>{H.push(T[W])}),ee(H)},b.DCOUNTA=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);const H=[];return A(p,W=>{H.push(T[W])}),O(H)},b.DDB=function(e,t,a,p,T){if(T=T===void 0?2:T,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T)))return o;if(e<0||t<0||a<0||p<0||T<=0||p>a)return h;if(t>=e)return 0;let H=0,W=0;for(let oe=1;oe<=p;oe++)W=Math.min(T/a*(e-H),e-t-H),H+=W;return W},b.DEC2BIN=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return h;if(e<0)return"1"+vt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const a=parseInt(e,10).toString(2);return t===void 0?a:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=a.length?vt("0",t-a.length)+a:h},b.DEC2HEX=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return h;if(e<0)return(1099511627776+e).toString(16);const a=parseInt(e,10).toString(16);return t===void 0?a:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=a.length?vt("0",t-a.length)+a:h},b.DEC2OCT=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return h;if(e<0)return(1073741824+e).toString(8);const a=parseInt(e,10).toString(8);return t===void 0?a:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=a.length?vt("0",t-a.length)+a:h},b.DECIMAL=function(e,t){return arguments.length<1?o:me(e=Y(e),t=Y(t))||(t===0?h:parseInt(e,t))},b.DEGREES=function(e){return(e=Y(e))instanceof Error?e:180*e/Math.PI},b.DELTA=function(e,t){return t=t===void 0?0:t,ae(e=Y(e),t=Y(t))?o:e===t?1:0},b.DEVSQ=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=f.mean(e);let a=0;for(let p=0;p<e.length;p++)a+=Math.pow(e[p]-t,2);return a},b.DGET=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];return T=se(typeof t=="string"?e[Me(e,t)]:e[t]),p.length===0?o:p.length>1?h:T[p[0]]},b.DISC=function(e,t,a,p,T){if(ae(e=Re(e),t=Re(t),a=Y(a),p=Y(p),T=(T=Y(T))||0))return o;if(a<=0||p<=0)return h;if(e>=t)return o;let H,W;switch(T){case 0:H=360,W=wt(e,t,!1);break;case 1:case 3:H=365,W=It(e,t,"D");break;case 2:H=360,W=It(e,t,"D");break;case 4:H=360,W=wt(e,t,!0);break;default:return h}return(p-a)/p*H/W},b.DMAX=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);let H=T[p[0]];return A(p,W=>{H<T[W]&&(H=T[W])}),H},b.DMIN=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);let H=T[p[0]];return A(p,W=>{H>T[W]&&(H=T[W])}),H},b.DOLLAR=function(e,t=2){if(e=Y(e),isNaN(e))return o;const a={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},p=(e=xt(e,t)).toLocaleString("en-US",a);return e<0?"$("+p.slice(2)+")":p},b.DOLLARDE=function(e,t){if(ae(e=Y(e),t=Y(t)))return o;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let a=parseInt(e,10);a+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const p=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return a=Math.round(a*p)/p,a},b.DOLLARFR=function(e,t){if(ae(e=Y(e),t=Y(t)))return o;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let a=parseInt(e,10);return a+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,a},b.DPRODUCT=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const oe=Me(e,t);T=se(e[oe])}else T=se(e[t]);let H=[];A(p,oe=>{H.push(T[oe])}),H=Jt(H);let W=1;return A(H,oe=>{W*=oe}),W},b.DSTDEV=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);let H=[];return A(p,W=>{H.push(T[W])}),H=Jt(H),ve.S(H)},b.DSTDEVP=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);let H=[];return A(p,W=>{H.push(T[W])}),H=Jt(H),ve.P(H)},b.DSUM=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);const H=[];return A(p,W=>{H.push(T[W])}),At(H)},b.DURATION=function(){throw new Error("DURATION is not implemented")},b.DVAR=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);const H=[];return A(p,W=>{H.push(T[W])}),Fe.S(H)},b.DVARP=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const p=yt(e,a);let T=[];if(typeof t=="string"){const W=Me(e,t);T=se(e[W])}else T=se(e[t]);const H=[];return A(p,W=>{H.push(T[W])}),Fe.P(H)},b.EDATE=function(e,t){return(e=Re(e))instanceof Error?e:isNaN(t)?o:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},b.EFFECT=function(e,t){return ae(e=Y(e),t=Y(t))?o:e<=0||t<1?h:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},b.EOMONTH=function(e,t){return(e=Re(e))instanceof Error?e:isNaN(t)?o:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},b.ERF=Xt,b.ERFC=Gt,b.ERFCPRECISE=Sn,b.ERFPRECISE=Fn,b.ERROR=St,b.EVEN=function(e){return(e=Y(e))instanceof Error?e:Oe(e,-2,-1)},b.EXACT=function(e,t){return arguments.length!==2?C:me(e,t)||(e=_e(e))===_e(t)},b.EXP=function(e){return arguments.length<1?C:arguments.length>1?L:(e=Y(e))instanceof Error?e:e=Math.exp(e)},b.EXPON=G,b.EXPONDIST=On,b.F=ne,b.FACT=it,b.FACTDOUBLE=function e(t){if((t=Y(t))instanceof Error)return t;const a=Math.floor(t);return a<=0?1:a*e(a-2)},b.FALSE=function(){return!1},b.FDIST=kn,b.FDISTRT=Rn,b.FIND=function(e,t,a){if(arguments.length<2)return C;e=_e(e),a=a===void 0?0:a;const p=(t=_e(t)).indexOf(e,a-1);return p===-1?o:p+1},b.FINV=Hn,b.FINVRT=Bn,b.FISHER=function(e){return(e=Y(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},b.FISHERINV=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},b.FIXED=sn,b.FLOOR=ft,b.FLOORMATH=Pn,b.FLOORPRECISE=_n,b.FORECAST=ge,b.FREQUENCY=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return o;const a=e.length,p=t.length,T=[];for(let H=0;H<=p;H++){T[H]=0;for(let W=0;W<a;W++)H===0?e[W]<=t[0]&&(T[0]+=1):H<p?e[W]>t[H-1]&&e[W]<=t[H]&&(T[H]+=1):H===p&&e[W]>t[p-1]&&(T[p]+=1)}return T},b.FTEST=Vn,b.FV=Nt,b.FVSCHEDULE=function(e,t){if(ae(e=Y(e),t=Le(q(t))))return o;const a=t.length;let p=e;for(let T=0;T<a;T++)p*=1+t[T];return p},b.GAMMA=ce,b.GAMMADIST=qn,b.GAMMAINV=Yn,b.GAMMALN=fe,b.GAMMALNPRECISE=Un,b.GAUSS=function(e){return(e=Y(e))instanceof Error?e:f.normal.cdf(e,0,1)-.5},b.GCD=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=e.length,a=e[0];let p=a<0?-a:a;for(let T=1;T<t;T++){const H=e[T];let W=H<0?-H:H;for(;p&&W;)p>W?p%=W:W%=p;p+=W}return p},b.GEOMEAN=function(){const e=Le(q(arguments));return e instanceof Error?e:f.geomean(e)},b.GESTEP=function(e,t){return ae(t=t||0,e=Y(e))?e:e>=t?1:0},b.GROWTH=function(e,t,a,p){if((e=Le(e))instanceof Error)return e;let T;if(t===void 0)for(t=[],T=1;T<=e.length;T++)t.push(T);if(a===void 0)for(a=[],T=1;T<=e.length;T++)a.push(T);if(ae(t=Le(t),a=Le(a)))return o;p===void 0&&(p=!0);const H=e.length;let W,oe,de=0,Ce=0,ke=0,qe=0;for(T=0;T<H;T++){const We=t[T],tt=Math.log(e[T]);de+=We,Ce+=tt,ke+=We*tt,qe+=We*We}de/=H,Ce/=H,ke/=H,qe/=H,p?(W=(ke-de*Ce)/(qe-de*de),oe=Ce-W*de):(W=ke/qe,oe=0);const Be=[];for(T=0;T<a.length;T++)Be.push(Math.exp(oe+W*a[T]));return Be},b.HARMEAN=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=e.length;let a=0;for(let p=0;p<t;p++)a+=1/e[p];return t/a},b.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const a=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),p=a?parseInt(e,16)-1099511627776:parseInt(e,16);if(p<-512||p>511)return h;if(a)return"1"+vt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const T=p.toString(2);return t===void 0?T:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=T.length?vt("0",t-T.length)+T:h},b.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},b.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const a=parseInt(e,16);if(a>536870911&&a<0xffe0000000)return h;if(a>=0xffe0000000)return(a-0xffc0000000).toString(8);const p=a.toString(8);return t===void 0?p:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},b.HLOOKUP=function(e,t,a,p){return Rt(e,be(t),a,p)},b.HOUR=function(e){return(e=Re(e))instanceof Error?e:e.getHours()},b.HYPGEOM=Ee,b.HYPGEOMDIST=zn,b.IF=function(e,t,a){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(a=arguments.length===3&&a)==null&&(a=0),e?t:a)},b.IFERROR=function(e,t){return Et(e)?t:e},b.IFNA=function(e,t){return e===C?t:e},b.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return C},b.IMABS=$t,b.IMAGINARY=st,b.IMARGUMENT=Kt,b.IMCONJUGATE=function(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",a!==0?ht(t,-a,p):e},b.IMCOS=qt,b.IMCOSH=ln,b.IMCOT=function(e){return ae(lt(e),st(e))?o:Mt(qt(e),Yt(e))},b.IMCSC=function(e){return e===!0||e===!1?o:ae(lt(e),st(e))?h:Mt("1",Yt(e))},b.IMCSCH=function(e){return e===!0||e===!1?o:ae(lt(e),st(e))?h:Mt("1",un(e))},b.IMDIV=Mt,b.IMEXP=function(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);p=p==="i"||p==="j"?p:"i";const T=Math.exp(t);return ht(T*Math.cos(a),T*Math.sin(a),p)},b.IMLN=function(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.log(Math.sqrt(t*t+a*a)),Math.atan(a/t),p)},b.IMLOG10=function(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.log(Math.sqrt(t*t+a*a))/Math.log(10),Math.atan(a/t)/Math.log(10),p)},b.IMLOG2=function(e){const t=lt(e),a=st(e);if(ae(t,a))return o;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.log(Math.sqrt(t*t+a*a))/Math.log(2),Math.atan(a/t)/Math.log(2),p)},b.IMPOWER=function(e,t){if(ae(t=Y(t),lt(e),st(e)))return o;let a=e.substring(e.length-1);a=a==="i"||a==="j"?a:"i";const p=Math.pow($t(e),t),T=Kt(e);return ht(p*Math.cos(t*T),p*Math.sin(t*T),a)},b.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return o;for(let t=1;t<arguments.length;t++){const a=lt(e),p=st(e),T=lt(arguments[t]),H=st(arguments[t]);if(ae(a,p,T,H))return o;e=ht(a*T-p*H,a*H+p*T)}return e},b.IMREAL=lt,b.IMSEC=function(e){return e===!0||e===!1||ae(lt(e),st(e))?o:Mt("1",qt(e))},b.IMSECH=function(e){return ae(lt(e),st(e))?o:Mt("1",ln(e))},b.IMSIN=Yt,b.IMSINH=un,b.IMSQRT=function(e){if(ae(lt(e),st(e)))return o;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const a=Math.sqrt($t(e)),p=Kt(e);return ht(a*Math.cos(p/2),a*Math.sin(p/2),t)},b.IMSUB=function(e,t){const a=lt(e),p=st(e),T=lt(t),H=st(t);if(ae(a,p,T,H))return o;const W=e.substring(e.length-1),oe=t.substring(t.length-1);let de="i";return(W==="j"||oe==="j")&&(de="j"),ht(a-T,p-H,de)},b.IMSUM=function(){if(!arguments.length)return o;const e=q(arguments);let t=e[0];for(let a=1;a<e.length;a++){const p=lt(t),T=st(t),H=lt(e[a]),W=st(e[a]);if(ae(p,T,H,W))return o;t=ht(p+H,T+W)}return t},b.IMTAN=function(e){return e===!0||e===!1||ae(lt(e),st(e))?o:Mt(Yt(e),qt(e))},b.INDEX=function(e,t,a){const p=me(e,t,a);if(p)return p;if(!Array.isArray(e))return o;const T=e.length>0&&!Array.isArray(e[0]);return T&&!a?(a=t,t=1):(a=a||1,t=t||1),a<0||t<0?o:T&&t===1&&a<=e.length?e[a-1]:t<=e.length&&a<=e[t-1].length?e[t-1][a-1]:m},b.INFO=function(){throw new Error("INFO is not implemented")},b.INT=function(e){return(e=Y(e))instanceof Error?e:Math.floor(e)},b.INTERCEPT=function(e,t){return ae(e=Le(e),t=Le(t))?o:e.length!==t.length?C:ge(0,e,t)},b.INTRATE=function(){throw new Error("INTRATE is not implemented")},b.IPMT=cn,b.IRR=function(e,t){if(t=t||0,ae(e=Le(q(e)),t=Y(t)))return o;const a=(Be,We,tt)=>{const ot=tt+1;let jt=Be[0];for(let ct=1;ct<Be.length;ct++)jt+=Be[ct]/Math.pow(ot,(We[ct]-We[0])/365);return jt},p=(Be,We,tt)=>{const ot=tt+1;let jt=0;for(let ct=1;ct<Be.length;ct++){const Ct=(We[ct]-We[0])/365;jt-=Ct*Be[ct]/Math.pow(ot,Ct+1)}return jt},T=[];let H=!1,W=!1;for(let Be=0;Be<e.length;Be++)T[Be]=Be===0?0:T[Be-1]+365,e[Be]>0&&(H=!0),e[Be]<0&&(W=!0);if(!H||!W)return h;let oe,de,Ce,ke=t=t===void 0?.1:t,qe=!0;do Ce=a(e,T,ke),oe=ke-Ce/p(e,T,ke),de=Math.abs(oe-ke),ke=oe,qe=de>1e-10&&Math.abs(Ce)>1e-10;while(qe);return ke},b.ISBLANK=function(e){return e===null},b.ISERR=Ft,b.ISERROR=Et,b.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},b.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},b.ISLOGICAL=Ot,b.ISNA=function(e){return e===C},b.ISNONTEXT=function(e){return typeof e!="string"},b.ISNUMBER=Tt,b.ISO=rt,b.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},b.ISOWEEKNUM=tn,b.ISPMT=function(e,t,a,p){return ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p))?o:p*e*(t/a-1)},b.ISREF=function(){throw new Error("ISREF is not implemented")},b.ISTEXT=bt,b.KURT=function(){const e=Le(q(arguments));if(e instanceof Error)return e;const t=f.mean(e),a=e.length;let p=0;for(let T=0;T<a;T++)p+=Math.pow(e[T]-t,4);return p/=Math.pow(f.stdev(e,!0),4),a*(a+1)/((a-1)*(a-2)*(a-3))*p-3*(a-1)*(a-1)/((a-2)*(a-3))},b.LARGE=De,b.LCM=function(){const e=Le(q(arguments));if(e instanceof Error)return e;for(var t,a,p,T,H=1;(p=e.pop())!==void 0;){if(p===0)return 0;for(;p>1;){if(p%2){for(t=3,a=Math.floor(Math.sqrt(p));t<=a&&p%t;t+=2);T=t<=a?t:p}else T=2;for(p/=T,H*=T,t=e.length;t;e[--t]%T==0&&(e[t]/=T)==1&&e.splice(t,1));}}return H},b.LEFT=function(e,t){return me(e,t)||(e=_e(e),(t=Y(t=t===void 0?1:t))instanceof Error||typeof e!="string"?o:e.substring(0,t))},b.LEN=function(e){return arguments.length===0?L:e instanceof Error?e:Array.isArray(e)?o:_e(e).length},b.LINEST=Se,b.LN=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)},b.LOG=function(e,t){return me(e=Y(e),t=Y(t))||(e===0||t===0?h:Math.log(e)/Math.log(t))},b.LOG10=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)/Math.log(10)},b.LOGEST=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t)))||e.length!==t.length)return o;for(let p=0;p<e.length;p++)e[p]=Math.log(e[p]);const a=Se(e,t);return a[0]=Math.round(1e6*Math.exp(a[0]))/1e6,a[1]=Math.round(1e6*Math.exp(a[1]))/1e6,a},b.LOGINV=Wn,b.LOGNORM=ze,b.LOGNORMDIST=Xn,b.LOGNORMINV=Gn,b.LOOKUP=function(e,t,a){t=q(t),a=a?q(a):t;const p=typeof e=="number";let T=C;for(let H=0;H<t.length;H++){if(t[H]===e)return a[H];if(p&&t[H]<=e||typeof t[H]=="string"&&t[H].localeCompare(e)<0)T=a[H];else if(p&&t[H]>e)return T}return T},b.LOWER=function(e){return arguments.length!==1?o:ae(e=_e(e))?e:e.toLowerCase()},b.MATCH=function(e,t,a){if(!e||!t||(arguments.length===2&&(a=1),!((t=q(t))instanceof Array))||a!==-1&&a!==0&&a!==1)return C;let p,T;for(let H=0;H<t.length;H++)if(a===1){if(t[H]===e)return H+1;t[H]<e&&(T?t[H]>T&&(p=H+1,T=t[H]):(p=H+1,T=t[H]))}else if(a===0){if(typeof e=="string"&&typeof t[H]=="string"){const W=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+W+"$").test(t[H].toLowerCase()))return H+1}else if(t[H]===e)return H+1}else if(a===-1){if(t[H]===e)return H+1;t[H]>e&&(T?t[H]<T&&(p=H+1,T=t[H]):(p=H+1,T=t[H]))}return p||C},b.MAX=Ke,b.MAXA=function(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;let a=S(e);return a=a.map(p=>p??0),a.length===0?0:Math.max.apply(Math,a)},b.MDURATION=function(){throw new Error("MDURATION is not implemented")},b.MEDIAN=Q,b.MID=function(e,t,a){if(t==null)return o;if(ae(t=Y(t),a=Y(a))||typeof e!="string")return a;const p=t-1,T=p+a;return e.substring(p,T)},b.MIN=he,b.MINA=function(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;let a=S(e);return a=a.map(p=>p??0),a.length===0?0:Math.min.apply(Math,a)},b.MINUTE=function(e){return(e=Re(e))instanceof Error?e:e.getMinutes()},b.MIRR=function(e,t,a){if(ae(e=Le(q(e)),t=Y(t),a=Y(a)))return o;const p=e.length,T=[],H=[];for(let de=0;de<p;de++)e[de]<0?T.push(e[de]):H.push(e[de]);const W=-en(a,H)*Math.pow(1+a,p-1),oe=en(t,T)*(1+t);return Math.pow(W/oe,1/(p-1))-1},b.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(a=>!a.length)||t.some(a=>!a.length)||ie(e).some(a=>typeof a!="number")||ie(t).some(a=>typeof a!="number")||e[0].length!==t.length?o:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((a,p)=>a.map((T,H)=>e[p].reduce((W,oe,de)=>W+oe*t[de][H],0)))},b.MOD=function(e,t){const a=me(e=Y(e),t=Y(t));if(a)return a;if(t===0)return g;let p=Math.abs(e%t);return p=e<0?t-p:p,t>0?p:-p},b.MODE=we,b.MODEMULT=$n,b.MODESNGL=Kn,b.MONTH=function(e){return(e=Re(e))instanceof Error?e:e.getMonth()+1},b.MROUND=function(e,t){return me(e=Y(e),t=Y(t))||(e*t==0?0:e*t<0?h:Math.round(e/t)*t)},b.MULTINOMIAL=function(){const e=Le(q(arguments));if(e instanceof Error)return e;let t=0,a=1;for(let p=0;p<e.length;p++)t+=e[p],a*=it(e[p]);return it(t)/a},b.MUNIT=function(e){return arguments.length>1?C:!(e=parseInt(e))||e<=0?o:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,a)=>(t[a]=1,t))},b.N=function(e){return Tt(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Et(e)?e:0},b.NA=function(){return C},b.NEGBINOM=U,b.NEGBINOMDIST=Jn,b.NETWORKDAYS=Pt,b.NETWORKDAYSINTL=Zn,b.NOMINAL=function(e,t){return ae(e=Y(e),t=Y(t))?o:e<=0||t<1?h:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},b.NORM=Z,b.NORMDIST=Qn,b.NORMINV=er,b.NORMSDIST=tr,b.NORMSINV=nr,b.NOT=function(e){return typeof e=="string"?o:e instanceof Error?e:!e},b.NOW=function(){return new Date},b.NPER=function(e,t,a,p,T){if(T=T===void 0?0:T,p=p===void 0?0:p,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T)))return o;if(e===0)return-(a+p)/t;{const H=t*(1+e*T)-p*e,W=a*e+t*(1+e*T);return Math.log(H/W)/Math.log(1+e)}},b.NPV=en,b.NUMBERVALUE=function(e,t,a){return typeof(e=Qe(e)?e:"")=="number"?e:typeof e!="string"?C:(t=t===void 0?".":t,a=a===void 0?",":a,Number(e.replace(t,".").replace(a,"")))},b.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const a=!(e.length!==10||e.substring(0,1)!=="7"),p=a?parseInt(e,8)-1073741824:parseInt(e,8);if(p<-512||p>511)return h;if(a)return"1"+vt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const T=p.toString(2);return t===void 0?T:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=T.length?vt("0",t-T.length)+T:h},b.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return h;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},b.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const a=parseInt(e,8);if(a>=536870912)return"ff"+(a+3221225472).toString(16);const p=a.toString(16);return t===void 0?p:isNaN(t)?o:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},b.ODD=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},b.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},b.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},b.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},b.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},b.OR=function(){const e=q(arguments);let t=o;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===o&&(t=!1),e[a]&&(t=!0))}return t},b.PDURATION=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?o:e<=0?h:(Math.log(a)-Math.log(t))/Math.log(1+e)},b.PEARSON=v,b.PERCENTILE=F,b.PERCENTILEEXC=rr,b.PERCENTILEINC=or,b.PERCENTRANK=X,b.PERCENTRANKEXC=ir,b.PERCENTRANKINC=ar,b.PERMUT=function(e,t){return ae(e=Y(e),t=Y(t))?o:it(e)/it(e-t)},b.PERMUTATIONA=function(e,t){return ae(e=Y(e),t=Y(t))?o:Math.pow(e,t)},b.PHI=function(e){return(e=Y(e))instanceof Error?o:Math.exp(-.5*e*e)/2.5066282746310002},b.PI=function(){return Math.PI},b.PMT=Dt,b.POISSON=ue,b.POISSONDIST=sr,b.POWER=ut,b.PPMT=function(e,t,a,p,T,H){return T=T||0,H=H||0,ae(e=Y(e),a=Y(a),p=Y(p),T=Y(T),H=Y(H))?o:Dt(e,a,p,T,H)-cn(e,t,a,p,T,H)},b.PRICE=function(){throw new Error("PRICE is not implemented")},b.PRICEDISC=function(e,t,a,p,T){if(ae(e=Re(e),t=Re(t),a=Y(a),p=Y(p),T=(T=Y(T))||0))return o;if(a<=0||p<=0)return h;if(e>=t)return o;let H,W;switch(T){case 0:H=360,W=wt(e,t,!1);break;case 1:case 3:H=365,W=It(e,t,"D");break;case 2:H=360,W=It(e,t,"D");break;case 4:H=360,W=wt(e,t,!0);break;default:return h}return p-a*p*W/H},b.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},b.PROB=function(e,t,a,p){if(a===void 0)return 0;if(p=p===void 0?a:p,ae(e=Le(q(e)),t=Le(q(t)),a=Y(a),p=Y(p)))return o;if(a===p)return e.indexOf(a)>=0?t[e.indexOf(a)]:0;const T=e.sort((oe,de)=>oe-de),H=T.length;let W=0;for(let oe=0;oe<H;oe++)T[oe]>=a&&T[oe]<=p&&(W+=t[e.indexOf(T[oe])]);return W},b.PRODUCT=Xe,b.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},b.PROPER=function(e){return ae(e)?e:isNaN(e)&&typeof e=="number"?o:(e=_e(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},b.PV=function(e,t,a,p,T){return p=p||0,T=T||0,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T))?o:e===0?-a*t-p:((1-Math.pow(1+e,t))/e*a*(1+e*T)-p)/Math.pow(1+e,t)},b.QUARTILE=K,b.QUARTILEEXC=lr,b.QUARTILEINC=ur,b.QUOTIENT=function(e,t){return me(e=Y(e),t=Y(t))||parseInt(e/t,10)},b.RADIANS=function(e){return(e=Y(e))instanceof Error?e:e*Math.PI/180},b.RAND=function(){return Math.random()},b.RANDBETWEEN=function(e,t){return me(e=Y(e),t=Y(t))||e+Math.ceil((t-e+1)*Math.random())-1},b.RANK=le,b.RANKAVG=cr,b.RANKEQ=dr,b.RATE=function(e,t,a,p,T,H){if(H=H===void 0?.01:H,p=p===void 0?0:p,T=T===void 0?0:T,ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p),T=Y(T),H=Y(H)))return o;const W=1e-10;let oe=H;T=T?1:0;for(let de=0;de<20;de++){if(oe<=-1)return h;let Ce,ke,qe;if(Math.abs(oe)<W?Ce=a*(1+e*oe)+t*(1+oe*T)*e+p:(ke=Math.pow(1+oe,e),Ce=a*ke+t*(1/oe+T)*(ke-1)+p),Math.abs(Ce)<W)return oe;if(Math.abs(oe)<W)qe=a*e+t*T*e;else{ke=Math.pow(1+oe,e);const Be=e*Math.pow(1+oe,e-1);qe=a*Be+t*(1/oe+T)*Be+t*(-1/(oe*oe))*(ke-1)}oe-=Ce/qe}return oe},b.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},b.REPLACE=function(e,t,a,p){return ae(t=Y(t),a=Y(a))||typeof e!="string"||typeof p!="string"?o:e.substr(0,t-1)+p+e.substr(t-1+a)},b.REPT=vt,b.RIGHT=function(e,t){return me(e,t)||(e=_e(e),(t=Y(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},b.ROMAN=function(e){if((e=Y(e))instanceof Error)return e;const t=String(e).split(""),a=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let p="",T=3;for(;T--;)p=(a[+t.pop()+10*T]||"")+p;return new Array(+t.join("")+1).join("M")+p},b.ROUND=xt,b.ROUNDDOWN=function(e,t){return me(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.ROUNDUP=function(e,t){return me(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.ROW=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?f.row(e,t):void 0:o},b.ROWS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:f.rows(e):o},b.RRI=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?o:e===0||t===0?h:Math.pow(a/t,1/e)-1},b.RSQ=function(e,t){return ae(e=Le(q(e)),t=Le(q(t)))?o:Math.pow(v(e,t),2)},b.SEARCH=function(e,t,a){let p;return typeof e!="string"||typeof t!="string"?o:(a=a===void 0?0:a,p=t.toLowerCase().indexOf(e.toLowerCase(),a-1)+1,p===0?o:p)},b.SEC=function(e){return(e=Y(e))instanceof Error?e:1/Math.cos(e)},b.SECH=function(e){return(e=Y(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},b.SECOND=function(e){return(e=Re(e))instanceof Error?e:e.getSeconds()},b.SERIESSUM=function(e,t,a,p){if(ae(e=Y(e),t=Y(t),a=Y(a),p=Le(p)))return o;let T=p[0]*Math.pow(e,t);for(let H=1;H<p.length;H++)T+=p[H]*Math.pow(e,t+H*a);return T},b.SHEET=function(){throw new Error("SHEET is not implemented")},b.SHEETS=function(){throw new Error("SHEETS is not implemented")},b.SIGN=function(e){return(e=Y(e))instanceof Error?e:e<0?-1:e===0?0:1},b.SIN=function(e){return(e=Y(e))instanceof Error?e:Math.sin(e)},b.SINH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},b.SKEW=je,b.SKEWP=fr,b.SLN=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?o:a===0?h:(e-t)/a},b.SLOPE=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return o;const a=f.mean(t),p=f.mean(e),T=t.length;let H=0,W=0;for(let oe=0;oe<T;oe++)H+=(t[oe]-a)*(e[oe]-p),W+=Math.pow(t[oe]-a,2);return H/W},b.SMALL=Ne,b.SORT=function(e,t=1,a=1,p=!1){if(!e||!Array.isArray(e))return C;if(e.length===0)return 0;if(!(t=Y(t))||t<1||(a=Y(a))!==1&&a!==-1)return o;if(typeof(p=Ue(p))!="boolean")return j;const T=oe=>oe.sort((de,Ce)=>(de=_e(de[t-1]),Ce=_e(Ce[t-1]),a===1?de<Ce?-1*a:a:de>Ce?a:-1*a)),H=J(e),W=p?be(H):H;return t>=1&&t<=W[0].length?p?be(T(W)):T(W):o},b.SQRT=function(e){return(e=Y(e))instanceof Error?e:e<0?h:Math.sqrt(e)},b.SQRTPI=function(e){return(e=Y(e))instanceof Error?e:Math.sqrt(e*Math.PI)},b.STANDARDIZE=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?o:(e-t)/a},b.STDEV=ve,b.STDEVA=function(){const e=nt.apply(this,arguments);return Math.sqrt(e)},b.STDEVP=pr,b.STDEVPA=function(){const e=re.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},b.STDEVS=hr,b.STEYX=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return o;const a=f.mean(t),p=f.mean(e),T=t.length;let H=0,W=0,oe=0;for(let de=0;de<T;de++)H+=Math.pow(e[de]-p,2),W+=(t[de]-a)*(e[de]-p),oe+=Math.pow(t[de]-a,2);return Math.sqrt((H-W*W/oe)/(T-2))},b.SUBSTITUTE=function(e,t,a,p){if(arguments.length<3)return C;if(e&&t){if(p===void 0)return e.split(t).join(a);{if(p=Math.floor(Number(p)),Number.isNaN(p)||p<=0)return o;let T=0,H=0;for(;T>-1&&e.indexOf(t,T)>-1;)if(T=e.indexOf(t,T+1),H++,T>-1&&H===p)return e.substring(0,T)+a+e.substring(T+t.length);return e}}return e},b.SUBTOTAL=function(e,t){if((e=Y(e))instanceof Error)return e;switch(e){case 1:case 101:return w(t);case 2:case 102:return ee(t);case 3:case 103:return O(t);case 4:case 104:return Ke(t);case 5:case 105:return he(t);case 6:case 106:return Xe(t);case 7:case 107:return ve.S(t);case 8:case 108:return ve.P(t);case 9:case 109:return At(t);case 10:case 110:return Fe.S(t);case 11:case 111:return Fe.P(t)}},b.SUM=At,b.SUMIF=function(e,t,a){if(e=q(e),a=a?q(a):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let p=0;const T=t==="*",H=T?null:mt(t+"");for(let W=0;W<e.length;W++){const oe=e[W],de=a[W];if(T)p+=oe;else{const Ce=[dt(oe,at)].concat(H);p+=gt(Ce)?de:0}}return p},b.SUMIFS=function(){const e=D(arguments),t=Le(q(e.shift()));if(t instanceof Error)return t;const a=e,p=a.length/2;for(let H=0;H<p;H++)a[2*H]=q(a[2*H]);let T=0;for(let H=0;H<t.length;H++){let W=!1;for(let oe=0;oe<p;oe++){const de=a[2*oe][H],Ce=a[2*oe+1];let ke=!1;if(Ce===void 0||Ce==="*")ke=!0;else{const qe=mt(Ce+""),Be=[dt(de,at)].concat(qe);ke=gt(Be)}if(!ke){W=!1;break}W=!0}W&&(T+=t[H])}return T},b.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return o;const e=arguments.length+1;let t,a,p,T,H=0;for(let W=0;W<arguments[0].length;W++)if(arguments[0][W]instanceof Array)for(let oe=0;oe<arguments[0][W].length;oe++){for(t=1,a=1;a<e;a++){const de=arguments[a-1][W][oe];if(de instanceof Error)return de;if(T=Y(de),T instanceof Error)return T;t*=T}H+=t}else{for(t=1,a=1;a<e;a++){const oe=arguments[a-1][W];if(oe instanceof Error)return oe;if(p=Y(oe),p instanceof Error)return p;t*=p}H+=t}return H},b.SUMSQ=function(){const e=Le(q(arguments));if(e instanceof Error)return e;let t=0;const a=e.length;for(let p=0;p<a;p++)t+=Tt(e[p])?e[p]*e[p]:0;return t},b.SUMX2MY2=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return o;let a=0;for(let p=0;p<e.length;p++)a+=e[p]*e[p]-t[p]*t[p];return a},b.SUMX2PY2=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return o;let a=0;e=Le(q(e)),t=Le(q(t));for(let p=0;p<e.length;p++)a+=e[p]*e[p]+t[p]*t[p];return a},b.SUMXMY2=function(e,t){if(ae(e=Le(q(e)),t=Le(q(t))))return o;let a=0;e=q(e),t=q(t);for(let p=0;p<e.length;p++)a+=Math.pow(e[p]-t[p],2);return a},b.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],a=arguments.length-1,p=Math.floor(a/2);let T=!1;const H=a%2!=0,W=a%2==0?null:arguments[arguments.length-1];if(p){for(let oe=0;oe<p;oe++)if(t===arguments[2*oe+1]){e=arguments[2*oe+2],T=!0;break}}T||(e=H?W:C)}else e=o;return e},b.SYD=function(e,t,a,p){return ae(e=Y(e),t=Y(t),a=Y(a),p=Y(p))?o:a===0||p<1||p>a?h:(e-t)*(a-(p=parseInt(p,10))+1)*2/(a*(a+1))},b.T=function(e){return e instanceof Error||typeof e=="string"?e:""},b.TAN=function(e){return(e=Y(e))instanceof Error?e:Math.tan(e)},b.TANH=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},b.TBILLEQ=function(e,t,a){return ae(e=Re(e),t=Re(t),a=Y(a))?o:a<=0||e>t||t-e>31536e6?h:365*a/(360-a*wt(e,t,!1))},b.TBILLPRICE=function(e,t,a){return ae(e=Re(e),t=Re(t),a=Y(a))?o:a<=0||e>t||t-e>31536e6?h:100*(1-a*wt(e,t,!1)/360)},b.TBILLYIELD=function(e,t,a){return ae(e=Re(e),t=Re(t),a=Y(a))?o:a<=0||e>t||t-e>31536e6?h:360*(100-a)/(a*wt(e,t,!1))},b.TDIST=gr,b.TDISTRT=br,b.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return C;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return o;const a=t.startsWith("$")?"$":"",p=t.endsWith("%");return p&&(e*=100),e=(e=sn(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+a+(e=e.replace("-","")):a+e,p&&(e+="%"),e},b.TEXTJOIN=function(e,t,...a){if(typeof t!="boolean"&&(t=Ue(t)),arguments.length<3)return C;e=e??"";let p=q(a),T=t?p.filter(H=>H):p;if(Array.isArray(e)){e=q(e);let H=T.map(oe=>[oe]),W=0;for(let oe=0;oe<H.length-1;oe++)H[oe].push(e[W]),W++,W===e.length&&(W=0);return T=q(H),T.join("")}return T.join(e)},b.TIME=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?o:e<0||t<0||a<0?h:(3600*e+60*t+a)/86400},b.TIMEVALUE=function(e){return(e=Re(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},b.TINV=mr,b.TODAY=function(){return Bt(new Date)},b.TRANSPOSE=function(e){return e?be(J(e)):C},b.TREND=function(e,t,a){if(ae(e=Le(q(e)),t=Le(q(t)),a=Le(q(a))))return o;const p=Se(e,t),T=p[0],H=p[1],W=[];return a.forEach(oe=>{W.push(T*oe+H)}),W},b.TRIM=function(e){return(e=_e(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},b.TRIMMEAN=function(e,t){if(ae(e=Le(q(e)),t=Y(t)))return o;const a=ft(e.length*t,2)/2;return f.mean((T=(T=a)||1,(p=se(e.sort((H,W)=>H-W),a))&&typeof p.slice=="function"?p.slice(0,p.length-T):p));var p,T},b.TRUE=function(){return!0},b.TRUNC=function(e,t){return me(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.TTEST=jr,b.TYPE=function(e){return Tt(e)?1:bt(e)?2:Ot(e)?4:Et(e)?16:Array.isArray(e)?64:void 0},b.UNICHAR=bn,b.UNICODE=mn,b.UNIQUE=kt,b.UPPER=function(e){return(e=_e(e))instanceof Error?e:e.toUpperCase()},b.VALUE=function(e){const t=me(e);if(t)return t;if(typeof e=="number")return e;if(Qe(e)||(e=""),typeof e!="string")return o;const a=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let p=Number(e);return isNaN(p)?o:(p=p||0,a&&(p*=.01),p)},b.VAR=Fe,b.VARA=nt,b.VARP=vr,b.VARPA=re,b.VARS=yr,b.VDB=function(){throw new Error("VDB is not implemented")},b.VLOOKUP=Rt,b.WEEKDAY=function(e,t){if((e=Re(e))instanceof Error)return e;t===void 0&&(t=1);const a=e.getDay();return hn[t][a]},b.WEEKNUM=function(e,t){if((e=Re(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return tn(e);const a=pn[t];let p=new Date(e.getFullYear(),0,1);const T=p.getDay()<a?1:0;return p-=24*Math.abs(p.getDay()-a)*60*60*1e3,Math.floor((e-p)/864e5/7+1)+T},b.WEIBULL=ye,b.WEIBULLDIST=xr,b.WORKDAY=_t,b.WORKDAYINTL=wr,b.XIRR=function(e,t,a){if(ae(e=Le(q(e)),t=Je(q(t)),a=Y(a)))return o;const p=(Be,We,tt)=>{const ot=tt+1;let jt=Be[0];for(let ct=1;ct<Be.length;ct++)jt+=Be[ct]/Math.pow(ot,Lt(We[ct],We[0])/365);return jt},T=(Be,We,tt)=>{const ot=tt+1;let jt=0;for(let ct=1;ct<Be.length;ct++){const Ct=Lt(We[ct],We[0])/365;jt-=Ct*Be[ct]/Math.pow(ot,Ct+1)}return jt};let H=!1,W=!1;for(let Be=0;Be<e.length;Be++)e[Be]>0&&(H=!0),e[Be]<0&&(W=!0);if(!H||!W)return h;let oe,de,Ce,ke=a=a||.1,qe=!0;do Ce=p(e,t,ke),oe=ke-Ce/T(e,t,ke),de=Math.abs(oe-ke),ke=oe,qe=de>1e-10&&Math.abs(Ce)>1e-10;while(qe);return ke},b.XNPV=function(e,t,a){if(ae(e=Y(e),t=Le(q(t)),a=Je(q(a))))return o;let p=0;for(let T=0;T<t.length;T++)p+=t[T]/Math.pow(1+e,Lt(a[T],a[0])/365);return p},b.XOR=function(){const e=q(arguments);let t=o;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===o&&(t=0),e[a]&&t++)}return t===o?t:!!(1&Math.floor(Math.abs(t)))},b.YEAR=function(e){return(e=Re(e))instanceof Error?e:e.getFullYear()},b.YEARFRAC=zt,b.YIELD=function(){throw new Error("YIELD is not implemented")},b.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},b.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},b.Z=xe,b.ZTEST=Cr,b.utils=Er}},d={};function M(z){var b=d[z];if(b!==void 0)return b.exports;var u=d[z]={exports:{}};return c[z].call(u.exports,u,u.exports,M),u.exports}M.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var R=M(960);s=R}(),s)},44:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(463);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var s=(""+n)[0];return s=="="||s=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var s={};return n.mask?s.mask=n.mask:n.format?s.mask=n.format:(s.locale=n.locale,s.options=n.options),n.decimal&&(s.options||(s.options={}),s.options={decimal:n.decimal}),s}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var s=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(s=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var c=obj.options.persistance==1?obj.options.url:obj.options.persistance,d=obj.prepareJson(arguments[2]);obj.save(c,d)}return s},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var s=Object.keys(obj.options.data[0]);s.length>n&&(n=s.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var c=[],d=0;d<n;d++)obj.options.colHeaders[d]||(obj.options.colHeaders[d]=""),obj.options.colWidths[d]||(obj.options.colWidths[d]=obj.options.defaultColWidth),obj.options.colAlignments[d]||(obj.options.colAlignments[d]=obj.options.defaultColAlign),obj.options.columns[d]?obj.options.columns[d].type||(obj.options.columns[d].type="text"):obj.options.columns[d]={type:"text"},obj.options.columns[d].name||(obj.options.columns[d].name=s&&s[d]?s[d]:d),obj.options.columns[d].source||(obj.options.columns[d].source=[]),obj.options.columns[d].options||(obj.options.columns[d].options=[]),obj.options.columns[d].editor||(obj.options.columns[d].editor=null),obj.options.columns[d].allowEmpty||(obj.options.columns[d].allowEmpty=!1),obj.options.columns[d].title||(obj.options.columns[d].title=obj.options.colHeaders[d]?obj.options.colHeaders[d]:""),obj.options.columns[d].width||(obj.options.columns[d].width=obj.options.colWidths[d]?obj.options.colWidths[d]:obj.options.defaultColWidth),obj.options.columns[d].align||(obj.options.columns[d].align=obj.options.colAlignments[d]?obj.options.colAlignments[d]:"center"),obj.options.columns[d].type=="autocomplete"||obj.options.columns[d].type=="dropdown"?obj.options.columns[d].url&&c.push({url:obj.options.columns[d].url,index:d,method:"GET",dataType:"json",success:function(M){for(var R=0;R<M.length;R++)obj.options.columns[this.index].source.push(M[R])}}):obj.options.columns[d].type=="calendar"&&(obj.options.columns[d].options.format||(obj.options.columns[d].options.format="DD/MM/YYYY"));c.length?jSuites.ajax(c,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(j){obj.scrollControls(j)},obj.content.onwheel=function(j){obj.wheelControls(j)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),s=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(s),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var c=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var d=0;d<obj.options.paginationOptions.length;d++){var M=document.createElement("option");M.value=obj.options.paginationOptions[d],M.innerHTML=obj.options.paginationOptions[d],obj.paginationDropdown.appendChild(M)}obj.paginationDropdown.value=obj.options.pagination,c.appendChild(document.createTextNode(obj.options.text.show)),c.appendChild(obj.paginationDropdown),c.appendChild(document.createTextNode(obj.options.text.entries))}var R,z=document.createElement("div");if(z.classList.add("jexcel_filter"),z.appendChild(c),z.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(R=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(R),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var b=0;b<obj.options.nestedHeaders.length;b++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[b]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(R=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(R),d=0;d<obj.options.columns.length;d++)obj.createCellHeader(d),obj.headerContainer.appendChild(obj.headers[d]),obj.colgroupContainer.appendChild(obj.colgroup[d]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var u=document.createElement("td");for(obj.filter.appendChild(u),d=0;d<obj.options.columns.length;d++)(u=document.createElement("td")).innerHTML="&nbsp;",u.setAttribute("data-x",d),u.className="jexcel_column_filter",obj.options.columns[d].type=="hidden"&&(u.style.display="none"),obj.filter.appendChild(u);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var f=document.createElement("a");f.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var k=document.createElement("span");k.innerHTML="Jspreadsheet CE",f.appendChild(k),obj.ads.appendChild(f),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var _=document.createElement("div"),g=document.createElement("div");if(obj.pagination.appendChild(_),obj.pagination.appendChild(g),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(z),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var o=Object.keys(obj.options.classes);for(d=0;d<o.length;d++){var m=jexcel.getIdFromColumnName(o[d],!0);obj.records[m[1]][m[0]].classList.add(obj.options.classes[o[d]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var s=0;s<obj.options.data.length;s++){for(var c=[],d=0;d<obj.options.columns.length;d++)c[d]=obj.options.data[s][obj.options.columns[d].name];n.push(c)}obj.options.data=n}s=0,d=0;var M=obj.options.columns.length,R=obj.options.data.length,z=obj.options.minDimensions[0],b=obj.options.minDimensions[1],u=z>M?z:M,f=b>R?b:R;for(s=0;s<f;s++)for(d=0;d<u;d++)obj.options.data[s]==null&&(obj.options.data[s]=[]),obj.options.data[s][d]==null&&(obj.options.data[s][d]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var k=0,_=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,k=obj.options.pagination*obj.pageNumber,_=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<_&&(_=obj.options.data.length)):(k=0,_=obj.options.data.length);for(s=0;s<obj.options.data.length;s++){var g=obj.createRow(s,obj.options.data[s]);s>=k&&s<_&&obj.tbody.appendChild(g)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var o=Object.keys(obj.options.mergeCells);for(d=0;d<o.length;d++){var m=obj.options.mergeCells[o[d]];obj.setMerge(o[d],m[0],m[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,s){for(var c=[],d=0,M=0,R=s==1||obj.options.copyCompatibility==0,z=obj.options.columns.length,b=obj.options.data.length,u=0;u<b;u++){d=0;for(var f=0;f<z;f++)n&&!obj.records[u][f].classList.contains("highlight")||(c[M]||(c[M]=[]),c[M][d]=R?obj.options.data[u][f]:obj.records[u][f].innerHTML,d++);d>0&&M++}return c},obj.getJsonRow=function(n){for(var s=obj.options.data[n],c=obj.options.columns.length,d={},M=0;M<c;M++)obj.options.columns[M].name||(obj.options.columns[M].name=M),d[obj.options.columns[M].name]=s[M];return d},obj.getJson=function(n){for(var s=[],c=obj.options.columns.length,d=obj.options.data.length,M=0;M<d;M++){for(var R=null,z=0;z<c;z++)n&&!obj.records[M][z].classList.contains("highlight")||(R==null&&(R={}),obj.options.columns[z].name||(obj.options.columns[z].name=z),R[obj.options.columns[z].name]=obj.options.data[M][z]);R!=null&&s.push(R)}return s},obj.prepareJson=function(n){for(var s=[],c=0;c<n.length;c++){var d=n[c].x,M=n[c].y,R=obj.options.columns[d].name?obj.options.columns[d].name:d;s[M]||(s[M]={row:M,data:{}}),s[M].data[R]=n[c].newValue}return s.filter(function(z){return z!=null})},obj.save=function(n,s){var c=obj.dispatch("onbeforesave",el,obj,s);if(c)s=c;else if(c===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(s)},success:function(d){obj.dispatch("onsave",el,obj,s)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,s){for(var c=0;c<obj.headers.length;c++){var d=jexcel.getColumnNameFromId([c,n]);s[c]!=null&&obj.setValue(d,s[c])}},obj.getColumnData=function(n){for(var s=[],c=0;c<obj.options.data.length;c++)s.push(obj.options.data[c][n]);return s},obj.setColumnData=function(n,s){for(var c=0;c<obj.rows.length;c++){var d=jexcel.getColumnNameFromId([n,c]);s[c]!=null&&obj.setValue(d,s[c])}},obj.createRow=function(n,s){obj.records[n]||(obj.records[n]=[]),s||(s=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var c=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(c=obj.options.rows[n].title)),c||(c=parseInt(n+1));var d=document.createElement("td");d.innerHTML=c,d.setAttribute("data-y",n),d.className="jexcel_row",obj.rows[n].appendChild(d);for(var M=0;M<obj.options.columns.length;M++)obj.records[n][M]=obj.createCell(M,n,s[M]),obj.rows[n].appendChild(obj.records[n][M]);return obj.rows[n]},obj.parseValue=function(n,s,c,d){(""+c).substr(0,1)=="="&&obj.options.parseFormulas==1&&(c=obj.executeFormula(c,n,s));var M=obj.options.columns[n];if(M&&!isFormula(c)){var R=null;if(R=getMask(M)){c&&c==Number(c)&&(c=Number(c));var z=jSuites.mask.render(c,R,!0);if(d&&R.mask){var b=R.mask.split(";");b[1]&&(b[1].match(new RegExp("\\[Red\\]","gi"))&&(c<0?d.classList.add("red"):d.classList.remove("red")),b[1].match(new RegExp("\\(","gi"))&&c<0&&(z="("+z+")"))}z&&(c=z)}}return c};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,s,c){var d=document.createElement("td");if(d.setAttribute("data-x",n),d.setAttribute("data-y",s),(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1){var M=secureFormula(c);M!=c&&(c=M)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?d.innerHTML=c:d.textContent=c,typeof obj.options.columns[n].editor.createCell=="function"&&(d=obj.options.columns[n].editor.createCell(d));else if(obj.options.columns[n].type=="hidden")d.style.display="none",d.textContent=c;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var R=document.createElement("input");R.type=obj.options.columns[n].type,R.name="c"+n,R.checked=c==1||c==1||c=="true",R.onclick=function(){obj.setValue(d,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||R.setAttribute("disabled","disabled"),d.appendChild(R),obj.options.data[s][n]=R.checked}else if(obj.options.columns[n].type=="calendar"){var z=null;if(!validDate(c)){var b=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);b&&(z=b)}d.textContent=jSuites.calendar.getDateString(z||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")d.classList.add("jexcel_dropdown"),d.textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=c,d.appendChild(u)}else d.style.color=c,d.textContent=c;else if(obj.options.columns[n].type=="image"){if(c&&c.substr(0,10)=="data:image"){var f=document.createElement("img");f.src=c,d.appendChild(f)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?d.innerHTML=stripScript(obj.parseValue(n,s,c,d)):d.textContent=obj.parseValue(n,s,c,d);obj.options.columns[n].readOnly==1&&(d.className="readonly");var k=obj.options.columns[n].align?obj.options.columns[n].align:"center";return d.style.textAlign=k,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||d.innerHTML.length>200)&&(d.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(c||d.innerHTML?obj.records[s][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(d.style.overflow="hidden")),d},obj.createCellHeader=function(n){var s=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,c=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=c,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,s,c){obj.options.nestedHeaders[s][n].title&&(obj.options.nestedHeaders[s][n].title=c,obj.options.nestedHeaders[s].element.children[n+1].textContent=c)},obj.createNestedHeader=function(n){var s=document.createElement("tr");s.classList.add("jexcel_nested");var c=document.createElement("td");s.appendChild(c),n.element=s;for(var d=0,M=0;M<n.length;M++){n[M].colspan||(n[M].colspan=1),n[M].align||(n[M].align="center"),n[M].title||(n[M].title=""),n[M].id||(n[M].id="");for(var R=n[M].colspan,z=[],b=0;b<R;b++)obj.options.columns[d]&&obj.options.columns[d].type=="hidden"&&R++,z.push(d),d++;(c=document.createElement("td")).setAttribute("data-column",z.join(",")),c.setAttribute("colspan",n[M].colspan),c.setAttribute("align",n[M].align),c.setAttribute("id",n[M].id),c.textContent=n[M].title,s.appendChild(c)}return s},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var s=0;s<n.length;s++)if(n[s].type=="i")(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",n[s].k),R.setAttribute("data-v",n[s].v),R.setAttribute("id",n[s].id),n[s].tooltip&&R.setAttribute("title",n[s].tooltip),n[s].onclick&&(n[s].onclick,1)?R.onclick=function(z){var b=z;return function(){n[b].onclick(el,obj,this)}}(s):R.onclick=function(){var z=this.getAttribute("data-k"),b=this.getAttribute("data-v");obj.setStyle(obj.highlighted,z,b)},R.textContent=n[s].content,obj.toolbar.appendChild(R);else if(n[s].type=="select"){var c=!1;(R=document.createElement("select")).classList.add("jexcel_toolbar_item"),R.setAttribute("data-k",n[s].k),n[s].tooltip&&R.setAttribute("title",n[s].tooltip),n[s].onchange&&(n[s].onchange,1)?(R.onchange=n[s].onchange,c=!0):R.onchange=function(){var z=this.getAttribute("data-k");obj.setStyle(obj.highlighted,z,this.value)};for(var d=0;d<n[s].v.length;d++){var M=document.createElement("option");M.value=n[s].v[d],M.textContent=n[s].v[d],n[s].selectedValue&&M.value===n[s].selectedValue&&(M.selected=!0),R.appendChild(M)}c&&R.dispatchEvent(new Event("change")),obj.toolbar.appendChild(R)}else if(n[s].type=="color"){var R;(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",n[s].k),R.setAttribute("data-v",""),n[s].tooltip&&R.setAttribute("title",n[s].tooltip),obj.toolbar.appendChild(R),R.textContent=n[s].content,jSuites.color(R,{onchange:function(z,b){var u=z.getAttribute("data-k");obj.setStyle(obj.highlighted,u,b)}})}},obj.setMerge=function(n,s,c,d){var M=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var R=parseInt(obj.highlighted[0].getAttribute("data-x")),z=parseInt(obj.highlighted[0].getAttribute("data-y")),b=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),u=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([R,z]),s=b-R+1,c=u-z+1}var f=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[f[1]][f[0]].getAttribute("data-merged")&&(M=obj.options.text.cellAlreadyMerged);else if((!s||s<2)&&(!c||c<2))M=obj.options.text.invalidMergeProperties;else for(var k=f[1];k<f[1]+c;k++)for(var _=f[0];_<f[0]+s;_++)jexcel.getColumnNameFromId([_,k]),obj.records[k][_].getAttribute("data-merged")&&(M=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(M)alert(M);else{s>1?obj.records[f[1]][f[0]].setAttribute("colspan",s):s=1,c>1?obj.records[f[1]][f[0]].setAttribute("rowspan",c):c=1,obj.options.mergeCells[n]=[s,c,[]],obj.records[f[1]][f[0]].setAttribute("data-merged","true"),obj.records[f[1]][f[0]].style.overflow="hidden";for(var g=[],o=f[1];o<f[1]+c;o++)for(var m=f[0];m<f[0]+s;m++)f[0]==m&&f[1]==o||(g.push(obj.options.data[o][m]),obj.updateCell(m,o,"",!0),obj.options.mergeCells[n][2].push(obj.records[o][m]),obj.records[o][m].style.display="none",obj.records[o][m]=obj.records[f[1]][f[0]]);obj.updateSelection(obj.records[f[1]][f[0]]),d||(obj.setHistory({action:"setMerge",column:n,colspan:s,rowspan:c,data:g}),obj.dispatch("onmerge",el,n,s,c))}},obj.getMerge=function(n){var s={};if(n)s=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var c=Object.keys(obj.options.mergeCells),d=0;d<c.length;d++)s[c[d]]=[obj.options.mergeCells[c[d]][0],obj.options.mergeCells[c[d]][1]]}return s},obj.removeMerge=function(n,s,c){if(obj.options.mergeCells[n]){var d=jexcel.getIdFromColumnName(n,!0);obj.records[d[1]][d[0]].removeAttribute("colspan"),obj.records[d[1]][d[0]].removeAttribute("rowspan"),obj.records[d[1]][d[0]].removeAttribute("data-merged");for(var M=obj.options.mergeCells[n],R=0,z=0;z<M[1];z++)for(var b=0;b<M[0];b++)(z>0||b>0)&&(obj.records[d[1]+z][d[0]+b]=M[2][R],obj.records[d[1]+z][d[0]+b].style.display="",s&&s[R]&&obj.updateCell(d[0]+b,d[1]+z,s[R]),R++);obj.updateSelection(obj.records[d[1]][d[0]],obj.records[d[1]+z-1][d[0]+b-1]),c||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var s=Object.keys(obj.options.mergeCells),c=0;c<s.length;c++)obj.removeMerge(s[c],null,n)}},obj.isColMerged=function(n,s){var c=[];if(obj.options.mergeCells)for(var d=Object.keys(obj.options.mergeCells),M=0;M<d.length;M++){var R=jexcel.getIdFromColumnName(d[M],!0),z=obj.options.mergeCells[d[M]][0],b=R[0],u=R[0]+(z>1?z-1:0);s==null?b<=n&&u>=n&&c.push(d[M]):s?b<n&&u>=n&&c.push(d[M]):b<=n&&u>n&&c.push(d[M])}return c},obj.isRowMerged=function(n,s){var c=[];if(obj.options.mergeCells)for(var d=Object.keys(obj.options.mergeCells),M=0;M<d.length;M++){var R=jexcel.getIdFromColumnName(d[M],!0),z=obj.options.mergeCells[d[M]][1],b=R[1],u=R[1]+(z>1?z-1:0);s==null?b<=n&&u>=n&&c.push(d[M]):s?b<n&&u>=n&&c.push(d[M]):b<=n&&u>n&&c.push(d[M])}return c},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var s=[];if(obj.options.columns[n].type=="checkbox")s.push({id:"true",name:"True"}),s.push({id:"false",name:"False"});else{for(var c=[],d=!1,M=0;M<obj.options.data.length;M++){var R=obj.options.data[M][n],z=obj.records[M][n].innerHTML;R&&z?c[R]=z:d=!0}var b=Object.keys(c);for(s=[],M=0;M<b.length;M++)s.push({id:b[M],name:c[b[M]]});d&&s.push({value:"",id:"",name:"(Blanks)"})}var u=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(u),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var f={data:s,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(k){obj.resetFilters(),obj.filters[n]=k.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=k.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(u,f)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var s=0;s<obj.filter.children.length;s++)obj.filters[s]&&(n=s);var c=function(R,z,b){for(var u=0;u<R.length;u++){var f=""+obj.options.data[b][z],k=""+obj.records[b][z].innerHTML;if(R[u]==f||R[u]==k)return!0}return!1},d=obj.filters[n];obj.results=[];for(var M=0;M<obj.options.data.length;M++)c(d,n,M)&&obj.results.push(M);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,s,c){var d=n.getAttribute("data-y"),M=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,M,d),M>0&&(obj.records[d][M-1].style.overflow="hidden");var R=function(L){var I=n.getBoundingClientRect(),B=document.createElement(L);return B.style.width=I.width+"px",B.style.height=I.height-2+"px",B.style.minHeight=I.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(B),obj.dispatch("oncreateeditor",el,n,M,d,B),B};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[d][M],obj.records[d][M].innerHTML,M,d],obj.options.columns[M].editor)obj.options.columns[M].editor.openEditor(n,el,s,c);else if(obj.options.columns[M].type!="hidden")if(obj.options.columns[M].type=="checkbox"||obj.options.columns[M].type=="radio"){var z=!n.children[0].checked;obj.setValue(n,z),obj.edition=null}else if(obj.options.columns[M].type=="dropdown"||obj.options.columns[M].type=="autocomplete"){if(z=obj.options.data[d][M],obj.options.columns[M].multiple&&!Array.isArray(z)&&(z=z.split(";")),typeof obj.options.columns[M].filter=="function")var b=obj.options.columns[M].filter(el,n,M,d,obj.options.columns[M].source);else b=obj.options.columns[M].source;for(var u=[],f=0;f<b.length;f++)u.push(b[f]);var k=R("div"),_={data:u,multiple:!!obj.options.columns[M].multiple,autocomplete:!(!obj.options.columns[M].autocomplete&&obj.options.columns[M].type!="autocomplete"),opened:!0,value:z,width:"100%",height:k.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[M].options&&obj.options.columns[M].options.type&&(_.type=obj.options.columns[M].options.type),jSuites.dropdown(k,_)}else if(obj.options.columns[M].type=="calendar"||obj.options.columns[M].type=="color")z=obj.options.data[d][M],(k=R("input")).value=z,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[M].options.position=!0),obj.options.columns[M].options.value=obj.options.data[d][M],obj.options.columns[M].options.opened=!0,obj.options.columns[M].options.onclose=function(L,I){obj.closeEditor(n,!0)},obj.options.columns[M].type=="color"?jSuites.color(k,obj.options.columns[M].options):jSuites.calendar(k,obj.options.columns[M].options),k.focus();else if(obj.options.columns[M].type=="html"){z=obj.options.data[d][M],(k=R("div")).style.position="relative",(m=document.createElement("div")).classList.add("jexcel_richtext"),k.appendChild(m),jSuites.editor(m,{focus:!0,value:z});var g=n.getBoundingClientRect(),o=m.getBoundingClientRect();window.innerHeight<g.bottom+o.height?m.style.top=g.top-(o.height+2)+"px":m.style.top=g.top+"px"}else if(obj.options.columns[M].type=="image"){var m,j=n.children[0];(k=R("div")).style.position="relative",(m=document.createElement("div")).classList.add("jclose"),j&&j.src&&m.appendChild(j),k.appendChild(m),jSuites.image(m,obj.options.imageOptions),g=n.getBoundingClientRect(),o=m.getBoundingClientRect(),window.innerHeight<g.bottom+o.height?m.style.top=g.top-(o.height+2)+"px":m.style.top=g.top+"px"}else{z=s==1?"":obj.options.data[d][M],obj.options.columns[M].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[M].wordWrap!=1?k=R("input"):k=R("textarea"),k.focus(),k.value=z,_=obj.options.columns[M];var h=null;if(!isFormula(z)&&(h=getMask(_))){if(!_.disabledMaskOnEdition)if(_.mask){var C=_.mask.split(";");k.setAttribute("data-mask",C[0])}else _.locale&&k.setAttribute("data-locale",_.locale);h.input=k,k.mask=h,jSuites.mask.render(z,h,!1)}k.onblur=function(){obj.closeEditor(n,!0)},k.scrollLeft=k.scrollWidth}}},obj.closeEditor=function(n,s){var c=parseInt(n.getAttribute("data-x")),d=parseInt(n.getAttribute("data-y"));if(s==1){if(obj.options.columns[c].editor)var M=obj.options.columns[c].editor.closeEditor(n,s);else if(!(obj.options.columns[c].type=="checkbox"||obj.options.columns[c].type=="radio"||obj.options.columns[c].type=="hidden"))if(obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete")M=n.children[0].dropdown.close(!0);else if(obj.options.columns[c].type=="calendar")M=n.children[0].calendar.close(!0);else if(obj.options.columns[c].type=="color")M=n.children[0].color.close(!0);else if(obj.options.columns[c].type=="html")M=n.children[0].children[0].editor.getData();else if(obj.options.columns[c].type=="image"){var R=n.children[0].children[0].children[0];M=R&&R.tagName=="IMG"?R.src:""}else if(obj.options.columns[c].type=="numeric")(""+(M=n.children[0].value)).substr(0,1)!="="&&M==""&&(M=obj.options.columns[c].allowEmpty?"":0),n.children[0].onblur=null;else{M=n.children[0].value,n.children[0].onblur=null;var z,b=obj.options.columns[c];if((z=getMask(b))&&M!==""&&!isFormula(M)&&typeof M!="number"){var u=jSuites.mask.extract(M,z,!0);u&&u.value!==""&&(M=u.value)}}obj.options.data[d][c]==M?n.innerHTML=obj.edition[1]:obj.setValue(n,M)}else obj.options.columns[c].editor?obj.options.columns[c].editor.closeEditor(n,s):obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[c].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[c].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,c,d,M,s),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][s]},obj.getColumnOptions=function(n,s){var c=obj.options.columns[n];return c||(c={type:"text"}),c},obj.getCellFromCoords=function(n,s){return obj.records[s][n]},obj.getLabel=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][s].innerHTML},obj.getLabelFromCoords=function(n,s){return obj.records[s][n].innerHTML},obj.getValue=function(n,s){if(typeof n=="object")var c=n.getAttribute("data-x"),d=n.getAttribute("data-y");else c=(n=jexcel.getIdFromColumnName(n,!0))[0],d=n[1];var M=null;return c!=null&&d!=null&&(obj.records[d]&&obj.records[d][c]&&(s||obj.options.copyCompatibility==1)?M=obj.records[d][c].innerHTML:obj.options.data[d]&&obj.options.data[d][c]!="undefined"&&(M=obj.options.data[d][c])),M},obj.getValueFromCoords=function(n,s,c){var d=null;return n!=null&&s!=null&&(obj.records[s]&&obj.records[s][n]&&c||obj.options.copyCompatibility==1?d=obj.records[s][n].innerHTML:obj.options.data[s]&&obj.options.data[s][n]!="undefined"&&(d=obj.options.data[s][n])),d},obj.setValue=function(n,s,c){var d=[];if(typeof n=="string"){var M=(u=jexcel.getIdFromColumnName(n,!0))[0],R=u[1];d.push(obj.updateCell(M,R,s,c)),obj.updateFormulaChain(M,R,d)}else if(M=null,R=null,n&&n.getAttribute&&(M=n.getAttribute("data-x"),R=n.getAttribute("data-y")),M!=null&&R!=null)d.push(obj.updateCell(M,R,s,c)),obj.updateFormulaChain(M,R,d);else{var z=Object.keys(n);if(z.length>0)for(var b=0;b<z.length;b++){var u;typeof n[b]=="string"?(M=(u=jexcel.getIdFromColumnName(n[b],!0))[0],R=u[1]):n[b].x!=null&&n[b].y!=null?(M=n[b].x,R=n[b].y,n[b].newValue!=null?s=n[b].newValue:n[b].value!=null&&(s=n[b].value)):(M=n[b].getAttribute("data-x"),R=n[b].getAttribute("data-y")),M!=null&&R!=null&&(d.push(obj.updateCell(M,R,s,c)),obj.updateFormulaChain(M,R,d))}}obj.setHistory({action:"setValue",records:d,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,d)},obj.setValueFromCoords=function(n,s,c,d){var M=[];M.push(obj.updateCell(n,s,c,d)),obj.updateFormulaChain(n,s,M),obj.setHistory({action:"setValue",records:M,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,M)},obj.setCheckRadioValue=function(){for(var n=[],s=Object.keys(obj.highlighted),c=0;c<s.length;c++){var d=obj.highlighted[c].getAttribute("data-x"),M=obj.highlighted[c].getAttribute("data-y");obj.options.columns[d].type!="checkbox"&&obj.options.columns[d].type!="radio"||n.push(obj.updateCell(d,M,!obj.options.data[M][d]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var s=new Option;s.innerHTML=n;var c=null;for(n=s.getElementsByTagName("script");c=n[0];)c.parentNode.removeChild(c);return s.innerHTML};obj.updateCell=function(n,s,c,d){if(obj.records[s][n].classList.contains("readonly")!=1||d){var M;(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1&&(M=secureFormula(c))!=c&&(c=M),(M=obj.dispatch("onbeforechange",el,obj.records[s][n],n,s,c))!=null&&(c=M),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(c=obj.options.columns[n].editor.updateCell(obj.records[s][n],c,d)),k={x:n,y:s,col:n,row:s,newValue:c,oldValue:obj.options.data[s][n]};let _=obj.options.columns[n].editor;if(_)obj.options.data[s][n]=c,typeof _.setValue=="function"&&_.setValue(obj.records[s][n],c);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var R=0;R<obj.options.data.length;R++)obj.options.data[R][n]=!1;obj.records[s][n].children[0].checked=c==1||c==1||c=="true"||c=="TRUE",obj.options.data[s][n]=obj.records[s][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[s][n]=c,obj.records[s][n].textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="calendar"){var z=null;if(!validDate(c)){var b=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);b&&(z=b)}obj.options.data[s][n]=c,obj.records[s][n].textContent=jSuites.calendar.getDateString(z||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[s][n]=c,obj.options.columns[n].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=c,obj.records[s][n].textContent="",obj.records[s][n].appendChild(u)}else obj.records[s][n].style.color=c,obj.records[s][n].textContent=c;else if(obj.options.columns[n].type=="image"){if(c=""+c,obj.options.data[s][n]=c,obj.records[s][n].innerHTML="",c&&c.substr(0,10)=="data:image"){var f=document.createElement("img");f.src=c,obj.records[s][n].appendChild(f)}}else obj.options.data[s][n]=c,obj.options.columns[n].type=="html"?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,c)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,c,obj.records[s][n])):obj.records[s][n].textContent=obj.parseValue(n,s,c,obj.records[s][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[s][n].innerHTML.length>200)?obj.records[s][n].style.whiteSpace="pre-wrap":obj.records[s][n].style.whiteSpace="";n>0&&(obj.records[s][n-1].style.overflow=c?"hidden":""),obj.dispatch("onchange",el,obj.records[s]&&obj.records[s][n]?obj.records[s][n]:null,n,s,c,k.oldValue)}else var k={x:n,y:s,col:n,row:s};return k},obj.copyData=function(n,s){var c=obj.getData(!0,!0),d=obj.selectedContainer,M=parseInt(n.getAttribute("data-x")),R=parseInt(n.getAttribute("data-y")),z=parseInt(s.getAttribute("data-x")),b=parseInt(s.getAttribute("data-y")),u=[],f=!1;if(d[0]==M){if(R<d[1])var k=R-d[1];else k=1;var _=0}else _=M<d[0]?M-d[0]:1,k=0;for(var g=0,o=0,m=R;m<=b;m++)if(!obj.rows[m]||obj.rows[m].style.display!="none"){c[o]==null&&(o=0),g=0,d[0]!=M&&(_=M<d[0]?M-d[0]:1);for(var j=M;j<=z;j++){if(obj.records[m][j]&&!obj.records[m][j].classList.contains("readonly")&&obj.records[m][j].style.display!="none"&&f==0){if(!obj.selection.length&&obj.options.data[m][j]!=""){f=!0;continue}(c[o]==null||c[o][g]==null)&&(g=0);var h=c[o][g];if(h&&!c[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+h).substr(0,1)=="="){var C=h.match(/([A-Z]+[0-9]+)/g);if(C){for(var L=[],I=0;I<C.length;I++){var B=jexcel.getIdFromColumnName(C[I],1);B[0]+=_,B[1]+=k,B[1]<0&&(B[1]=0);var D=jexcel.getColumnNameFromId([B[0],B[1]]);D!=C[I]&&(L[C[I]]=D)}L&&(h=obj.updateFormula(h,L))}}else h==Number(h)&&(h=Number(h)+k);else if(obj.options.columns[j].type=="calendar"){var A=new Date(h);A.setDate(A.getDate()+k),h=A.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(A.getMonth()+1))+"-"+jexcel.doubleDigitFormat(A.getDate())+" 00:00:00"}}u.push(obj.updateCell(j,m,h)),obj.updateFormulaChain(j,m,u)}g++,d[0]!=M&&_++}o++,k++}obj.setHistory({action:"setValue",records:u,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,u)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,s,c){if(n==1){if(obj.selectedCell&&(s>=obj.selectedCell[1]&&s<=obj.selectedCell[3]||c>=obj.selectedCell[1]&&c<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(s>=obj.selectedCell[0]&&s<=obj.selectedCell[2]||c>=obj.selectedCell[0]&&c<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){f=1;for(var s=0;s<obj.highlighted.length;s++){obj.highlighted[s].classList.remove("highlight"),obj.highlighted[s].classList.remove("highlight-left"),obj.highlighted[s].classList.remove("highlight-right"),obj.highlighted[s].classList.remove("highlight-top"),obj.highlighted[s].classList.remove("highlight-bottom"),obj.highlighted[s].classList.remove("highlight-selected");var c=parseInt(obj.highlighted[s].getAttribute("data-x")),d=parseInt(obj.highlighted[s].getAttribute("data-y"));if(obj.highlighted[s].getAttribute("data-merged"))var M=parseInt(obj.highlighted[s].getAttribute("colspan")),R=parseInt(obj.highlighted[s].getAttribute("rowspan")),z=M>0?c+(M-1):c,b=R>0?d+(R-1):d;else z=c,b=d;for(var u=c;u<=z;u++)obj.headers[u]&&obj.headers[u].classList.remove("selected");for(u=d;u<=b;u++)obj.rows[u]&&obj.rows[u].classList.remove("selected")}}else var f=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&f==1&&obj.dispatch("onblur",el),f},obj.updateSelection=function(n,s,c){var d=n.getAttribute("data-x"),M=n.getAttribute("data-y");if(s)var R=s.getAttribute("data-x"),z=s.getAttribute("data-y");else R=d,z=M;obj.updateSelectionFromCoords(d,M,R,z,c)},obj.updateSelectionFromCoords=function(n,s,c,d,M){var R=obj.resetSelection();if(s==null&&(s=0,d=obj.rows.length-1),c==null&&(c=n),d==null&&(d=s),n>=obj.headers.length&&(n=obj.headers.length-1),s>=obj.rows.length&&(s=obj.rows.length-1),c>=obj.headers.length&&(c=obj.headers.length-1),d>=obj.rows.length&&(d=obj.rows.length-1),obj.selectedCell=[n,s,c,d],n!=null){if(obj.records[s][n]&&obj.records[s][n].classList.add("highlight-selected"),parseInt(n)<parseInt(c))var z=parseInt(n),b=parseInt(c);else z=parseInt(c),b=parseInt(n);if(parseInt(s)<parseInt(d))var u=parseInt(s),f=parseInt(d);else u=parseInt(d),f=parseInt(s);for(var k=z;k<=b;k++)for(var _=u;_<=f;_++)if(obj.records[_][k]&&obj.records[_][k].getAttribute("data-merged")){var g=parseInt(obj.records[_][k].getAttribute("data-x")),o=parseInt(obj.records[_][k].getAttribute("data-y")),m=parseInt(obj.records[_][k].getAttribute("colspan")),j=parseInt(obj.records[_][k].getAttribute("rowspan"));m>1&&(g<z&&(z=g),g+m>b&&(b=g+m-1)),j&&(o<u&&(u=o),o+j>f&&(f=o+j-1))}var h=null,C=null,L=null,I=null;for(_=u;_<=f;_++)obj.rows[_].style.display!="none"&&(L==null&&(L=_),I=_);for(k=z;k<=b;k++){for(_=u;_<=f;_++)obj.rows[_].style.display!="none"&&obj.records[_][k].style.display!="none"&&(obj.records[_][k].classList.add("highlight"),obj.highlighted.push(obj.records[_][k]));obj.options.columns[k].type!="hidden"&&(h==null&&(h=k),C=k)}for(h||(h=0),C||(C=0),k=h;k<=C;k++)obj.options.columns[k].type!="hidden"&&obj.colgroup[k].style&&obj.colgroup[k].style.display!="none"&&(obj.records[L]&&obj.records[L][k]&&obj.records[L][k].classList.add("highlight-top"),obj.records[I]&&obj.records[I][k]&&obj.records[I][k].classList.add("highlight-bottom"),obj.headers[k].classList.add("selected"));for(_=L;_<=I;_++)obj.rows[_]&&obj.rows[_].style.display!="none"&&(obj.records[_][h].classList.add("highlight-left"),obj.records[_][C].classList.add("highlight-right"),obj.rows[_].classList.add("selected"));obj.selectedContainer=[h,L,C,I]}R==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,h,L,C,I,M),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,s){obj.removeCopySelection();var c=obj.selectedContainer[0],d=obj.selectedContainer[1],M=obj.selectedContainer[2],R=obj.selectedContainer[3];if(n!=null&&s!=null){if(n-M>0)var z=parseInt(M)+1,b=parseInt(n);else z=parseInt(n),b=parseInt(c)-1;if(s-R>0)var u=parseInt(R)+1,f=parseInt(s);else u=parseInt(s),f=parseInt(d)-1;b-z<=f-u?(z=parseInt(c),b=parseInt(M)):(u=parseInt(d),f=parseInt(R));for(var k=u;k<=f;k++)for(var _=z;_<=b;_++)obj.records[k][_]&&obj.rows[k].style.display!="none"&&obj.records[k][_].style.display!="none"&&(obj.records[k][_].classList.add("selection"),obj.records[u][_].classList.add("selection-top"),obj.records[f][_].classList.add("selection-bottom"),obj.records[k][z].classList.add("selection-left"),obj.records[k][b].classList.add("selection-right"),obj.selection.push(obj.records[k][_]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],s=n.getAttribute("data-x"),c=obj.content.getBoundingClientRect(),d=c.left,M=c.top,R=n.getBoundingClientRect(),z=R.left,b=R.top,u=R.width,f=R.height,k=z-d+obj.content.scrollLeft+u-4,_=b-M+obj.content.scrollTop+f-4;if(obj.corner.style.top=_+"px",obj.corner.style.left=k+"px",obj.options.freezeColumns){var g=obj.getFreezeWidth();s>obj.options.freezeColumns-1&&z-d+u<g?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var s=obj.content.getBoundingClientRect(),c=s.left,d=s.top,M=s.width,R=s.height,z=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),b=z.left,u=z.top,f=z.width,k=z.height;if(n==0||n==1)var _=b-c+obj.content.scrollLeft,g=u-d+obj.content.scrollTop-2;else _=b-c+obj.content.scrollLeft+f,g=u-d+obj.content.scrollTop+k;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+R||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-k:obj.content.scrollTop=g-(R-2));var o=obj.getFreezeWidth();_>obj.content.scrollLeft+o&&_<obj.content.scrollLeft+M||(_<obj.content.scrollLeft+30?(obj.content.scrollLeft=_,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):_<obj.content.scrollLeft+o?obj.content.scrollLeft=_-o-1:obj.content.scrollLeft=_-(M-20))},obj.getWidth=function(n){if(n===void 0)for(var s=[],c=0;c<obj.headers.length;c++)s.push(obj.options.columns[c].width);else typeof n=="object"&&(n=n.getAttribute("data-x")),s=obj.colgroup[n].getAttribute("width");return s},obj.setWidth=function(n,s,c){if(s){if(Array.isArray(n)){c||(c=[]);for(var d=0;d<n.length;d++){c[d]||(c[d]=obj.colgroup[n[d]].getAttribute("width"));var M=Array.isArray(s)&&s[d]?s[d]:s;obj.colgroup[n[d]].setAttribute("width",M),obj.options.columns[n[d]].width=M}}else c||(c=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].width=s;obj.setHistory({action:"setWidth",column:n,oldValue:c,newValue:s}),obj.dispatch("onresizecolumn",el,n,s,c),obj.updateCornerPosition()}},obj.setHeight=function(n,s,c){s>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),c||(c=obj.rows[n].getAttribute("height"))||(c=obj.rows[n].getBoundingClientRect().height),s=parseInt(s),obj.rows[n].style.height=s+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=s,obj.setHistory({action:"setHeight",row:n,oldValue:c,newValue:s}),obj.dispatch("onresizerow",el,n,s,c),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var s=[],c=0;c<obj.rows.length;c++){var d=obj.rows[c].style.height;d&&(s[c]=d)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),s=obj.rows[n].style.height;return s},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var s=0;s<obj.options.footers.length;s++){if(obj.tfoot.children[s])var c=obj.tfoot.children[s];else{c=document.createElement("tr");var d=document.createElement("td");c.appendChild(d),obj.tfoot.appendChild(c)}for(var M=0;M<obj.headers.length;M++){if(obj.options.footers[s][M]||(obj.options.footers[s][M]=""),obj.tfoot.children[s].children[M+1])d=obj.tfoot.children[s].children[M+1];else{d=document.createElement("td"),c.appendChild(d);var R=obj.options.columns[M].align?obj.options.columns[M].align:"center";d.style.textAlign=R}d.textContent=obj.parseValue(+obj.records.length+M,s,obj.options.footers[s][M]),d.style.display=obj.colgroup[M].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,s){if(obj.headers[n]){var c=obj.headers[n].textContent;s||(s=prompt(obj.options.text.columnName,c)),s&&(obj.headers[n].textContent=s,obj.headers[n].setAttribute("title",s),obj.options.columns[n].title=s),obj.setHistory({action:"setHeader",column:n,oldValue:c,newValue:s}),obj.dispatch("onchangeheader",el,n,c,s)}},obj.getHeaders=function(n){for(var s=[],c=0;c<obj.headers.length;c++)s.push(obj.getHeader(c));return n?s:s.join(obj.options.csvDelimiter)},obj.getMeta=function(n,s){return n?s?obj.options.meta[n]&&obj.options.meta[n][s]?obj.options.meta[n][s]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,s,c){if(obj.options.meta||(obj.options.meta={}),s&&c)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][s]=c;else for(var d=Object.keys(n),M=0;M<d.length;M++){obj.options.meta[d[M]]||(obj.options.meta[d[M]]={});for(var R=Object.keys(n[d[M]]),z=0;z<R.length;z++)obj.options.meta[d[M]][R[z]]=n[d[M]][R[z]]}obj.dispatch("onchangemeta",el,n,s,c)},obj.updateMeta=function(n){if(obj.options.meta){for(var s={},c=Object.keys(obj.options.meta),d=0;d<c.length;d++)n[c[d]]?s[n[c[d]]]=obj.options.meta[c[d]]:s[c[d]]=obj.options.meta[c[d]];obj.options.meta=s}},obj.getStyle=function(n,s){if(n)return n=jexcel.getIdFromColumnName(n,!0),s?obj.records[n[1]][n[0]].style[s]:obj.records[n[1]][n[0]].getAttribute("style");for(var c={},d=obj.options.data[0].length,M=obj.options.data.length,R=0;R<M;R++)for(var z=0;z<d;z++){var b=s?obj.records[R][z].style[s]:obj.records[R][z].getAttribute("style");b&&(c[jexcel.getColumnNameFromId([z,R])]=b)}return c},obj.resetStyle=function(n,s){for(var c=Object.keys(n),d=0;d<c.length;d++){var M=jexcel.getIdFromColumnName(c[d],!0);obj.records[M[1]]&&obj.records[M[1]][M[0]]&&obj.records[M[1]][M[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,s)},obj.setStyle=function(n,s,c,d,M){var R={},z={},b=function(h,C,L){var I=jexcel.getIdFromColumnName(h,!0);if(obj.records[I[1]]&&obj.records[I[1]][I[0]]&&(obj.records[I[1]][I[0]].classList.contains("readonly")==0||d)){var B=obj.records[I[1]][I[0]].style[C];B!=L||d?obj.records[I[1]][I[0]].style[C]=L:(L="",obj.records[I[1]][I[0]].style[C]=""),z[h]||(z[h]=[]),R[h]||(R[h]=[]),z[h].push([C+":"+B]),R[h].push([C+":"+L])}};if(s&&c)if(typeof n=="string")b(n,s,c);else for(var u=[],f=0;f<n.length;f++){var k=n[f].getAttribute("data-x"),_=n[f].getAttribute("data-y"),g=jexcel.getColumnNameFromId([k,_]);u[g]||(b(g,s,c),u[g]=!0)}else{var o=Object.keys(n);for(f=0;f<o.length;f++){var m=n[o[f]];typeof m=="string"&&(m=m.split(";"));for(var j=0;j<m.length;j++)typeof m[j]=="string"&&(m[j]=m[j].split(":")),m[j][0].trim()&&b(o[f],m[j][0].trim(),m[j][1])}}for(o=Object.keys(z),f=0;f<o.length;f++)z[o[f]]=z[o[f]].join(";");for(o=Object.keys(R),f=0;f<o.length;f++)R[o[f]]=R[o[f]].join(";");M||obj.setHistory({action:"setStyle",oldValue:z,newValue:R}),obj.dispatch("onchangestyle",el,n,s,c)},obj.getComments=function(n,s){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),s?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var c={},d=0;d<obj.options.data.length;d++)for(var M=0;M<obj.options.columns.length;M++){var R=obj.records[d][M].getAttribute("title");R&&(c[n=jexcel.getColumnNameFromId([M,d])]=R)}return c},obj.setComments=function(n,s,c){if(typeof n=="string")var d=jexcel.getIdFromColumnName(n,!0);else d=n;var M=obj.records[d[1]][d[0]].getAttribute("title"),R=[M,c=obj.records[d[1]][d[0]].getAttribute("data-author")];obj.records[d[1]][d[0]].setAttribute("title",s||""),obj.records[d[1]][d[0]].setAttribute("data-author",c||""),s?obj.records[d[1]][d[0]].classList.add("jexcel_comments"):obj.records[d[1]][d[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[s,c],oldValue:R}),obj.dispatch("oncomments",el,s,M,d,d[0],d[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,s){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}s=s==null?obj.headers[n].classList.contains("arrow-down")?1:0:s?1:0;var c=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var d=0;d<obj.options.data.length;d++)c[d]=[d,Number(obj.options.data[d][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(d=0;d<obj.options.data.length;d++)c[d]=[d,obj.options.data[d][n]];else for(d=0;d<obj.options.data.length;d++)c[d]=[d,obj.records[d][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(R){return function(z,b){var u=z[1],f=b[1];return R?u===""&&f!==""?1:u!==""&&f===""||u>f?-1:u<f?1:0:u===""&&f!==""?1:u!==""&&f===""?-1:u>f?1:u<f?-1:0}}),c=c.sort(obj.options.sorting(s));var M=[];for(d=0;d<c.length;d++)M[d]=c[d][0];return obj.setHistory({action:"orderBy",rows:M,column:n,order:s}),obj.updateOrderArrow(n,s),obj.updateOrder(M),obj.dispatch("onsort",el,n,s),!0}},obj.updateOrderArrow=function(n,s){for(var c=0;c<obj.headers.length;c++)obj.headers[c].classList.remove("arrow-up"),obj.headers[c].classList.remove("arrow-down");s?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var s=[],c=0;c<n.length;c++)s[c]=obj.options.data[n[c]];for(obj.options.data=s,s=[],c=0;c<n.length;c++)s[c]=obj.records[n[c]];for(obj.records=s,s=[],c=0;c<n.length;c++)s[c]=obj.rows[n[c]];if(obj.rows=s,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(c=0;c<obj.rows.length;c++)obj.tbody.appendChild(obj.rows[c])},obj.moveRow=function(n,s,c){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var d=1;else d=0;if(obj.isRowMerged(n).length||obj.isRowMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}c||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0?n>s?obj.tbody.insertBefore(obj.rows[n],obj.rows[s]):obj.tbody.insertBefore(obj.rows[n],obj.rows[s].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(s,0,obj.rows.splice(n,1)[0]),obj.records.splice(s,0,obj.records.splice(n,1)[0]),obj.options.data.splice(s,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,s)},obj.insertRow=function(n,s,c){if(obj.options.allowInsertRow==1){var d=[];if(n>0)var M=n;else M=1,n&&(d=n);c=!!c;var R=obj.options.data.length-1;if((s==null||s>=parseInt(R)||s<0)&&(s=R),obj.dispatch("onbeforeinsertrow",el,s,M,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(s,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var z=c?s:s+1,b=obj.records.splice(z),u=obj.options.data.splice(z),f=obj.rows.splice(z),k=[],_=[],g=[],o=z;o<M+z;o++){obj.options.data[o]=[];for(var m=0;m<obj.options.columns.length;m++)obj.options.data[o][m]=d[m]?d[m]:"";var j=obj.createRow(o,obj.options.data[o]);f[0]?Array.prototype.indexOf.call(obj.tbody.children,f[0])>=0&&obj.tbody.insertBefore(j,f[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0&&obj.tbody.appendChild(j),k.push(obj.records[o]),_.push(obj.options.data[o]),g.push(j)}Array.prototype.push.apply(obj.records,b),Array.prototype.push.apply(obj.options.data,u),Array.prototype.push.apply(obj.rows,f),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:s,numOfRows:M,insertBefore:c,rowRecords:k,rowData:_,rowNode:g}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,s,M,k,c)}},obj.deleteRow=function(n,s){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var c=obj.getSelectedRows();c[0]?(n=parseInt(c[0].getAttribute("data-y")),s=c.length):(n=obj.options.data.length-1,s=1)}var d=obj.options.data.length-1;if((n==null||n>d||n<0)&&(n=d),s||(s=1),n+s>=obj.options.data.length&&(s=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,s)===!1)return!1;if(parseInt(n)>-1){var M=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=n;R<n+s;R++)obj.isRowMerged(R,!1).length&&(M=!0);if(M){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&d+1===s&&(s--,console.error("Jspreadsheet: It is not possible to delete the last row")),R=n;R<n+s;R++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[R])>=0&&(obj.rows[R].className="",obj.rows[R].parentNode.removeChild(obj.rows[R]));var z=obj.records.splice(n,s),b=obj.options.data.splice(n,s),u=obj.rows.splice(n,s);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+s-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:s,insertBefore:1,rowRecords:z,rowData:b,rowNode:u}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,s,z)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,s){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var c=1;else c=0;if(obj.isColMerged(n).length||obj.isColMerged(s,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(s=parseInt(s))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s]);for(var d=0;d<obj.rows.length;d++)obj.rows[d].insertBefore(obj.records[d][n],obj.records[d][s])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s].nextSibling),d=0;d<obj.rows.length;d++)obj.rows[d].insertBefore(obj.records[d][n],obj.records[d][s].nextSibling);for(obj.options.columns.splice(s,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(s,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(s,0,obj.colgroup.splice(n,1)[0]),d=0;d<obj.rows.length;d++)obj.options.data[d].splice(s,0,obj.options.data[d].splice(n,1)[0]),obj.records[d].splice(s,0,obj.records[d].splice(n,1)[0]);if(obj.options.footers)for(d=0;d<obj.options.footers.length;d++)obj.options.footers[d].splice(s,0,obj.options.footers[d].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,s)},obj.insertColumn=function(n,s,c,d){if(obj.options.allowInsertColumn==1){var M=[];if(n>0)var R=n;else R=1,n&&(M=n);c=!!c;var z=obj.options.columns.length-1;if((s==null||s>=parseInt(z)||s<0)&&(s=z),obj.dispatch("onbeforeinsertcolumn",el,s,R,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(s,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}d||(d=[]);for(var b=0;b<R;b++)d[b]||(d[b]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var u=c?s:s+1;obj.options.columns=jexcel.injectArray(obj.options.columns,u,d);for(var f=obj.headers.splice(u),k=obj.colgroup.splice(u),_=[],g=[],o=[],m=[],j=[],h=u;h<R+u;h++)obj.createCellHeader(h),obj.headerContainer.insertBefore(obj.headers[h],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(obj.colgroup[h],obj.colgroupContainer.children[h+1]),_.push(obj.headers[h]),g.push(obj.colgroup[h]);if(obj.options.footers)for(var C=0;C<obj.options.footers.length;C++){for(j[C]=[],b=0;b<R;b++)j[C].push("");obj.options.footers[C].splice(u,0,j[C])}for(var L=0;L<obj.options.data.length;L++){var I=obj.options.data[L].splice(u),B=obj.records[L].splice(u);for(m[L]=[],o[L]=[],h=u;h<R+u;h++){var D=M[L]?M[L]:"";obj.options.data[L][h]=D;var A=obj.createCell(h,L,obj.options.data[L][h]);obj.records[L][h]=A,obj.rows[L]&&obj.rows[L].insertBefore(A,obj.rows[L].children[h+1]),m[L].push(D),o[L].push(A)}Array.prototype.push.apply(obj.options.data[L],I),Array.prototype.push.apply(obj.records[L],B)}if(Array.prototype.push.apply(obj.headers,f),Array.prototype.push.apply(obj.colgroup,k),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(C=0;C<obj.options.nestedHeaders.length;C++){var S=parseInt(obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan)+R;obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan=S,obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("colspan",S);var J=obj.thead.children[C].children[obj.thead.children[C].children.length-1].getAttribute("data-column");for(J=J.split(","),h=u;h<R+u;h++)J.push(h);obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("data-column",J)}else S=parseInt(obj.options.nestedHeaders[0].colspan)+R,obj.options.nestedHeaders[0].colspan=S,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",S);obj.setHistory({action:"insertColumn",columnNumber:s,numOfColumns:R,insertBefore:c,columns:d,headers:_,colgroup:g,records:o,footers:j,data:m}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,s,R,o,c)}},obj.deleteColumn=function(n,s){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var c=obj.getSelectedColumns(!0);c.length?(n=parseInt(c[0]),s=parseInt(c.length)):(n=obj.headers.length-1,s=1)}var d=obj.options.data[0].length-1;if((n==null||n>d||n<0)&&(n=d),s||(s=1),s>obj.options.data[0].length-n&&(s=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,s)===!1)return!1;if(parseInt(n)>-1){var M=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=n;R<n+s;R++)obj.isColMerged(R,!1).length&&(M=!0);if(M){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var z=obj.options.columns.splice(n,s);for(R=n;R<n+s;R++)obj.colgroup[R].className="",obj.headers[R].className="",obj.colgroup[R].parentNode.removeChild(obj.colgroup[R]),obj.headers[R].parentNode.removeChild(obj.headers[R]);for(var b=obj.headers.splice(n,s),u=obj.colgroup.splice(n,s),f=[],k=[],_=[],g=0;g<obj.options.data.length;g++)for(R=n;R<n+s;R++)obj.records[g][R].className="",obj.records[g][R].parentNode.removeChild(obj.records[g][R]);for(g=0;g<obj.options.data.length;g++)k[g]=obj.options.data[g].splice(n,s),f[g]=obj.records[g].splice(n,s);if(obj.options.footers)for(g=0;g<obj.options.footers.length;g++)_[g]=obj.options.footers[g].splice(n,s);if(obj.conditionalSelectionUpdate(0,n,n+s-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var o=0;o<obj.options.nestedHeaders.length;o++){var m=parseInt(obj.options.nestedHeaders[o][obj.options.nestedHeaders[o].length-1].colspan)-s;obj.options.nestedHeaders[o][obj.options.nestedHeaders[o].length-1].colspan=m,obj.thead.children[o].children[obj.thead.children[o].children.length-1].setAttribute("colspan",m)}else m=parseInt(obj.options.nestedHeaders[0].colspan)-s,obj.options.nestedHeaders[0].colspan=m,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",m);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:s,insertBefore:1,columns:z,headers:b,colgroup:u,records:f,footers:_,data:k}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,s,f)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var s=[],c=0;c<obj.rows.length;c++)obj.rows[c].classList.contains("selected")&&(n?s.push(c):s.push(obj.rows[c]));return s},obj.getSelectedColumns=function(){for(var n=[],s=0;s<obj.headers.length;s++)obj.headers[s].classList.contains("selected")&&n.push(s);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(R=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var s=0;s<obj.rows.length;s++)obj.rows[s]&&(z=obj.rows[s].getAttribute("data-y"))!=s&&(obj.rows[s].setAttribute("data-y",s),obj.rows[s].children[0].setAttribute("data-y",s),obj.rows[s].children[0].innerHTML=s+1);var c=[],d=[],M=function(o,m,j,h){if(o!=j&&obj.records[h][j].setAttribute("data-x",j),m!=h&&obj.records[h][j].setAttribute("data-y",h),o!=j||m!=h){var C=jexcel.getColumnNameFromId([o,m]),L=jexcel.getColumnNameFromId([j,h]);c[C]=L}};for(s=0;s<obj.records.length;s++)for(n=0;n<obj.records[0].length;n++)if(obj.records[s][n]){var R=obj.records[s][n].getAttribute("data-x"),z=obj.records[s][n].getAttribute("data-y");if(obj.records[s][n].getAttribute("data-merged")){var b=jexcel.getColumnNameFromId([R,z]),u=jexcel.getColumnNameFromId([n,s]);if(d[b]==null)if(b==u)d[b]=!1;else{var f=parseInt(n-R),k=parseInt(s-z);d[b]=[u,f,k]}}else M(R,z,n,s)}var _=Object.keys(d);if(_.length){for(n=0;n<_.length;n++)if(d[_[n]]){var g=jexcel.getIdFromColumnName(_[n],!0);for(M(R=g[0],z=g[1],R+d[_[n]][1],z+d[_[n]][2]),b=_[n],u=d[_[n]][0],s=0;s<obj.options.mergeCells[b][2].length;s++)R=parseInt(obj.options.mergeCells[b][2][s].getAttribute("data-x")),z=parseInt(obj.options.mergeCells[b][2][s].getAttribute("data-y")),obj.options.mergeCells[b][2][s].setAttribute("data-x",R+d[_[n]][1]),obj.options.mergeCells[b][2][s].setAttribute("data-y",z+d[_[n]][2]);obj.options.mergeCells[u]=obj.options.mergeCells[b],delete obj.options.mergeCells[b]}}obj.updateFormulas(c),obj.updateMeta(c),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,s=obj.rows.length-1;s>=0;s--){for(var c=!1,d=0;d<obj.headers.length;d++)obj.options.data[s][d]&&(c=!0);if(c)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var M=0;for(d=obj.headers.length-1;d>=0;d--){for(c=!1,s=0;s<obj.rows.length;s++)obj.options.data[s][d]&&(c=!0);if(c)break;M++}obj.options.minSpareCols-M>0&&obj.insertColumn(obj.options.minSpareCols-M)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),s=0;s<obj.rows.length;s++)for(d=0;d<obj.headers.length;d++)obj.options.updateTable(el,obj.records[s][d],d,s,obj.options.data[s][d],obj.records[s][d].textContent,jexcel.getColumnNameFromId([d,s]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,s){(n=obj.getCell(n))&&(s?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,s,c){var d=jexcel.getColumnNameFromId([n,s]);if(obj.formula[d]&&obj.formula[d].length>0)if(chainLoopProtection[d])obj.records[s][n].innerHTML="#ERROR",obj.formula[d]="";else{chainLoopProtection[d]=!0;for(var M=0;M<obj.formula[d].length;M++){var R=jexcel.getIdFromColumnName(obj.formula[d][M],!0),z=""+obj.options.data[R[1]][R[0]];z.substr(0,1)=="="?c.push(obj.updateCell(R[0],R[1],z,!0)):Object.keys(obj.formula)[M]=null,obj.updateFormulaChain(R[0],R[1],c)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var s=0;s<obj.options.data.length;s++)for(var c=0;c<obj.options.data[0].length;c++)if((b=""+obj.options.data[s][c]).substr(0,1)=="="){var d=obj.updateFormula(b,n);d!=b&&(obj.options.data[s][c]=d)}var M=[],R=Object.keys(obj.formula);for(s=0;s<R.length;s++){var z=R[s],b=obj.formula[z];for(n[z]&&(z=n[z]),M[z]=[],c=0;c<b.length;c++){var u=b[c];n[u]&&(u=n[u]),M[z].push(u)}}obj.formula=M},obj.updateFormula=function(n,s){for(var c=/[A-Z]/,d=/[0-9]/,M="",R=null,z=null,b="",u=0;u<n.length;u++)c.exec(n[u])?(R=1,z=0,b+=n[u]):d.exec(n[u])?(z=R?1:0,b+=n[u]):(R&&z&&(b=s[b]?s[b]:b),M+=b,M+=n[u],R=0,z=0,b="");return b&&(R&&z&&(b=s[b]?s[b]:b),M+=b),M};var secureFormula=function(n){for(var s="",c=0,d=0;d<n.length;d++)n[d]=='"'&&(c=c==0?1:0),s+=c==1?n[d]:n[d].toUpperCase();return s};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var s=0;s<n.length;s++){var c=[],d=n[s].split(":"),M=jexcel.getIdFromColumnName(d[0],!0),R=jexcel.getIdFromColumnName(d[1],!0);if(M[0]<=R[0])var z=M[0],b=R[0];else z=R[0],b=M[0];if(M[1]<=R[1])var u=M[1],f=R[1];else u=R[1],f=M[1];for(var k=u;k<=f;k++)for(var _=z;_<=b;_++)c.push(jexcel.getColumnNameFromId([_,k]));expression=expression.replace(n[s],c.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,s){var c=s&&obj.options.columns[s].decimal?obj.options.columns[s].decimal:".",d=""+n;return(d=d.split(c))[0]=d[0].match(/[+-]?[0-9]/g),d[0]&&(d[0]=d[0].join("")),d[1]&&(d[1]=d[1].match(/[0-9]*/g).join("")),d[0]&&Number.isInteger(Number(d[0]))?d[1]?n=+(d[0]+"."+d[1]):n=+(d[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,s){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,s?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-c<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}obj.updateScroll(1)},obj.up.visible=function(n,s){if(n==0)var c=parseInt(obj.selectedCell[0]),d=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),d=parseInt(obj.selectedCell[3]);if(s==0){for(var M=0;M<d;M++)if(obj.records[M][c].style.display!="none"&&obj.rows[M].style.display!="none"){d=M;break}}else d=obj.up.get(c,d);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=d):(obj.selectedCell[2]=c,obj.selectedCell[3]=d)},obj.up.get=function(n,s){n=parseInt(n);for(var c=(s=parseInt(s))-1;c>=0;c--)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[s][n])continue;s=c;break}return s},obj.down=function(n,s){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,s?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}obj.updateScroll(3)},obj.down.visible=function(n,s){if(n==0)var c=parseInt(obj.selectedCell[0]),d=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),d=parseInt(obj.selectedCell[3]);if(s==0){for(var M=obj.rows.length-1;M>d;M--)if(obj.records[M][c].style.display!="none"&&obj.rows[M].style.display!="none"){d=M;break}}else d=obj.down.get(c,d);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=d):(obj.selectedCell[2]=c,obj.selectedCell[3]=d)},obj.down.get=function(n,s){n=parseInt(n);for(var c=(s=parseInt(s))+1;c<obj.rows.length;c++)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[s][n])continue;s=c;break}return s},obj.right=function(n,s){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,s?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,s){if(n==0)var c=parseInt(obj.selectedCell[0]),d=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),d=parseInt(obj.selectedCell[3]);if(s==0){for(var M=obj.headers.length-1;M>c;M--)if(obj.records[d][M].style.display!="none"){c=M;break}}else c=obj.right.get(c,d);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=d):(obj.selectedCell[2]=c,obj.selectedCell[3]=d)},obj.right.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var c=n+1;c<obj.headers.length;c++)if(obj.records[s][c].style.display!="none"){if(obj.records[s][c].getAttribute("data-merged")&&obj.records[s][c]==obj.records[s][n])continue;n=c;break}return n},obj.left=function(n,s){n?obj.selectedCell[2]>0&&obj.left.visible(1,s?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,s){if(n==0)var c=parseInt(obj.selectedCell[0]),d=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),d=parseInt(obj.selectedCell[3]);if(s==0){for(var M=0;M<c;M++)if(obj.records[d][M].style.display!="none"){c=M;break}}else c=obj.left.get(c,d);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=d):(obj.selectedCell[2]=c,obj.selectedCell[3]=d)},obj.left.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var c=n-1;c>=0;c--)if(obj.records[s][c].style.display!="none"){if(obj.records[s][c].getAttribute("data-merged")&&obj.records[s][c]==obj.records[s][n])continue;n=c;break}return n},obj.first=function(n,s){if(n?s?obj.selectedCell[3]=0:obj.left.visible(1,0):(s?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,s){if(n?s?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(s?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)s=obj.rows;else var s=obj.results;var c=100;n!=null&&n!=-1||(n=Math.ceil(s.length/c)-1);var d=n*c,M=n*c+c;M>s.length&&(M=s.length),(d=M-100)<0&&(d=0);for(var R=d;R<M;R++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[R]):obj.tbody.appendChild(obj.rows[s[R]]),obj.tbody.children.length>c&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c>0)for(var d=0;d<30;d++)(c-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[c],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[c]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),s=1))}return s},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var c=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c<obj.rows.length-1)for(var d=0;d<=30;d++)c<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[c]):obj.tbody.appendChild(obj.rows[n[c]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),s=1)),c+=1}return s},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,s=parseInt(obj.selectedCell[3]/100),c=parseInt(obj.rows.length/100);if(n!=s&&s<=c&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(s),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var s=function(d){obj.results.indexOf(d)==-1&&obj.results.push(d)},c=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c=new RegExp(c,"i"),obj.options.data.forEach(function(d,M){if(function(f,k,_){for(var g=0;g<f.length;g++)if((""+f[g]).toLowerCase().search(k)>=0||(""+obj.records[_][g].innerHTML).toLowerCase().search(k)>=0)return!0;return!1}(d,c,M)){var R=obj.isRowMerged(M);if(R.length)for(var z=0;z<R.length;z++)for(var b=jexcel.getIdFromColumnName(R[z],!0),u=0;u<obj.options.mergeCells[R[z]][1];u++)s(b[1]+u);else s(M)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,s=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var c=0;c<obj.rows.length;c++)!obj.results||obj.results.indexOf(c)>-1?(s<n&&(obj.tbody.appendChild(obj.rows[c]),s++),obj.rows[c].style.display=""):obj.rows[c].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var s=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)c=obj.rows;else var c=obj.results;var d=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(c.length/d)-1),obj.pageNumber=n;var M=n*d,R=n*d+d;for(R>c.length&&(R=c.length),M<0&&(M=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var z=M;z<R;z++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[z]):obj.tbody.appendChild(obj.rows[c[z]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,s)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var s=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var c=1,d=s<10?s:10;else s-obj.pageNumber<5?(d=s,(c=s-9)<1&&(c=1)):(c=obj.pageNumber-4,d=obj.pageNumber+5);c>1&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML="<",R.title=1,obj.pagination.children[1].appendChild(R));for(var M=c;M<=d;M++){var R;(R=document.createElement("div")).className="jexcel_page",R.innerHTML=M,obj.pagination.children[1].appendChild(R),obj.pageNumber==M-1&&R.classList.add("jexcel_page_selected")}d<s&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML=">",R.title=s,obj.pagination.children[1].appendChild(R)),obj.pagination.children[0].innerHTML=function(z){var b=Array.prototype.slice.call(arguments,1);return z.replace(/{(\d+)}/g,function(u,f){return b[f]!==void 0?b[f]:u})}(obj.options.text.showingPage,obj.pageNumber+1,s)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var s="";s+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var c=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(c,obj.options.csvFileName+".csv");else{var d=document.createElement("a"),M=URL.createObjectURL(c);d.href=M,d.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(d),d.click(),d.parentNode.removeChild(d)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var s=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,s+1),obj.history[s]=n}},obj.copy=function(n,s,c,d,M){s||(s="	");for(var R=new RegExp(s,"ig"),z=[],b=[],u=[],f=[],k=[],_=obj.options.data[0].length,g=obj.options.data.length,o="",m=!1,j="",h="",C=0,L=0,I=0,B=0,D=!0,A=0;A<g;A++)for(var S=0;S<_;S++)n&&!obj.records[A][S].classList.contains("highlight")||(I<=S&&(I=S),B<=A&&(B=A));if(_===I+1&&g===B+1&&(D=!1),M&&obj.options.includeHeadersOnDownload==1||!M&&obj.options.includeHeadersOnCopy==1&&!D||d){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(o=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],A=0;A<o.length;A++){var J=[];for(S=0;S<o[A].length;S++){var q=parseInt(o[A][S].colspan);J.push(o[A][S].title);for(var ie=0;ie<q-1;ie++)J.push("")}h+=J.join(s)+`\r
`}m=!0}for(obj.style=[],A=0;A<g;A++){for(b=[],u=[],S=0;S<_;S++)if(!n||obj.records[A][S].classList.contains("highlight")){m==1&&z.push(obj.headers[S].textContent);var pe=obj.options.data[A][S];if(pe.match&&(pe.match(R)||pe.match(/,/g)||pe.match(/\n/)||pe.match(/\"/))&&(pe='"'+(pe=pe.replace(new RegExp('"',"g"),'""'))+'"'),b.push(pe),obj.options.columns[S].type=="checkbox"||obj.options.columns[S].type=="radio")var se=pe;else(se=obj.options.stripHTMLOnCopy==1?obj.records[A][S].textContent:obj.records[A][S].innerHTML).match&&(se.match(R)||se.match(/,/g)||se.match(/\n/)||se.match(/\"/))&&(se='"'+(se=se.replace(new RegExp('"',"g"),'""'))+'"');u.push(se),o=(o=obj.records[A][S].getAttribute("style")).replace("display: none;",""),obj.style.push(o||"")}b.length&&(m&&(C=b.length,f.push(z.join(s))),f.push(b.join(s))),u.length&&(L++,m&&(k.push(z.join(s)),m=!1),k.push(u.join(s)))}_==C&&g==L&&(j=h);var be=j+f.join(`\r
`),Me=j+k.join(`\r
`);if(c||(obj.options.copyCompatibility==1?obj.textarea.value=Me:obj.textarea.value=be,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Me:obj.data=be,obj.hashString=obj.hash(obj.data),!c){if(obj.removeCopyingSelection(),obj.highlighted)for(S=0;S<obj.highlighted.length;S++)obj.highlighted[S].classList.add("copying"),obj.highlighted[S].classList.contains("highlight-left")&&obj.highlighted[S].classList.add("copying-left"),obj.highlighted[S].classList.contains("highlight-right")&&obj.highlighted[S].classList.add("copying-right"),obj.highlighted[S].classList.contains("highlight-top")&&obj.highlighted[S].classList.add("copying-top"),obj.highlighted[S].classList.contains("highlight-bottom")&&obj.highlighted[S].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?k:f,obj.hashString)}return obj.data},obj.paste=function(n,s,c){var d=parseInt(n),M=parseInt(s),R=parseInt(obj.selectedCell[2]),z=parseInt(obj.selectedCell[3]),b=R-d+1,u=z-M+1;R<d&&(n=R.toString(),b=d-R+1),z<M&&(s=z.toString(),u=M-z+1);var f=obj.dispatch("onbeforepaste",el,c,n,s);if(f===!1)return!1;f&&(c=f);var k=obj.hash(c),_=k==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&k==obj.hashString&&(c=obj.data),c=obj.parseCSV(c,"	"),b>1&Number.isInteger(b/c[0].length)){_=null,o=b/c[0].length;var g=c.map(function(q,ie){var pe=Array.apply(null,{length:o*q.length}).map(function(se,be){return q[be%q.length]});return pe});c=g}if(u>1&Number.isInteger(u/c.length)){_=null;var o=u/c.length;g=Array.apply(null,{length:o*c.length}).map(function(q,ie){return c[ie%c.length]}),c=g}if(n!=null&&s!=null&&c){for(var m=0,j=0,h=[],C={},L={},I=0,B=parseInt(n),D=parseInt(s),A=null;A=c[j];){for(m=0,B=parseInt(n);A[m]!=null;){var S=obj.updateCell(B,D,A[m]);if(h.push(S),obj.updateFormulaChain(B,D,h),_&&_[I]){var J=jexcel.getColumnNameFromId([B,D]);C[J]=_[I],L[J]=obj.getStyle(J),obj.records[D][B].setAttribute("style",_[I]),I++}if(A[++m]!=null){if(B>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}B=obj.right.get(B,D)}}if(j++,c[j]){if(D>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}D=obj.down.get(n,D)}}obj.updateSelectionFromCoords(n,s,B,D),obj.setHistory({action:"setValue",records:h,selection:obj.selectedCell,newStyle:C,oldStyle:L}),obj.updateTable(),obj.dispatch("onpaste",el,c),obj.onafterchanges(el,h)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),s=0;s<n.length;s++)n[s].classList.remove("copying"),n[s].classList.remove("copying-left"),n[s].classList.remove("copying-right"),n[s].classList.remove("copying-top"),n[s].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,s){var c=s.insertBefore?+s.rowNumber:s.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var d=s.numOfRows,M=c;M<d+c;M++)obj.rows[M].parentNode.removeChild(obj.rows[M]);obj.records.splice(c,d),obj.options.data.splice(c,d),obj.rows.splice(c,d),obj.conditionalSelectionUpdate(1,c,d+c-1)}else{obj.records=jexcel.injectArray(obj.records,c,s.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,c,s.rowData),obj.rows=jexcel.injectArray(obj.rows,c,s.rowNode);var R=0;for(M=c;M<s.numOfRows+c;M++)obj.tbody.insertBefore(s.rowNode[R],obj.tbody.children[M]),R++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,s){var c=s.insertBefore?s.columnNumber:s.columnNumber+1;if(n==1){var d=s.numOfColumns;obj.options.columns.splice(c,d);for(var M=c;M<d+c;M++)obj.headers[M].parentNode.removeChild(obj.headers[M]),obj.colgroup[M].parentNode.removeChild(obj.colgroup[M]);obj.headers.splice(c,d),obj.colgroup.splice(c,d);for(var R=0;R<s.data.length;R++){for(M=c;M<d+c;M++)obj.records[R][M].parentNode.removeChild(obj.records[R][M]);obj.records[R].splice(c,d),obj.options.data[R].splice(c,d)}if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R].splice(c,d)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,c,s.columns),obj.headers=jexcel.injectArray(obj.headers,c,s.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,c,s.colgroup);var z=0;for(M=c;M<s.numOfColumns+c;M++)obj.headerContainer.insertBefore(s.headers[z],obj.headerContainer.children[M+1]),obj.colgroupContainer.insertBefore(s.colgroup[z],obj.colgroupContainer.children[M+1]),z++;for(R=0;R<s.data.length;R++)for(obj.options.data[R]=jexcel.injectArray(obj.options.data[R],c,s.data[R]),obj.records[R]=jexcel.injectArray(obj.records[R],c,s.records[R]),z=0,M=c;M<s.numOfColumns+c;M++)obj.rows[R].insertBefore(s.records[R][z],obj.rows[R].children[M+1]),z++;if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R]=jexcel.injectArray(obj.options.footers[R],c,s.footers[R])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(R=0;R<obj.options.nestedHeaders.length;R++){if(n==1)var b=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)-s.numOfColumns;else b=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)+s.numOfColumns;obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan=b,obj.thead.children[R].children[obj.thead.children[R].children.length-1].setAttribute("colspan",b)}else b=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-s.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+s.numOfColumns,obj.options.nestedHeaders[0].colspan=b,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",b);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var c=[];if(obj.historyIndex>=0){var d=obj.history[obj.historyIndex--];if(d.action=="insertRow")obj.historyProcessRow(1,d);else if(d.action=="deleteRow")obj.historyProcessRow(0,d);else if(d.action=="insertColumn")obj.historyProcessColumn(1,d);else if(d.action=="deleteColumn")obj.historyProcessColumn(0,d);else if(d.action=="moveRow")obj.moveRow(d.newValue,d.oldValue);else if(d.action=="moveColumn")obj.moveColumn(d.newValue,d.oldValue);else if(d.action=="setMerge")obj.removeMerge(d.column,d.data);else if(d.action=="setStyle")obj.setStyle(d.oldValue,null,null,1);else if(d.action=="setWidth")obj.setWidth(d.column,d.oldValue);else if(d.action=="setHeight")obj.setHeight(d.row,d.oldValue);else if(d.action=="setHeader")obj.setHeader(d.column,d.oldValue);else if(d.action=="setComments")obj.setComments(d.column,d.oldValue[0],d.oldValue[1]);else if(d.action=="orderBy"){for(var M=[],R=0;R<d.rows.length;R++)M[d.rows[R]]=R;obj.updateOrderArrow(d.column,d.order?0:1),obj.updateOrder(M)}else if(d.action=="setValue"){for(var z=0;z<d.records.length;z++)c.push({x:d.records[z].x,y:d.records[z].y,newValue:d.records[z].oldValue}),d.oldStyle&&obj.resetStyle(d.oldStyle);obj.setValue(c),d.selection&&obj.updateSelectionFromCoords(d.selection[0],d.selection[1],d.selection[2],d.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onundo",el,d)},obj.redo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var c=obj.history[++obj.historyIndex];if(c.action=="insertRow")obj.historyProcessRow(0,c);else if(c.action=="deleteRow")obj.historyProcessRow(1,c);else if(c.action=="insertColumn")obj.historyProcessColumn(0,c);else if(c.action=="deleteColumn")obj.historyProcessColumn(1,c);else if(c.action=="moveRow")obj.moveRow(c.oldValue,c.newValue);else if(c.action=="moveColumn")obj.moveColumn(c.oldValue,c.newValue);else if(c.action=="setMerge")obj.setMerge(c.column,c.colspan,c.rowspan,1);else if(c.action=="setStyle")obj.setStyle(c.newValue,null,null,1);else if(c.action=="setWidth")obj.setWidth(c.column,c.newValue);else if(c.action=="setHeight")obj.setHeight(c.row,c.newValue);else if(c.action=="setHeader")obj.setHeader(c.column,c.newValue);else if(c.action=="setComments")obj.setComments(c.column,c.newValue[0],c.newValue[1]);else if(c.action=="orderBy")obj.updateOrderArrow(c.column,c.order),obj.updateOrder(c.rows);else if(c.action=="setValue"){obj.setValue(c.records);for(var d=0;d<c.records.length;d++)c.oldStyle&&obj.resetStyle(c.newStyle);c.selection&&obj.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onredo",el,c)},obj.getDropDownValue=function(n,s){var c=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var d=[],M=obj.options.columns[n].source,R=0;R<M.length;R++)typeof M[R]=="object"?d[M[R].id]=M[R].name:d[M[R]]=M[R];var z=Array.isArray(s)?s:(""+s).split(";");for(R=0;R<z.length;R++)typeof z[R]=="object"?c.push(d[z[R].id]):d[z[R]]&&c.push(d[z[R]])}else console.error("Invalid column");return c.length>0?c.join("; "):""},obj.parseCSV=function(n,s){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),s=s||",";for(var c=[],d=!1,M=0,R=0,z=0;z<n.length;z++){var b=n[z],u=n[z+1];c[M]=c[M]||[],c[M][R]=c[M][R]||"",b=='"'&&d&&u=='"'?(c[M][R]+=b,++z):b!='"'?b!=s||d?b!="\r"||u!=`
`||d?b==`
`&&!d||b=="\r"&&!d?(++M,R=0):c[M][R]+=b:(++M,R=0,++z):++R:d=!d}return c},obj.hash=function(n){var s,c=0;if(n.length===0)return c;for(s=0;s<n.length;s++)c=(c<<5)-c+n.charCodeAt(s),c|=0;return c},obj.onafterchanges=function(n,s){obj.dispatch("onafterchanges",n,s)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var s=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&s.length>0)for(var c=s.shift(),d=0;d<c.length;d++)obj.options.columns[d]||(obj.options.columns[d]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[d].title===void 0&&(obj.options.columns[d].title=c[d]);obj.options.data=s,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,s,c,d){var M=[];if(c==null)obj.options.allowInsertColumn==1&&M.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(s),1)}}),obj.options.allowInsertColumn==1&&M.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(s),0)}}),obj.options.allowDeleteColumn==1&&M.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(s))}}),obj.options.allowRenameColumn==1&&M.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(s)}}),obj.options.columnSorting==1&&(M.push({type:"line"}),M.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(s,0)}}),M.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(s,1)}}));else if(obj.options.allowInsertRow==1&&(M.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(c),1)}}),M.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(c))}})),obj.options.allowDeleteRow==1&&M.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(c))}}),s&&obj.options.allowComments==1){M.push({type:"line"});var R=obj.records[c][s].getAttribute("title")||"";M.push({title:R?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var z=prompt(obj.options.text.comments,R);z&&obj.setComments([s,c],z)}}),R&&M.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([s,c],"")}})}return M.push({type:"line"}),M.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&M.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(z){z&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],z)})}}),obj.options.allowExport&&M.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&M.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),M},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var s=0;s<obj.options.freezeColumns;s++)n+=parseInt(obj.options.columns[s].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var s=0;s<obj.options.freezeColumns;s++){s>0&&obj.options.columns[s-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[s-1].width)),obj.headers[s].classList.add("jexcel_freezed"),obj.headers[s].style.left=n+"px";for(var c=0;c<obj.rows.length;c++)if(obj.rows[c]&&obj.records[c][s]){var d=scrollLeft+(s>0?obj.records[c][s-1].style.width:0)-51+"px";obj.records[c][s].classList.add("jexcel_freezed"),obj.records[c][s].style.left=d}}else for(s=0;s<obj.options.freezeColumns;s++)for(obj.headers[s].classList.remove("jexcel_freezed"),obj.headers[s].style.left="",c=0;c<obj.rows.length;c++)obj.records[c][s]&&(obj.records[c][s].classList.remove("jexcel_freezed"),obj.records[c][s].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var s=Object.keys(n),c=0;c<s.length;c++)typeof n[s[c]]=="function"&&(jexcel[s[c]]=n[s[c]],jexcel.license&&typeof n[s[c]].license=="function"&&n[s[c]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,s){if(n.jexcel){var c=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",s&&(destroyEvents(c),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var s=jexcel.current.edition[0].children[0],c=jexcel.current.edition[0].children[0].value,d=s.selectionStart;c=c.slice(0,d)+`
`+c.slice(d),s.value=c,s.focus(),s.selectionStart=d+1,s.selectionEnd=d+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46||n.which==8)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var M=jexcel.current.selectedCell[1],R=jexcel.current.selectedCell[0];jexcel.current.options.columns[R].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[R].type=="checkbox"||jexcel.current.options.columns[R].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[M][R],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[M][R],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[M][R],!0),jexcel.current.options.columns[R].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;var c=jexcel.getElement(n.target);if(c[0]?jexcel.current!=c[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=c[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&s==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(c[1]==1){if(o=n.target.getAttribute("data-x")){var d=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&d.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:o,width:d.width},jexcel.current.headers[o].classList.add("resizing");for(var M=0;M<jexcel.current.records.length;M++)jexcel.current.records[M][o]&&jexcel.current.records[M][o].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&d.height-n.offsetY<6)if(jexcel.current.isColMerged(o).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:o,destination:o},jexcel.current.headers[o].classList.add("dragging"),M=0;M<jexcel.current.records.length;M++)jexcel.current.records[M][o]&&jexcel.current.records[M][o].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var R=jexcel.current.selectedHeader,z=o;else jexcel.current.selectedHeader==o&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(o)},800)),jexcel.current.selectedHeader=o,R=o,z=o;jexcel.current.updateSelectionFromCoords(R,0,z,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var b=n.target.getAttribute("data-column").split(","),u=parseInt(b[0]),f=parseInt(b[b.length-1]);else u=0,f=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(u,0,f,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(c[1]==2){var k=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))d=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&d.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:k,height:d.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&d.width-n.offsetX<6?jexcel.current.isRowMerged(k).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:k,destination:k},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(R=jexcel.current.selectedRow,z=k):(jexcel.current.selectedRow=k,R=k,z=k),jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,z));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var _=function(m){var j=m.getAttribute("data-x"),h=m.getAttribute("data-y");return j&&h?[j,h]:m.parentNode?_(m.parentNode):void 0},g=_(n.target);if(g){var o=g[0];k=g[1],jexcel.current.edition&&(jexcel.current.edition[2]==o&&jexcel.current.edition[3]==k||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,k):jexcel.current.updateSelectionFromCoords(o,k)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var s=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),c=jexcel.current.getSelectedColumns();if(c.length>1){for(var d=[],M=0;M<c.length;M++)d.push(parseInt(jexcel.current.colgroup[c[M]].getAttribute("width")));d[c.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(c,s,d)}else jexcel.current.setWidth(jexcel.current.resizing.column,s,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var R=0;R<jexcel.current.records.length;R++)jexcel.current.records[R][jexcel.current.resizing.column]&&jexcel.current.records[R][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var z=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,z,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var b=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),R=0;R<jexcel.current.rows.length;R++)jexcel.current.records[R][jexcel.current.dragging.column]&&jexcel.current.records[R][jexcel.current.dragging.column].classList.remove("dragging");for(M=0;M<jexcel.current.headers.length;M++)jexcel.current.headers[M].classList.remove("dragging-left"),jexcel.current.headers[M].classList.remove("dragging-right");b&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var u=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<u&&(u-=1)}else u=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,u,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var c=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+c>0){var d=jexcel.current.resizing.width+c;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",d),jexcel.current.updateCornerPosition()}}else{var M=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+M>0){var R=jexcel.current.resizing.height+M;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",R),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var z=n.target.getAttribute("data-x");if(z)if(jexcel.current.isColMerged(z).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var b=0;b<jexcel.current.headers.length;b++)jexcel.current.headers[b].classList.remove("dragging-left"),jexcel.current.headers[b].classList.remove("dragging-right");jexcel.current.dragging.column==z?jexcel.current.dragging.destination=parseInt(z):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<z?jexcel.current.dragging.destination=parseInt(z)-1:jexcel.current.dragging.destination=parseInt(z),jexcel.current.headers[z].classList.add("dragging-left")):(jexcel.current.dragging.column<z?jexcel.current.dragging.destination=parseInt(z):jexcel.current.dragging.destination=parseInt(z)+1,jexcel.current.headers[z].classList.add("dragging-right"))}}else{var u=n.target.getAttribute("data-y");if(u)if(jexcel.current.isRowMerged(u).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var f=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=f&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,f),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var k=n.target.getAttribute("data-x"),_=n.target.getAttribute("data-y"),g=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&k&&!_&&g.width-(n.clientX-g.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!k&&_&&g.height-(n.clientY-g.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!k&&_&&g.width-(n.clientX-g.left)<6||n.target&&k&&!_&&g.height-(n.clientY-g.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var c=jexcel.getElement(n.target);if(c[0]){if(jexcel.current!=c[0].jexcel&&jexcel.current)return!1;var d=n.target.getAttribute("data-x"),M=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(c[1]==1&&jexcel.current.selectedHeader){d=n.target.getAttribute("data-x");var R=jexcel.current.selectedHeader,z=d;jexcel.current.updateSelectionFromCoords(R,0,z,jexcel.current.options.data.length-1)}c[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(R=jexcel.current.selectedRow,z=M,jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,z)):jexcel.current.edition||d&&M&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(d,M):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],d,M)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var s=jexcel.current.highlighted[0].getAttribute("data-x"),c=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,d=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),M=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[c][s],jexcel.current.records[M][d])}}else if(n.target.classList.contains("jexcel_column_filter")){var R=n.target.getAttribute("data-x");jexcel.current.openFilter(R)}else{var z=jexcel.getElement(n.target);if(z[1]==1&&jexcel.current.options.columnSorting==1&&(R=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(R),z[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var b=function(f){if(f.parentNode){var k=f.getAttribute("data-x"),_=f.getAttribute("data-y");return k&&_?f:b(f.parentNode)}},u=b(n.target);u&&u.classList.contains("highlight")&&jexcel.current.openEditor(u)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var s=n.target.getAttribute("data-x"),c=n.target.getAttribute("data-y");if(s||c){(s<parseInt(jexcel.current.selectedCell[0])||s>parseInt(jexcel.current.selectedCell[2])||c<parseInt(jexcel.current.selectedCell[1])||c>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(s,c,s,c);var d=jexcel.current.options.contextMenu(jexcel.current,s,c,n);jexcel.current.contextMenu.contextmenu.open(n,d),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var s=jexcel.getElement(n.target);if(s[0]?jexcel.current!=s[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=s[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var c=n.target.getAttribute("data-x"),d=n.target.getAttribute("data-y");c&&d&&(jexcel.current.updateSelectionFromCoords(c,d),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[c].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,s){var c=[];if(n.classList.contains("jexcel_tabs"))M=n.children[0],R=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var d=document.createElement("div"),M=n.appendChild(d),R=(d=document.createElement("div"),n.appendChild(d))}for(var z=[],b=[],u=0;u<s.length;u++){z[u]=document.createElement("div"),z[u].classList.add("jexcel_tab");var f=jexcel(z[u],s[u]);R.appendChild(z[u]),c[u]=n.jexcel.push(f),b[u]=document.createElement("div"),b[u].classList.add("jexcel_tab_link"),b[u].setAttribute("data-spreadsheet",n.jexcel.length-1),b[u].innerHTML=s[u].sheetName,b[u].onclick=function(){for(var _=0;_<M.children.length;_++)M.children[_].classList.remove("selected"),R.children[_].style.display="none";var g=this.getAttribute("data-spreadsheet");R.children[g].style.display="block",M.children[g].classList.add("selected")},M.appendChild(b[u])}for(var k=0;k<M.children.length;k++)M.children[k].classList.remove("selected"),R.children[k].style.display="none";return M.children[M.children.length-1].classList.add("selected"),R.children[M.children.length-1].style.display="block",c},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,s){var c,d=function(M){var R=[];return M.SheetNames.forEach(function(z){var b={rows:[],columns:[],data:[],style:{}};if(b.sheetName=z,(h=M.Sheets[z]["!cols"])&&h.length)for(var u=0;u<h.length;u++)b.columns[u]={},h[u]&&h[u].wpx&&(b.columns[u].width=h[u].wpx+"px");if((h=M.Sheets[z]["!rows"])&&h.length)for(u=0;u<h.length;u++)h[u]&&h[u].hpx&&(b.rows[u]={},b.rows[u].height=h[u].hpx+"px");if((h=M.Sheets[z]["!merges"])&&h.length>0)for(b.mergeCells=[],u=0;u<h.length;u++){var f=h[u].s.c,k=h[u].s.r,_=h[u].e.c,g=h[u].e.r,o=jexcel.getColumnNameFromId([f,k]);b.mergeCells[o]=[_-f+1,g-k+1]}var m=0,j=0,h=Object.keys(M.Sheets[z]);for(u=0;u<h.length;u++)if(h[u].substr(0,1)!="!"){var C=M.Sheets[z][h[u]],L=jexcel.getIdFromColumnName(h[u],!0);b.data[L[1]]||(b.data[L[1]]=[]),b.data[L[1]][L[0]]=C.f?"="+C.f:C.w,m<L[0]&&(m=L[0]),j<L[1]&&(j=L[1]),C.style&&Object.keys(C.style).length>0&&(b.style[h[u]]=C.style),C.s&&C.s.fgColor&&(b.style[h[u]]&&(b.style[h[u]]+=";"),b.style[h[u]]+="background-color:#"+C.s.fgColor.rgb)}for(var I=b.columns,B=0;B<=j;B++)for(u=0;u<=m;u++)b.data[B]||(b.data[B]=[]),b.data[B][u]||I<u&&(b.data[B][u]="");R.push(b)}),R};(c=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array<"u"?(c.responseType="arraybuffer",c.onload=function(M){var R=c.response,z=new Uint8Array(R),b=XLSX.read(z,{type:"array",cellFormula:!0,cellStyles:!0});s(d(b))}):(c.setRequestHeader("Accept-Charset","x-user-defined"),c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var M=convertResponseBodyToText(c.responseBody),R=XLSX.read(M,{type:"binary",cellFormula:!0,cellStyles:!0});s(d(R))}}),c.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,s,c){return n.slice(0,s).concat(c).concat(n.slice(s))},jexcel.getColumnName=function(n){return jexcel.helpers.getColumnName(n)},jexcel.getIdFromColumnName=function(n,s){var c=/^[a-zA-Z]+/.exec(n);if(c){for(var d=0,M=0;M<c[0].length;M++)d+=parseInt(c[0].charCodeAt(M)-64)*Math.pow(26,c[0].length-1-M);--d<0&&(d=0);var R=parseInt(/[0-9]+$/.exec(n));R>0&&R--,n=s==1?[d,R]:d+"-"+R}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var s=0,c=0;return function d(M){M.className&&M.classList.contains("jexcel_container")&&(c=M),M.tagName=="THEAD"?s=1:M.tagName=="TBODY"&&(s=2),M.parentNode&&(c||d(M.parentNode))}(n),[c,s]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,s){if(n.tagName=="TABLE"){s||(s={}),s.columns=[],s.data=[];var c=n.querySelectorAll("colgroup > col");if(c.length)for(var d=0;d<c.length;d++){if(!(M=c[d].style.width))var M=c[d].getAttribute("width");M&&(s.columns[d]||(s.columns[d]={}),s.columns[d].width=M)}var R=function(be){var Me=be.getBoundingClientRect(),me=Me.width>50?Me.width:50;s.columns[d]||(s.columns[d]={}),be.getAttribute("data-celltype")?s.columns[d].type=be.getAttribute("data-celltype"):s.columns[d].type="text",s.columns[d].width=me+"px",s.columns[d].title=be.innerHTML,s.columns[d].align=be.style.textAlign||"center",(Me=be.getAttribute("name"))&&(s.columns[d].name=Me),(Me=be.getAttribute("id"))&&(s.columns[d].id=Me),(Me=be.getAttribute("data-mask"))&&(s.columns[d].mask=Me)},z=[],b=n.querySelectorAll(":scope > thead > tr");if(b.length){for(var u=0;u<b.length-1;u++){var f=[];for(d=0;d<b[u].children.length;d++){var k={title:b[u].children[d].textContent,colspan:b[u].children[d].getAttribute("colspan")||1};f.push(k)}z.push(f)}for(b=b[b.length-1].children,d=0;d<b.length;d++)R(b[d])}var _=0,g={},o={},m={},j={},h=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(u=0;u<h.length;u++)if(s.data[_]=[],s.parseTableFirstRowAsHeader!=1||b.length||u!=0){for(d=0;d<h[u].children.length;d++){if(C=h[u].children[d].getAttribute("data-formula"))C.substr(0,1)!="="&&(C="="+C);else var C=h[u].children[d].innerHTML;s.data[_].push(C);var L=jexcel.getColumnNameFromId([d,u]),I=h[u].children[d].getAttribute("class");I&&(j[L]=I);var B=parseInt(h[u].children[d].getAttribute("colspan"))||0,D=parseInt(h[u].children[d].getAttribute("rowspan"))||0;(B||D)&&(g[L]=[B||1,D||1]),h[u].children[d].style&&h[u].children[d].style.display=="none"&&(h[u].children[d].style.display="");var A=h[u].children[d].getAttribute("style");A&&(m[L]=A),h[u].children[d].classList.contains("styleBold")&&(m[L]?m[L]+="; font-weight:bold;":m[L]="font-weight:bold;")}h[u].style&&h[u].style.height&&(o[u]={height:h[u].style.height}),_++}else for(d=0;d<h[u].children.length;d++)R(h[u].children[d]);if(Object.keys(z).length>0&&(s.nestedHeaders=z),Object.keys(m).length>0&&(s.style=m),Object.keys(g).length>0&&(s.mergeCells=g),Object.keys(o).length>0&&(s.rows=o),Object.keys(j).length>0&&(s.classes=j),(h=n.querySelectorAll("tfoot tr")).length){var S=[];for(u=0;u<h.length;u++){var J=[];for(d=0;d<h[u].children.length;d++)J.push(h[u].children[d].textContent);S.push(J)}Object.keys(S).length>0&&(s.footers=S)}if(s.parseTableAutoCellType==1){var q=[];for(d=0;d<s.columns.length;d++){var ie=!0,pe=!0;for(q[d]=[],u=0;u<s.data.length;u++)C=s.data[u][d],q[d][C]||(q[d][C]=0),q[d][C]++,C.length>25&&(ie=!1),C.length==10&&C.substr(4,1)=="-"&&C.substr(7,1)=="-"||(pe=!1);var se=Object.keys(q[d]).length;pe?s.columns[d].type="calendar":ie==1&&se>1&&se<=parseInt(.1*s.data.length)&&(s.columns[d].type="dropdown",s.columns[d].source=Object.keys(q[d]))}}return s}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var s=this.config.root;else s=window;var c=0,d=s.getSelection();if(d&&d.rangeCount!==0){var M=d.getRangeAt(0),R=M.cloneRange();R.selectNodeContents(n),R.setEnd(M.endContainer,M.endOffset),c=R.toString().length}return c},invert:function(n){for(var s=[],c=Object.keys(n),d=0;d<c.length;d++)s[n[c[d]]]=c[d];return s},getColumnName:function(n){let s,c=n+1,d="";for(;c>0;)s=(c-1)%26,d=String.fromCharCode(65+s).toString()+d,c=parseInt((c-s)/26);return d},getColumnNameFromCoords:function(n,s){return component.getColumnName(parseInt(n))+(parseInt(s)+1)},getCoordsFromColumnName:function(n){var s=/^[a-zA-Z]+/.exec(n);if(s){for(var c=0,d=0;d<s[0].length;d++)c+=parseInt(s[0].charCodeAt(d)-64)*Math.pow(26,s[0].length-1-d);--c<0&&(c=0);var M=parseInt(/[0-9]+$/.exec(n))||null;return M>0&&M--,[c,M]}},createFromTable:function(){},injectArray:function(n,s,c){return n.slice(0,s).concat(c).concat(n.slice(s))},parseCSV:function(n,s){s=s||",";for(var c=0,d=0,M=[[]],R=0,z=null,b=!1,u=!1,f=0;f<n.length;f++)if(M[d]||(M[d]=[]),M[d][c]||(M[d][c]=""),n[f]!="\r")if(n[f]!=`
`&&n[f]!=s||b!=0&&u!=1&&z){if(n[f]=='"'&&(b=!b),z===null){if((z=b)==1)continue}else if(z===!0&&!u&&n[f]=='"'){n[f+1]=='"'?(b=!0,M[d][c]+=n[f],f++):u=!0;continue}M[d][c]+=n[f]}else{if(z=null,b=!1,u=!1,M[d][c][0]=='"'){var k=M[d][c].trim();k[k.length-1]=='"'&&(M[d][c]=k.substr(1,k.length-2))}n[f]==`
`?(c=0,d++):++c>R&&(R=c)}for(var _=0;_<M.length;_++)for(f=0;f<=R;f++)M[_][f]===void 0&&(M[_][f]="");return M}},component),typeof jQuery<"u"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(s){var c=n(this).get(0);return c.jexcel?Array.isArray(c.jexcel)?c.jexcel[s][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):c.jexcel[s].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(n){var s=__webpack_module_cache__[n];if(s!==void 0)return s.exports;var c=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(c.exports,c,c.exports,__webpack_require__),c.exports}var __webpack_exports__=__webpack_require__(44);jspreadsheet=__webpack_exports__}(),jspreadsheet})}(dist$1)),dist$1.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs(distExports),_hoisted_1={class:"grid grid-rows-[55px,1fr]"},_hoisted_2={class:"flex-grow mt-10"},_sfc_main={__name:"Documents",setup(n){const s=ref(new Date),c=ref(null),d=ref([]),M=ref([]),R=ref(null);let z=null;(async()=>{try{const{data:C}=await axios.get("/getRowPage/22");M.value=Array.isArray(C)?C:C.items||[],M.value.length&&!R.value&&(R.value=M.value[0].NumberPage,await u(R.value,s.value))}catch(C){console.error("getRowPage error",C)}})();const u=async(C,L)=>{try{const{data:I}=await axios.get(`/selectResultBlogs/${C}/${o(L)}`);d.value=I}catch(I){console.error("selectResultBlogs error",I)}},f=async C=>{R.value=C,await u(R.value,s.value)};function k(){if(!d.value||typeof d.value!="object")return"";const C=Object.keys(d.value||{});if(!C.length)return"";const L=d.value[C[0]];if(!L)return"";const I=Object.keys(L);if(!I.length)return"";const B=L[I[0]];if(!B)return"";const D=Object.keys(B);if(!D.length)return"";const A=B[D[0]];return!A||!A.length?"":A[0].group_name||""}const _=k();z&&_&&z.setValue("A3",_);const g={A1:"border-left:2px solid #000;border-right:1px solid #fff;border-top:1px solid #000;border-bottom:1px solid #000;w-200;",A2:"background:yellow",B2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",C2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",D2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",E2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",F2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",G2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",H2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",I2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",A3:"border-right:none;border-left:none;font-weight: bold;",B3:"border-right:none;border-left:none;font-weight: bold;",C3:"border-right:none;border-left:none;font-weight: bold;",A4:"font-weight: bold;",B4:"font-weight: bold;",C4:"color:red;font-weight: bold;"};function o(C){if(!C)return"";const L=new Date(C),I=String(L.getDate()).padStart(2,"0"),B=String(L.getMonth()+1).padStart(2,"0"),D=L.getFullYear();return`${I}.${B}.${D}`}onMounted(()=>{u(s.value);const C=[[o(s.value),...Array(18).fill("")],Array(300).fill("")];function L(B){let D="",A=B;for(;A>=0;)D=String.fromCharCode(A%26+65)+D,A=Math.floor(A/26)-1;return D}const I=Array.from({length:300},(B,D)=>({title:L(D),width:D===0?150:100}));z=jspreadsheet(c.value,{data:C,style:g,columns:I,minDimensions:[300,150],merge:[{row:0,col:0,rowspan:1,colspan:14},{row:1,col:0,rowspan:1,colspan:14}],onchange:(B,D,A,S,J)=>{j(A)}}),z.setValue("A1",o(s.value)),z.setValue("C2","OTK"),z.setValue("D2",""),z.setValue("E2","laboratoriyasi"),z.setValue("G2","tahlili")});function m(C){if(!C)return"";const L=C.split(":");return L[0]+":"+L[1]}function j(C){let L="",I=C;for(;I>=0;)L=String.fromCharCode(I%26+65)+L,I=Math.floor(I/26)-1;return L}function h(C,L,I,B,D,A="#d10000"){const S=L+B-1,J=I+D-1;let q={};for(let ie=L;ie<=S;ie++)q[`${j(I)}${ie+1}`]=`border-left: 2px solid ${A};`,q[`${j(J)}${ie+1}`]=`border-right: 2px solid ${A};`;for(let ie=I;ie<=J;ie++){const pe=j(ie);q[`${pe}${L+1}`]=`border-top: 2px solid ${A};`,q[`${pe}${S+1}`]=`border-bottom: 2px solid ${A};`}C.setStyle(q)}return watch(s,C=>{R.value&&u(R.value,C)}),watch(d,()=>{console.log("Qabul qilingan rowData:",d.value);let C=k();console.log("Aniqlangan groupName:",C),z&&C&&z.setValue("A3",C)}),watch(d,()=>{const C=Object.keys(d.value||{});if(!z||!C.length)return;let L=2,I=0,B=0;C.forEach(D=>{const A=d.value[D],S=Object.keys(A);let J=0;S.forEach(q=>{var Ue,Re;const ie=A[q],pe=Object.keys(ie),se=new Set;pe.forEach(Je=>{(ie[Je]||[]).forEach(Le=>se.add(Le.parameter_name))});const be=Array.from(se),Me=Array.from(new Set(pe.map(Je=>{var Le;return((Le=(ie[Je]||[])[0])==null?void 0:Le.time_name)||""}))).sort(),me=be.length+1,ae=Me.length+3;J=Math.max(J,ae),z.setValueFromCoords(I,L,((Re=(Ue=ie[pe[0]])==null?void 0:Ue[0])==null?void 0:Re.group_name)||""),z.setValueFromCoords(I,L+1,`${q}-Smena`);const Pe={};for(let Je=0;Je<me;Je++){const Y=`${j(I+Je)}${L+1}`;Pe[Y]="background: #c7efc4; font-weight: bold;";const Le=`${j(I+Je)}${L+2}`;Pe[Le]="background: #cfe2f3; font-weight: bold;";const _e=`${j(I+Je)}${L+3}`;Pe[_e]="background: #c9b2d6; font-weight: bold;"}setTimeout(()=>z.setStyle(Pe),10),z.setValueFromCoords(I,L+2,"Vaqt"),be.forEach((Je,Y)=>{z.setValueFromCoords(I+1+Y,L+2,Je)});const Ye=new Map;be.forEach((Je,Y)=>Ye.set(Je,Y)),Me.forEach((Je,Y)=>{const Le=L+3+Y;z.setValueFromCoords(I,Le,m(Je));const _e=z.getCellFromCoords(I,Le);_e&&(_e.style.backgroundColor="#bbfcc1",_e.style.fontWeight="bold");const pt=[];pe.forEach(Qe=>{var Te;const Ae=ie[Qe]||[];((Te=Ae[0])==null?void 0:Te.time_name)===Je&&pt.push(...Ae)}),pt.forEach(Qe=>{const Ae=Qe.parameter_name,Te=Ye.get(Ae);if(Te===void 0)return;const He=I+1+Te,Ve=Number(Qe.Value);z.setValueFromCoords(He,Le,isNaN(Ve)?Qe.Value:Ve);const Ge=Number(Qe.Min),et=z.getCellFromCoords(He,Le);et&&!isNaN(Ve)&&!isNaN(Ge)&&Ve<Ge&&(et.style.backgroundColor="yellow",et.style.color="red",et.style.fontWeight="bold"),Qe.WithFormula==="1"&&et&&(et.style.border="1px dashed #444")})}),setTimeout(()=>h(z,L,I,ae,me,"#d10000"),10),B+=1,B%2===0?(L+=J+2,I=0):I+=me+2}),B%2!==0&&(L+=J+2,I=0,B=0)})}),(C,L)=>{const I=resolveComponent("VaDateInput"),B=resolveComponent("VaTab"),D=resolveComponent("VaTabs");return openBlock(),createElementBlock("div",_hoisted_1,[L[2]||(L[2]=createBaseVNode("main",null,null,-1)),createBaseVNode("main",_hoisted_2,[createVNode(I,{modelValue:s.value,"onUpdate:modelValue":L[0]||(L[0]=A=>s.value=A),class:"mb-10",onchange:"fetchData(value)"},null,8,["modelValue"]),createVNode(D,{modelValue:R.value,"onUpdate:modelValue":L[1]||(L[1]=A=>R.value=A),class:"mb-6"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(M.value,A=>(openBlock(),createBlock(B,{key:A.NumberPage,name:A.NumberPage,onClick:S=>f(A.NumberPage)},{default:withCtx(()=>[createTextVNode(toDisplayString(A.Name),1)]),_:2},1032,["name","onClick"]))),128))]),_:1},8,["modelValue"]),createBaseVNode("div",{ref_key:"sheetEl",ref:c,style:{width:"100vw",height:"100vh"}},null,512)])])}}};export{_sfc_main as default};
