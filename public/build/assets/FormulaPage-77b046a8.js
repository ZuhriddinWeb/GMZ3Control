import{c as R,r as u,d as B,H as v,x as g,o as I,f as r,g as E,h as M,i as m,k as n,l as h,j as s,m as x,t as T}from"./app-9e3064ce.js";/* empty css                   */import{_ as U,a as A}from"./EditSource-eea9df20.js";const $={class:"grid grid-rows-[55px,1fr]"},j={class:"flex justify-between"},q=m("span",{class:"flex w-full"},null,-1),z={class:"va-h3"},G={class:"flex-grow"},J={__name:"FormulaPage",setup(O){const{locale:c,t}=R(),i=u([]),f=u(null),d=u(!1),o=B({Name:"",ShortName:"",Comment:""});function V(e){f.value.applyTransaction({remove:[e]})}function w(e,l){e.setData(l)}v("ondeleted",V),v("onupdated",w);const N=g(()=>[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:t("table.name"),field:"Name",flex:1},{headerName:t("table.shortName"),field:"ShortName"},{headerName:t("table.comment"),field:"Comment",flex:1},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:U},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:A}]),b={sortable:!0,filter:!0},p=async()=>{try{const e=await x.get("/formula");i.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},y=async()=>{try{const{data:e}=await x.post("/formula",o);e.status===200?(d.value=!1,o.Name="",o.ShortName="",o.Comment="",await p()):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return I(()=>{const e=localStorage.getItem("locale");e&&(c.value=e),p()}),g(()=>c.value==="uz"?"Русский":"O‘zbek"),(e,l)=>{const C=r("VaButton"),_=r("VaInput"),D=r("VaTextarea"),S=r("VaForm"),k=r("VaModal"),F=r("ag-grid-vue");return E(),M("div",$,[m("main",null,[m("div",j,[q,n(C,{onClick:l[0]||(l[0]=a=>d.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),n(k,{modelValue:d.value,"onUpdate:modelValue":l[4]||(l[4]=a=>d.value=a),"ok-text":s(t)("buttons.save"),"cancel-text":s(t)("buttons.cancel"),onOk:y,"close-button":""},{default:h(()=>[m("h3",z,T(s(t)("modals.addSourceTitle")),1),m("div",null,[n(S,{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:h(()=>[n(_,{class:"w-full",modelValue:o.Name,"onUpdate:modelValue":l[1]||(l[1]=a=>o.Name=a),rules:[a=>a&&a.length>0||s(t)("form.requiredField")],label:s(t)("form.name")},null,8,["modelValue","rules","label"]),n(_,{class:"w-full",modelValue:o.ShortName,"onUpdate:modelValue":l[2]||(l[2]=a=>o.ShortName=a),rules:[a=>a&&a.length>0||s(t)("form.requiredField")],label:s(t)("form.shortName")},null,8,["modelValue","rules","label"]),n(D,{class:"w-full",modelValue:o.Comment,"onUpdate:modelValue":l[3]||(l[3]=a=>o.Comment=a),"max-length":"125",label:s(t)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),m("main",G,[n(F,{rowData:i.value,columnDefs:N.value,defaultColDef:b,animateRows:"true",class:"ag-theme-material h-full",onGridReady:l[5]||(l[5]=a=>f.value=a.api)},null,8,["rowData","columnDefs"])])])}}};export{J as default};
