import{c as E,r as i,d as I,s as h,o as R,f as r,g as B,h as F,i as d,j as s,l as v,t as M,k as n,n as V,H as _}from"./app-c0G7Ml5G.js";/* empty css                   */import{_ as U,a as A}from"./EditUnitsModal-BwFrh1-r.js";const $={class:"grid grid-rows-[55px,1fr]"},j={class:"flex justify-between"},q={class:"va-h3"},z={class:"flex-grow"},P={__name:"ChangesPage",setup(G){const{locale:u,t:a}=E(),c=i([]),f=i(null),m=i(!1),o=I({Name:"",ShortName:"",Comment:""});function b(e){f.value.applyTransaction({remove:[e]})}function w(e,t){e.setData(t)}_("ondeleted",b),_("onupdated",w);const x=h(()=>[{headerName:a("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:a("table.name"),field:"FactoryID",flex:1},{headerName:a("table.change"),field:"Change"},{headerName:a("table.startingDay"),field:"StartingDay"},{headerName:a("table.startingTime"),field:"StartingTime"},{headerName:a("table.endingDay"),field:"EndingDay"},{headerName:a("table.endingTime"),field:"EndingTime"},{headerName:a("table.comment"),field:"Comment"},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:U},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:A}]),N={sortable:!0,filter:!0},p=async()=>{try{const e=await V.get("/changes");c.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},D=async()=>{try{const{data:e}=await V.post("/units",o);e.status===200?(m.value=!1,o.Name="",o.ShortName="",o.Comment="",await p()):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return R(()=>{const e=localStorage.getItem("locale");e&&(u.value=e),p()}),h(()=>u.value==="uz"?"Русский":"O‘zbek"),(e,t)=>{const y=r("VaButton"),g=r("VaInput"),C=r("VaTextarea"),S=r("VaForm"),k=r("VaModal"),T=r("ag-grid-vue");return F(),B("div",$,[d("main",null,[d("div",j,[t[6]||(t[6]=d("span",{class:"flex w-full"},null,-1)),s(y,{onClick:t[0]||(t[0]=l=>m.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),s(k,{modelValue:m.value,"onUpdate:modelValue":t[4]||(t[4]=l=>m.value=l),"ok-text":n(a)("buttons.save"),"cancel-text":n(a)("buttons.cancel"),onOk:D,"close-button":""},{default:v(()=>[d("h3",q,M(n(a)("modals.addChangeTitle")),1),d("div",null,[s(S,{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:v(()=>[s(g,{class:"w-full",modelValue:o.Name,"onUpdate:modelValue":t[1]||(t[1]=l=>o.Name=l),rules:[l=>l&&l.length>0||n(a)("form.requiredField")],label:n(a)("form.name")},null,8,["modelValue","rules","label"]),s(g,{class:"w-full",modelValue:o.ShortName,"onUpdate:modelValue":t[2]||(t[2]=l=>o.ShortName=l),rules:[l=>l&&l.length>0||n(a)("form.requiredField")],label:n(a)("form.shortName")},null,8,["modelValue","rules","label"]),s(C,{class:"w-full",modelValue:o.Comment,"onUpdate:modelValue":t[3]||(t[3]=l=>o.Comment=l),"max-length":"125",label:n(a)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),d("main",z,[s(T,{rowData:c.value,columnDefs:x.value,defaultColDef:N,animateRows:"true",class:"ag-theme-material h-full",onGridReady:t[5]||(t[5]=l=>f.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{P as default};
