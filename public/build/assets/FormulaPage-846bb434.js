import{c as R,r as u,d as B,H as v,s as g,o as I,f as r,g as E,h as M,i as m,k as n,l as V,j as s,m as x,t as T}from"./app-23ff0182.js";/* empty css                   */import{_ as U,a as A}from"./EditSource-8a70d9e8.js";const $={class:"grid grid-rows-[55px,1fr]"},j={class:"flex justify-between"},q={class:"va-h3"},z={class:"flex-grow"},L={__name:"FormulaPage",setup(G){const{locale:c,t}=R(),i=u([]),f=u(null),d=u(!1),o=B({Name:"",ShortName:"",Comment:""});function h(e){f.value.applyTransaction({remove:[e]})}function w(e,a){e.setData(a)}v("ondeleted",h),v("onupdated",w);const N=g(()=>[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:t("table.name"),field:"Name",flex:1},{headerName:t("table.shortName"),field:"ShortName"},{headerName:t("table.comment"),field:"Comment",flex:1},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:U},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:A}]),b={sortable:!0,filter:!0},p=async()=>{try{const e=await x.get("/formula");i.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},y=async()=>{try{const{data:e}=await x.post("/formula",o);e.status===200?(d.value=!1,o.Name="",o.ShortName="",o.Comment="",await p()):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return I(()=>{const e=localStorage.getItem("locale");e&&(c.value=e),p()}),g(()=>c.value==="uz"?"Русский":"O‘zbek"),(e,a)=>{const C=r("VaButton"),_=r("VaInput"),D=r("VaTextarea"),S=r("VaForm"),k=r("VaModal"),F=r("ag-grid-vue");return E(),M("div",$,[m("main",null,[m("div",j,[a[6]||(a[6]=m("span",{class:"flex w-full"},null,-1)),n(C,{onClick:a[0]||(a[0]=l=>d.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),n(k,{modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=l=>d.value=l),"ok-text":s(t)("buttons.save"),"cancel-text":s(t)("buttons.cancel"),onOk:y,"close-button":""},{default:V(()=>[m("h3",q,T(s(t)("modals.addSourceTitle")),1),m("div",null,[n(S,{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:V(()=>[n(_,{class:"w-full",modelValue:o.Name,"onUpdate:modelValue":a[1]||(a[1]=l=>o.Name=l),rules:[l=>l&&l.length>0||s(t)("form.requiredField")],label:s(t)("form.name")},null,8,["modelValue","rules","label"]),n(_,{class:"w-full",modelValue:o.ShortName,"onUpdate:modelValue":a[2]||(a[2]=l=>o.ShortName=l),rules:[l=>l&&l.length>0||s(t)("form.requiredField")],label:s(t)("form.shortName")},null,8,["modelValue","rules","label"]),n(D,{class:"w-full",modelValue:o.Comment,"onUpdate:modelValue":a[3]||(a[3]=l=>o.Comment=l),"max-length":"125",label:s(t)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),m("main",z,[n(F,{rowData:i.value,columnDefs:N.value,defaultColDef:b,animateRows:"true",class:"ag-theme-material h-full",onGridReady:a[5]||(a[5]=l=>f.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{L as default};
