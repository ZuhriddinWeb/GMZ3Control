import{u as U,ab as $,s as y,c as z,r as f,K as A,o as G,a9 as j,f as q,g as i,h as o,i as d,G as V,F as b,j as p,l as w,k as _,m as L,I as k,J as S,ac as M,x as E,t as H,S as J,n as K,ad as Q,ae as W}from"./app-I7GpoV4R.js";/* empty css                   */import{V as X}from"./VueShiftCalendar-BXKA5F0w.js";const Y={class:"grid grid-rows-[55px,1fr]"},Z={class:"flex-grow"},ee={class:"m-2"},ae={key:0},se={__name:"OperatorResultPage",props:{id:Number},setup(I){const{init:te}=U(),R=$(),m=y(()=>R.query.type),{locale:v,t:u}=z(),T=I,n=f([]),C=f(null),c=f(null),t=f({smena:null,day:null}),x={sortable:!0,filter:!0},F=y(()=>[{headerName:u("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:u("table.structure"),field:P(),flex:1},{headerName:u("table.namePage"),field:B(),flex:1},{headerName:"Operator",field:"multiplied_manual_count"},{headerName:"Formula",field:"multiplied_formula_count"},{headerName:u("table.want"),field:"multiplied_parameter_count"},{headerName:u("table.be"),field:"kiritilgan"},{headerName:"%",field:"foiz",valueFormatter:l=>`${l.value}%`},{headerName:u("table.operator"),field:"kiritgan_operator"}]),D=y(()=>t.value.day?`${t.value.day} - ${t.value.smena}`:""),B=()=>(v.value==="uz","page_name"),P=()=>(v.value==="uz","factory_structure_name"),g=async()=>{try{const l={day:t.value.day,smena:t.value.smena},a=await K.get(`/getRowPageResult/${T.id}`,{params:l}),r=Array.isArray(a.data)?a.data:a.data.items;m.value==="inputed"||m.value==="not_inputed"?(n.value=r.map(e=>{const s=m.value==="inputed"?e.inputed_param_with_times:e.not_inputed_param_with_times;if(!s||s.length===0)return null;const O=s.map(N=>({factory_structure_name:e.factory_structure_name,page_name:e.page_name,param_name:N.param,graphic_time_name:N.time}));return{page_name:e.page_name,factory_structure_name:e.factory_structure_name,params:O}}).filter(e=>e!==null),c.value=n.value.length?n.value[0].page_name:null):n.value=r}catch(l){console.error("❌ Maʼlumot yuklashda xatolik:",l)}};A(()=>t.value,()=>{g()},{deep:!0});let h=null;return G(()=>{const l=localStorage.getItem("locale");l&&(v.value=l);const a=new Date,r=a.getHours();if(r>=8&&r<20)t.value.smena=1,t.value.day=a.toISOString().split("T")[0];else{t.value.smena=2;const e=new Date(a);r<8&&e.setDate(a.getDate()-1),t.value.day=e.toISOString().split("T")[0]}g(),h=setInterval(()=>g(),3e5)}),j(()=>{h&&clearInterval(h)}),(l,a)=>{const r=q("ag-grid-vue");return o(),i("div",Y,[a[4]||(a[4]=d("main",null,[d("div",{class:"flex justify-between"},[d("span",{class:"flex w-full"})])],-1)),d("main",Z,[d("div",ee,[p(_(X),{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value=e),"with-slot":!0},{default:w(()=>[p(_(L),{modelValue:D.value,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value=e),label:"Smena",readonly:""},null,8,["modelValue"])]),_:1},8,["modelValue"])]),m.value?(o(),i("div",ae,[p(_(J),{modelValue:c.value,"onUpdate:modelValue":a[2]||(a[2]=e=>c.value=e),grow:""},{tabs:w(()=>[(o(!0),i(k,null,S(n.value,(e,s)=>(o(),b(_(M),{key:s,name:e.page_name},{default:w(()=>[E(H(e.page_name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),(o(!0),i(k,null,S(n.value,(e,s)=>Q((o(),i("div",{key:s,class:"mb-6"},[p(r,{class:"ag-theme-material w-full",rowData:e.params||[],columnDefs:[{headerName:"Sex",field:"factory_structure_name",flex:1},{headerName:"Sahifa",field:"page_name",flex:1},{headerName:"Parametr",field:"param_name",flex:1},{headerName:"Vaqti",field:"graphic_time_name",flex:1}],defaultColDef:x,animateRows:"",style:{height:"1000px"}},null,8,["rowData"])])),[[W,c.value===e.page_name]])),128))])):V("",!0),m.value?V("",!0):(o(),b(r,{key:1,rowData:n.value,columnDefs:F.value,defaultColDef:x,animateRows:"true",class:"ag-theme-material h-full",onGridReady:a[3]||(a[3]=e=>C.value=e.api)},null,8,["rowData","columnDefs"]))])])}}};export{se as default};
