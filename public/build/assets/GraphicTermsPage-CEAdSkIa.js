import{c as j,a as P,u as z,r as n,s as i,d as L,o as q,f as v,g as J,h as V,i as r,j as m,F as K,G as Q,k as d,z as W,l as X,t as Y,m as Z,n as u,H as _}from"./app-CXTPu4f3.js";/* empty css                   */import{_ as ee,a as ae}from"./DeleteGraphicTimesModal-6f0g7Osf.js";import{f as h}from"./format-D9pTN3Kd.js";const te={class:"grid grid-rows-[55px,1fr]"},oe={class:"flex justify-between"},se={class:"va-h3"},le={class:"grid grid-cols-1 md:grid-cols-1 gap-1 items-end w-full"},ne={class:"flex-grow"},me={__name:"GraphicTermsPage",props:{id:Number},setup(b){const{locale:y,t}=j(),D=P(),{init:T}=z(),g=b,w=n([]),x=n(null),c=n(!1),S=n([]),k=n([]),p=n("Oy"),N=i(()=>D.state.user.roles[8]),f=e=>{var a,o;return((o=(a=N.value)==null?void 0:a.pivot)==null?void 0:o[e])==="1"},G=i(()=>f("create")),E=i(()=>f("update")),F=i(()=>f("delete"));console.log(N);const s=L({GraphicId:g.id,Name:"",Component:p.value});function H(e){x.value.applyTransaction({remove:[e]})}function I(e,a){e.setData(a)}_("ondeleted",H),_("onupdated",I);function $(e){s.Component=e}const O=i(()=>{const e=[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:"ID",field:"id",width:80},{headerName:t("table.change"),field:"Change",width:120},{headerName:t("table.graphicName"),field:"GName",flex:1},{headerName:t("table.name"),field:"Name",flex:1,valueFormatter:a=>h(new Date(`1970-01-01T${a.value}`),"HH:mm")},{headerName:t("table.startTime"),field:"StartTime",valueFormatter:a=>h(new Date(`1970-01-01T${a.value}`),"HH:mm")},{headerName:t("table.endTime"),field:"EndTime",valueFormatter:a=>h(new Date(`1970-01-01T${a.value}`),"HH:mm")},{headerName:t("table.comment"),field:"Comment",flex:1}];return E.value&&e.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:ee}),F.value&&e.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:ae}),e}),R={sortable:!0,filter:!0},C=async()=>{try{const e=await u.get(`/getTimes/${g.id}`);w.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},B=async()=>{try{const e=await u.get("/graphics"),a=await u.get("/changes");S.value=e.data.map(o=>({value:o.id,text:o.Name})),k.value=a.data.map(o=>({value:o.Change,text:o.Change}))}catch(e){console.error("Error fetching graphics data:",e)}},M=async()=>{try{const{data:e}=await u.post("/graphictimes",s);e.status===200?(c.value=!1,s.ChangeId="",s.Name="",s.StartTime="",s.EndTime="",await C(),T({message:t("login.successMessage"),color:"success"})):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return q(()=>{const e=localStorage.getItem("locale");e&&(y.value=e),C(),B()}),(e,a)=>{const o=v("VaSelect"),U=v("VaModal"),A=v("ag-grid-vue");return V(),J("div",te,[r("main",null,[r("div",oe,[a[5]||(a[5]=r("span",{class:"flex w-full"},null,-1)),G.value?(V(),K(d(W),{key:0,onClick:a[0]||(a[0]=l=>c.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):Q("",!0)]),m(U,{modelValue:c.value,"onUpdate:modelValue":a[3]||(a[3]=l=>c.value=l),"ok-text":d(t)("buttons.save"),"cancel-text":d(t)("buttons.cancel"),onOk:M,"close-button":""},{default:X(()=>[r("h3",se,Y(d(t)("modals.addGraphicTimesTitle")),1),r("div",le,[m(d(Z),{modelValue:s.Name,"onUpdate:modelValue":a[1]||(a[1]=l=>s.Name=l),label:d(t)("form.name")},null,8,["modelValue","label"]),m(o,{modelValue:p.value,"onUpdate:modelValue":[a[2]||(a[2]=l=>p.value=l),$],options:[{text:"Oy",value:"Oy"},{text:"Soat",value:"Soat"}],label:"Formni tanlang"},null,8,["modelValue"])])]),_:1},8,["modelValue","ok-text","cancel-text"])]),r("main",ne,[m(A,{rowData:w.value,columnDefs:O.value,defaultColDef:R,animateRows:"true",class:"ag-theme-material h-full",onGridReady:a[4]||(a[4]=l=>x.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{me as default};
