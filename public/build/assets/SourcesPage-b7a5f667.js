import{r as _,G as D,f as d,g as N,h as y,k as s,l as v,i,m as h,d as $,c as T,H as S,x as k,o as R,j as p,t as F}from"./app-4b8e09cd.js";/* empty css                   */const j={class:"h-full w-full text-center content-center"},q=i("h3",{class:"va-h3"},"Ma'lumotni o'chirish",-1),O=i("p",null," Classic modal overlay which represents a dialog box or other interactive component, such as a dismissible alert, sub-window, etc. ",-1),A={__name:"DeleteSource",props:["params"],setup(g){const m=_(!1),t=g,f=D("ondeleted"),n=async()=>{console.log(t.params.data.id);try{const{data:u}=await h.delete(`/source/${t.params.data.id}`);u.status===200?(f(t.params.data),m.value=!1):console.error("Error deleting data:",u.message)}catch(u){console.error("Error deleting data:",u)}};return(u,a)=>{const o=d("VaButton"),V=d("VaModal");return N(),y("main",j,[s(o,{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:a[0]||(a[0]=c=>m.value=!0)}),s(V,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=c=>m.value=c),"ok-text":"Apply",onClose:a[2]||(a[2]=c=>m.value=!1),onOk:n,"close-button":""},{default:v(()=>[q,O]),_:1},8,["modelValue"])])}}},z={class:"h-full w-full text-center content-center"},G=i("h3",{class:"va-h3"}," O'lchov birliklarini tahrirlash ",-1),P={__name:"EditSource",props:["params"],setup(g){const m=g,t=_(!1),f=D("onupdated"),n=$({Name:"",ShortName:"",Comment:"",id:m.params.data.id});h.get(`source/${m.params.data.id}`).then(a=>{n.Name=a.data.Name,n.ShortName=a.data.ShortName,n.Comment=a.data.Comment});const u=async()=>{try{const{data:a}=await h.put("/source",n);a.status===200?(f(m.params.node,a.unit),t.value=!1):console.error("Error saving data:",a.message)}catch(a){console.error("Error saving data:",a)}};return(a,o)=>{const V=d("VaButton"),c=d("VaInput"),b=d("VaTextarea"),x=d("VaForm"),w=d("VaModal");return N(),y("main",z,[s(V,{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:o[0]||(o[0]=e=>t.value=!0)}),s(w,{modelValue:t.value,"onUpdate:modelValue":o[4]||(o[4]=e=>t.value=e),"ok-text":"Saqlash","cancel-text":"Bekor qilish",onOk:u,onClose:o[5]||(o[5]=e=>t.value=!1),"close-button":""},{default:v(()=>[G,i("div",null,[s(x,{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:v(()=>[s(c,{class:"w-full",modelValue:n.Name,"onUpdate:modelValue":o[1]||(o[1]=e=>n.Name=e),rules:[e=>e&&e.length>0||"To'ldirish majburiy bo'lgan maydon"],label:"Nomlanishi"},null,8,["modelValue","rules"]),s(c,{class:"w-full",modelValue:n.ShortName,"onUpdate:modelValue":o[2]||(o[2]=e=>n.ShortName=e),rules:[e=>e&&e.length>0||"To'ldirish majburiy bo'lgan maydon"],label:"Qisqa nomi"},null,8,["modelValue","rules"]),s(b,{class:"w-full",modelValue:n.Comment,"onUpdate:modelValue":o[3]||(o[3]=e=>n.Comment=e),"max-length":"125",label:"Izoh"},null,8,["modelValue"])]),_:1},512)])]),_:1},8,["modelValue"])])}}};const H={class:"grid grid-rows-[55px,1fr]"},L={class:"flex justify-between"},Q=i("span",{class:"flex w-full"},null,-1),J={class:"va-h3"},K={class:"flex-grow"},Y={__name:"SourcesPage",setup(g){const{locale:m,t}=T(),f=_([]),n=_(null),u=_(!1),a=$({Name:"",ShortName:"",Comment:""});function o(e){n.value.applyTransaction({remove:[e]})}function V(e,r){e.setData(r)}S("ondeleted",o),S("onupdated",V);const c=k(()=>[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:t("table.name"),field:"Name",flex:1},{headerName:t("table.shortName"),field:"ShortName"},{headerName:t("table.comment"),field:"Comment",flex:1},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:P},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:A}]),b={sortable:!0,filter:!0},x=async()=>{try{const e=await h.get("/source");f.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},w=async()=>{try{const{data:e}=await h.post("/source",a);e.status===200?(u.value=!1,a.Name="",a.ShortName="",a.Comment="",await x()):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return R(()=>{const e=localStorage.getItem("locale");e&&(m.value=e),x()}),k(()=>m.value==="uz"?"Русский":"O‘zbek"),(e,r)=>{const B=d("VaButton"),C=d("VaInput"),E=d("VaTextarea"),M=d("VaForm"),U=d("VaModal"),I=d("ag-grid-vue");return N(),y("div",H,[i("main",null,[i("div",L,[Q,s(B,{onClick:r[0]||(r[0]=l=>u.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),s(U,{modelValue:u.value,"onUpdate:modelValue":r[4]||(r[4]=l=>u.value=l),"ok-text":p(t)("buttons.save"),"cancel-text":p(t)("buttons.cancel"),onOk:w,"close-button":""},{default:v(()=>[i("h3",J,F(p(t)("modals.addSourceTitle")),1),i("div",null,[s(M,{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:v(()=>[s(C,{class:"w-full",modelValue:a.Name,"onUpdate:modelValue":r[1]||(r[1]=l=>a.Name=l),rules:[l=>l&&l.length>0||p(t)("form.requiredField")],label:p(t)("form.name")},null,8,["modelValue","rules","label"]),s(C,{class:"w-full",modelValue:a.ShortName,"onUpdate:modelValue":r[2]||(r[2]=l=>a.ShortName=l),rules:[l=>l&&l.length>0||p(t)("form.requiredField")],label:p(t)("form.shortName")},null,8,["modelValue","rules","label"]),s(E,{class:"w-full",modelValue:a.Comment,"onUpdate:modelValue":r[3]||(r[3]=l=>a.Comment=l),"max-length":"125",label:p(t)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),i("main",K,[s(I,{rowData:f.value,columnDefs:c.value,defaultColDef:b,animateRows:"true",class:"ag-theme-material h-full",onGridReady:r[5]||(r[5]=l=>n.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{Y as default};
