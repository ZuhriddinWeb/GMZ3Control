import{u as U,r as N,c as _,E as q,f as x,g as E,h as C,j as u,k as e,z as M,l as h,i as p,t as w,n as R,d as T,V as B,m as v,a as J,s as b,o as K,F as Q,G as W,H as F}from"./app-NUfPaPq9.js";/* empty css                   */const X={class:"h-full w-full text-center content-center"},Y={class:"va-h3"},Z={__name:"DeleteStructure",props:["params"],setup(S){const{init:g}=U(),c=N(!1),r=S,{t:V}=_(),n=q("ondeleted"),d=async()=>{try{const{data:i}=await R.delete(`/structure/${r.params.data.id}`);i.status===200?(n(r.params.data),c.value=!1,g({message:V("login.successMessage"),color:"success"})):console.error("Error deleting data:",i.message)}catch(i){console.error("Error deleting data:",i)}};return(i,f)=>{const m=x("VaModal");return C(),E("main",X,[u(e(M),{round:"",icon:"delete",color:"red",preset:"primary",class:"mt-1",onClick:f[0]||(f[0]=s=>c.value=!0)}),u(m,{modelValue:c.value,"onUpdate:modelValue":f[1]||(f[1]=s=>c.value=s),"ok-text":e(V)("modals.apply"),"cancel-text":e(V)("modals.cancel"),onClose:f[2]||(f[2]=s=>c.value=!1),onOk:d,"close-button":""},{default:h(()=>[p("h3",Y,w(e(V)("modals.title")),1),p("p",null,w(e(V)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ee={class:"h-full w-full text-center content-center"},ae={__name:"EditStructure",props:["params"],setup(S){const g=S,c=N(!1),r=q("onupdated"),{init:V}=U(),{t:n}=_(),d=T({Name:"",NameRus:"",ShortNameRus:"",ShortName:"",Comment:"",id:g.params.data.id}),i=async()=>{R.get(`structure/${g.params.data.id}`).then(m=>{Object.assign(d,m.data)}).catch(m=>{console.error("Error fetching data:",m)})},f=async()=>{try{const{data:m}=await R.put("/structure",d);m.status===200?(r(g.params.node,m.unit),c.value=!1,V({message:n("login.successMessage"),color:"success"})):console.error("Error saving data:",m.message)}catch(m){console.error("Error saving data:",m)}};return(m,s)=>{const k=x("VaTextarea"),D=x("VaModal");return C(),E("main",ee,[u(e(M),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:s[0]||(s[0]=a=>c.value=!0)}),u(D,{modelValue:c.value,"onUpdate:modelValue":s[6]||(s[6]=a=>c.value=a),"ok-text":e(n)("modals.apply"),"cancel-text":e(n)("modals.cancel"),onOk:f,onClose:s[7]||(s[7]=a=>c.value=!1),"close-button":""},{default:h(()=>[p("h3",{class:"va-h3",onVnodeMounted:i},w(e(n)("modals.editFactory")),513),p("div",null,[u(e(B),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:h(()=>[u(e(v),{class:"w-full",modelValue:d.Name,"onUpdate:modelValue":s[1]||(s[1]=a=>d.Name=a),rules:[a=>!!a||e(n)("validation.required")],label:e(n)("form.name")},null,8,["modelValue","rules","label"]),u(e(v),{class:"w-full",modelValue:d.NameRus,"onUpdate:modelValue":s[2]||(s[2]=a=>d.NameRus=a),rules:[a=>!!a||e(n)("validation.required")],label:e(n)("form.nameRus")},null,8,["modelValue","rules","label"]),u(e(v),{class:"w-full",modelValue:d.ShortName,"onUpdate:modelValue":s[3]||(s[3]=a=>d.ShortName=a),rules:[a=>!!a||e(n)("validation.required")],label:e(n)("form.shortName")},null,8,["modelValue","rules","label"]),u(e(v),{class:"w-full",modelValue:d.ShortNameRus,"onUpdate:modelValue":s[4]||(s[4]=a=>d.ShortNameRus=a),rules:[a=>!!a||e(n)("validation.required")],label:e(n)("form.shortNameRus")},null,8,["modelValue","rules","label"]),u(k,{class:"w-full",modelValue:d.Comment,"onUpdate:modelValue":s[5]||(s[5]=a=>d.Comment=a),"max-length":125,label:e(n)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},le={class:"grid grid-rows-[55px,1fr]"},te={class:"flex justify-between"},oe={class:"va-h3"},se={class:"flex-grow"},ue={__name:"FactoriesStructurePage",setup(S){const{init:g}=U(),{locale:c,t:r}=_(),V=J(),n=N([]),d=N(null),i=N(!1);N([]);const f=b(()=>V.state.user.roles[4]),m=t=>{var o,y;return((y=(o=f.value)==null?void 0:o.pivot)==null?void 0:y[t])==="1"},s=b(()=>m("create")),k=b(()=>m("update")),D=b(()=>m("delete")),a=T({Name:"",NameRus:"",ShortNameRus:"",ShortName:"",Comment:""});function j(t){d.value.applyTransaction({remove:[t]})}function I(t,o){t.setData(o)}F("ondeleted",j),F("onupdated",I);const O=b(()=>{const t=[{headerName:r("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:r("table.name"),field:A(),flex:1},{headerName:r("table.shortName"),field:G()}];return k.value&&t.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:ae}),D.value&&t.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:Z}),t}),z={sortable:!0,filter:!0},A=()=>c.value==="uz"?"Name":"NameRus",G=()=>c.value==="uz"?"ShortName":"ShortNameRus",$=async()=>{try{const t=await R.get("/structure");n.value=Array.isArray(t.data)?t.data:t.data.items}catch(t){console.error("Error fetching data:",t)}},P=async()=>{try{const{data:t}=await R.post("/structure",a);t.status===200?(i.value=!1,a.Name="",a.NameRus="",a.ShortName="",a.ShortNameRus="",a.Comment="",await $(),g({message:r("login.successMessage"),color:"success"})):console.error("Error saving data:",t.message)}catch(t){console.error("Error saving data:",t)}};return K(()=>{const t=localStorage.getItem("locale");t&&(c.value=t),$()}),(t,o)=>{const y=x("VaTextarea"),H=x("VaModal"),L=x("ag-grid-vue");return C(),E("div",le,[p("main",null,[p("div",te,[o[8]||(o[8]=p("span",{class:"flex w-full"},null,-1)),s.value?(C(),Q(e(M),{key:0,onClick:o[0]||(o[0]=l=>i.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):W("",!0)]),u(H,{modelValue:i.value,"onUpdate:modelValue":o[6]||(o[6]=l=>i.value=l),"ok-text":e(r)("buttons.save"),"cancel-text":e(r)("buttons.cancel"),onOk:P,"close-button":""},{default:h(()=>[p("h3",oe,w(e(r)("modals.addStructureTitle"))+w(),1),p("div",null,[u(e(B),{ref:"formRef",class:"flex flex-col items-baseline gap-1"},{default:h(()=>[u(e(v),{class:"w-full",modelValue:a.Name,"onUpdate:modelValue":o[1]||(o[1]=l=>a.Name=l),rules:[l=>l&&l.length>0||e(r)("validation.requiredField")],label:e(r)("form.name")},null,8,["modelValue","rules","label"]),u(e(v),{class:"w-full",modelValue:a.NameRus,"onUpdate:modelValue":o[2]||(o[2]=l=>a.NameRus=l),rules:[l=>l&&l.length>0||e(r)("validation.requiredField")],label:e(r)("form.nameRus")},null,8,["modelValue","rules","label"]),u(e(v),{class:"w-full",modelValue:a.ShortName,"onUpdate:modelValue":o[3]||(o[3]=l=>a.ShortName=l),rules:[l=>l&&l.length>0||e(r)("validation.requiredField")],label:e(r)("form.shortName")},null,8,["modelValue","rules","label"]),u(e(v),{class:"w-full",modelValue:a.ShortNameRus,"onUpdate:modelValue":o[4]||(o[4]=l=>a.ShortNameRus=l),rules:[l=>l&&l.length>0||e(r)("validation.requiredField")],label:e(r)("form.shortNameRus")},null,8,["modelValue","rules","label"]),u(y,{class:"w-full",modelValue:a.Comment,"onUpdate:modelValue":o[5]||(o[5]=l=>a.Comment=l),"max-length":"125",label:e(r)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),p("main",se,[u(L,{rowData:n.value,columnDefs:O.value,defaultColDef:z,animateRows:"true",class:"ag-theme-material h-full",onGridReady:o[7]||(o[7]=l=>d.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{ue as default};
