import{u as U,c as I,r as c,E as j,f as g,g as M,h as k,j as d,k as n,z as $,l as h,i as p,t as E,n as P,d as z,V as A,m as F,a as W,s as _,o as X,F as Y,G as Z,H as G}from"./app-CMWF8Qbk.js";/* empty css                   */const ee={class:"h-full w-full text-center content-center"},ae={class:"va-h3"},te={__name:"DeleteParam",props:["params"],setup(S){const{init:b}=U(),{t:i}=I(),t=c(!1),f=S,w=j("ondeleted"),D=async()=>{try{const{data:l}=await P.delete(`/static/${f.params.data.id}`);l.status===200?(w(f.params.data),t.value=!1,b({message:i("login.successMessage"),color:"success"})):console.error("Error deleting data:",l.message)}catch(l){console.error("Error deleting data:",l)}};return(l,V)=>{const s=g("VaModal");return k(),M("main",ee,[d(n($),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:V[0]||(V[0]=x=>t.value=!0)}),d(s,{modelValue:t.value,"onUpdate:modelValue":V[1]||(V[1]=x=>t.value=x),"ok-text":n(i)("modals.apply"),"cancel-text":n(i)("modals.cancel"),onClose:V[2]||(V[2]=x=>t.value=!1),onOk:D,"close-button":""},{default:h(()=>[p("h3",ae,E(n(i)("modals.title")),1),p("p",null,E(n(i)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},le={class:"h-full w-full text-center content-center"},oe={class:"flex gap-5 flex-wrap w-full mt-4"},se={__name:"EditParam",props:["params"],setup(S){const{init:b}=U(),{t:i}=I(),t=S,f=c(!1),w=j("onupdated"),D=c([]);c([]),c([]);const l=z({Value:"",PeriodTypeId:"",PeriodStartDate:"",PeriodEndDate:"",Comment:"",id:t.params.data.id}),V=async()=>{try{const[m,e]=await Promise.all([P.get("/periodType"),P.get(`static/${t.params.data.id}`)]);D.value=m.data.map(y=>({value:y.id,text:y.name})),l.Value=+e.data.value,l.PeriodTypeId=+e.data.period_type_id,l.PeriodStartDate=e.data.period_start_date?new Date(e.data.period_start_date):null,l.PeriodEndDate=e.data.period_end_date?new Date(e.data.period_end_date):null,l.Comment=e.data.Comment}catch(m){console.error("Error fetching data:",m)}},s=m=>{if(!m)return null;const e=new Date(m);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.toISOString().split("T")[0]},x=async()=>{try{const m={...l,PeriodStartDate:s(l.PeriodStartDate),PeriodEndDate:s(l.PeriodEndDate)},{data:e}=await P.put("/static",m);e.status===200?(w(t.params.node,e.unit),f.value=!1,b({message:i("login.successMessage"),color:"success"})):console.error("Error saving data:",e.message)}catch(m){console.error("Error saving data:",m)}};return(m,e)=>{const y=g("VaDatePicker"),T=g("VaSelect"),C=g("VaTextarea"),N=g("VaModal");return k(),M("main",le,[d(n($),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:e[0]||(e[0]=u=>f.value=!0)}),d(N,{modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=u=>f.value=u),"ok-text":n(i)("modals.apply"),"cancel-text":n(i)("modals.cancel"),onOk:x,onClose:e[7]||(e[7]=u=>f.value=!1),"close-button":""},{default:h(()=>[p("h3",{class:"va-h3",onVnodeMounted:V},E(n(i)("modals.editFactory")),513),p("div",null,[d(n(A),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:h(()=>[d(n(F),{class:"w-full",modelValue:l.Value,"onUpdate:modelValue":e[1]||(e[1]=u=>l.Value=u),rules:[u=>u&&u.length>0||n(i)("validation.required")],label:n(i)("table.value")},null,8,["modelValue","rules","label"]),p("div",oe,[d(y,{modelValue:l.PeriodStartDate,"onUpdate:modelValue":e[2]||(e[2]=u=>l.PeriodStartDate=u),stateful:"","highlight-weekend":""},null,8,["modelValue"]),d(y,{modelValue:l.PeriodEndDate,"onUpdate:modelValue":e[3]||(e[3]=u=>l.PeriodEndDate=u),stateful:"","highlight-weekend":""},null,8,["modelValue"])]),d(T,{modelValue:l.PeriodTypeId,"onUpdate:modelValue":e[4]||(e[4]=u=>l.PeriodTypeId=u),"value-by":"value",class:"mb-6 w-full",label:n(i)("menu.paramtypes"),options:D.value,clearable:""},null,8,["modelValue","label","options"]),d(C,{class:"w-full",modelValue:l.Description,"onUpdate:modelValue":e[5]||(e[5]=u=>l.Description=u),"max-length":"125",label:n(i)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ne={class:"grid grid-rows-[55px,1fr]"},re={class:"flex justify-between"},de={class:"va-h3"},ue={class:"flex gap-5 flex-wrap w-full mt-4"},ie={class:"flex-grow"},pe={__name:"StaticParametrs",setup(S){const b=W(),{init:i}=U(),{t}=I(),f=c([]),w=c(null),D=c(!1),l=c([]);c([]);const V=c([]);c([]);const s=z({ParameterID:"",Value:"",PeriodTypeId:"",PeriodStartDate:null,PeriodEndDate:null,Comment:""}),x=_(()=>b.state.user.roles[10]),m=o=>{var a,v;return((v=(a=x.value)==null?void 0:a.pivot)==null?void 0:v[o])==="1"},e=_(()=>m("create")),y=_(()=>m("update")),T=_(()=>m("delete"));function C(o){w.value.applyTransaction({remove:[o]})}function N(o,a){o.setData(a)}G("ondeleted",C),G("onupdated",N);const u=_(()=>{const o=[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:t("table.id"),field:"Uuid",hide:!0,flex:1},{headerName:t("table.name"),field:"PName",flex:1},{headerName:t("menu.paramtypes"),field:"PTName"},{headerName:t("menu.units"),field:"UName"},{headerName:t("table.value"),field:"value"},{headerName:t("table.startingDay"),field:"period_start_date"},{headerName:t("table.endingDay"),field:"period_end_date"},{headerName:t("table.comment"),field:"Comment",flex:1}];return y.value&&o.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:se}),T.value&&o.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:te}),o}),q={sortable:!0,filter:!0},R=async()=>{try{const o=await P.get("/static");f.value=Array.isArray(o.data)?o.data:o.data.items}catch(o){console.error("Error fetching data:",o)}},L=async()=>{try{const o=await P.get("/param"),a=await P.get("/periodType");V.value=o.data.map(v=>({value:v.Uuid,text:v.Name})),l.value=a.data.map(v=>({value:v.id,text:v.name}))}catch(o){console.error("Error fetching graphics data:",o)}},O=o=>{if(!o)return null;const a=new Date(o);return a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),a.toISOString().split("T")[0]},H=async()=>{try{const o={...s,PeriodStartDate:O(s.PeriodStartDate),PeriodEndDate:O(s.PeriodEndDate)},{data:a}=await P.post("/static",o);a.status===200?(D.value=!1,s.ParameterID="",s.Value="",s.Comment="",s.PeriodTypeId="",s.PeriodStartDate=null,s.PeriodEndDate=null,await R(),i({message:t("login.successMessage"),color:"success"})):console.error("Error saving data:",a.message)}catch(o){console.error("Error saving data:",o)}};return X(()=>{R(),L()}),(o,a)=>{const v=g("VaSelect"),B=g("VaDatePicker"),J=g("VaTextarea"),K=g("VaModal"),Q=g("ag-grid-vue");return k(),M("div",ne,[p("main",null,[p("div",re,[a[9]||(a[9]=p("span",{class:"flex w-full"},null,-1)),e.value?(k(),Y(n($),{key:0,onClick:a[0]||(a[0]=r=>D.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):Z("",!0)]),d(K,{modelValue:D.value,"onUpdate:modelValue":a[7]||(a[7]=r=>D.value=r),"ok-text":n(t)("modals.apply"),"cancel-text":n(t)("modals.cancel"),onOk:H,"close-button":""},{default:h(()=>[p("h3",de,E(n(t)("modals.addParamsTitle")),1),p("div",null,[d(n(A),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:h(()=>[d(v,{modelValue:s.ParameterID,"onUpdate:modelValue":a[1]||(a[1]=r=>s.ParameterID=r),"value-by":"value",class:"mb-1 w-full",label:n(t)("menu.params"),options:V.value,searchable:"",clearable:""},null,8,["modelValue","label","options"]),d(n(F),{class:"w-full",modelValue:s.Value,"onUpdate:modelValue":a[2]||(a[2]=r=>s.Value=r),rules:[r=>r&&r.length>0||n(t)("validation.required")],label:n(t)("table.value")},null,8,["modelValue","rules","label"]),p("div",ue,[d(B,{modelValue:s.PeriodStartDate,"onUpdate:modelValue":a[3]||(a[3]=r=>s.PeriodStartDate=r),stateful:"","highlight-weekend":"","text-input":!0},null,8,["modelValue"]),d(B,{modelValue:s.PeriodEndDate,"onUpdate:modelValue":a[4]||(a[4]=r=>s.PeriodEndDate=r),stateful:"","highlight-weekend":"","text-input":!0},null,8,["modelValue"])]),d(v,{modelValue:s.PeriodTypeId,"onUpdate:modelValue":a[5]||(a[5]=r=>s.PeriodTypeId=r),"value-by":"value",class:"mb-6 w-full",label:n(t)("menu.paramtypes"),options:l.value,clearable:""},null,8,["modelValue","label","options"]),d(J,{class:"w-full",modelValue:s.Comment,"onUpdate:modelValue":a[6]||(a[6]=r=>s.Comment=r),"max-length":"125",label:n(t)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),p("main",ie,[d(Q,{rowData:f.value,columnDefs:u.value,defaultColDef:q,animateRows:"true",class:"ag-theme-material h-full",onGridReady:a[8]||(a[8]=r=>w.value=r.api)},null,8,["rowData","columnDefs"])])])}}};export{pe as default};
