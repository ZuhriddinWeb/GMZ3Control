import{u as q,c as $,r as N,E as B,f as U,g as E,h as P,j as u,k as e,z as F,l as R,i as c,t as k,n as x,d as G,V as j,m as f,a as L,s as M,o as Q,F as X,G as Y,H as W}from"./app-BX7Mihpv.js";/* empty css                   */const Z={class:"h-full w-full text-center content-center"},ee={class:"va-h3"},le={__name:"DeleteParam",props:["params"],setup(I){const{init:D}=q(),{t:d}=$(),t=N(!1),b=I,S=B("ondeleted"),y=async()=>{try{const{data:g}=await x.delete(`/param/${b.params.data.Uuid}`);g.status===200?(S(b.params.data),t.value=!1,D({message:d("login.successMessage"),color:"success"})):console.error("Error deleting data:",g.message)}catch(g){console.error("Error deleting data:",g)}};return(g,V)=>{const s=U("VaModal");return P(),E("main",Z,[u(e(F),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:V[0]||(V[0]=o=>t.value=!0)}),u(s,{modelValue:t.value,"onUpdate:modelValue":V[1]||(V[1]=o=>t.value=o),"ok-text":e(d)("modals.apply"),"cancel-text":e(d)("modals.cancel"),onClose:V[2]||(V[2]=o=>t.value=!1),onOk:y,"close-button":""},{default:R(()=>[c("h3",ee,k(e(d)("modals.title")),1),c("p",null,k(e(d)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ae={class:"h-full w-full text-center content-center"},te={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},se={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},oe={__name:"EditParam",props:["params"],setup(I){const{init:D}=q(),{t:d}=$(),t=I,b=N(!1),S=B("onupdated"),y=N([]),g=N([]),V=N([]),s=G({Name:"",NameRus:"",ShortNameRus:"",ShortName:"",WinCC:"",ServerId:"",ParamsTypeID:"",UnitsID:"",Min:"",Max:"",Comment:"",id:t.params.data.Uuid}),o=async()=>{try{const[p,r,h,i]=await Promise.all([x.get("/paramtypes"),x.get("/units"),x.get("/servers"),x.get(`param/${t.params.data.Uuid}`)]);y.value=p.data.map(v=>({value:v.id,text:v.Name})),g.value=r.data.map(v=>({value:v.id,text:v.Name})),V.value=h.data.map(v=>({value:v.id,text:v.name})),s.Name=i.data.Name,s.NameRus=i.data.NameRus,s.ShortNameRus=i.data.ShortNameRus,s.ShortName=i.data.ShortName,s.WinCC=i.data.WinCC,s.ServerId=+i.data.Ipid,s.ParamsTypeID=+i.data.Pid,s.UnitsID=+i.data.Uid,s.Min=+i.data.Min,s.Max=+i.data.Max,s.Comment=i.data.Comment}catch(p){console.error("Error fetching data:",p)}},T=async()=>{try{const{data:p}=await x.put("/param",s);p.status===200?(S(t.params.node,p.unit),b.value=!1,D({message:d("login.successMessage"),color:"success"})):console.error("Error saving data:",p.message)}catch(p){console.error("Error saving data:",p)}};return(p,r)=>{const h=U("VaSelect"),i=U("VaTextarea"),v=U("VaModal");return P(),E("main",ae,[u(e(F),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:r[0]||(r[0]=l=>b.value=!0)}),u(v,{modelValue:b.value,"onUpdate:modelValue":r[12]||(r[12]=l=>b.value=l),"ok-text":e(d)("modals.apply"),"cancel-text":e(d)("modals.cancel"),onOk:T,onClose:r[13]||(r[13]=l=>b.value=!1),"close-button":""},{default:R(()=>[c("h3",{class:"va-h3",onVnodeMounted:o},k(e(d)("modals.editFactory")),513),c("div",null,[u(e(j),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:R(()=>[u(e(f),{class:"w-full",modelValue:s.Name,"onUpdate:modelValue":r[1]||(r[1]=l=>s.Name=l),rules:[l=>l&&l.length>0||e(d)("form.requiredField")],label:e(d)("form.name")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:s.NameRus,"onUpdate:modelValue":r[2]||(r[2]=l=>s.NameRus=l),rules:[l=>l&&l.length>0||e(d)("form.requiredField")],label:e(d)("form.nameRus")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:s.ShortName,"onUpdate:modelValue":r[3]||(r[3]=l=>s.ShortName=l),rules:[l=>l&&l.length>0||e(d)("form.requiredField")],label:e(d)("form.shortName")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:s.ShortNameRus,"onUpdate:modelValue":r[4]||(r[4]=l=>s.ShortNameRus=l),rules:[l=>l&&l.length>0||e(d)("form.requiredField")],label:e(d)("form.shortNameRus")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:s.WinCC,"onUpdate:modelValue":r[5]||(r[5]=l=>s.WinCC=l),rules:[l=>l&&l.length>0||e(d)("form.requiredField")],label:e(d)("form.wincc")},null,8,["modelValue","rules","label"]),u(h,{modelValue:s.ServerId,"onUpdate:modelValue":r[6]||(r[6]=l=>s.ServerId=l),"value-by":"value",class:"w-full",label:e(d)("menu.servers"),options:V.value,clearable:""},null,8,["modelValue","label","options"]),c("div",te,[u(e(f),{class:"w-full",modelValue:s.Min,"onUpdate:modelValue":r[7]||(r[7]=l=>s.Min=l),rules:[l=>l&&l.length>0||e(d)("form.requiredField")],label:e(d)("table.min")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:s.Max,"onUpdate:modelValue":r[8]||(r[8]=l=>s.Max=l),rules:[l=>l&&l.length>0||e(d)("form.requiredField")],label:e(d)("table.max")},null,8,["modelValue","rules","label"])]),c("div",se,[u(h,{modelValue:s.ParamsTypeID,"onUpdate:modelValue":r[9]||(r[9]=l=>s.ParamsTypeID=l),"value-by":"value",class:"mb-6",label:e(d)("menu.paramtypes"),options:y.value,clearable:""},null,8,["modelValue","label","options"]),u(h,{modelValue:s.UnitsID,"onUpdate:modelValue":r[10]||(r[10]=l=>s.UnitsID=l),"value-by":"value",class:"mb-6",label:e(d)("menu.units"),options:g.value,clearable:""},null,8,["modelValue","label","options"])]),u(i,{class:"w-full",modelValue:s.Comment,"onUpdate:modelValue":r[11]||(r[11]=l=>s.Comment=l),"max-length":"125",label:e(d)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ne={class:"grid grid-rows-[55px,1fr]"},re={class:"flex justify-between"},de={class:"va-h3"},ue={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},me={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},ie={class:"flex-grow"},fe={__name:"ParametersPage",setup(I){const D=L(),{init:d}=q(),{t}=$(),b=N([]),S=N(null),y=N(!1),g=N([]),V=N([]),s=N([]),o=G({Name:"",NameRus:"",ShortNameRus:"",ShortName:"",WinCC:"",ParamsTypeID:"",ServerId:"",UnitsID:"",Min:"",Max:"",Comment:""}),T=M(()=>D.state.user.roles[10]),p=m=>{var n,C;return((C=(n=T.value)==null?void 0:n.pivot)==null?void 0:C[m])==="1"},r=M(()=>p("create")),h=M(()=>p("update")),i=M(()=>p("delete"));function v(m){S.value.applyTransaction({remove:[m]})}function l(m,n){m.setData(n)}W("ondeleted",v),W("onupdated",l);const A=M(()=>{const m=[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:t("table.id"),field:"Uuid",hide:!0,flex:1},{headerName:t("table.name"),field:"Name",flex:1},{headerName:t("table.shortName"),field:"ShortName"},{headerName:t("menu.paramtypes"),hide:!0,field:"PName"},{headerName:t("menu.units"),field:"UName"},{headerName:t("table.min"),field:"Min"},{headerName:t("table.max"),field:"Max"},{headerName:t("table.comment"),field:"Comment",flex:1}];return h.value&&m.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:oe}),i.value&&m.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:le}),m}),z={sortable:!0,filter:!0},O=async()=>{try{const m=await x.get("/param");b.value=Array.isArray(m.data)?m.data:m.data.items}catch(m){console.error("Error fetching data:",m)}},H=async()=>{try{const m=await x.get("/paramtypes"),n=await x.get("/units"),C=await x.get("/servers");g.value=m.data.map(w=>({value:w.id,text:w.Name})),s.value=n.data.map(w=>({value:w.id,text:w.Name})),V.value=C.data.map(w=>({value:w.id,text:w.name}))}catch(m){console.error("Error fetching graphics data:",m)}},_=async()=>{try{const{data:m}=await x.post("/param",o);m.status===200?(y.value=!1,o.Name="",o.NameRus="",o.ShortNameRus="",o.ShortName="",o.ParamsTypeID="",o.UnitsID="",o.Min="",o.Max="",o.Comment="",await O(),d({message:t("login.successMessage"),color:"success"})):console.error("Error saving data:",m.message)}catch(m){console.error("Error saving data:",m)}};return Q(()=>{O(),H()}),(m,n)=>{const C=U("VaSelect"),w=U("VaTextarea"),J=U("VaModal"),K=U("ag-grid-vue");return P(),E("div",ne,[c("main",null,[c("div",re,[n[14]||(n[14]=c("span",{class:"flex w-full"},null,-1)),r.value?(P(),X(e(F),{key:0,onClick:n[0]||(n[0]=a=>y.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):Y("",!0)]),u(J,{modelValue:y.value,"onUpdate:modelValue":n[12]||(n[12]=a=>y.value=a),"ok-text":e(t)("modals.apply"),"cancel-text":e(t)("modals.cancel"),onOk:_,"close-button":""},{default:R(()=>[c("h3",de,k(e(t)("modals.addParamsTitle")),1),c("div",null,[u(e(j),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:R(()=>[u(e(f),{class:"w-full",modelValue:o.Name,"onUpdate:modelValue":n[1]||(n[1]=a=>o.Name=a),rules:[a=>a&&a.length>0||e(t)("validation.required")],label:e(t)("form.name")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:o.NameRus,"onUpdate:modelValue":n[2]||(n[2]=a=>o.NameRus=a),rules:[a=>a&&a.length>0||e(t)("validation.required")],label:e(t)("form.nameRus")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:o.ShortName,"onUpdate:modelValue":n[3]||(n[3]=a=>o.ShortName=a),rules:[a=>a&&a.length>0||e(t)("validation.required")],label:e(t)("form.shortName")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:o.ShortNameRus,"onUpdate:modelValue":n[4]||(n[4]=a=>o.ShortNameRus=a),rules:[a=>a&&a.length>0||e(t)("validation.required")],label:e(t)("form.shortNameRus")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:o.WinCC,"onUpdate:modelValue":n[5]||(n[5]=a=>o.WinCC=a),rules:[a=>a&&a.length>0||e(t)("validation.required")],label:e(t)("form.wincc")},null,8,["modelValue","rules","label"]),u(C,{modelValue:o.ServerId,"onUpdate:modelValue":n[6]||(n[6]=a=>o.ServerId=a),"value-by":"value",class:"w-full",label:e(t)("menu.servers"),options:V.value,clearable:""},null,8,["modelValue","label","options"]),c("div",ue,[u(e(f),{class:"w-full",modelValue:o.Min,"onUpdate:modelValue":n[7]||(n[7]=a=>o.Min=a),rules:[a=>a&&a.length>0||e(t)("validation.required")],label:e(t)("table.min")},null,8,["modelValue","rules","label"]),u(e(f),{class:"w-full",modelValue:o.Max,"onUpdate:modelValue":n[8]||(n[8]=a=>o.Max=a),rules:[a=>a&&a.length>0||e(t)("validation.required")],label:e(t)("table.max")},null,8,["modelValue","rules","label"])]),c("div",me,[u(C,{modelValue:o.ParamsTypeID,"onUpdate:modelValue":n[9]||(n[9]=a=>o.ParamsTypeID=a),"value-by":"value",class:"mb-6",label:e(t)("menu.paramtypes"),options:g.value,clearable:""},null,8,["modelValue","label","options"]),u(C,{modelValue:o.UnitsID,"onUpdate:modelValue":n[10]||(n[10]=a=>o.UnitsID=a),"value-by":"value",class:"mb-6",label:e(t)("menu.units"),options:s.value,clearable:""},null,8,["modelValue","label","options"])]),u(w,{class:"w-full",modelValue:o.Comment,"onUpdate:modelValue":n[11]||(n[11]=a=>o.Comment=a),"max-length":"125",label:e(t)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),c("main",ie,[u(K,{rowData:b.value,columnDefs:A.value,defaultColDef:z,animateRows:"true",class:"ag-theme-material h-full",onGridReady:n[13]||(n[13]=a=>S.value=a.api)},null,8,["rowData","columnDefs"])])])}}};export{fe as default};
