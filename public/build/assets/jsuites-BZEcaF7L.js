import{P as getDefaultExportFromCjs}from"./app-c0G7Ml5G.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules-TDtrdbi3.js";var dist$1={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(n,l){(function(c,f){n.exports=f()})(jsuites,function(){var c;return function(){var f={195:function(b){(function(u,d){b.exports=d()})(this,function(){return function(Ve){function d(Ae,Te){this.highOrder=Ae,this.lowOrder=Te}var k=[new d(1779033703,4089235720),new d(3144134277,2227873595),new d(1013904242,4271175723),new d(2773480762,1595750129),new d(1359893119,2917565137),new d(2600822924,725511199),new d(528734635,4215389547),new d(1541459225,327033209)],P=[new d(1116352408,3609767458),new d(1899447441,602891725),new d(3049323471,3964484399),new d(3921009573,2173295548),new d(961987163,4081628472),new d(1508970993,3053834265),new d(2453635748,2937671579),new d(2870763221,3664609560),new d(3624381080,2734883394),new d(310598401,1164996542),new d(607225278,1323610764),new d(1426881987,3590304994),new d(1925078388,4068182383),new d(2162078206,991336113),new d(2614888103,633803317),new d(3248222580,3479774868),new d(3835390401,2666613458),new d(4022224774,944711139),new d(264347078,2341262773),new d(604807628,2007800933),new d(770255983,1495990901),new d(1249150122,1856431235),new d(1555081692,3175218132),new d(1996064986,2198950837),new d(2554220882,3999719339),new d(2821834349,766784016),new d(2952996808,2566594879),new d(3210313671,3203337956),new d(3336571891,1034457026),new d(3584528711,2466948901),new d(113926993,3758326383),new d(338241895,168717936),new d(666307205,1188179964),new d(773529912,1546045734),new d(1294757372,1522805485),new d(1396182291,2643833823),new d(1695183700,2343527390),new d(1986661051,1014477480),new d(2177026350,1206759142),new d(2456956037,344077627),new d(2730485921,1290863460),new d(2820302411,3158454273),new d(3259730800,3505952657),new d(3345764771,106217008),new d(3516065817,3606008344),new d(3600352804,1432725776),new d(4094571909,1467031594),new d(275423344,851169720),new d(430227734,3100823752),new d(506948616,1363258195),new d(659060556,3750685593),new d(883997877,3785050280),new d(958139571,3318307427),new d(1322822218,3812723403),new d(1537002063,2003034995),new d(1747873779,3602036899),new d(1955562222,1575990012),new d(2024104815,1125592928),new d(2227730452,2716904306),new d(2361852424,442776044),new d(2428436474,593698344),new d(2756734187,3733110249),new d(3204031479,2999351573),new d(3329325298,3815920427),new d(3391569614,3928383900),new d(3515267271,566280711),new d(3940187606,3454069534),new d(4118630271,4000239992),new d(116418474,1914138554),new d(174292421,2731055270),new d(289380356,3203993006),new d(460393269,320620315),new d(685471733,587496836),new d(852142971,1086792851),new d(1017036298,365543100),new d(1126000580,2618297676),new d(1288033470,3409855158),new d(1501505948,4234509866),new d(1607167915,987167468),new d(1816402316,1246189591)],g=new Array(64),s,m,j,h,C,T,I,_,O,N,F,Z,q=8;function se(Ae){return unescape(encodeURIComponent(Ae))}function ge(Ae){for(var Te=[],Be=(1<<q)-1,ze=Ae.length*q,Je=0;Je<ze;Je+=q)Te[Je>>5]|=(Ae.charCodeAt(Je/q)&Be)<<32-q-Je%32;return Te}function ae(Ae){for(var Te="0123456789abcdef",Be="",ze=Ae.length*4,Je,Qe=0;Qe<ze;Qe+=1)Je=Ae[Qe>>2]>>(3-Qe%4)*8,Be+=Te.charAt(Je>>4&15)+Te.charAt(Je&15);return Be}function me(Ae,Te){var Be,ze,Je,Qe;return Be=(Ae.lowOrder&65535)+(Te.lowOrder&65535),ze=(Ae.lowOrder>>>16)+(Te.lowOrder>>>16)+(Be>>>16),Je=(ze&65535)<<16|Be&65535,Be=(Ae.highOrder&65535)+(Te.highOrder&65535)+(ze>>>16),ze=(Ae.highOrder>>>16)+(Te.highOrder>>>16)+(Be>>>16),Qe=(ze&65535)<<16|Be&65535,new d(Qe,Je)}function Le(Ae,Te,Be,ze){var Je,Qe,it,dt;return Je=(Ae.lowOrder&65535)+(Te.lowOrder&65535)+(Be.lowOrder&65535)+(ze.lowOrder&65535),Qe=(Ae.lowOrder>>>16)+(Te.lowOrder>>>16)+(Be.lowOrder>>>16)+(ze.lowOrder>>>16)+(Je>>>16),it=(Qe&65535)<<16|Je&65535,Je=(Ae.highOrder&65535)+(Te.highOrder&65535)+(Be.highOrder&65535)+(ze.highOrder&65535)+(Qe>>>16),Qe=(Ae.highOrder>>>16)+(Te.highOrder>>>16)+(Be.highOrder>>>16)+(ze.highOrder>>>16)+(Je>>>16),dt=(Qe&65535)<<16|Je&65535,new d(dt,it)}function je(Ae,Te,Be,ze,Je){var Qe,it,dt,mt;return Qe=(Ae.lowOrder&65535)+(Te.lowOrder&65535)+(Be.lowOrder&65535)+(ze.lowOrder&65535)+(Je.lowOrder&65535),it=(Ae.lowOrder>>>16)+(Te.lowOrder>>>16)+(Be.lowOrder>>>16)+(ze.lowOrder>>>16)+(Je.lowOrder>>>16)+(Qe>>>16),dt=(it&65535)<<16|Qe&65535,Qe=(Ae.highOrder&65535)+(Te.highOrder&65535)+(Be.highOrder&65535)+(ze.highOrder&65535)+(Je.highOrder&65535)+(it>>>16),it=(Ae.highOrder>>>16)+(Te.highOrder>>>16)+(Be.highOrder>>>16)+(ze.highOrder>>>16)+(Je.highOrder>>>16)+(Qe>>>16),mt=(it&65535)<<16|Qe&65535,new d(mt,dt)}function ie(Ae,Te,Be){return new d(Ae.highOrder&Te.highOrder^Ae.highOrder&Be.highOrder^Te.highOrder&Be.highOrder,Ae.lowOrder&Te.lowOrder^Ae.lowOrder&Be.lowOrder^Te.lowOrder&Be.lowOrder)}function _e(Ae,Te,Be){return new d(Ae.highOrder&Te.highOrder^~Ae.highOrder&Be.highOrder,Ae.lowOrder&Te.lowOrder^~Ae.lowOrder&Be.lowOrder)}function Ye(Ae,Te){return Te<=32?new d(Ae.highOrder>>>Te|Ae.lowOrder<<32-Te,Ae.lowOrder>>>Te|Ae.highOrder<<32-Te):new d(Ae.lowOrder>>>Te|Ae.highOrder<<32-Te,Ae.highOrder>>>Te|Ae.lowOrder<<32-Te)}function Ue(Ae){var Te=Ye(Ae,28),Be=Ye(Ae,34),ze=Ye(Ae,39);return new d(Te.highOrder^Be.highOrder^ze.highOrder,Te.lowOrder^Be.lowOrder^ze.lowOrder)}function He(Ae){var Te=Ye(Ae,14),Be=Ye(Ae,18),ze=Ye(Ae,41);return new d(Te.highOrder^Be.highOrder^ze.highOrder,Te.lowOrder^Be.lowOrder^ze.lowOrder)}function ut(Ae){var Te=Ye(Ae,1),Be=Ye(Ae,8),ze=Ne(Ae,7);return new d(Te.highOrder^Be.highOrder^ze.highOrder,Te.lowOrder^Be.lowOrder^ze.lowOrder)}function Y(Ae){var Te=Ye(Ae,19),Be=Ye(Ae,61),ze=Ne(Ae,6);return new d(Te.highOrder^Be.highOrder^ze.highOrder,Te.lowOrder^Be.lowOrder^ze.lowOrder)}function Ne(Ae,Te){return Te<=32?new d(Ae.highOrder>>>Te,Ae.lowOrder>>>Te|Ae.highOrder<<32-Te):new d(0,Ae.highOrder<<32-Te)}var Ve=se(Ve),bt=Ve.length*q;Ve=ge(Ve),Ve[bt>>5]|=128<<24-bt%32,Ve[(bt+128>>10<<5)+31]=bt;for(var O=0;O<Ve.length;O+=32){s=k[0],m=k[1],j=k[2],h=k[3],C=k[4],T=k[5],I=k[6],_=k[7];for(var N=0;N<80;N++)N<16?g[N]=new d(Ve[N*2+O],Ve[N*2+O+1]):g[N]=Le(Y(g[N-2]),g[N-7],ut(g[N-15]),g[N-16]),F=je(_,He(C),_e(C,T,I),P[N],g[N]),Z=me(Ue(s),ie(s,m,j)),_=I,I=T,T=C,C=me(h,F),h=j,j=m,m=s,s=me(F,Z);k[0]=me(s,k[0]),k[1]=me(m,k[1]),k[2]=me(j,k[2]),k[3]=me(h,k[3]),k[4]=me(C,k[4]),k[5]=me(T,k[5]),k[6]=me(I,k[6]),k[7]=me(_,k[7])}for(var tt=[],O=0;O<k.length;O++)tt.push(k[O].highOrder),tt.push(k[O].lowOrder);return ae(tt)}})}},L={};function R(b){var u=L[b];if(u!==void 0)return u.exports;var d=L[b]={exports:{}};return f[b].call(d.exports,d,d.exports,R),d.exports}(function(){R.n=function(b){var u=b&&b.__esModule?function(){return b.default}:function(){return b};return R.d(u,{a:u}),u}})(),function(){R.d=function(b,u){for(var d in u)R.o(u,d)&&!R.o(b,d)&&Object.defineProperty(b,d,{enumerable:!0,get:u[d]})}}(),function(){R.o=function(b,u){return Object.prototype.hasOwnProperty.call(b,u)}}();var W={};(function(){R.d(W,{default:function(){return Rt}});var b=function(w){document.dictionary||(document.dictionary={});var E=null,a=Object.keys(w);for(E=0;E<a.length;E++)document.dictionary[a[E]]=w[a[E]]},u=function(w){return typeof document<"u"&&document.dictionary&&document.dictionary[w]||w},d={setDictionary:b,translate:u},P=function(w,E){if(E===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(r){return r!==null}),setTimeout(function(){window.jSuitesStateControl.push(w)},0);else{var a=window.jSuitesStateControl.indexOf(w);a>=0&&window.jSuitesStateControl.splice(a,1)}},g={};g.two=function(w){return w=""+w,w.length==1&&(w="0"+w),w},g.focus=function(w){if(w.textContent.length){const E=document.createRange(),a=window.getSelection();let r=w;for(;r.lastChild;)r=r.lastChild;r.nodeType===Node.TEXT_NODE?E.setStart(r,r.length):E.setStart(r,r.childNodes.length),E.collapse(!0),a.removeAllRanges(),a.addRange(E),w.scrollLeft=w.scrollWidth}},g.isNumeric=function(w){return typeof w=="string"&&(w=w.trim()),!isNaN(w)&&w!==null&&w!==""},g.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(w){var E=Math.random()*16|0,a=w=="x"?E:E&3|8;return a.toString(16)})},g.getNode=function(){var w=document.getSelection().anchorNode;return w?w.nodeType==3?w.parentNode:w:null},g.hash=function(w){var E=0,a,r;if(w.length===0)return E;for(a=0;a<w.length;a++)r=w.charCodeAt(a),r>32&&(E=(E<<5)-E+r,E|=0);return E},g.randomColor=function(w){var E=-.25,a=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);var r=[],B,te;for(te=0;te<3;te++)B=parseInt(a.substr(te*2,2),16),B=Math.round(Math.min(Math.max(0,B+B*E),255)).toString(16),r.push(("00"+B).substr(B.length));return w==!0?"#"+g.two(r[0].toString(16))+g.two(r[1].toString(16))+g.two(r[2].toString(16)):r},g.getWindowWidth=function(){var w=window,E=document,a=E.documentElement,r=E.getElementsByTagName("body")[0],B=w.innerWidth||a.clientWidth||r.clientWidth;return B},g.getWindowHeight=function(){var w=window,E=document,a=E.documentElement,r=E.getElementsByTagName("body")[0],B=w.innerHeight||a.clientHeight||r.clientHeight;return B},g.getPosition=function(w){if(w.changedTouches&&w.changedTouches[0])var E=w.changedTouches[0].pageX,a=w.changedTouches[0].pageY;else var E=window.Event?w.pageX:w.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),a=window.Event?w.pageY:w.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[E,a]},g.click=function(w){if(w.click)w.click();else{var E=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});w.dispatchEvent(E)}},g.findElement=function(w,E){var a=!1;function r(B){B&&!a&&(typeof E=="function"?a=E(B):typeof E=="string"&&B.classList&&B.classList.contains(E)&&(a=B)),B.parentNode&&!a&&r(B.parentNode)}return r(w),a};var s=g;const m=function(w){return typeof w=="object"||typeof w=="function"};function j(w,E,a){if(typeof w!="string"||w.length===0)return;const r=w.split(".");if(r.length===0)return;let B=this;if(typeof E>"u"&&typeof a>"u"){for(let ee=0;ee<r.length;ee++){const S=r[ee];if(B!=null&&m(B)&&Object.prototype.hasOwnProperty.call(B,S))B=B[S];else return}return B}for(let ee=0;ee<r.length-1;ee++){const S=r[ee];if(B==null||!m(B))return console.warn(`Cannot set value: path '${w}' blocked by invalid object at '${S}'`),!1;Object.prototype.hasOwnProperty.call(B,S)&&(B[S]==null||!m(B[S]))?B[S]={}:Object.prototype.hasOwnProperty.call(B,S)||(B[S]={}),B=B[S]}const te=r[r.length-1];return B==null||!m(B)?!1:a===!0?Object.prototype.hasOwnProperty.call(B,te)?(delete B[te],!0):!1:(B[te]=E,!0)}function h(w,E){var a={};a.options={};var r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},B=null;for(var te in r)E&&E.hasOwnProperty(te)?a.options[te]=E[te]:a.options[te]=r[te];w.classList.add("jsorting"),w.addEventListener("dragstart",function(A){let V=A.target;if(V.nodeType===3)if(V.parentNode.getAttribute("draggable")==="true")V=V.parentNode;else{A.preventDefault(),A.stopPropagation();return}if(V.getAttribute("draggable")==="true"){let G=Array.prototype.indexOf.call(V.parentNode.children,V);B={element:V,o:G,d:G},V.style.opacity="0.25",typeof a.options.ondragstart=="function"&&a.options.ondragstart(w,V,A),A.dataTransfer.setDragImage(V,0,0)}}),w.addEventListener("dragover",function(A){if(A.preventDefault(),B&&ee(A.target)&&A.target.getAttribute("draggable")=="true"&&B.element!=A.target){if(a.options.direction)var V=A.target.clientWidth/2>A.offsetX;else var V=A.target.clientHeight/2>A.offsetY;V?A.target.parentNode.insertBefore(B.element,A.target):A.target.parentNode.insertBefore(B.element,A.target.nextSibling),B.d=Array.prototype.indexOf.call(A.target.parentNode.children,B.element)}}),w.addEventListener("dragleave",function(A){A.preventDefault()}),w.addEventListener("dragend",function(A){A.preventDefault(),B&&(typeof a.options.ondragend=="function"&&a.options.ondragend(w,B.element,A),B.o<B.d?A.target.parentNode.insertBefore(B.element,A.target.parentNode.children[B.o]):A.target.parentNode.insertBefore(B.element,A.target.parentNode.children[B.o].nextSibling),B.element.style.opacity="",B=null)}),w.addEventListener("drop",function(A){A.preventDefault(),B&&(B.o!==B.d&&typeof a.options.ondrop=="function"&&a.options.ondrop(w,B.o,B.d,B.element,A.target,A),B.element.style.opacity="",B=null)});for(var ee=function(A){var V=!1;function G(ne){ne.className&&ne.classList.contains("jsorting")&&(V=!0),V||G(ne.parentNode)}return G(A),V},S=0;S<w.children.length;S++)w.children[S].hasAttribute("draggable")||w.children[S].setAttribute("draggable","true");return w.val=function(){for(var A=null,V=[],G=0;G<w.children.length;G++)(A=w.children[G].getAttribute("data-id"))&&V.push(A);return V},w}function C(w,E){var a={};(!E.loadUp||typeof E.loadUp!="function")&&(E.loadUp=function(){return!1}),(!E.loadDown||typeof E.loadDown!="function")&&(E.loadDown=function(){return!1}),E.timer||(E.timer=100);var r=null,B=function(te){if(r==null){var ee=!1,S=w.scrollTop;w.scrollTop+w.clientHeight*2>=w.scrollHeight?E.loadDown()&&(S==w.scrollTop&&(w.scrollTop=w.scrollTop-w.clientHeight),ee=!0):w.scrollTop<=w.clientHeight&&E.loadUp()&&(S==w.scrollTop&&(w.scrollTop=w.scrollTop+w.clientHeight),ee=!0),r=setTimeout(function(){r=null},E.timer),ee&&typeof E.onupdate=="function"&&E.onupdate()}};return w.onscroll=function(te){B()},w.onwheel=function(te){B()},a}function T(){var w=function(E,a){if(Array.isArray(E)){var r={instance:[],complete:a};if(E.length>0)for(var B=0;B<E.length;B++)E[B].multiple=r,r.instance.push(w(E[B]));return r}if(E.data||(E.data={}),E.type&&(E.method=E.type),E.method||(E.method="GET"),E.dataType||(E.dataType="json"),E.data){var te=function(ne,he){var ce=[];if(ne){var fe=Object.keys(ne);if(fe.length)for(var Ee=0;Ee<fe.length;Ee++){if(he)var De=he+"["+fe[Ee]+"]";else var De=fe[Ee];if(ne[De]instanceof FileList)ce[De]=ne[fe[Ee]];else if(ne[fe[Ee]]===null||ne[fe[Ee]]===void 0)ce[De]="";else if(typeof ne[fe[Ee]]=="object")for(var Se=te(ne[fe[Ee]],De),qe=Object.keys(Se),$e=0;$e<qe.length;$e++)ce[qe[$e]]=Se[qe[$e]];else ce[De]=ne[fe[Ee]]}}return ce},ee=te(E.data),S=Object.keys(ee);if(E.method=="GET"){if(S.length){for(var A=[],B=0;B<S.length;B++)A.push(S[B]+"="+encodeURIComponent(ee[S[B]]));E.url.indexOf("?")<0&&(E.url+="?"),E.url+=A.join("&")}}else for(var A=new FormData,B=0;B<S.length;B++)if(ee[S[B]]instanceof FileList){if(ee[S[B]].length)for(var V=0;V<ee[S[B]].length;V++)A.append(S[B],ee[S[B]][V],ee[S[B]][V].name)}else A.append(S[B],ee[S[B]])}var G=new XMLHttpRequest;return G.open(E.method,E.url,!0),E.requestedWith?G.setRequestHeader("X-Requested-With",E.requestedWith):E.requestedWith!==!1&&G.setRequestHeader("X-Requested-With","XMLHttpRequest"),E.contentType&&G.setRequestHeader("Content-Type",E.contentType),E.method==="POST"?G.setRequestHeader("Accept","application/json"):E.dataType==="blob"?G.responseType="blob":E.contentType||(E.dataType==="json"?G.setRequestHeader("Content-Type","text/json"):E.dataType==="html"&&G.setRequestHeader("Content-Type","text/html")),E.cache!==!0&&(G.setRequestHeader("pragma","no-cache"),G.setRequestHeader("cache-control","no-cache")),E.withCredentials===!0&&(G.withCredentials=!0),typeof E.beforeSend=="function"&&E.beforeSend(G),typeof w.beforeSend=="function"&&w.beforeSend(G),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(G),G.onerror=function(){E.error&&typeof E.error=="function"&&E.error({message:"Network error: Unable to reach the server.",status:0})},G.ontimeout=function(){E.error&&typeof E.error=="function"&&E.error({message:"Request timed out after "+G.timeout+"ms.",status:0})},G.onload=function(){if(G.status>=200&&G.status<300)if(E.dataType==="json")try{var ne=JSON.parse(G.responseText);E.success&&typeof E.success=="function"&&E.success(ne)}catch(ce){E.error&&typeof E.error=="function"&&E.error(ce,ne)}else{if(E.dataType==="blob")var ne=G.response;else var ne=G.responseText;E.success&&typeof E.success=="function"&&E.success(ne)}else E.error&&typeof E.error=="function"&&E.error(G.responseText,G.status);if(w.queue&&w.queue.length>0&&w.send(w.queue.shift()),w.requests&&w.requests.length){var he=w.requests.indexOf(G);if(w.requests.splice(he,1),w.requests.length||E.complete&&typeof E.complete=="function"&&E.complete(ne),E.group&&w.oncomplete&&typeof w.oncomplete[E.group]=="function"&&(w.pending(E.group)||(w.oncomplete[E.group](),w.oncomplete[E.group]=null)),E.multiple&&E.multiple.instance){var he=E.multiple.instance.indexOf(G);E.multiple.instance.splice(he,1),E.multiple.instance.length||E.multiple.complete&&typeof E.multiple.complete=="function"&&E.multiple.complete(ne)}}},G.options=E,G.data=A,E.queue===!0&&w.requests.length>0?w.queue.push(G):w.send(G),G};return w.send=function(E){E.data?Array.isArray(E.data)?E.send(E.data.join("&")):E.send(E.data):E.send(),w.requests.push(E)},w.exists=function(E,a){var r=new XMLHttpRequest;r.open("HEAD",E,!1),r.send(),r.status&&a(r.status)},w.pending=function(E){var a=0,r=w.requests;if(r&&r.length)for(var B=0;B<r.length;B++)(!E||E==r[B].options.group)&&a++;return a},w.oncomplete={},w.requests=[],w.queue=[],w}var I=T();function _(){const w={loading:{}};return w.loading.show=function(E){w.loading.element||(w.loading.element=document.createElement("div"),w.loading.element.className="jloading"),document.body.appendChild(w.loading.element),E>0&&setTimeout(function(){w.loading.hide()},E*1e3)},w.loading.hide=function(){w.loading.element&&w.loading.element.parentNode&&document.body.removeChild(w.loading.element)},w.slideLeft=function(E,a,r){a==!0?(E.classList.add("jslide-left-in"),setTimeout(function(){E.classList.remove("jslide-left-in"),typeof r=="function"&&r()},400)):(E.classList.add("jslide-left-out"),setTimeout(function(){E.classList.remove("jslide-left-out"),typeof r=="function"&&r()},400))},w.slideRight=function(E,a,r){a===!0?(E.classList.add("jslide-right-in"),setTimeout(function(){E.classList.remove("jslide-right-in"),typeof r=="function"&&r()},400)):(E.classList.add("jslide-right-out"),setTimeout(function(){E.classList.remove("jslide-right-out"),typeof r=="function"&&r()},400))},w.slideTop=function(E,a,r){a===!0?(E.classList.add("jslide-top-in"),setTimeout(function(){E.classList.remove("jslide-top-in"),typeof r=="function"&&r()},400)):(E.classList.add("jslide-top-out"),setTimeout(function(){E.classList.remove("jslide-top-out"),typeof r=="function"&&r()},400))},w.slideBottom=function(E,a,r){a===!0?(E.classList.add("jslide-bottom-in"),setTimeout(function(){E.classList.remove("jslide-bottom-in"),typeof r=="function"&&r()},400)):(E.classList.add("jslide-bottom-out"),setTimeout(function(){E.classList.remove("jslide-bottom-out"),typeof r=="function"&&r()},100))},w.fadeIn=function(E,a){E.style.display="",E.classList.add("jfade-in"),setTimeout(function(){E.classList.remove("jfade-in"),typeof a=="function"&&a()},2e3)},w.fadeOut=function(E,a){E.classList.add("jfade-out"),setTimeout(function(){E.style.display="none",E.classList.remove("jfade-out"),typeof a=="function"&&a()},1e3)},w}var O=_();function N(){var w={};w.now=function(ee,S){var A=null,V=null,G=null,ne=null,he=null,ce=null;return Array.isArray(ee)?(A=ee[0],V=ee[1],G=ee[2],ne=ee[3],he=ee[4],ce=ee[5]):(ee||(ee=new Date),A=ee.getFullYear(),V=ee.getMonth()+1,G=ee.getDate(),ne=ee.getHours(),he=ee.getMinutes(),ce=ee.getSeconds()),S==!0?s.two(A)+"-"+s.two(V)+"-"+s.two(G):s.two(A)+"-"+s.two(V)+"-"+s.two(G)+" "+s.two(ne)+":"+s.two(he)+":"+s.two(ce)},w.toArray=function(ee){var A=ee.split(ee.indexOf("T")!==-1?"T":" "),S=A[1],A=A[0].split("-"),V=parseInt(A[0]),G=parseInt(A[1]),ne=parseInt(A[2]),he=0,ce=0;return S&&(S=S.split(":"),he=parseInt(S[0]),ce=parseInt(S[1])),[V,G,ne,he,ce,0]};var E=Date.UTC(1900,0,0),a=Date.UTC(1900,1,29),r=864e5;w.dateToNum=function(ee){typeof ee=="string"&&(ee=new Date(ee+"  GMT+0"));var S=ee.getTime();return S>=a&&(S+=r),S-=E,S/r},w.numToDate=function(ee){var S=E+ee*r;S>=a&&(S-=r);const A=new Date(S);var V=[A.getUTCFullYear(),A.getUTCMonth()+1,A.getUTCDate(),A.getUTCHours(),A.getUTCMinutes(),A.getUTCSeconds()];return w.now(V)};let B=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],te=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(w,"weekdays",{get:function(){return B.map(function(ee){return d.translate(ee)})}}),Object.defineProperty(w,"weekdaysShort",{get:function(){return B.map(function(ee){return d.translate(ee).substring(0,3)})}}),Object.defineProperty(w,"months",{get:function(){return te.map(function(ee){return d.translate(ee)})}}),Object.defineProperty(w,"monthsShort",{get:function(){return te.map(function(ee){return d.translate(ee).substring(0,3)})}}),w}var F=N();function Z(){var w={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},E=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var v=0;this.date[4]&&(v=parseFloat(this.date[4]/60));var D=parseInt(this.date[3])+v;D/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?D=s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),D=s.two(this.date[0])+"-"+s.two(this.date[1])+"-"+s.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(D+=" "+s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5])));return D},a=function(){var v="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)v=parseInt(this.date[3]);else{let X=parseInt(this.date[3]);X<13&&this.values.indexOf("PM")!==-1?v=(X+12)%24:v=X%24}this.date[4]&&(v+=parseFloat(this.date[4]/60)),this.date[5]&&(v+=parseFloat(this.date[5]/3600)),v/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var D=F.now(this.date);v=F.dateToNum(D)}return isNaN(v)&&(v=""),v},r=function(v){return v===null||v===""||v===void 0},B=function(v){var D=(""+v)[0];return D=="="},te=function(v){return v==="currency"||v==="percentage"||v==="scientific"||v==="numeric"},ee=function(v){if(v&&Number(v)==v)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var D=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=D[1]}else{v||(v=this.mask);var X=new RegExp("0{1}(.{1})0+","ig"),D=X.exec(v);if(D&&D[1]&&D[1].length==1)return this.options.decimal=D[1],D[1];var X=new RegExp("#{1}(.{1})#+","ig"),D=X.exec(v);D&&D[1]&&D[1].length==1?D[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},S=function(v,D){if(v=="")return"";D||(D=ee.call(this)),v=(""+v).split(D);var X=v[0].match(/[-]+/g);if(X&&X.length?X=!0:X=!1,v[0]=v[0].match(/[0-9]+/g),v[0]?(X&&v[0].unshift("-"),v[0]=v[0].join("")):X&&(v[0]="-"),v[0]||v[1])v[1]!==void 0&&(v[1]=v[1].match(/[0-9]+/g),v[1]?v[1]=v[1].join(""):v[1]="");else return"";return v},A=function(v,D){if(v==="")return"";var X=ee.call(this),ue=this.options;if(v=S.call(this,v),v==="")return"";var K=null;if(v[0]&&(ue.style==="percent"?K=parseFloat(v[0])/100:K=parseFloat(v[0]+".1")),(v[0]==="-"||v[0]==="-00")&&!v[1]&&D&&D.inputType=="deleteContentBackward")return"";var le=new Intl.NumberFormat(this.locale,ue).format(K);if(le=le.split(X),ue.style==="percent"&&le[0].indexOf("%")!==-1&&(le[0]=le[0].replace("%",""),le[2]="%"),typeof le[1]<"u"){var be=le[1].replace(/[0-9]*/g,"");be&&(le[2]=be)}return v[1]!==void 0?le[1]=X+v[1]:le[1]="",le.join("")},V=function(v,D){var X=he.call(v);if(X){var ue=A.call(this,X,D),K=ue.length-X.length,le=ne.call(v)+K;he.call(v,ue,le,!0)}},G=function(v){var D=S.call(this,v);return D?(D[0]==="-"&&(D[0]="-0"),parseFloat(D.join("."))):null},ne=function(v,D){if(v===void 0)if(this.tagName=="DIV"){var X=0,ue=window.getSelection();if(ue&&ue.rangeCount!==0){var K=ue.getRangeAt(0),le=K.cloneRange();le.selectNodeContents(this),le.setEnd(K.endContainer,K.endOffset),X=le.toString().length}return X}else return this.selectionStart;else{var be=he.call(this);if(D){for(var le=null,Me=0;Me<be.length;Me++)(be[Me].match(/[\-0-9]/g)||be[Me]==="."||be[Me]===",")&&(le=Me);le===null&&(le=be.indexOf(" ")),v>=le&&(v=le+1)}if(v>be.length&&(v=be.length),v)if(this.tagName=="DIV"){var ue=window.getSelection(),K=document.createRange();this.childNodes[0]&&(K.setStart(this.childNodes[0],v),ue.removeAllRanges(),ue.addRange(K))}else this.selectionStart=v,this.selectionEnd=v}},he=function(v,D,X){if(this.tagName=="DIV")if(v===void 0){var v=this.innerText;return this.value&&this.value.length>v.length&&(v=this.value),v}else this.innerText!==v&&(this.innerText=v,D&&ne.call(this,D,X));else{if(v===void 0)return this.value;this.value!==v&&(this.value=v,D&&ne.call(this,D,X))}},ce=F.weekdays,fe=F.weekdaysShort,Ee=F.months,De=F.monthsShort,Se={YEAR:function(v,D){var X=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<=10&&this.values[this.index].length<D&&(this.values[this.index]+=v),this.values[this.index].length==D){if(D==2)var X=X.substr(0,2)+this.values[this.index];else if(D==3)var X=X.substr(0,1)+this.values[this.index];else if(D==4)var X=this.values[this.index];this.date[0]=X,this.index++}},YYYY:function(v){Se.YEAR.call(this,v,4)},YYY:function(v){Se.YEAR.call(this,v,3)},YY:function(v){Se.YEAR.call(this,v,2)},FIND:function(v,D){if(r(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=v;return}for(var X=0,ue=0,K=(this.values[this.index]+v).toLowerCase(),le=0;le<D.length;le++)D[le].toLowerCase().indexOf(K)==0&&(X=le,ue++);if(ue>1)this.values[this.index]+=v;else if(ue==1){var be=D[X].length-this.values[this.index].length-1;return this.position+=be,this.values[this.index]=D[X],this.index++,X}},MMM:function(v){var D=Se.FIND.call(this,v,De);D!==void 0&&(this.date[1]=D+1)},MON:function(v){Se.MMM.call(this,v)},MMMM:function(v){var D=Se.FIND.call(this,v,Ee);D!==void 0&&(this.date[1]=D+1)},MONTH:function(v){Se.MMMM.call(this,v)},MMMMM:function(v){r(this.values[this.index])&&(this.values[this.index]="");for(var D=(this.values[this.index]+v).toLowerCase(),X=0;X<Ee.length;X++)if(Ee[X][0].toLowerCase().indexOf(D)==0){this.values[this.index]=Ee[X][0],this.date[1]=X+1,this.index++;break}},MM:function(v){r(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(this.date[1]=this.values[this.index]="0"+v,this.index++):parseInt(v)<2&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[1]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[1]=this.values[this.index]+=v,this.index++)},M:function(v){var D=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))this.values[this.index]=v,v>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[1]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[1]=this.values[this.index]+=v,this.index++;else var D=!0;else var D=!0;if(D==!0){var X=parseInt(this.values[this.index]);X>0&&X<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(v){var D=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))this.values[this.index]=v,parseInt(v)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(v)<2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[2]=this.values[this.index]+=v,this.index++;else var D=!0;else var D=!0;if(D==!0){var X=parseInt(this.values[this.index]);X>0&&X<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(v){r(this.values[this.index])?parseInt(v)>3&&parseInt(v)<10?(this.date[2]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==3&&parseInt(v)<2?(this.date[2]=this.values[this.index]+=v,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(v)<10?(this.date[2]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[2]=this.values[this.index]+=v,this.index++)},DDD:function(v){Se.FIND.call(this,v,fe)},DY:function(v){Se.DDD.call(this,v)},DDDD:function(v){Se.FIND.call(this,v,ce)},DAY:function(v){Se.DDDD.call(this,v)},HH12:function(v,D){var X=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))parseInt(v)>1&&parseInt(v)<10?(D&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[3]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]<1&&parseInt(v)<10)this.date[3]=this.values[this.index]+=v,this.index++;else var X=!0;else var X=!0;if(X==!0){var ue=parseInt(this.values[this.index]);ue>=0&&ue<=12&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH24:function(v,D){var X=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(this.values[this.index]==null||this.values[this.index]=="")parseInt(v)>2&&parseInt(v)<10?(D&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v);else if(this.values[this.index]==2&&parseInt(v)<4)!D&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]<2&&parseInt(v)<10)!D&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++;else var X=!0;else var X=!0;if(X==!0){var ue=parseInt(this.values[this.index]);ue>=0&&ue<24&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH:function(v){Se.HH24.call(this,v,1)},H:function(v){Se.HH24.call(this,v,0)},"\\[H\\]":function(v){this.values[this.index]==null&&(this.values[this.index]=""),v.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=v:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(v,D){this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>5&&parseInt(v)<10?(this.date[D]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):parseInt(v)<10&&(this.date[D]=this.values[this.index]+=v,this.index++)},MI:function(v){Se.N60.call(this,v,4)},SS:function(v){Se.N60.call(this,v,5)},"AM/PM":function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?v.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":v.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<7&&(this.values[this.index]=v),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(v){var D=ee.call(this),X=!1;r(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(X=!0);var ue=S.call(this,this.values[this.index],D);ue&&(this.values[this.index]=ue.join(D)),parseInt(v)>=0&&parseInt(v)<10?(this.values[this.index]=="0"&&v>0?this.values[this.index]="":this.values[this.index]=="-0"&&v>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||v==D)&&(this.values[this.index]+=v)):D&&v==D?this.values[this.index].indexOf(D)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=v):v=="-"&&(X=!0),X===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(v){Se["0{1}(.{1}0+)?"].call(this,v)},"0{1}(.{1}0+)?%":function(v){Se["0{1}(.{1}0+)?"].call(this,v),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(v){Se["0{1}(.{1}0+)?"].call(this,v);var D=ee.call(this),X=this.tokens[this.index].substr(1,1),ue=this.values[this.index][0]==="-",K=S.call(this,this.values[this.index],D);if(K!==""){var le=K[0].match(/[0-9]/g);if(le){le=le.join("");for(var be=[],Me=0,ve=le.length-1;ve>=0;ve--)be.push(le[ve]),Me++,Me%3||be.push(X);be=be.reverse(),K[0]=be.join(""),K[0].substr(0,1)==X&&(K[0]=K[0].substr(1))}else K[0]="";this.values[this.index]=K.join(D),ue&&(this.values[this.index]="-"+this.values[this.index])}},0:function(v){v.match(/[0-9]/g)&&(this.values[this.index]=v,this.index++)},"[0-9a-zA-Z$]+":function(v){r(this.values[this.index])&&(this.values[this.index]="");var D=this.tokens[this.index],X=this.values[this.index],ue=X.length;D[ue]==v?(this.values[this.index]+=v,this.values[this.index]==D&&this.index++):(this.values[this.index]=D,this.index++,v.match(/[\-0-9]/g)&&this.position--)},A:function(v){v.match(/[a-zA-Z]/gi)&&(this.values[this.index]=v,this.index++)},".":function(v){Se["[0-9a-zA-Z$]+"].call(this,v)},"@":function(v){r(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=v}},qe=function(v){if(this.type=="general")var D=[].concat(w.general);else var D=[].concat(w.currency,w.datetime,w.percentage,w.scientific,w.numeric,w.text,w.general);var X=new RegExp(D.join("|"),"gi");return v.match(X)},$e=function(v){if(this.type)if(this.type=="text")var D=["text"];else if(this.type=="general")var D=["general"];else if(this.type=="datetime")var D=["numeric","datetime","general"];else var D=["currency","percentage","scientific","numeric","general"];else var D=Object.keys(w);for(var X=0;X<D.length;X++)for(var ue=D[X],K=0;K<w[ue].length;K++){var le=new RegExp(w[ue][K],"gi"),be=v.match(le);if(be)return{type:ue,method:w[ue][K]}}},Q=function(v){for(var D=[],X=0;X<v.length;X++){var ue=$e.call(this,v[X]);ue?D.push(ue.method):D.push(null)}for(var X=0;X<D.length;X++)D[X]=="MM"&&(D[X-1]&&D[X-1].indexOf("H")>=0||D[X-2]&&D[X-2].indexOf("H")>=0||D[X+1]&&D[X+1].indexOf("S")>=0||D[X+2]&&D[X+2].indexOf("S")>=0)&&(D[X]="MI");return D},pe=function(v){var D=$e.call(this,v);if(D)var X=D.type;if(X){for(var ue=0,K=qe.call(this,v),le=0;le<K.length;le++)D=$e.call(this,K[le]),D&&te(D.type)&&ue++;ue>1&&(X="general")}return X},we=function(){typeof Se[this.methods[this.index]]=="function"?(Se[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},U=function(v){return(""+ +v).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(D,X,ue,K,le){return le<0?X+"0."+Array(1-le-ue.length).join(0)+ue+K:X+ue+K+Array(le-K.length+1).join(0)})},J=function(v,D,X){var ue=null,K={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof v=="object"){if(K.input=v.target,K.value=he.call(v.target),K.caret=ne.call(v.target),(ue=v.target.getAttribute("data-mask"))&&(K.mask=ue),(ue=v.target.getAttribute("data-type"))&&(K.type=ue),v.target.mask?(v.target.mask.options&&(K.options=v.target.mask.options),v.target.mask.locale&&(K.locale=v.target.mask.locale)):(ue=v.target.getAttribute("data-locale"))&&(K.locale=ue,K.mask&&(K.options.style=K.mask)),v.target.attributes&&v.target.attributes.length)for(var le=0;le<v.target.attributes.length;le++){var be=v.target.attributes[le].name,Me=v.target.attributes[le].value;be.substr(0,4)=="data"&&(K.options[be.substr(5)]=Me)}}else{if(typeof D=="string")K.mask=D;else for(var be=Object.keys(D),le=0;le<be.length;le++)K[be[le]]=D[be[le]];typeof v=="number"&&(ee.call(K,K.mask),v=(""+v).replace(".",K.options.decimal)),K.value=v,K.input&&(he.call(K.input,v),s.focus(K.input),K.caret=ne.call(K.input))}if(!B(K.value)&&(K.mask||K.locale)){if(K.mask){if(K.mask=K.mask.replace(new RegExp(/\[h]/),"|h|"),K.mask=K.mask.replace(new RegExp(/\[.*?\]/),""),K.mask=K.mask.replace(new RegExp(/\|h\|/),"[h]"),K.mask.indexOf(";")!==-1){var ue=K.mask.split(";");K.mask=ue[0]}if(K.mask.indexOf("##")!==-1){var ve=K.mask.split(";");ve[0]&&(typeof v=="object"&&(ve[0]=ve[0].replace(new RegExp(/_\)/g),""),ve[0]=ve[0].replace(new RegExp(/_\(/g),"")),ve[0]=ve[0].replace("*","	"),ve[0]=ve[0].replace(new RegExp(/_-/g),""),ve[0]=ve[0].replace(new RegExp(/_/g),""),ve[0]=ve[0].replace(new RegExp(/"/g),""),ve[0]=ve[0].replace("##0.###","##0.000"),ve[0]=ve[0].replace("##0.##","##0.00"),ve[0]=ve[0].replace("##0.#","##0.0"),ve[0]=ve[0].replace("##0,###","##0,000"),ve[0]=ve[0].replace("##0,##","##0,00"),ve[0]=ve[0].replace("##0,#","##0,0")),K.mask=ve[0]}if(K.mask.indexOf("\\")!==-1){var ve=K.mask.split(";");ve[0]=ve[0].replace(new RegExp(/\\/g),""),K.mask=ve[0]}K.type||(K.type=pe.call(K,K.mask)),K.tokens=qe.call(K,K.mask)}if(typeof v!="object"||!v.inputType||!v.inputType.indexOf("insert")||!v.inputType.indexOf("delete"))if(K.locale)if(K.input)V.call(K,K.input,v);else var Ie=A.call(K,K.value);else{for(K.methods=Q.call(K,K.tokens),K.event=v;K.position<K.value.length&&typeof K.tokens[K.index]<"u";)we.call(K);var Ie=K.values.join("");if(te(K.type)&&Ie!==""){for(;typeof K.tokens[K.index]<"u";){var ue=$e.call(K,K.tokens[K.index]);ue&&ue.type=="general"&&(K.values[K.index]=K.tokens[K.index]),K.index++}var Fe=!0}else var Fe=!1;if(Ie=K.values.join(""),K.input){if(ue=Ie.length-K.value.length,ue>0)var et=K.caret+ue;else var et=K.caret;he.call(K.input,Ie,et,Fe)}}if(K.input){var re=null;if(te(K.type)){let ye=he.call(K.input);K.number=G.call(K,ye),K.type=="percentage"&&(""+ye).indexOf("%")!==-1?re=J.adjustPrecision(K.number/100):re=K.number}else K.type=="datetime"&&(re=E.call(K),K.date[0]&&K.date[1]&&K.date[2]&&K.input.setAttribute("data-completed",!0));re&&K.input.setAttribute("data-value",re)}if(Ie!==void 0)return X?K:Ie}};return J.adjustPrecision=function(v){if(typeof v=="number"&&!Number.isInteger(v)){const D=v.toString().split(".");if(D[1]&&D[1].length>10){let X=0;const ue=D[1][D[1].length-2];if(ue==0||ue==9){for(let K=D[1].length-2;K>0;K--)if(X>=0&&D[1][K]==ue){if(X++,X>6)break}else{X=0;break}if(X)return parseFloat(parseFloat(v).toFixed(D[1].length-1))}}}return v},J.getType=pe,J.prepare=function(v,D){return D||(D={}),qe.call(D,v)},J.apply=function(v){var D=he.call(v.target);v.key.length==1&&(D+=v.key),he.call(v.target,J(D,v.target.getAttribute("data-mask")))},J.run=function(v,D,X){return J(v,{mask:D,decimal:X})},J.extract=function(v,D,X){if(r(v)||typeof D!="object")return v;if(D=Object.assign({},D),D.options||(D.options={}),!D.mask&&D.format&&(D.mask=D.format),D.mask){if(D.mask.indexOf(";")!==-1){var ue=D.mask.split(";");D.mask=ue[0]}D.mask=D.mask.replace(new RegExp(/\[h]/),"|h|"),D.mask=D.mask.replace(new RegExp(/\[.*?\]/),""),D.mask=D.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(D,D.mask);var K=null,le=null;if(D.type=="percent"||D.options.style=="percent"?K="percentage":D.mask&&(K=pe.call(D,D.mask)),K==="text"){var be={};le=v}else if(K==="general"){var be=J(v,D,!0);le=v}else if(K==="datetime"){v instanceof Date&&(v=J.getDateString(v,D.mask));var be=J(v,D,!0);s.isNumeric(v)?le=v:le=a.call(be)}else if(K==="scientific"){le=v,typeof v=="string"&&(le=Number(le));var be=D}else{le=G.call(D,v),K==="percentage"&&(""+v).indexOf("%")!==-1&&(le/=100);var be=D}return be.value=le,!be.type&&K&&(be.type=K),X?be:le},J.render=function(v,D,X,ue){if(r(v)||typeof D!="object")return v;if(D=Object.assign({},D),D.options||(D.options={}),!D.mask&&D.format&&(D.mask=D.format),D.mask){if(D.mask.indexOf(";")!==-1){var K=D.mask.split(";");X||(K[0]=K[0].replace(new RegExp(/_\)/g),""),K[0]=K[0].replace(new RegExp(/_\(/g),"")),D.mask=K[0]}D.mask=D.mask.replace(new RegExp(/\[h]/),"|h|"),D.mask=D.mask.replace(new RegExp(/\[.*?\]/),""),D.mask=D.mask.replace(new RegExp(/\|h\|/),"[h]")}var le=null;D.type=="percent"||D.options.style=="percent"?le="percentage":D.mask?le=pe.call(D,D.mask):v instanceof Date&&(le="datetime");var be=!1;if(le=="datetime"||D.type=="calendar"){var K=J.getDateString(v,D.mask);K&&(v=K),D.mask&&X&&(be=!0)}else if(le==="text")typeof v=="number"&&(v=v.toString());else if(typeof v=="string"&&c.isNumeric(v)&&(v=Number(v)),le==="percentage"&&(v=J.adjustPrecision(v*100)),typeof v=="number"){var K=null;if(D.mask&&X){var Me=ee.call(D,D.mask);if(le==="scientific")if(D.mask.indexOf(Me)!==-1){let xe=D.mask.split("E");xe=xe[0].split(Me),xe=""+xe[1].match(/[0-9]+/g),xe=xe.length,K=v.toExponential(xe)}else K=v.toExponential(0);else{if(D.mask.indexOf(Me)!==-1){Me=D.mask.split(Me),Me=""+Me[1].match(/[0-9]+/g),Me=Me.length,K=v.toFixed(Me);let xe=v.toString().split("."),Oe=xe[1];Oe&&Oe.length>Me&&Oe[Oe.length-1]==="5"&&(K=parseFloat(xe[0]+"."+Oe+"1").toFixed(Me))}else K=v.toFixed(0);(""+K).indexOf("e")!==-1&&(K=U(K))}}else if(D.locale&&X){var Me=(""+v).split(".");if(D.options){typeof Me[1]>"u"&&(Me[1]="");var Ie=Me[1].length;if(D.options.minimumFractionDigits>Ie)for(var ve=0;ve<D.options.minimumFractionDigits-Ie;ve++)Me[1]+="0"}Me[1].length?K=Me.join("."):K=Me[0];var Ie=Me[1].length;D.options&&D.options.maximumFractionDigits<Ie&&(K=parseFloat(K).toFixed(D.options.maximumFractionDigits))}else K=U(v);K!==null&&(v=K,ee.call(D,D.mask),D.options.decimal&&(v=v.replace(".",D.options.decimal)))}else D.mask&&X&&(be=!0);if(be){var Fe=D.mask.length-v.length;if(Fe>0)for(var ve=0;ve<Fe;ve++)v+=" "}if(le==="scientific")if(!X)v=U(v);else return v;if(le==="numeric"&&ue===!1&&typeof v=="string")return v;if(v=J(v,D),X&&le==="numeric"){var et=D.mask.match(new RegExp(/^[0]+$/gm));if(et&&et.length===1){var re=et[0].length;if(re>3)for(v=""+v;v.length<re;)v="0"+v}}return v},J.set=function(v,D){if(D){v.setAttribute("data-mask",D);var X=new Event("input",{bubbles:!0,cancelable:!0});v.dispatchEvent(X)}},J.extractDateFromString=function(v,D){var X=J(v,{mask:D},!0);if(v>0&&Number(v)==v&&(X.values.join("")!==X.value||X.type=="numeric")){var ue=new Date(Math.round((v-25569)*86400*1e3));return ue.getFullYear()+"-"+s.two(ue.getMonth())+"-"+s.two(ue.getDate())+" 00:00:00"}var K=!1;return X.values&&X.values.length===X.tokens.length&&X.values[X.values.length-1].length>=X.tokens[X.tokens.length-1].length&&(K=!0),X.date[0]&&X.date[1]&&(X.date[2]||K)?(X.date[2]||(X.date[2]=1),X.date[0]+"-"+s.two(X.date[1])+"-"+s.two(X.date[2])+" "+s.two(X.date[3])+":"+s.two(X.date[4])+":"+s.two(X.date[5])):""},J.getDateString=function(v,D){if(!D)var D={};if(D&&typeof D=="object"){if(D.format)var X=D.format;else if(D.mask)var X=D.mask}else var X=D;if(X||(X="YYYY-MM-DD"),X.indexOf("[h]")>=0){var ue=0;if(v&&s.isNumeric(v)&&(ue=parseFloat(24*Number(v)),X.indexOf("mm")>=0)){var K=(""+ue).split(".");if(K[1]){var le=60*parseFloat("0."+K[1]);le=parseFloat(le.toFixed(2))}else var le=0;ue=parseInt(K[0])+":"+s.two(le)}return ue}v instanceof Date?v=F.now(v):v&&s.isNumeric(v)&&(v=F.numToDate(v));for(var be=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Me=new RegExp(be.join("|"),"gi"),ve=X.match(Me),Ie=0;Ie<ve.length;Ie++)ve[Ie].toUpperCase()=="MM"&&(ve[Ie-1]&&ve[Ie-1].toUpperCase().indexOf("H")>=0||ve[Ie-2]&&ve[Ie-2].toUpperCase().indexOf("H")>=0||ve[Ie+1]&&ve[Ie+1].toUpperCase().indexOf("S")>=0||ve[Ie+2]&&ve[Ie+2].toUpperCase().indexOf("S")>=0)&&(ve[Ie]="mi");var Fe={tokens:ve};if(v){var le=""+v,et=le.indexOf("T")!==-1?"T":" ";le=le.split(et);var K=0,re=0,ye=0;le[1]&&(K=le[1].split(":"),re=K[1]?K[1]:0,ye=K[2]?K[2]:0,K=K[0]?K[0]:0),le=le[0].split("-");let ot=new Date(le[0],le[1],0).getDate();if(le[0]&&le[1]&&le[2]&&le[0]>0&&le[1]>0&&le[1]<13&&le[2]>0&&le[2]<=ot){Fe.data=[le[0],le[1],le[2],K,re,ye],Fe.value=[];for(var xe=new Date(Fe.data[0],Fe.data[1]-1,Fe.data[2],Fe.data[3],Fe.data[4],Fe.data[5]),Oe=function(ft){var nt=this.tokens[ft],lt=nt.toUpperCase(),Xe=null;lt==="YYYY"?Xe=this.data[0]:lt==="YYY"?Xe=this.data[0].substring(1,4):lt==="YY"?Xe=this.data[0].substring(2,4):lt==="Y"?Xe=this.data[0].substring(3,4):nt==="MON"?Xe=F.months[xe.getMonth()].substr(0,3).toUpperCase():nt==="mon"?Xe=F.months[xe.getMonth()].substr(0,3).toLowerCase():nt==="MONTH"?Xe=F.months[xe.getMonth()].toUpperCase():nt==="month"?Xe=F.months[xe.getMonth()].toLowerCase():lt==="MMMMM"?Xe=F.months[xe.getMonth()].substr(0,1):lt==="MMMM"||nt==="Month"?Xe=F.months[xe.getMonth()]:lt==="MMM"||nt=="Mon"?Xe=F.months[xe.getMonth()].substr(0,3):lt==="MM"?Xe=s.two(this.data[1]):lt==="M"?Xe=xe.getMonth()+1:nt==="DAY"?Xe=F.weekdays[xe.getDay()].toUpperCase():nt==="day"?Xe=F.weekdays[xe.getDay()].toLowerCase():lt==="DDDD"||nt=="Day"?Xe=F.weekdays[xe.getDay()]:lt==="DDD"?Xe=F.weekdays[xe.getDay()].substr(0,3):lt==="DD"?Xe=s.two(this.data[2]):lt==="D"?Xe=parseInt(this.data[2]):lt==="Q"?Xe=Math.floor((xe.getMonth()+3)/3):lt==="HH24"||lt==="HH"?(Xe=this.data[3],Xe>12&&this.tokens.indexOf("am/pm")!==-1&&(Xe-=12),Xe=s.two(Xe)):lt==="HH12"?this.data[3]>12?Xe=s.two(this.data[3]-12):Xe=s.two(this.data[3]):lt==="H"?(Xe=this.data[3],Xe>12&&this.tokens.indexOf("am/pm")!==-1&&(Xe-=12,Xe=s.two(Xe))):lt==="MI"?Xe=s.two(this.data[4]):lt==="SS"?Xe=s.two(this.data[5]):lt==="MS"?Xe=xe.getMilliseconds():lt==="AM/PM"?this.data[3]>=12?Xe="PM":Xe="AM":lt==="WD"&&(Xe=F.weekdays[xe.getDay()]),Xe===null?this.value[ft]=this.tokens[ft]:this.value[ft]=Xe},Ie=0;Ie<Fe.tokens.length;Ie++)Oe.call(Fe,Ie);v=Fe.value.join("")}else v=""}return v},J}var q=Z();function se(){var w=function(E,a){if(E.calendar)return E.calendar.setOptions(a,!0);var r={type:"calendar"};r.options={},r.date=null,r.setOptions=function(U,J){var v={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:F.monthsShort,monthsFull:F.months,weekdays:F.weekdays,textDone:d.translate("Done"),textReset:d.translate("Reset"),textUpdate:d.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var D in v)U&&U.hasOwnProperty(D)?r.options[D]=U[D]:(typeof r.options[D]>"u"||J===!0)&&(r.options[D]=v[D]);if(r.options.resetButton==!1?A.style.display="none":A.style.display="",r.options.readonly?E.setAttribute("readonly","readonly"):E.removeAttribute("readonly"),r.options.placeholder?E.setAttribute("placeholder",r.options.placeholder):E.removeAttribute("placeholder"),s.isNumeric(r.options.value)&&r.options.value>0&&(r.options.value=w.numToDate(r.options.value),r.options.dataType="numeric"),A.innerHTML=r.options.textReset,V.innerHTML=r.options.textDone,$e.innerHTML=r.options.textUpdate,r.options.format&&E.setAttribute("data-mask",r.options.format.toLowerCase()),!r.options.value&&r.options.today)var X=w.now();else var X=r.options.value;return X&&(r.options.value=null,r.setValue(X)),r},r.open=function(U){if(!S.classList.contains("jcalendar-focus")&&!S.classList.contains("jcalendar-inline")){if(w.current=r,P(r,!0),r.getDays(),r.options.type=="year-month-picker"&&r.getMonths(),r.options.time&&(Q.value=r.date[3],pe.value=r.date[4]),S.classList.add("jcalendar-focus"),s.getWindowWidth()<800||r.options.fullscreen)S.classList.add("jcalendar-fullsize"),O.slideBottom(ne,1);else{S.classList.remove("jcalendar-fullsize");var J=E.getBoundingClientRect(),v=ne.getBoundingClientRect();if(r.options.position)G.style.position="fixed",window.innerHeight<J.bottom+v.height?G.style.top=J.top-(v.height+2)+"px":G.style.top=J.top+J.height+2+"px",G.style.left=J.left+"px";else{if(window.innerHeight<J.bottom+v.height){var D=-1*(J.height+v.height+2);D+J.top<0&&(D=-1*(J.top+J.height)),G.style.top=D+"px"}else G.style.top="2px";if(window.innerWidth<J.left+v.width){var D=window.innerWidth-(J.left+v.width+20);G.style.left=D+"px"}else G.style.left="0px"}}typeof r.options.onopen=="function"&&r.options.onopen(E)}},r.close=function(U,J){if(r.options.autoSelect!==!0&&typeof J>"u"&&(J=!1),S.classList.contains("jcalendar-focus")){if(J!==!1){var v=S.querySelector(".jcalendar-selected");if(typeof J=="string")var D=J;else if(!v||v.classList.contains("jcalendar-disabled"))var D=r.options.value;else var D=r.getValue();r.setValue(D)}else{let X=r.options.value||"";r.options.value=null,r.setValue(X)}!U&&typeof r.options.onclose=="function"&&r.options.onclose(E),S.classList.remove("jcalendar-focus"),P(r,!1),w.current=null}return r.options.value},r.prev=function(){r.options.mode=="years"?(r.date[0]=r.date[0]-12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},r.next=function(){r.options.mode=="years"?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},r.setToday=function(){var U=new Date().toISOString().substr(0,10);return r.setValue(U),U},r.setValue=function(U){U||(U=""+U);var J=U,v=r.options.value;if(v!=J){if(J){r.setLabel(J,r.options);var X=J.split(" ");X[1]||(X[1]="00:00:00");var D=X[1].split(":"),X=X[0].split("-"),ue=parseInt(X[0]),K=parseInt(X[1]),le=parseInt(X[2]),be=parseInt(D[0]),Me=parseInt(D[1]);r.date=[ue,K,le,be,Me,0];var U=r.setLabel(J,r.options),ve=w.now(new Date(ue,K-1,le),!0);if(r.options.validRange){if(!r.options.validRange[0]||ve>=r.options.validRange[0])var Ie=!0;else var Ie=!1;if(!r.options.validRange[1]||ve<=r.options.validRange[1])var Fe=!0;else var Fe=!1;Ie&&Fe?(E.classList.remove("jcalendar_warning"),E.title=""):(E.classList.add("jcalendar_warning"),E.title=d.translate("Date outside the valid range"))}else E.classList.remove("jcalendar_warning"),E.title=""}else{r.date=null;var U="";E.classList.remove("jcalendar_warning"),E.title=""}r.options.value=J,typeof r.options.onchange=="function"&&r.options.onchange(E,J,v),E.value!=U&&(E.value=U,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))}r.date&&(r.getDays(),r.options.type=="year-month-picker"&&r.getMonths())},r.getValue=function(){return r.date?r.options.time?s.two(r.date[0])+"-"+s.two(r.date[1])+"-"+s.two(r.date[2])+" "+s.two(r.date[3])+":"+s.two(r.date[4])+":"+s.two(0):s.two(r.date[0])+"-"+s.two(r.date[1])+"-"+s.two(r.date[2])+" "+s.two(0)+":"+s.two(0)+":"+s.two(0):""},r.update=function(U,J){if(!U.classList.contains("jcalendar-disabled")){var v=S.querySelector(".jcalendar-selected");v&&v.classList.remove("jcalendar-selected"),U.classList.add("jcalendar-selected"),U.classList.contains("jcalendar-set-month")?(r.date[1]=J,r.date[2]=1):r.date[2]=U.innerText,r.options.time?(r.date[3]=Q.value,r.date[4]=pe.value):r.close(null,!0)}ee()},r.reset=function(){r.setValue(""),r.date=null,r.close(!1,!1)},r.getDays=function(){r.options.mode="days";var be=new Date,U=r.date&&s.isNumeric(r.date[0])?r.date[0]:parseInt(be.getFullYear()),J=r.date&&s.isNumeric(r.date[1])?r.date[1]:parseInt(be.getMonth())+1,v=r.date&&s.isNumeric(r.date[2])?r.date[2]:parseInt(be.getDate()),D=r.date&&s.isNumeric(r.date[3])?r.date[3]:parseInt(be.getHours()),X=r.date&&s.isNumeric(r.date[4])?r.date[4]:parseInt(be.getMinutes());r.date=[U,J,v,D,X,0],he.innerHTML=U,ce.innerHTML=r.options.months[J-1];var ue=be.getMonth()==J-1&&be.getFullYear()==U,K=be.getDate(),be=new Date(U,J,0,0,0),le=be.getDate(),be=new Date(U,J-1,0,0,0),Me=be.getDay()+1,et=r.options.startingDay||0;Me=Me-et,Ee.innerHTML="";var ve=document.createElement("tr");ve.setAttribute("align","center"),Ee.appendChild(ve);for(var Ie=0;Ie<7;Ie++){var Fe=document.createElement("td");Fe.classList.add("jcalendar-weekday"),Fe.innerHTML=r.options.weekdays[et].substr(0,1),ve.appendChild(Fe),et++,et>6&&(et=0)}for(var et=0,re=0,ye=0;ye<6;ye++){var ve=document.createElement("tr");ve.setAttribute("align","center"),ve.style.height="34px";for(var Ie=0;Ie<7;Ie++){var Fe=document.createElement("td");if(Fe.classList.add("jcalendar-set-day"),et>=Me&&et<Me+le){re++,Fe.innerHTML=re,re==v&&Fe.classList.add("jcalendar-selected"),ue&&K==re&&(Fe.style.fontWeight="bold");var xe=w.now(new Date(U,J-1,re),!0);if(r.options.validRange){if(!r.options.validRange[0]||xe>=r.options.validRange[0])var Oe=!0;else var Oe=!1;if(!r.options.validRange[1]||xe<=r.options.validRange[1])var Ge=!0;else var Ge=!1;Oe&&Ge||Fe.classList.add("jcalendar-disabled")}}ve.appendChild(Fe),et++}Ee.appendChild(ve)}r.options.time?Se.style.display="":Se.style.display="none",ee()},r.getMonths=function(){r.options.mode="months";var U=r.options.months;r.options.value;var J=new Date,v=parseInt(J.getFullYear()),D=parseInt(J.getMonth())+1,X=r.date&&s.isNumeric(r.date[0])?r.date[0]:v,ue=r.date&&s.isNumeric(r.date[1])?r.date[1]:D;he.innerHTML=r.date[0],ce.innerHTML=U[ue-1];var K=document.createElement("table");K.setAttribute("width","100%");for(var le=null,be=0;be<12;be++){if(!(be%4)){var le=document.createElement("tr");le.setAttribute("align","center"),K.appendChild(le)}var Me=document.createElement("td");if(Me.classList.add("jcalendar-set-month"),Me.setAttribute("data-value",be+1),Me.innerText=U[be],r.options.validRange){var ve=X+"-"+s.two(be+1);if(!r.options.validRange[0]||ve>=r.options.validRange[0].substr(0,7))var Ie=!0;else var Ie=!1;if(!r.options.validRange[1]||ve<=r.options.validRange[1].substr(0,7))var Fe=!0;else var Fe=!1;Ie&&Fe||Me.classList.add("jcalendar-disabled")}be+1==ue&&Me.classList.add("jcalendar-selected"),v==X&&be+1==D&&(Me.style.fontWeight="bold"),le.appendChild(Me)}Ee.innerHTML='<tr><td colspan="7"></td></tr>',Ee.children[0].children[0].appendChild(K),ee()},r.getYears=function(){r.options.mode="years";for(var U=new Date,J=U.getFullYear(),v=r.date&&s.isNumeric(r.date[0])?r.date[0]:parseInt(U.getFullYear()),D=[],X=0;X<25;X++)D[X]=parseInt(r.date[0])+(X-12);var ue=document.createElement("table");ue.setAttribute("width","100%");for(var X=0;X<25;X++){if(!(X%5)){var K=document.createElement("tr");K.setAttribute("align","center"),ue.appendChild(K)}var le=document.createElement("td");le.classList.add("jcalendar-set-year"),le.innerText=D[X],v==D[X]&&le.classList.add("jcalendar-selected"),J==D[X]&&(le.style.fontWeight="bold"),K.appendChild(le)}Ee.innerHTML='<tr><td colspan="7"></td></tr>',Ee.firstChild.firstChild.appendChild(ue),ee()},r.setLabel=function(U,J){return w.getDateString(U,J)},r.fromFormatted=function(U,J){return w.extractDateFromString(U,J)};var B=function(U){var J=s.findElement(U.target,"jcalendar-container");if(J){var v=U.target.className;if(v=="jcalendar-prev")r.prev();else if(v=="jcalendar-next")r.next();else if(v=="jcalendar-month")r.getMonths();else if(v=="jcalendar-year")r.getYears();else if(v=="jcalendar-set-year")r.date[0]=U.target.innerText,r.options.type=="year-month-picker"?r.getMonths():r.getDays();else if(U.target.classList.contains("jcalendar-set-month")){var D=parseInt(U.target.getAttribute("data-value"));r.options.type=="year-month-picker"?r.update(U.target,D):(r.date[1]=D,r.getDays())}else v=="jcalendar-confirm"||v=="jcalendar-update"||v=="jcalendar-close"?r.close(null,!0):v=="jcalendar-backdrop"?r.close(!1,!1):v=="jcalendar-reset"?r.reset():U.target.classList.contains("jcalendar-set-day")&&U.target.innerText&&r.update(U.target)}else r.close(!1,!1)},te=function(U){if(U.target.value&&U.target.value.length>3){var J=w.extractDateFromString(U.target.value,r.options.format);J&&r.setValue(J)}},ee=function(){var U=S.querySelector(".jcalendar-selected");U&&U.classList.contains("jcalendar-disabled")?($e.setAttribute("disabled","disabled"),Q.setAttribute("disabled","disabled"),pe.setAttribute("disabled","disabled")):($e.removeAttribute("disabled"),Q.removeAttribute("disabled"),pe.removeAttribute("disabled")),typeof r.options.onupdate=="function"&&r.options.onupdate(E,r.getValue())},S=null,A=null,V=null,G=null,ne=null,he=null,ce=null,fe=null,Ee=null,De=null,Se=null,qe=null,$e=null,Q=null,pe=null,we=function(){E.tagName=="INPUT"&&E.value&&(a.value=E.value),A=document.createElement("div"),A.className="jcalendar-reset",V=document.createElement("div"),V.className="jcalendar-confirm",De=document.createElement("div"),De.className="jcalendar-controls",De.style.borderBottom="1px solid #ddd",De.appendChild(A),De.appendChild(V),G=document.createElement("div"),G.className="jcalendar-container",ne=document.createElement("div"),ne.className="jcalendar-content",G.appendChild(ne),E.tagName=="DIV"?(S=E,S.classList.add("jcalendar-inline")):(ne.appendChild(De),S=document.createElement("div"),S.className="jcalendar"),S.classList.add("jcalendar-container"),S.appendChild(G);var U=document.createElement("div");U.className="jcalendar-table",ne.appendChild(U);var J=document.createElement("td");J.setAttribute("colspan","2"),J.className="jcalendar-prev",he=document.createElement("span"),he.className="jcalendar-year",ce=document.createElement("span"),ce.className="jcalendar-month";var v=document.createElement("td");v.className="jcalendar-header",v.setAttribute("colspan","3"),v.appendChild(ce),v.appendChild(he);var D=document.createElement("td");D.setAttribute("colspan","2"),D.className="jcalendar-next";var X=document.createElement("thead"),ue=document.createElement("tr");ue.appendChild(J),ue.appendChild(v),ue.appendChild(D),X.appendChild(ue),fe=document.createElement("table"),Ee=document.createElement("tbody"),fe.setAttribute("cellpadding","0"),fe.setAttribute("cellspacing","0"),fe.appendChild(X),fe.appendChild(Ee),U.appendChild(fe),Q=document.createElement("select"),Q.className="jcalendar-select",Q.onchange=function(){r.date[3]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(E,r.getValue())};for(var K=0;K<24;K++){var le=document.createElement("option");le.value=K,le.innerHTML=s.two(K),Q.appendChild(le)}pe=document.createElement("select"),pe.className="jcalendar-select",pe.onchange=function(){r.date[4]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(E,r.getValue())};for(var K=0;K<60;K++){var le=document.createElement("option");le.value=K,le.innerHTML=s.two(K),pe.appendChild(le)}var be=document.createElement("div");be.className="jcalendar-controls",Se=document.createElement("div"),Se.className="jcalendar-time",Se.style.maxWidth="140px",Se.appendChild(Q),Se.appendChild(pe),$e=document.createElement("button"),$e.setAttribute("type","button"),$e.className="jcalendar-update",qe=document.createElement("div"),qe.style.flexGrow="10",qe.appendChild($e),be.appendChild(Se),E.tagName=="INPUT"&&be.appendChild(qe),ne.appendChild(be);var Me=document.createElement("div");Me.className="jcalendar-backdrop",S.appendChild(Me),E.addEventListener("keyup",te),S.addEventListener("swipeleft",function(ve){O.slideLeft(fe,0,function(){r.next(),O.slideRight(fe,1)}),ve.preventDefault(),ve.stopPropagation()}),S.addEventListener("swiperight",function(ve){O.slideRight(fe,0,function(){r.prev(),O.slideLeft(fe,1)}),ve.preventDefault(),ve.stopPropagation()}),"ontouchend"in document.documentElement?(S.addEventListener("touchend",B),E.addEventListener("touchend",r.open)):(S.addEventListener("mouseup",B),E.addEventListener("mouseup",r.open)),w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),r.setOptions(a),E.tagName=="INPUT"?(E.parentNode.insertBefore(S,E.nextSibling),E.setAttribute("autocomplete","off"),E.classList.add("jcalendar-input"),E.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(Q.value=r.date[3],pe.value=r.date[4])),r.options.opened==!0&&r.open(),r.options.controls==!1&&G.classList.add("jcalendar-hide-controls"),E.change=r.setValue,E.val=function(ve){if(ve===void 0)return r.getValue();r.setValue(ve)},E.calendar=S.calendar=r};return we(),r};return w.keydown=function(E){var a=null;(a=w.current)&&(E.which==13?a.close(!1,!0):E.which==27&&a.close(!1,!1))},w.prettify=function(E,a){if(!a)var a={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};E.indexOf("GMT")===-1&&E.indexOf("Z")===-1&&(E+=" GMT");var r=new Date,B=new Date(E),te=parseInt((r-B)/1e3/60);if(String.prototype.format=function(S){return this.replace("{0}",S)},te==0)var ee=a.justNow;else if(te<90)var ee=a.xMinutesAgo.format(te);else if(te<1440)var ee=a.xHoursAgo.format(Math.round(te/60));else if(te<20160)var ee=a.xDaysAgo.format(Math.round(te/1440));else if(te<43200)var ee=a.xWeeksAgo.format(Math.round(te/10080));else if(te<1036800)var ee=a.xMonthsAgo.format(Math.round(te/43200));else var ee=a.xYearsAgo.format(Math.round(te/525600));return ee},w.prettifyAll=function(){for(var E=document.querySelectorAll(".prettydate"),a=0;a<E.length;a++)E[a].getAttribute("data-date")?E[a].innerHTML=w.prettify(E[a].getAttribute("data-date")):E[a].innerHTML&&(E[a].setAttribute("title",E[a].innerHTML),E[a].setAttribute("data-date",E[a].innerHTML),E[a].innerHTML=w.prettify(E[a].innerHTML))},w.now=F.now,w.toArray=F.toArray,w.dateToNum=F.dateToNum,w.numToDate=F.numToDate,w.weekdays=F.weekdays,w.months=F.months,w.weekdaysShort=F.weekdaysShort,w.monthsShort=F.monthsShort,w.extractDateFromString=q.extractDateFromString,w.getDateString=q.getDateString,w}var ge=se();function ae(){var w={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},E=function(a){return w[a]?w[a]:w.material};return E.get=function(a){return w[a]?w[a]:w},E.set=function(a,r){w[a]=r},E}var me=ae();function Le(w,E){var a={};a.options={};var r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var B in r)E&&E.hasOwnProperty(B)?a.options[B]=E[B]:a.options[B]=r[B];w.classList.add("jtabs");var te=null,ee=null,S=null;const A=function(ce){a.options.animation&&setTimeout(function(){let fe=a.headers.children[ce].getBoundingClientRect();a.options.palette==="modern"?(S.style.width=fe.width-4+"px",S.style.left=a.headers.children[ce].offsetLeft+2+"px"):(S.style.width=fe.width+"px",S.style.left=a.headers.children[ce].offsetLeft+"px"),a.options.position==="bottom"?S.style.top="0px":S.style.bottom="0px"},50)};var V=function(ce){typeof a.headers.scrollTo=="function"?a.headers.scrollTo({left:ce,behavior:"smooth"}):a.headers.scrollLeft=ce,ce<=1?te.classList.add("disabled"):te.classList.remove("disabled"),ce>=a.headers.scrollWidth-a.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),a.headers.scrollWidth<=a.headers.offsetWidth?(te.style.display="none",ee.style.display="none"):(te.style.display="",ee.style.display="")};if(a.setBorder=A,a.open=function(ce){if(Array.from(a.content.children),!!a.content.children[ce]){for(var fe=null,Ee=0;Ee<a.headers.children.length;Ee++)a.headers.children[Ee].classList.contains("jtabs-selected")&&(fe=Ee),a.headers.children[Ee].classList.remove("jtabs-selected"),a.headers.children[Ee].removeAttribute("aria-selected"),a.content.children[Ee]&&a.content.children[Ee].classList.remove("jtabs-selected");if(a.headers.children[ce].classList.add("jtabs-selected"),a.headers.children[ce].setAttribute("aria-selected","true"),a.content.children[ce]&&a.content.children[ce].classList.add("jtabs-selected"),fe!=ce&&typeof a.options.onchange=="function"&&a.content.children[ce]&&a.options.onchange(w,a,ce,a.headers.children[ce],a.content.children[ce]),a.options.hideHeaders==!0&&a.headers.children.length<3&&a.options.allowCreate==!1)a.headers.parentNode.style.display="none";else{a.headers.parentNode.style.display="";var De=a.headers.children[ce].offsetLeft,Se=De+a.headers.children[ce].offsetWidth,qe=a.headers.scrollLeft,$e=qe+a.headers.offsetWidth;qe<=De&&$e>=Se||V(De-1),A(ce)}}},a.selectIndex=function(ce){var fe=Array.prototype.indexOf.call(a.headers.children,ce);return fe>=0&&a.open(fe),fe},a.rename=function(ce,fe){fe||(fe=prompt("New title",a.headers.children[ce].innerText)),a.headers.children[ce].innerText=fe,A(a.getActive())},a.create=function(ce,fe){if(typeof a.options.onbeforecreate=="function"){var Ee=a.options.onbeforecreate(w,ce);if(Ee===!1)return!1;ce=Ee}var De=a.appendElement(ce);return typeof a.options.oncreate=="function"&&a.options.oncreate(w,De),A(a.getActive()),De},a.remove=function(ce){return a.deleteElement(ce)},a.nextNumber=function(){for(var ce=0,fe=0;fe<a.headers.children.length;fe++){var Ee=a.headers.children[fe].innerText.match(/[0-9].*/);Ee>ce&&(ce=parseInt(Ee))}return ce?ce++:ce=1,ce},a.deleteElement=function(ce){let fe=a.getActive();if(a.headers.children[ce])a.headers.removeChild(a.headers.children[ce]),a.content.removeChild(a.content.children[ce]);else return!1;if(fe===ce)a.open(0);else{let Ee=a.getActive()||0;A(Ee)}typeof a.options.ondelete=="function"&&a.options.ondelete(w,ce)},a.appendElement=function(ce,fe,Ee,De){if(!ce)var ce=prompt("Title?","");if(ce){let $e=s.guid(),Q=s.guid();var Se=document.createElement("div");Se.setAttribute("id",Q),Se.setAttribute("role","tabpanel"),Se.setAttribute("aria-labelledby",$e);var qe=document.createElement("div");if(qe.setAttribute("id",$e),qe.setAttribute("role","tab"),qe.setAttribute("aria-controls",Q),qe.innerHTML=ce,qe.content=Se,typeof De>"u")a.content.appendChild(Se),a.headers.insertBefore(qe,a.headers.lastChild);else{let pe=a.content.children[De];pe?a.content.insertBefore(Se,pe):a.content.appendChild(Se),pe=a.headers.children[De]||a.headers.lastChild,a.headers.insertBefore(qe,pe)}return a.options.allowChangePosition&&qe.setAttribute("draggable","true"),Ee!==!1&&a.selectIndex(qe),typeof fe=="function"&&fe(Se,qe),Se}},a.getActive=function(){for(var ce=0;ce<a.headers.children.length;ce++)if(a.headers.children[ce].classList.contains("jtabs-selected"))return ce;return!1},a.updateContent=function(ce,fe){if(typeof fe!="string")var Ee=fe;else{var Ee=document.createElement("div");Ee.innerHTML=fe}a.content.children[ce].classList.contains("jtabs-selected")&&fe.classList.add("jtabs-selected"),a.content.replaceChild(fe,a.content.children[ce]),A()},a.updatePosition=function(ce,fe,Ee,De){if(ce>fe?a.content.insertBefore(a.content.children[ce],a.content.children[fe]):a.content.insertBefore(a.content.children[ce],a.content.children[fe].nextSibling),De!==!1)a.open(fe);else{const Se=a.getActive();fe<Se&&a.setBorder(Se)}!Ee&&typeof a.options.onchangeposition=="function"&&a.options.onchangeposition(a.headers,ce,fe)},a.move=function(ce,fe,Ee,De){ce>fe?a.headers.insertBefore(a.headers.children[ce],a.headers.children[fe]):a.headers.insertBefore(a.headers.children[ce],a.headers.children[fe].nextSibling),a.updatePosition(ce,fe,Ee,De)},a.setBorder=A,a.init=function(){w.innerHTML="",a.headers=document.createElement("div"),a.content=document.createElement("div"),a.headers.classList.add("jtabs-headers"),a.headers.setAttribute("role","tablist"),a.content.classList.add("jtabs-content"),a.content.setAttribute("role","region"),a.content.setAttribute("aria-label","Tab Panels"),a.options.palette?w.classList.add("jtabs-modern"):w.classList.remove("jtabs-modern"),a.options.padding&&(a.content.style.padding=parseInt(a.options.padding)+"px");var ce=document.createElement("div");ce.className="jtabs-headers-container",ce.appendChild(a.headers),a.options.maxWidth&&(ce.style.maxWidth=parseInt(a.options.maxWidth)+"px");var fe=document.createElement("div");if(fe.className="jtabs-controls",fe.setAttribute("draggable","false"),ce.appendChild(fe),a.options.position=="bottom"?(w.appendChild(a.content),w.appendChild(ce)):(w.appendChild(ce),w.appendChild(a.content)),a.options.allowCreate==!0){var Ee=document.createElement("div");Ee.className="jtabs-add",Ee.onclick=function(){a.create()},fe.appendChild(Ee)}te=document.createElement("div"),te.className="jtabs-prev",te.onclick=function(){V(a.headers.scrollLeft-a.headers.offsetWidth)},fe.appendChild(te),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){V(a.headers.scrollLeft+a.headers.offsetWidth)},fe.appendChild(ee);for(var De=0;De<a.options.data.length;De++){if(a.options.data[De].titleElement)var Se=a.options.data[De].titleElement;else var Se=document.createElement("div");if(a.options.data[De].icon){var qe=document.createElement("div"),$e=document.createElement("i");$e.classList.add("material-icons"),$e.innerHTML=a.options.data[De].icon,qe.appendChild($e),Se.appendChild(qe)}if(a.options.data[De].title){var Q=document.createTextNode(a.options.data[De].title);Se.appendChild(Q)}if(a.options.data[De].width&&(Se.style.width=a.options.data[De].width),a.options.data[De].contentElement)var pe=a.options.data[De].contentElement;else{var pe=document.createElement("div");pe.innerHTML=a.options.data[De].content}a.headers.appendChild(Se),a.content.appendChild(pe)}S=document.createElement("div"),S.className="jtabs-border",a.headers.appendChild(S),a.options.animation&&w.classList.add("jtabs-animation"),a.headers.addEventListener("click",function(we){if(we.target.parentNode.classList.contains("jtabs-headers"))var U=we.target;else if(we.target.tagName=="I")var U=we.target.parentNode.parentNode;else var U=we.target.parentNode;var J=a.selectIndex(U);typeof a.options.onclick=="function"&&a.options.onclick(w,a,J,a.headers.children[J],a.content.children[J])}),a.headers.addEventListener("contextmenu",function(we){a.selectIndex(we.target)}),a.headers.children.length&&a.open(0),V(0),a.options.allowChangePosition==!0&&h(a.headers,{direction:1,ondrop:function(we,U,J){a.updatePosition(U,J)}}),typeof a.options.onload=="function"&&a.options.onload(w,a)},w.children[0]&&w.children[0].children.length)for(var G=0;G<w.children[0].children.length;G++){var ne=a.options.data&&a.options.data[G]?a.options.data[G]:{};w.children[1]&&w.children[1].children[G]?(ne.titleElement=w.children[0].children[G],ne.contentElement=w.children[1].children[G]):ne.contentElement=w.children[0].children[G],a.options.data[G]=ne}var he=!1;if(a.options.data)for(var G=0;G<a.options.data.length;G++)a.options.data[G].url&&(I({url:a.options.data[G].url,type:"GET",dataType:"text/html",index:G,success:function(fe){a.options.data[this.index].content=fe},complete:function(){a.init()}}),he=!0);return he||a.init(),w.tabs=a,a}function je(w,E){if(w.color)return w.color.setOptions(E,!0);var a={type:"color"};a.options={};var r=null,B=null,te=null,ee=null,S=null,A=null,V=null;a.setOptions=function(v,D){var X={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};v||(v={}),v&&!v.palette&&(v.palette=me());for(var ue in X)v&&v.hasOwnProperty(ue)?a.options[ue]=v[ue]:(typeof a.options[ue]>"u"||D===!0)&&(a.options[ue]=X[ue]);return ee&&(ee.innerHTML=a.options.resetLabel),S&&(S.innerHTML=a.options.doneLabel),a.options.palette&&V&&V.updateContent(0,fe()),typeof a.options.value=="string"&&(w.value=a.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value)),a.options.placeholder?w.setAttribute("placeholder",a.options.placeholder):w.getAttribute("placeholder")&&w.removeAttribute("placeholder"),a},a.select=function(v){var D=r.querySelector(".jcolor-selected");D&&D.classList.remove("jcolor-selected"),a.values[v]&&a.values[v].classList.add("jcolor-selected"),a.options.value=v},a.open=function(){if(!r.classList.contains("jcolor-focus")){P(a,!0),r.classList.add("jcolor-focus"),a.options.value&&a.select(a.options.value),te.style.marginTop="",te.style.marginLeft="";var v=te.getBoundingClientRect(),D=s.getWindowWidth(),X=s.getWindowHeight();if(D<800||a.options.fullscreen==!0?(te.classList.add("jcolor-fullscreen"),O.slideBottom(te,1),B.style.display="block"):(te.classList.contains("jcolor-fullscreen")&&(te.classList.remove("jcolor-fullscreen"),B.style.display=""),a.options.position?te.style.position="fixed":te.style.position="",v.left+v.width>D&&(te.style.marginLeft=-1*(v.left+v.width-(D-20))+"px"),v.top+v.height>X&&(te.style.marginTop=-1*(v.top+v.height-(X-20))+"px")),typeof a.options.onopen=="function"&&a.options.onopen(w,a),V.setBorder(V.getActive()),a.options.value){var ue=ce(a.options.value);pe.forEach(function(K,le){K.value=ue[le],K.dispatchEvent(new Event("input"))})}}},a.close=function(v){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),B.style.display="",!v&&typeof a.options.onclose=="function"&&a.options.onclose(w,a),P(a,!1)),a.options.value},a.setValue=function(v){v||(v=""),v!=a.options.value&&(a.options.value=v,Q=v,a.select(v),typeof a.options.onchange=="function"&&a.options.onchange(w,v,a),w.value!=a.options.value&&(w.value=a.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value),typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),a.options.closeOnChange==!0&&a.close())},a.getValue=function(){return a.options.value};var G=function(v){var D=v.toString(16);return D.length===1?"0"+D:D},ne=function(v,D,X){return"#"+G(v)+G(D)+G(X)},he=function(v){return parseInt("0x"+v)},ce=function(v){return[he(v.substr(1,2)),he(v.substr(3,2)),he(v.substr(5,2))]},fe=function(){var v=document.createElement("div");v.className="jcolor-grid",a.values=[];var D=document.createElement("table");D.setAttribute("cellpadding","7"),D.setAttribute("cellspacing","0");for(var X=0;X<a.options.palette.length;X++){for(var ue=document.createElement("tr"),K=0;K<a.options.palette[X].length;K++){var le=document.createElement("td"),be=a.options.palette[X][K];be.length<7&&be.substr(0,1)!=="#"&&(be="#"+be),le.style.backgroundColor=be,le.setAttribute("data-value",be),le.innerHTML="",ue.appendChild(le),a.options.value==be&&le.classList.add("jcolor-selected"),a.values[be]=le}D.appendChild(ue)}return v.appendChild(D),v},Ee=document.createElement("canvas");Ee.width=200,Ee.height=160;var De=Ee.getContext("2d"),Se=function(){var v=A.firstChild.getBoundingClientRect();Ee.width=v.width-14,qe()},qe=function(){var v=De.createLinearGradient(0,0,Ee.width,0);v.addColorStop(0,"rgb(255,0,0)"),v.addColorStop(.15,"rgb(255,0,255)"),v.addColorStop(.33,"rgb(0,0,255)"),v.addColorStop(.49,"rgb(0,255,255)"),v.addColorStop(.67,"rgb(0,255,0)"),v.addColorStop(.84,"rgb(255,255,0)"),v.addColorStop(1,"rgb(255,0,0)"),De.fillStyle=v,De.fillRect(0,0,Ee.width,Ee.height),v=De.createLinearGradient(0,0,0,Ee.height),v.addColorStop(0,"rgba(255,255,255,1)"),v.addColorStop(.5,"rgba(255,255,255,0)"),v.addColorStop(.5,"rgba(0,0,0,0)"),v.addColorStop(1,"rgba(0,0,0,1)"),De.fillStyle=v,De.fillRect(0,0,Ee.width,Ee.height)},$e=function(){var v=document.createElement("div");v.className="jcolor-hsl";var D=document.createElement("div");D.className="jcolor-point";var X=document.createElement("div");X.appendChild(Ee),X.appendChild(D),v.appendChild(X);var ue=function(K,le,be){if(K===1){var Me=v.getBoundingClientRect(),ve=le-Me.left,Ie=be-Me.top;ve<0&&(ve=0),Ie<0&&(Ie=0),ve>Me.width&&(ve=Me.width),Ie>Me.height&&(Ie=Me.height),D.style.left=ve+"px",D.style.top=Ie+"px";var Fe=De.getImageData(ve,Ie,1,1).data;Q=ne(Fe[0],Fe[1],Fe[2])}};return v.addEventListener("mousedown",function(K){ue(K.buttons,K.clientX,K.clientY)}),v.addEventListener("mousemove",function(K){ue(K.buttons,K.clientX,K.clientY)}),v.addEventListener("touchmove",function(K){ue(1,K.changedTouches[0].clientX,K.changedTouches[0].clientY)}),v},Q="",pe=[],we=function(){if(Q!=="")for(var v=0;v<pe.length;v++){var D=ce(Q);D[v]=0;var X="linear-gradient(90deg, rgb(";X+=D.join(", "),X+="), rgb(",D[v]=255,X+=D.join(", "),X+="))",pe[v].style.backgroundImage=X}},U=function(){var v=document.createElement("div");v.className="jcolor-sliders";var D=document.createElement("div"),X=function(be){var Me=document.createElement("div");Me.className="jcolor-sliders-input-container";var ve=document.createElement("label");ve.innerText=be;var Ie=document.createElement("div");Ie.className="jcolor-sliders-input-subcontainer";var Fe=document.createElement("input");Fe.type="range",Fe.min=0,Fe.max=255,Fe.value=0,Fe.setAttribute("aria-label","Color value"),Fe.setAttribute("aria-valuemin","0"),Fe.setAttribute("aria-valuemax","255"),Fe.setAttribute("aria-valuenow","0"),Me.appendChild(ve),Ie.appendChild(Fe);var et=document.createElement("div");return et.innerText=Fe.value,Fe.addEventListener("input",function(){et.innerText=Fe.value}),Ie.appendChild(et),Me.appendChild(Ie),D.appendChild(Me),Fe};pe=[X("Red"),X("Green"),X("Blue")],v.appendChild(D);var ue=document.createElement("div");ue.className="jcolor-sliders-final-color";var K=document.createElement("div");K.style.visibility="hidden",K.innerText="a",ue.appendChild(K);var le=function(){var be=ne(parseInt(pe[0].value),parseInt(pe[1].value),parseInt(pe[2].value));K.innerText=be,K.style.color=be,K.style.removeProperty("visibility"),Q=be};return pe.forEach(function(be){be.addEventListener("input",function(){le(),we()})}),v.appendChild(ue),v},J=function(){a.setOptions(E),w.tagName=="INPUT"&&(w.classList.add("jcolor-input"),w.readOnly=!0),r=document.createElement("div"),r.className="jcolor",B=document.createElement("div"),B.className="jcolor-backdrop",r.appendChild(B),te=document.createElement("div"),te.className="jcolor-content";var v=document.createElement("div");v.className="jcolor-controls",te.appendChild(v),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=a.options.resetLabel,v.appendChild(ee),S=document.createElement("div"),S.className="jcolor-close",S.innerHTML=a.options.doneLabel,v.appendChild(S),A=document.createElement("div"),te.appendChild(A),V=Le(A,{animation:!0,data:[{title:"Grid",contentElement:fe()},{title:"Spectrum",contentElement:$e()},{title:"Sliders",contentElement:U()}],onchange:function(D,X,ue){if(ue===1)Se();else{var K=Q!==""?Q:a.getValue();if(ue===2&&K){var le=ce(K);pe.forEach(function(be,Me){be.value=le[Me],be.dispatchEvent(new Event("input"))})}}},palette:"modern"}),r.appendChild(te),w.tagName=="INPUT"?w.parentNode.insertBefore(r,w.nextSibling):w.appendChild(r),r.addEventListener("click",function(D){if(D.target.tagName=="TD"){var X=D.target.getAttribute("data-value");X&&a.setValue(X)}else D.target.classList.contains("jcolor-reset")?(a.setValue(""),a.close()):D.target.classList.contains("jcolor-close")?(V.getActive()>0&&a.setValue(Q),a.close()):D.target.classList.contains("jcolor-backdrop")?a.close():a.open()}),w.addEventListener("mouseup",function(D){a.open()}),window.addEventListener("resize",function(){r.classList.contains("jcolor-focus")&&V.getActive()==1&&Se()}),a.options.opened==!0&&a.open(),w.change=a.setValue,w.val=function(D){if(D===void 0)return a.getValue();a.setValue(D)},w.color=a,r.color=a};return a.toHex=function(v){var D=function(X){return("0"+parseInt(X).toString(16)).slice(-2)};if(v)return/^#[0-9A-F]{6}$/i.test(v)?v:(v=v.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),v&&v.length?"#"+D(v[1])+D(v[2])+D(v[3]):"")},J(),a}function ie(){var w=function(E,a){var r={type:"contextmenu"};r.options={};var B={items:null,onclick:null};for(var te in B)a&&a.hasOwnProperty(te)?r.options[te]=a[te]:r.options[te]=B[te];E.classList.add("jcontextmenu"),r.open=function(A,V){if(V&&(r.options.items=V,r.create(V)),w.current&&w.current.close(),P(r,!0),E.classList.add("jcontextmenu-focus"),w.current=r,r.options.items&&r.options.items.length>0||E.children.length){if(A.target)if(A.changedTouches&&A.changedTouches[0])G=A.changedTouches[0].clientX,ne=A.changedTouches[0].clientY;else var G=A.clientX,ne=A.clientY;else var G=A.x,ne=A.y;var he=E.getBoundingClientRect();if(window.innerHeight<ne+he.height){var ce=ne-he.height;ce<0&&(ce=0),E.style.top=ce+"px"}else E.style.top=ne+"px";window.innerWidth<G+he.width?G-he.width>0?E.style.left=G-he.width+"px":E.style.left="10px":E.style.left=G+"px"}},r.isOpened=function(){return!!E.classList.contains("jcontextmenu-focus")},r.close=function(){E.classList.contains("jcontextmenu-focus")&&E.classList.remove("jcontextmenu-focus"),P(r,!1)},r.create=function(A){E.innerHTML="";var V=ee();E.appendChild(V);for(var G=0;G<A.length;G++){var ne=S(A[G]);E.appendChild(ne)}};function ee(){var A=document.createElement("div");A.classList.add("header"),A.addEventListener("click",function(ne){ne.preventDefault(),ne.stopPropagation()});var V=document.createElement("a");V.classList.add("title"),V.innerHTML=d.translate("Menu"),A.appendChild(V);var G=document.createElement("a");return G.classList.add("close"),G.innerHTML=d.translate("close"),G.addEventListener("click",function(ne){r.close()}),A.appendChild(G),A}function S(A){if(A.type&&(A.type=="line"||A.type=="divisor"))var V=document.createElement("hr");else{var V=document.createElement("div"),G=document.createElement("a");if(G.innerHTML=A.title,A.tooltip&&V.setAttribute("title",A.tooltip),A.icon&&V.setAttribute("data-icon",A.icon),A.id&&(V.id=A.id),A.disabled?V.className="jcontextmenu-disabled":A.onclick&&(V.method=A.onclick,V.addEventListener("mousedown",function(qe){qe.preventDefault()}),V.addEventListener("mouseup",function(qe){this.method(this,qe)})),V.appendChild(G),A.submenu){var ne=document.createElement("span");ne.innerHTML="&#9658;",V.appendChild(ne),V.classList.add("jcontexthassubmenu");var he=document.createElement("div");he.classList.add("jcontextmenu"),he.setAttribute("tabindex","900");for(var ce=A.submenu,fe=0;fe<ce.length;fe++){var Ee=S(ce[fe]);he.appendChild(Ee)}V.appendChild(he)}else if(A.shortcut){var De=document.createElement("span");De.innerHTML=A.shortcut,V.appendChild(De)}}return V}return typeof r.options.onclick=="function"&&E.addEventListener("click",function(A){r.options.onclick(r,A)}),r.options.items&&r.create(r.options.items),window.addEventListener("mousewheel",function(){r.close()}),E.contextmenu=r,r};return w}var _e=ie();function Ye(){var w=function(E,a){if(E.dropdown)return E.dropdown.setOptions(a,!0);var r={type:"dropdown"};r.options={};var B=function(U,J){U&&U.length&&(r.options.sortResults!==!1&&(typeof r.options.sortResults=="function"?U.sort(r.options.sortResults):U.sort(te)),r.setData(U)),typeof r.options.onload=="function"&&r.options.onload(E,r,U,J),J&&S(J),J==null&&(r.options.value=""),E.value=r.options.value,r.options.opened==!0&&r.open()},te=function(U,J){var v,D;return typeof U=="string"?v=U:U.text?v=U.text:U.name&&(v=U.name),typeof J=="string"?D=J:J.text?D=J.text:J.name&&(D=J.name),typeof v=="string"||typeof D=="string"?(typeof v!="string"&&(v=""+v),typeof D!="string"&&(D=""+D),v.localeCompare(D)):v-D},ee=function(){r.value={};for(var U=0;U<r.items.length;U++)r.items[U].selected==!0&&(r.items[U].element&&r.items[U].element.classList.remove("jdropdown-selected"),r.items[U].selected=null);r.options.value="",E.value=""},S=function(U){if(ee(),U!==null)if(!U)typeof r.value[""]<"u"&&(r.value[""]="");else{Array.isArray(U)||(U=(""+U).split(";"));for(var J=0;J<U.length;J++)r.value[U[J]]=""}for(var J=0;J<r.items.length;J++)typeof r.value[A(J)]<"u"&&(r.items[J].element&&r.items[J].element.classList.add("jdropdown-selected"),r.items[J].selected=!0,r.value[A(J)]=V(J));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},A=function(U,J){if(r.options.format)var v="id";else var v="value";return r.items[U]?r.items[U].data[v]:""},V=function(U,J){if(r.options.format)var v="name";else var v="text";return r.items[U]?r.items[U].data[v]:""},G=function(){return Object.keys(r.value)},ne=function(){for(var U=[],J=Object.keys(r.value),v=0;v<J.length;v++)U.push(r.value[J[v]]);return U};r.setOptions=function(U,J){U||(U={});var v={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var D in v)U&&U.hasOwnProperty(D)?r.options[D]=U[D]:(typeof r.options[D]>"u"||J===!0)&&(r.options[D]=v[D]);return(r.options.remoteSearch==!0||r.options.type==="searchbar")&&(r.options.autocomplete=!0),r.options.newOptions==!0?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),r.options.autocomplete==!0?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),E.classList.remove("jdropdown-searchbar"),E.classList.remove("jdropdown-picker"),E.classList.remove("jdropdown-list"),r.options.type=="searchbar"?E.classList.add("jdropdown-searchbar"):r.options.type=="list"?E.classList.add("jdropdown-list"):r.options.type=="picker"?E.classList.add("jdropdown-picker"):s.getWindowWidth()<800?r.options.autocomplete?(E.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(E.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(E.style.width=r.options.width,E.style.minWidth=r.options.width):(E.style.removeProperty("width"),E.style.removeProperty("min-width")),E.classList.add("jdropdown-default"),r.options.type="default"),r.options.type=="searchbar"?he.appendChild(Ee):ce.insertBefore(Ee,ce.firstChild),r.options.url&&!U.data?I({url:r.options.url,method:"GET",dataType:"json",success:function(X){X&&B(X,r.options.value)}}):B(r.options.data,r.options.value),r};var he=null,ce=null,fe=null,Ee=null,De=null,Se=null,qe=null,$e=function(){if(a||(a={}),E.tagName=="SELECT"){var U=w.extractFromDom(E,a);E=U.el,a=U.options}!a.placeholder&&E.getAttribute("placeholder")&&(a.placeholder=E.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,E.classList.add("jdropdown"),he=document.createElement("div"),he.className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header jss_object",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){typeof r.options.onfocus=="function"&&r.options.onfocus(E)},r.header.onblur=function(){typeof r.options.onblur=="function"&&r.options.onblur(E)},r.header.onkeyup=function(J){r.options.autocomplete==!0&&!qe?(r.search!=r.header.value.trim()&&(qe=setTimeout(function(){r.find(r.header.value.trim()),qe=null},400)),E.classList.contains("jdropdown-focus")||r.open()):r.options.autocomplete||r.next(J.key)},w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),ce=document.createElement("div"),ce.className="jdropdown-container",fe=document.createElement("div"),fe.className="jdropdown-content",Ee=document.createElement("div"),Ee.className="jdropdown-close",Ee.textContent="Done",De=document.createElement("div"),De.className="jdropdown-reset",De.textContent="x",De.onclick=function(){r.reset(),r.close()},Se=document.createElement("div"),Se.className="jdropdown-backdrop",he.appendChild(r.header),ce.appendChild(fe),E.appendChild(he),E.appendChild(ce),E.appendChild(Se),r.setOptions(a),"ontouchsend"in document.documentElement?E.addEventListener("touchsend",w.mouseup):E.addEventListener("mouseup",w.mouseup),r.options.lazyLoading==!0&&C(fe,{loadUp:r.loadUp,loadDown:r.loadDown}),fe.onwheel=function(J){J.stopPropagation()},E.change=r.setValue,E.val=function(J){if(J===void 0)return r.getValue(!!r.options.multiple);r.setValue(J)},E.dropdown=r};r.getUrl=function(){return r.options.url},r.setUrl=function(U,J){r.options.url=U,I({url:r.options.url,method:"GET",dataType:"json",success:function(v){r.setData(v),typeof J=="function"&&J(r)}})},r.setId=function(U,J){if(r.options.format)var v="id";else var v="value";typeof U=="object"?U[v]=J:r.items[U].data[v]=J};const Q=function(U,J){if(!U){let X=r.options.autocomplete==!0?r.header.value:"";if(U=prompt(d.translate("Add A New Option"),X),!U)return!1}if(J||(J=s.guid()),r.options.format)var v={id:J,name:U};else var v={value:J,text:U};if(typeof r.options.onbeforeinsert=="function"){let X=r.options.onbeforeinsert(r,v);if(X===!1)return!1;X&&(v=X)}r.options.data.push(v);var D=r.createItem(v);return fe.appendChild(D.element),typeof r.options.oninsert=="function"&&r.options.oninsert(r,v,D),fe.style.display=="none"&&(fe.style.display=""),r.results&&r.results.push(D),v};r.add=function(U,J){return typeof r.options.prompt=="function"?r.options.prompt.call(r,Q):Q(U,J)},r.createItem=function(U,J,v){r.options.format?(!U.id&&U.value!==void 0&&(U.id=U.value),!U.name&&U.text!==void 0&&(U.name=U.text)):(!U.value&&U.id!==void 0&&(U.value=U.id),!U.text&&U.name!==void 0&&(U.text=U.name));var D={};if(D.element=document.createElement("div"),D.element.className="jdropdown-item",D.element.indexValue=r.items.length,D.data=U,J&&(D.group=J),U.id&&D.element.setAttribute("id",U.id),U.disabled==!0&&D.element.setAttribute("data-disabled",!0),U.tooltip&&D.element.setAttribute("title",U.tooltip),U.image){var X=document.createElement("img");X.className="jdropdown-image",X.src=U.image,U.title||X.classList.add("jdropdown-image-small"),D.element.appendChild(X)}else if(U.icon){var ue=document.createElement("span");ue.className="jdropdown-icon material-icons",ue.innerText=U.icon,U.title||ue.classList.add("jdropdown-icon-small"),U.color&&(ue.style.color=U.color),D.element.appendChild(ue)}else if(U.color){var K=document.createElement("div");K.className="jdropdown-color",K.style.backgroundColor=U.color,D.element.appendChild(K)}if(r.options.format)var le=U.name;else var le=U.text;var be=document.createElement("div");if(be.className="jdropdown-description",be.textContent=le||"&nbsp;",U.title){var Me=document.createElement("div");Me.className="jdropdown-title",Me.innerText=U.title,be.appendChild(Me)}if(r.options.format)var ve=U.id;else var ve=U.value;return r.value[ve]&&(D.element.classList.add("jdropdown-selected"),D.selected=!0),r.items.push(D),D.element.appendChild(be),D},r.appendData=function(U){if(U.length){for(var J=[],v=[],D=0;D<U.length;D++)U[D].group?(v[U[D].group]||(v[U[D].group]=[]),v[U[D].group].push(D)):J.push(D);var X=0,ue=Object.keys(v);if(ue.length>0)for(var D=0;D<ue.length;D++){var K=document.createElement("div");K.className="jdropdown-group";var le=document.createElement("div");le.className="jdropdown-group-name",le.textContent=ue[D];var be=document.createElement("i");be.className="jdropdown-group-arrow jdropdown-group-arrow-down",le.appendChild(be);var Me=document.createElement("div");Me.className="jdropdown-group-items";for(var ve=0;ve<v[ue[D]].length;ve++){var Ie=r.createItem(U[v[ue[D]][ve]],K,ue[D]);(r.options.lazyLoading==!1||X<200)&&(Me.appendChild(Ie.element),X++)}K.appendChild(le),K.appendChild(Me),r.groups.push(K),Me.children.length>0&&fe.appendChild(K)}if(J.length)for(var D=0;D<J.length;D++){var Ie=r.createItem(U[J[D]]);(r.options.lazyLoading==!1||X<200)&&(fe.appendChild(Ie.element),X++)}}},r.setData=function(U){if(ee(),fe.textContent="",r.header.value="",r.items=[],U&&U.length){for(var J=0;J<U.length;J++)typeof U[J]!="object"&&(r.options.format?U[J]={id:U[J],name:U[J]}:U[J]={value:U[J],text:U[J]});r.appendData(U),r.options.data=U}else r.options.data=[];r.close()},r.getData=function(){return r.options.data},r.getPosition=function(U){for(var J=0;J<r.items.length;J++)if(A(J)==U)return J;return!1},r.getText=function(U){var J=ne();return U?J:J.join("; ")},r.getValue=function(U){var J=G();return U?J:J.join(";")};var pe=function(U){E.value!=r.options.value&&(E.value=r.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),typeof r.options.onchange=="function"&&r.options.onchange(E,r,U,r.options.value)};r.setValue=function(U){var J=r.getValue();Array.isArray(U)&&(U=U.join(";")),J!==U&&(S(U),pe(J))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(v,J){var v=parseInt(v);if(r.items&&r.items[v]&&(J===!0||r.items[v].data.disabled!==!0))if(r.setCursor(v,!1),!r.options.multiple)r.items[v].selected?r.options.allowEmpty!==!1&&r.setValue(null):r.setValue(A(v)),r.close();else{var D=r.options.value;r.items[v].selected?(r.items[v].element.classList.remove("jdropdown-selected"),r.items[v].selected=!1,delete r.value[A(v)]):(r.items[v].element.classList.add("jdropdown-selected"),r.items[v].selected=!0,r.value[A(v)]=V(v)),r.options.value=Object.keys(r.value).join(";"),r.options.autocomplete==!1&&(r.header.value=ne().join("; ")),pe(D)}},r.selectItem=function(U){r.selectIndex(U.indexValue)};var we=function(U,J){for(var v=0;v<J.length;v++)if(r.options.format){if(J[v].id==U)return!0}else if(J[v].value==U)return!0;return!1};return r.find=function(U){if(r.search==U.trim())return!1;if(r.search=U,r.setCursor(),r.groups.length)for(var J=0;J<r.groups.length;J++)r.groups[J].lastChild.textContent="";if(fe.textContent="",r.options.remoteSearch==!0){r.results=null;var v=r.options.url;let Me={url:v,method:"GET",data:{q:U},dataType:"json",success:function(ve){r.items=[];var Ie=Object.keys(r.value);if(Ie.length)for(var Fe=0;Fe<Ie.length;Fe++)we(Ie[Fe],ve)||(r.options.format?ve.unshift({id:Ie[Fe],name:r.value[Ie[Fe]]}):ve.unshift({value:Ie[Fe],text:r.value[Ie[Fe]]}));r.appendData(ve),ve.length?fe.style.display="":fe.style.display="none",typeof r.options.onsearch=="function"&&r.options.onsearch(r,ve)}};if(typeof r.options.onbeforesearch=="function"){let ve=r.options.onbeforesearch(r,Me);if(ve===!1)return;typeof ve=="object"&&(Me=ve)}I(Me)}else{U=new RegExp(U,"gi");for(var D=[],J=0;J<r.items.length;J++){var X=V(J),ue=r.items[J].data.title||"",K=r.items[J].data.group||"",le=r.items[J].data.synonym||"";le&&(le=le.join(" ")),(U==null||r.items[J].selected==!0||X.toString().match(U)||ue.match(U)||K.match(U)||le.match(U))&&D.push(r.items[J])}if(!D.length)fe.style.display="none",r.results=null;else{fe.style.display="",r.results=D;var be=D.length||0;r.options.lazyLoading==!0&&be>200&&(be=200);for(var J=0;J<be;J++)r.results[J].group?(r.results[J].group.parentNode||fe.appendChild(r.results[J].group),r.results[J].group.lastChild.appendChild(r.results[J].element)):fe.appendChild(r.results[J].element)}}r.options.autofocus==!0&&r.first()},r.open=function(){if(!E.classList.contains("jdropdown-focus")){w.current=r,P(r,!0),E.classList.add("jdropdown-focus"),s.getWindowWidth()<800&&(r.options.type==null||r.options.type=="picker")&&O.slideBottom(ce,1),r.options.autocomplete==!0&&(r.header.value=r.search,r.header.focus());var U=G();if(U[0]){var J=r.getPosition(U[0]);J!==!1&&r.setCursor(J)}if(!r.options.type||r.options.type=="default"){var v=E.getBoundingClientRect(),D=ce.getBoundingClientRect();r.options.position?(ce.style.position="fixed",window.innerHeight<v.bottom+D.height?(ce.style.top="",ce.style.bottom=window.innerHeight-v.top+1+"px"):(ce.style.top=v.bottom+"px",ce.style.bottom=""),ce.style.left=v.left+"px"):window.innerHeight<v.bottom+D.height?(ce.style.top="",ce.style.bottom=v.height+1+"px"):(ce.style.top="",ce.style.bottom=""),ce.style.minWidth=v.width+"px",r.options.maxWidth&&(ce.style.maxWidth=r.options.maxWidth),!r.items.length&&r.options.autocomplete==!0?fe.style.display="none":fe.style.display=""}}typeof r.options.onopen=="function"&&r.options.onopen(E)},r.close=function(U){return E.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),!U&&typeof r.options.onclose=="function"&&r.options.onclose(E),r.header.blur&&r.header.blur(),E.classList.remove("jdropdown-focus"),P(r,!1),w.current=null),r.getValue()},r.setCursor=function(U,J){if(r.currentIndex!=null&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),U==null)r.currentIndex=null;else if(U=parseInt(U),r.items[U].element.parentNode&&(r.items[U].element.classList.add("jdropdown-cursor"),r.currentIndex=U,J!==!1&&r.items[r.currentIndex].element)){fe.scrollTop;var v=r.items[r.currentIndex].element;fe.scrollTop=v.offsetTop-v.scrollTop+v.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){r.options.lazyLoading===!0&&r.loadFirst();var U=fe.querySelectorAll(".jdropdown-item");if(U.length){var J=U[0].indexValue;r.setCursor(J)}},r.last=function(){r.options.lazyLoading===!0&&r.loadLast();var U=fe.querySelectorAll(".jdropdown-item");if(U.length){var J=U[U.length-1].indexValue;r.setCursor(J)}},r.next=function(U){var J=null;if(U){if(U.length==1){var v=r.currentIndex||-1;U=U.toLowerCase();var D=null,X=null,ue=fe.querySelectorAll(".jdropdown-item");if(ue.length){for(var K=0;K<ue.length;K++)if(ue[K].indexValue>v&&(D=r.items[ue[K].indexValue])&&(X=D.element.innerText[0])&&(X=X.toLowerCase(),U==X)){J=ue[K].indexValue;break}r.setCursor(J)}}}else if(r.currentIndex==null||r.currentIndex==null)r.first();else{var le=r.items[r.currentIndex].element,be=le.nextElementSibling;be?(be.classList.contains("jdropdown-group")&&(be=be.lastChild.firstChild),J=be.indexValue):le.parentNode.classList.contains("jdropdown-group-items")&&((be=le.parentNode.parentNode.nextElementSibling)&&(be.classList.contains("jdropdown-group")?be=be.lastChild.firstChild:be.classList.contains("jdropdown-item")?J=be.indexValue:be=null),be&&(J=be.indexValue)),J!==null&&r.setCursor(J)}},r.prev=function(){var U=null;if(r.currentIndex===null)r.first();else{var J=r.items[r.currentIndex].element,v=J.previousElementSibling;v?(v.classList.contains("jdropdown-group")&&(v=v.lastChild.lastChild),U=v.indexValue):J.parentNode.classList.contains("jdropdown-group-items")&&((v=J.parentNode.parentNode.previousElementSibling)&&(v.classList.contains("jdropdown-group")?v=v.lastChild.lastChild:v.classList.contains("jdropdown-item")?U=v.indexValue:v=null),v&&(U=v.indexValue))}U!==null&&r.setCursor(U)},r.loadFirst=function(){if(r.results)var U=r.results;else var U=r.items;var J=U.length||0;r.options.lazyLoading==!0&&J>200&&(J=200),fe.textContent="";for(var v=0;v<J;v++)U[v].group?(U[v].group.parentNode||fe.appendChild(U[v].group),U[v].group.lastChild.appendChild(U[v].element)):fe.appendChild(U[v].element);fe.scrollTop=0},r.loadLast=function(){if(r.results)var U=r.results;else var U=r.items;var J=U.length;if(J>200){J=J-200,fe.textContent="";for(var v=J;v<U.length;v++)U[v].group?(U[v].group.parentNode||fe.appendChild(U[v].group),U[v].group.lastChild.appendChild(U[v].element)):fe.appendChild(U[v].element);fe.scrollTop=fe.scrollHeight}},r.loadUp=function(){var U=!1;if(r.results)var J=r.results;else var J=r.items;var v=fe.querySelectorAll(".jdropdown-item"),D=v[0].indexValue;D=r.items[D];var X=J.indexOf(D)-1;if(X>0){for(var ue=0;X>0&&J[X]&&ue<200;)J[X].group?(J[X].group.parentNode||fe.insertBefore(J[X].group,fe.firstChild),J[X].group.lastChild.insertBefore(J[X].element,J[X].group.lastChild.firstChild)):fe.insertBefore(J[X].element,fe.firstChild),X--,ue++;U=!0}return U},r.loadDown=function(){var U=!1;if(r.results)var J=r.results;else var J=r.items;var v=fe.querySelectorAll(".jdropdown-item"),D=v[v.length-1].indexValue;D=r.items[D];var X=J.indexOf(D)+1;if(X<J.length){for(var ue=0;X<J.length&&J[X]&&ue<200;)J[X].group?(J[X].group.parentNode||fe.appendChild(J[X].group),J[X].group.lastChild.appendChild(J[X].element)):fe.appendChild(J[X].element),X++,ue++;U=!0}return U},$e(),r};return w.keydown=function(E){var a=null;if(a=w.current){if(E.which==13||E.which==9)a.header.value&&a.currentIndex==null&&a.options.newOptions?a.add():(a.currentIndex==null&&a.options.autocomplete==!0&&a.header.value!=""&&a.find(a.header.value),a.selectIndex(a.currentIndex));else if(E.which==38)a.currentIndex==null?a.first():a.currentIndex>0&&a.prev(),E.preventDefault();else if(E.which==40)a.currentIndex==null?a.first():a.currentIndex+1<a.items.length&&a.next(),E.preventDefault();else if(E.which==36)a.first(),E.target.classList.contains("jdropdown-header")||E.preventDefault();else if(E.which==35)a.last(),E.target.classList.contains("jdropdown-header")||E.preventDefault();else if(E.which==27)a.close();else if(E.which==33){if(a.currentIndex==null)a.first();else if(a.currentIndex>0)for(var r=0;r<7;r++)a.prev();E.preventDefault()}else if(E.which==34){if(a.currentIndex==null)a.first();else if(a.currentIndex+1<a.items.length)for(var r=0;r<7;r++)a.next();E.preventDefault()}}},w.mouseup=function(E){var a=s.findElement(E.target,"jdropdown");if(a){var r=a.dropdown;if(E.target.classList.contains("jdropdown-header"))if(a.classList.contains("jdropdown-focus")&&a.classList.contains("jdropdown-default")){var B=a.getBoundingClientRect();if(E.changedTouches&&E.changedTouches[0]){var te=E.changedTouches[0].clientX;E.changedTouches[0].clientY}else{var te=E.clientX;E.clientY}B.width-(te-B.left)<30?E.target.classList.contains("jdropdown-add")?r.add():r.close():r.options.autocomplete==!1&&r.close()}else r.open();else if(E.target.classList.contains("jdropdown-group-name")){var ee=E.target.nextSibling.children;if(E.target.nextSibling.style.display!="none")for(var S=0;S<ee.length;S++)ee[S].style.display!="none"&&r.selectItem(ee[S])}else E.target.classList.contains("jdropdown-group-arrow")?E.target.classList.contains("jdropdown-group-arrow-down")?(E.target.classList.remove("jdropdown-group-arrow-down"),E.target.classList.add("jdropdown-group-arrow-up"),E.target.parentNode.nextSibling.style.display="none"):(E.target.classList.remove("jdropdown-group-arrow-up"),E.target.classList.add("jdropdown-group-arrow-down"),E.target.parentNode.nextSibling.style.display=""):E.target.classList.contains("jdropdown-item")?r.selectItem(E.target):E.target.classList.contains("jdropdown-image")||E.target.classList.contains("jdropdown-description")?r.selectItem(E.target.parentNode):E.target.classList.contains("jdropdown-title")?r.selectItem(E.target.parentNode.parentNode):(E.target.classList.contains("jdropdown-close")||E.target.classList.contains("jdropdown-backdrop"))&&r.close()}},w.extractFromDom=function(E,a){var r=E;if(a||(a={}),E.getAttribute("multiple")&&(!a||a.multiple==null)&&(a.multiple=!0),E.getAttribute("placeholder")&&(!a||a.placeholder==null)&&(a.placeholder=E.getAttribute("placeholder")),E.getAttribute("data-autocomplete")&&(!a||a.autocomplete==null)&&(a.autocomplete=!0),(!a||a.width==null)&&(a.width=E.offsetWidth),E.value&&(!a||a.value==null)&&(a.value=E.value),!a||a.data==null){a.data=[];for(var B=0;B<E.children.length;B++)if(E.children[B].tagName=="OPTGROUP")for(var te=0;te<E.children[B].children.length;te++)a.data.push({value:E.children[B].children[te].value,text:E.children[B].children[te].textContent,group:E.children[B].getAttribute("label")});else a.data.push({value:E.children[B].value,text:E.children[B].textContent})}(!a||a.onchange==null)&&(a.onchange=function(S,A,V,G){a.multiple==!0?obj.items[A].classList.contains("jdropdown-selected")?r.options[A].setAttribute("selected","selected"):r.options[A].removeAttribute("selected"):r.value=G});var ee=document.createElement("div");return E.parentNode.insertBefore(ee,E),E.style.display="none",E=ee,{el:E,options:a}},w}var Ue=Ye();function He(w,E){if(w.picker)return w.picker.setOptions(E,!0);var a={type:"picker"};a.options={};var r=null,B=null,te=function(A){return A instanceof Element||A instanceof HTMLDocument},ee=function(){B.innerHTML="";for(var A=Object.keys(a.options.data),V=0;V<A.length;V++){var G=document.createElement("div");G.classList.add("jpicker-item"),G.setAttribute("role","option"),G.k=A[V],G.v=a.options.data[A[V]];var ne=a.getLabel(A[V],G);te(ne)?G.appendChild(ne):G.innerHTML=ne,B.appendChild(G)}};a.setOptions=function(A,V){var G={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};A&&A.options&&(A.data=A.options);for(var ne in G)A&&A.hasOwnProperty(ne)?a.options[ne]=A[ne]:(typeof a.options[ne]>"u"||V===!0)&&(a.options[ne]=G[ne]);return a.options.header===!1?r.style.display="none":r.style.display="",a.options.width?r.style.width=parseInt(a.options.width)+"px":r.style.width="",a.options.height?(B.style.maxHeight=a.options.height+"px",B.style.overflow="scroll"):B.style.overflow="",a.options.columns>0&&(a.options.grid?(B.classList.add("jpicker-grid"),B.style.gridTemplateColumns="repeat("+a.options.grid+", 1fr)"):(B.classList.add("jpicker-columns"),B.style.width=a.options.width?a.options.width:36*a.options.columns+"px")),isNaN(parseInt(a.options.value))&&(a.options.value=0),ee(),a.setValue(a.options.value),a},a.getValue=function(){return a.options.value},a.setValue=function(A,V){if(a.setLabel(A),a.options.value=String(A),w.value!=a.options.value&&(w.value=a.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),B.children[A]&&B.children[A].getAttribute("type")!=="generic"&&a.close(),V&&typeof a.options.onchange=="function"){var G=a.options.data[A];a.options.onchange(w,a,G,G,A,V)}},a.getLabel=function(A,V){var G=a.options.data[A]||null;return typeof a.options.render=="function"&&(G=a.options.render(G,V)),G},a.setLabel=function(A){var V;a.options.content?V='<i class="material-icons">'+a.options.content+"</i>":V=a.getLabel(A,null),te(V)?(r.innerHTML="",r.appendChild(V)):r.innerHTML=V},a.open=function(){if(!w.classList.contains("jpicker-focus")){P(a,!0),w.classList.add("jpicker-focus"),w.focus();var A=0,V=0;B.style.marginLeft="";var G=r.getBoundingClientRect(),ne=B.getBoundingClientRect();window.innerHeight<G.bottom+ne.height||a.options.bottom?A=-1*(ne.height+4):A=G.height+4,a.options.right===!0&&(V=-1*ne.width+G.width),ne.left+V<0&&(V=V+ne.left+10),ne.left+ne.width>window.innerWidth&&(V=-1*(10+ne.left+ne.width-window.innerWidth)),B.style.marginTop=parseInt(A)+"px",B.style.marginLeft=parseInt(V)+"px",typeof a.options.onopen=="function"&&a.options.onopen(w,a)}},a.close=function(){w.classList.contains("jpicker-focus")&&(w.classList.remove("jpicker-focus"),P(a,!1),typeof a.options.onclose=="function"&&a.options.onclose(w,a))};var S=function(){let A=s.guid();w.classList.add("jpicker"),w.setAttribute("role","combobox"),w.setAttribute("aria-haspopup","listbox"),w.setAttribute("aria-expanded","false"),w.setAttribute("aria-controls",A),w.setAttribute("tabindex","0"),w.onmousedown=function(V){w.classList.contains("jpicker-focus")||a.open()},r=document.createElement("div"),r.classList.add("jpicker-header"),B=document.createElement("div"),B.setAttribute("id",A),B.setAttribute("role","listbox"),B.classList.add("jpicker-content"),B.onclick=function(V){var G=s.findElement(V.target,"jpicker-item");G&&G.parentNode===B&&a.setValue(G.k,V)},w.appendChild(r),w.appendChild(B),w.value=E.value||0,a.setOptions(E),typeof a.options.onload=="function"&&a.options.onload(w,a),w.change=a.setValue,w.val=function(V){if(V===void 0)return a.getValue();a.setValue(V)},w.picker=a};return S(),a}function ut(w,E){var a={type:"toolbar"};a.options={};var r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var B in r)E&&E.hasOwnProperty(B)?a.options[B]=E[B]:a.options[B]=r[B];!w&&E.app&&E.app.el&&(w=document.createElement("div"),E.app.el.appendChild(w));var te=document.createElement("div");te.classList.add("jtoolbar-item"),te.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),te.appendChild(ee),a.selectItem=function(A){for(var V=S.children,G=0;G<V.length;G++)A!=V[G]&&V[G].classList.remove("jtoolbar-selected");A.classList.add("jtoolbar-selected")},a.hide=function(){O.slideBottom(w,0,function(){w.style.display="none"})},a.show=function(){w.style.display="",O.slideBottom(w,1)},a.get=function(){return w},a.setBadge=function(A,V){S.children[A].children[1].firstChild.innerHTML=V},a.destroy=function(){toolbar.remove(),w.innerHTML=""},a.update=function(A,V){for(var G=0;G<S.children.length;G++){var ne=S.children[G];typeof ne.updateState=="function"&&ne.updateState(w,a,ne,A,V)}for(var G=0;G<ee.children.length;G++){var ne=ee.children[G];typeof ne.updateState=="function"&&ne.updateState(w,a,ne,A,V)}},a.create=function(A){S.innerHTML="";for(var V=0;V<A.length;V++){var G=document.createElement("div");if(G.classList.add("jtoolbar-item"),A[V].width&&(G.style.width=parseInt(A[V].width)+"px"),A[V].k&&(G.k=A[V].k),A[V].tooltip&&(G.setAttribute("title",A[V].tooltip),G.setAttribute("aria-label",A[V].tooltip)),A[V].id&&G.setAttribute("id",A[V].id),A[V].updateState&&(G.updateState=A[V].updateState),A[V].active&&G.classList.add("jtoolbar-active"),A[V].disabled&&G.classList.add("jtoolbar-disabled"),A[V].type=="select"||A[V].type=="dropdown")He(G,A[V]);else if(A[V].type=="divisor")G.classList.add("jtoolbar-divisor");else if(A[V].type=="label")G.classList.add("jtoolbar-label"),G.innerHTML=A[V].content;else{var ne=document.createElement("i");if(typeof A[V].class>"u")ne.classList.add("material-icons");else for(var he=A[V].class.split(" "),ce=0;ce<he.length;ce++)ne.classList.add(he[ce]);if(ne.innerHTML=A[V].content?A[V].content:"",G.setAttribute("role","button"),G.appendChild(ne),a.options.badge==!0){var fe=document.createElement("div");fe.classList.add("jbadge");var Ee=document.createElement("div");Ee.innerHTML=A[V].badge?A[V].badge:"",fe.appendChild(Ee),G.appendChild(fe)}if(A[V].title)if(a.options.title==!0){var De=document.createElement("span");De.innerHTML=A[V].title,G.appendChild(De)}else G.setAttribute("title",A[V].title);a.options.app&&A[V].route&&(G.route=A[V].route,G.onclick=function(){a.options.app.pages(this.route)},a.options.app.pages(A[V].route,{toolbarItem:G,closed:!0})),typeof A[V].render=="function"&&A[V].render(G,A[V])}A[V].onclick&&(G.onclick=A[V].onclick.bind(A[V],w,a,G)),S.appendChild(G)}setTimeout(function(){a.refresh()},0)},a.open=function(){te.classList.add("jtoolbar-arrow-selected"),w.getBoundingClientRect();var A=ee.getBoundingClientRect();A.bottom>window.innerHeight||a.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",te.children[0].focus(),P(a,!0)},a.close=function(){te.classList.remove("jtoolbar-arrow-selected"),P(a,!1)},a.refresh=function(){if(a.options.responsive==!0){var A=w.parentNode.getBoundingClientRect();a.options.maxWidth||(a.options.maxWidth=A.width);var V=parseInt(a.options.maxWidth);for(te.parentNode&&te.parentNode.removeChild(te);ee.firstChild;)S.appendChild(ee.firstChild);if(V<S.offsetWidth)for(V-=50;S.lastChild&&V<S.offsetWidth;)ee.insertBefore(S.lastChild,ee.firstChild);ee.children.length>0&&S.appendChild(te)}},a.setReadonly=function(A){A=A?"add":"remove",w.classList[A]("jtoolbar-disabled")},w.onclick=function(A){var V=s.findElement(A.target,"jtoolbar-item");V&&a.selectItem(V),A.target.classList.contains("jtoolbar-arrow")&&a.open()},window.addEventListener("resize",function(){a.refresh()}),w.classList.add("jtoolbar"),w.innerHTML="",a.options.container==!0&&w.classList.add("jtoolbar-container");var S=document.createElement("div");return w.appendChild(S),a.options.app&&w.classList.add("jtoolbar-mobile"),a.create(a.options.items),w.toolbar=a,a}function Y(){var w=function(E,a){var r={type:"editor"};r.options={};var B={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var te in B)a&&a.hasOwnProperty(te)?r.options[te]=a[te]:r.options[te]=B[te];var ee=null,S=null,A=[];r.el=E,typeof r.options.onclick=="function"&&(E.onclick=function(re){r.options.onclick(E,r,re)}),E.classList.add("jeditor-container");var V=document.createElement("div");V.className="jsnippet",V.setAttribute("contenteditable",!1);var G=document.createElement("div");if(G.className="jeditor-toolbar",r.editor=document.createElement("div"),r.editor.setAttribute("contenteditable",!0),r.editor.setAttribute("spellcheck",!1),r.editor.classList.add("jeditor"),r.options.placeholder&&r.editor.setAttribute("data-placeholder",r.options.placeholder),(r.options.maxHeight||r.options.height)&&(r.editor.style.overflowY="auto",r.options.maxHeight&&(r.editor.style.maxHeight=r.options.maxHeight),r.options.height&&(r.editor.style.height=r.options.height)),r.options.url)I({url:r.options.url,dataType:"html",success:function(re){r.editor.innerHTML=re,w.setCursor(r.editor,r.options.focus=="initial")}});else if(r.options.value)r.editor.innerHTML=r.options.value;else for(var ne=0;ne<E.children.length;ne++)r.editor.appendChild(E.children[ne]);E.innerHTML="";var he=function(re){typeof r.options.onchange=="function"&&r.options.onchange(E,r,re),r.options.value=r.getData(),E.value!=r.options.value&&(E.value=r.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},ce=function(re){var ye=document.createElement("div");ye.innerHTML=re;var xe=ye.querySelectorAll("img");if(xe.length)for(var Oe=0;Oe<xe.length;Oe++)r.addImage(xe[Oe].src)},fe=function(){var re=null;if(re=V.children[0]){re.classList.contains("jslider-grid")||re.classList.add("jslider-grid");var ye=re.children.length;re.setAttribute("data-number",ye>4?4:ye),ye>4?re.setAttribute("data-total",ye-4):re.removeAttribute("data-total")}},Ee=function(re){V.innerHTML||r.appendSnippet({}),V.children[0].appendChild(re),fe()};r.appendSnippet=function(re){V.innerHTML="";for(var ye=["image","title","description","host","url"],xe=0;xe<ye.length;xe++){var Oe=document.createElement("div");if(Oe.className="jsnippet-"+ye[xe],Oe.setAttribute("data-k",ye[xe]),V.appendChild(Oe),re[ye[xe]])if(ye[xe]=="image"){Array.isArray(re.image)||(re.image=[re.image]);for(var Ge=0;Ge<re.image.length;Ge++){var Ke=document.createElement("img");Ke.src=re.image[Ge],Oe.appendChild(Ke)}}else Oe.innerHTML=re[ye[xe]]}r.editor.appendChild(document.createElement("br")),r.editor.appendChild(V)},r.setData=function(re){typeof re=="object"?r.editor.innerHTML=re.content:r.editor.innerHTML=re,r.options.focus&&w.setCursor(r.editor,!0),A=[]},r.getFiles=function(){for(var re=r.editor.querySelectorAll(".jfile"),ye=[],xe=0;xe<re.length;xe++)A[re[xe].src]&&ye.push(A[re[xe].src]);return ye},r.getText=function(){return r.editor.innerText},r.getData=function(re){if(re){var ye={content:""};if(V.innerHTML){ye.snippet={};for(var xe=0;xe<V.children.length;xe++){var Oe=V.children[xe].getAttribute("data-k");if(Oe)if(Oe=="image"){ye.snippet.image||(ye.snippet.image=[]);for(var Ge=0;Ge<V.children[xe].children.length;Ge++)ye.snippet.image.push(V.children[xe].children[Ge].getAttribute("src"))}else ye.snippet[Oe]=V.children[xe].innerHTML}}var Ke=Object.keys(A);if(Ke.length){ye.files=[];for(var xe=0;xe<Ke.length;xe++)ye.files.push(A[Ke[xe]])}var ot=document.createElement("div");ot.innerHTML=r.editor.innerHTML;var ft=ot.querySelector(".jsnippet");ft&&ft.remove();var nt=ot.innerHTML;nt=nt.replace(/<br>/g,`
`),nt=nt.replace(/<\/div>/g,`</div>
`),nt=nt.replace(/<(?:.|\n)*?>/gm,""),ye.content=nt.trim(),Ie("getData",ye)}else var ye=r.editor.innerHTML;return ye},r.reset=function(){r.editor.innerHTML="",V.innerHTML="",A=[]},r.addPdf=function(re){if(re.result.substr(0,4)!="data")console.error("Invalid source");else{var ye=document.createElement("canvas");ye.width=60,ye.height=60;var xe=new Image,Oe=ye.getContext("2d");Oe.drawImage(xe,0,0,ye.width,ye.height),ye.toBlob(function(Ge){var Ke=document.createElement("img");Ke.src=window.URL.createObjectURL(Ge),Ke.title=re.name,Ke.className="jfile pdf",A[Ke.src]={file:Ke.src,extension:"pdf",content:re.result},document.execCommand("insertHtml",!1,Ke.outerHTML)})}},r.addImage=function(re,ye){if(r.options.acceptImages)if(re||(re=""),re.substr(0,4)!="data"&&!r.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(re.substr(0,4)=="data"){var xe=re.split(";");xe=xe[0].split("/"),xe=xe[1]}else{var xe=re.substr(re.lastIndexOf(".")+1);re=r.options.remoteParser+re}var Oe=new Image;Oe.onload=function(){var Ke=document.createElement("canvas");Ke.width=Oe.width,Ke.height=Oe.height;var ot=Ke.getContext("2d");ot.drawImage(Oe,0,0,Ke.width,Ke.height),Ke.toBlob(function(ft){var nt=document.createElement("img");nt.src=window.URL.createObjectURL(ft),nt.classList.add("jfile"),nt.setAttribute("tabindex","900"),nt.setAttribute("width",Oe.width),nt.setAttribute("height",Oe.height),A[nt.src]={file:nt.src,extension:xe,content:Ke.toDataURL()},r.options.dropAsSnippet||ye?(Ee(nt),A[nt.src].snippet=!0):document.execCommand("insertHtml",!1,nt.outerHTML),he()})},Oe.src=re}},r.addFile=function(re){for(var ye=[],xe=0;xe<re.length;xe++)if(re[xe].size>r.options.maxFileSize)alert("The file is too big");else{var Oe=re[xe].type.split("/");Oe[0]=="image"?Oe=1:Oe[1]=="pdf"?Oe=2:Oe=0,Oe?(ye[xe]=new FileReader,ye[xe].index=xe,ye[xe].type=Oe,ye[xe].name=re[xe].name,ye[xe].date=re[xe].lastModified,ye[xe].size=re[xe].size,ye[xe].addEventListener("load",function(Ge){Ge.target.type==2?r.options.acceptFiles==!0&&r.addPdf(Ge.target):r.addImage(Ge.target.result)},!1),ye[xe].readAsDataURL(re[xe])):alert("The extension is not allowed")}},r.destroy=function(){r.editor.removeEventListener("mouseup",be),r.editor.removeEventListener("mousedown",Me),r.editor.removeEventListener("mousemove",ve),r.editor.removeEventListener("keyup",K),r.editor.removeEventListener("keydown",le),r.editor.removeEventListener("dragstart",U),r.editor.removeEventListener("dragenter",J),r.editor.removeEventListener("dragover",v),r.editor.removeEventListener("drop",D),r.editor.removeEventListener("paste",we),r.editor.removeEventListener("blur",X),r.editor.removeEventListener("focus",ue),E.editor=null,E.classList.remove("jeditor-container"),G.remove(),V.remove(),r.editor.remove()},r.upload=function(){s.click(r.file)};const De=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Se=["width","height","align","border","src","tabindex"],qe=["color","font-weight","font-size","background","background-color","margin"],$e=function(re){if(re.tagName&&De.indexOf(re.tagName.toLowerCase())===-1&&re.innerText&&(re.innerHTML=re.innerText),re.attributes&&re.attributes.length){let ye=null,xe=re.getAttribute("style");if(xe){ye=[];let Ge=xe.split(";");for(let Ke=0;Ke<Ge.length;Ke++){let ot=Ge[Ke].trim().split(":");if(qe.indexOf(ot[0].trim())>=0){let ft=ot.shift();ot=ot.join(":"),ye.push(ft+":"+ot)}}}re.tagName.toUpperCase()==="IMG"&&(!r.options.acceptImages||!re.src?re.parentNode.removeChild(re):(re.setAttribute("tabindex","900"),r.addImage(re.src)));let Oe=[];for(let Ge=0;Ge<re.attributes.length;Ge++)Oe.push(re.attributes[Ge].name);Oe.length&&Oe.forEach(function(Ge){Se.indexOf(Ge)===-1?re.removeAttribute(Ge):re.attributes&&re.attributes[ne]&&re.attributes[ne].value.indexOf("<")!==-1&&re.attributes[ne].value.replace("<","&#60;")}),re.style="",ye&&ye.length&&re.setAttribute("style",ye.join(";"))}if(re.children.length)for(let ye=re.children.length;ye>0;ye--)$e(re.children[ye-1])};var Q=function(re){var ye=window.getSelection(),xe=document.createRange();xe.selectNode(re),ye.addRange(xe)},pe=function(re){re&&(re=re.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ye=new DOMParser,xe=ye.parseFromString(re,"text/html");$e(xe);var Oe=document.createElement("div");return Oe.innerHTML=xe.firstChild.innerHTML,Oe},we=function(re){if(r.options.filterPaste==!0){if(re.clipboardData||re.originalEvent.clipboardData)var ye=(re.originalEvent||re).clipboardData.getData("text/html"),xe=(re.originalEvent||re).clipboardData.getData("text/plain"),Oe=(re.originalEvent||re).clipboardData.files;else if(window.clipboardData)var ye=window.clipboardData.getData("Html"),xe=window.clipboardData.getData("Text"),Oe=window.clipboardData.files;if(Oe.length)r.addFile(Oe);else if(!ye)ye=xe.split(`\r
`),re.target.innerText?(ye=ye.map(function(Ke){return"<div>"+Ke+"</div>"}),document.execCommand("insertText",!1,ye.join(""))):ye.map(function(Ke){var ot=document.createElement("div");ot.innerText=Ke,r.editor.appendChild(ot)});else{var Ge=pe(ye);document.execCommand("insertHtml",!1,Ge.innerHTML)}re.preventDefault()}},U=function(re){S&&S.e&&re.preventDefault()},J=function(re){S||r.options.dropZone==!1||(E.classList.add("jeditor-dragging"),re.preventDefault())},v=function(re){S||r.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){E.classList.remove("jeditor-dragging")},100),re.preventDefault())},D=function(re){if(!(S||r.options.dropZone==!1)){var ye=null;document.caretRangeFromPoint?ye=document.caretRangeFromPoint(re.clientX,re.clientY):re.rangeParent&&(ye=document.createRange(),ye.setStart(re.rangeParent,re.rangeOffset));var xe=window.getSelection();xe.removeAllRanges(),xe.addRange(ye),xe.anchorNode.parentNode.focus();var Oe=(re.originalEvent||re).dataTransfer.getData("text/html"),Ge=(re.originalEvent||re).dataTransfer.getData("text/plain"),Ke=(re.originalEvent||re).dataTransfer.files;Ke.length?r.addFile(Ke):Ge&&ce(Oe),E.classList.remove("jeditor-dragging"),re.preventDefault()}},X=function(re){Ie("onevent",re),he(re),typeof r.options.onblur=="function"&&r.options.onblur(E,r,re)},ue=function(re){typeof r.options.onfocus=="function"&&r.options.onfocus(E,r,re)},K=function(re){r.editor.innerHTML||(r.editor.innerHTML="<div><br></div>"),typeof r.options.onkeyup=="function"&&r.options.onkeyup(E,r,re)},le=function(re){if(Ie("onevent",re),re.key=="Delete"&&re.target.tagName=="IMG"){var ye=re.target.parentNode;Q(re.target),ye.classList.contains("jsnippet-image")&&fe()}typeof r.options.onkeydown=="function"&&r.options.onkeydown(E,r,re)},be=function(re){if(S&&S.e&&(S.e.classList.remove("resizing"),S.e.changed==!0)){var ye=S.e.cloneNode();ye.width=parseInt(S.e.style.width)||S.e.getAttribute("width"),ye.height=parseInt(S.e.style.height)||S.e.getAttribute("height"),S.e.style.width="",S.e.style.height="",Q(S.e),document.execCommand("insertHtml",!1,ye.outerHTML)}S=!1},Me=function(re){var ye=function(Ke){var ot=Ke.getBoundingClientRect();ot.width-(re.clientX-ot.left)<40&&re.clientY-ot.top<40&&(Ke.innerHTML="",Ke.remove())};if(re.target.tagName=="IMG")if(re.target.style.cursor){var xe=re.target.getBoundingClientRect();S={e:re.target,x:re.clientX,y:re.clientY,w:xe.width,h:xe.height,d:re.target.style.cursor},re.target.getAttribute("width")||re.target.setAttribute("width",xe.width),re.target.getAttribute("height")||re.target.setAttribute("height",xe.height);var Oe=window.getSelection();if(Oe.rangeCount)for(var Ge=0;Ge<Oe.rangeCount;Ge++)Oe.removeRange(Oe.getRangeAt(Ge));re.target.classList.add("resizing")}else S=!0;else re.target.classList.contains("jsnippet")?ye(re.target):re.target.parentNode.classList.contains("jsnippet")&&ye(re.target.parentNode),S=!0},ve=function(re){if(re.target.tagName=="IMG"&&!re.target.parentNode.classList.contains("jsnippet-image")&&r.options.allowImageResize==!0&&re.target.getAttribute("tabindex")){var ye=re.target.getBoundingClientRect();re.clientY-ye.top<5?ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="ne-resize":re.clientX-ye.left<5?re.target.style.cursor="nw-resize":re.target.style.cursor="n-resize":ye.height-(re.clientY-ye.top)<5?ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="se-resize":re.clientX-ye.left<5?re.target.style.cursor="sw-resize":re.target.style.cursor="s-resize":ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="e-resize":re.clientX-ye.left<5?re.target.style.cursor="w-resize":re.target.style.cursor=""}if(re.which==1&&S&&S.d){if(S.d=="e-resize"||S.d=="ne-resize"||S.d=="se-resize")if(S.e.style.width=S.w+(re.clientX-S.x),re.shiftKey){var xe=(re.clientX-S.x)*(S.h/S.w);S.e.style.height=S.h+xe}else var xe=null;xe||(S.d=="s-resize"||S.d=="se-resize"||S.d=="sw-resize")&&(re.shiftKey||(S.e.style.height=S.h+(re.clientY-S.y))),S.e.changed=!0}},Ie=function(re,ye){if(r.options.extensions){var xe=Object.keys(r.options.extensions);if(xe.length)for(var Oe=0;Oe<xe.length;Oe++)r.options.extensions[xe[Oe]]&&typeof r.options.extensions[xe[Oe]][re]=="function"&&r.options.extensions[xe[Oe]][re].call(r,ye)}},Fe=function(){if(r.options.extensions){var re=Object.keys(r.options.extensions);if(re.length)for(var ye=0;ye<re.length;ye++)r.options.extensions[re[ye]]&&typeof r.options.extensions[re[ye]]=="function"&&(r.options.extensions[re[ye]]=r.options.extensions[re[ye]](E,r))}};if(document.addEventListener("mouseup",be),document.addEventListener("mousemove",ve),r.editor.addEventListener("mousedown",Me),r.editor.addEventListener("keyup",K),r.editor.addEventListener("keydown",le),r.editor.addEventListener("dragstart",U),r.editor.addEventListener("dragenter",J),r.editor.addEventListener("dragover",v),r.editor.addEventListener("drop",D),r.editor.addEventListener("paste",we),r.editor.addEventListener("focus",ue),r.editor.addEventListener("blur",X),E.appendChild(r.editor),r.options.snippet&&r.appendSnippet(r.options.snippet),r.options.toolbar){if(Array.isArray(r.options.toolbar))var et={container:!0,responsive:!0,items:r.options.toolbar};else if(r.options.toolbar===!0)var et={container:!0,responsive:!0,items:[]};else var et=r.options.toolbar;et.items&&et.items.length||(et.items=w.getDefaultToolbar(r)),r.options.toolbarOnTop?(E.classList.add("toolbar-on-top"),E.insertBefore(G,E.firstChild)):(r.editor.style.padding="15px",E.appendChild(G)),ut(G,et),G.addEventListener("click",function(){r.editor.focus()})}return r.file=document.createElement("input"),r.file.style.display="none",r.file.type="file",r.file.setAttribute("accept","image/*"),r.file.onchange=function(){r.addFile(this.files)},E.appendChild(r.file),r.options.focus&&w.setCursor(r.editor,r.options.focus=="initial"),E.change=r.setData,E.val=function(re){if(re===void 0){var ye=E.getAttribute("data-html")!=="true";return r.getData(ye)}else r.setData(re)},Fe(),E.editor=r,typeof r.options.onload=="function"&&r.options.onload(E,r,r.editor),r};return w.setCursor=function(E,a){E.focus(),document.execCommand("selectAll");var r=window.getSelection(),B=r.getRangeAt(0);if(a==!0)var te=B.startContainer,ee=0;else var te=B.endContainer,ee=te.length;B.setStart(te,ee),B.setEnd(te,ee),r.removeAllRanges(),r.addRange(B)},w.getDefaultToolbar=function(E){var a=function(B,te,ee){ee.color||(je(ee,{onchange:function(S,A){ee.k==="color"?document.execCommand("foreColor",!1,A):document.execCommand("backColor",!1,A)}}),ee.color.open())},r=[];return r.push({content:"undo",onclick:function(){document.execCommand("undo")}}),r.push({content:"redo",onclick:function(){document.execCommand("redo")}}),r.push({type:"divisor"}),E.options.toolbarOnTop&&(r.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(B){return'<span style="font-family:'+B+'">'+B+"</span>"},onchange:function(B,te,ee,S,A){document.execCommand("fontName",!1,S)}}),r.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(B){return'<span style="font-size:'+B+'">'+B+"</span>"},onchange:function(B,te,ee,S,A){document.execCommand("fontSize",!1,parseInt(A)+1)}}),r.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(B){return'<i class="material-icons">'+B+"</i>"},onchange:function(B,te,ee,S,A){var V=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(V[A])}}),r.push({type:"divisor"}),r.push({content:"format_color_text",k:"color",onclick:a}),r.push({content:"format_color_fill",k:"background-color",onclick:a})),r.push({content:"format_bold",onclick:function(B,te,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_italic",onclick:function(B,te,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_underline",onclick:function(B,te,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({type:"divisor"}),r.push({content:"format_list_bulleted",onclick:function(B,te,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_list_numbered",onclick:function(B,te,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_increase",onclick:function(B,te,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),E.options.toolbarOnTop&&(r.push({type:"divisor"}),r.push({content:"photo",onclick:function(){E.upload()}}),r.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(B,te){te&&(te.onmouseover=this.onmouseover,B=B.split("x"),te.setAttribute("data-x",B[0]),te.setAttribute("data-y",B[1]));var ee=document.createElement("div");return te.style.margin="1px",te.style.border="1px solid #ddd",ee},onmouseover:function(B){for(var te=parseInt(B.target.getAttribute("data-x")),ee=parseInt(B.target.getAttribute("data-y")),S=0;S<B.target.parentNode.children.length;S++){var A=B.target.parentNode.children[S],V=parseInt(A.getAttribute("data-x")),G=parseInt(A.getAttribute("data-y"));V<=te&&G<=ee?(A.style.backgroundColor="#cae1fc",A.style.borderColor="#2977ff"):(A.style.backgroundColor="",A.style.borderColor="#ddd")}},onchange:function(B,te,ee){ee=ee.split("x");for(var S=document.createElement("table"),A=document.createElement("tbody"),V=0;V<=ee[1];V++){for(var G=document.createElement("tr"),ne=0;ne<=ee[0];ne++){var he=document.createElement("td");he.innerHTML="",G.appendChild(he)}A.appendChild(G)}S.appendChild(A),S.setAttribute("width","100%"),S.setAttribute("cellpadding","6"),S.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,S.outerHTML)}})),r},w}var Ne=Y();function Ve(){var w=function(E,a){var r={};r.options={};var B={type:"big",title:"Untitled",width:510,height:472};for(var te in B)a&&a.hasOwnProperty(te)?r.options[te]=a[te]:r.options[te]=B[te];var ee=function(){for(var V=document.createElement("div");E.children[0];)V.appendChild(E.children[0]);for(r.content=document.createElement("div"),r.content.className="jfloating_content",r.content.innerHTML=E.innerHTML;V.children[0];)r.content.appendChild(V.children[0]);r.container=document.createElement("div"),r.container.className="jfloating",r.container.appendChild(r.content),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),r.options.width&&(r.container.style.width=parseInt(r.options.width)+"px"),r.options.height&&(r.container.style.height=parseInt(r.options.height)+"px"),E.innerHTML="",E.appendChild(r.container)},S=function(){r.container&&r.container.addEventListener("click",function(V){var G=V.target.getBoundingClientRect();if(V.target.classList.contains("jfloating")){if(V.changedTouches&&V.changedTouches[0])var ne=V.changedTouches[0].clientX,he=V.changedTouches[0].clientY;else var ne=V.clientX,he=V.clientY;G.width-(ne-G.left)<50&&he-G.top<50?setTimeout(function(){r.close()},100):r.setState()}})},A=function(){r.container.classList.add("jfloating-"+r.options.type)};return r.state={isMinized:!1},r.setState=function(){r.state.isMinized?r.container.classList.remove("jfloating-minimized"):r.container.classList.add("jfloating-minimized"),r.state.isMinized=!r.state.isMinized},r.close=function(){Components.elements.splice(w.elements.indexOf(r.container),1),r.updatePosition(),E.remove()},r.updatePosition=function(){for(var V=0;V<w.elements.length;V++){var G=w.elements[V],ne=w.elements[V-1];G.style.right=V*(ne?ne.offsetWidth:G.offsetWidth)*1.01+"px"}},r.init=function(){ee(),S(),A(),w.elements.push(r.container),r.updatePosition(),E.floating=r},r.init(),r};return w.elements=[],w}var bt=Ve();function tt(){const w=function(S){return!isNaN(S)&&S!==null&&(typeof S!="string"||S.trim()!=="")},E={between:function(S,A){return S>=A[0]&&S<=A[1]},"not between":function(S,A){return S<A[0]||S>A[1]},"<":function(S,A){return S<A[0]},"<=":function(S,A){return S<=A[0]},">":function(S,A){return S>A[0]},">=":function(S,A){return S>=A[0]},"=":function(S,A){return S==A[0]},"!=":function(S,A){return S!=A[0]}},a={"valid date":function(){return!0},"=":function(S,A){return S===A[0]},"!=":function(S,A){return S!==A[0]},"<":function(S,A){return S<A[0]},"<=":function(S,A){return S<=A[0]},">":function(S,A){return S>A[0]},">=":function(S,A){return S>=A[0]},between:function(S,A){return S>=A[0]&&S<=A[1]},"not between":function(S,A){return S<A[0]||S>A[1]}},r={contains:function(S,A){return S.includes(A[0])},"not contains":function(S,A){return!S.includes(A[0])},"begins with":function(S,A){return S.startsWith(A[0])},"ends with":function(S,A){return S.endsWith(A[0])},"=":function(S,A){return S===A[0]},"!=":function(S,A){return S!==A[0]},"valid email":function(S){var A=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return A.test(S)},"valid url":function(S){var A=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return A.test(S)}},B=function(S,A){return typeof B[A.type]=="function"?A.allowBlank&&(typeof S>"u"||S===""||S===null)?!0:B[A.type].call(this,S,A):null};B.url=function(S){var A=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!A.test(S)},B.email=function(S){var A=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(S&&A.test(S))},B.required=function(S){return!!(S&&S.trim())},B.empty=function(S){return typeof S>"u"||S===null||typeof S=="string"&&!S.toString().trim()},B["not exist"]=B.empty,B.notEmpty=function(S){return!B.empty(S)},B.exist=B.notEmpty,B.number=function(S,A){if(!w(S))return!1;if(!A||!A.criteria)return!0;if(!E[A.criteria])return!1;let V=A.value.map(function(G){return parseFloat(G)});return E[A.criteria](S,V)},B.login=function(S){let A=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(S&&A.test(S))},B.list=function(S,A){let V=typeof S;if(V!=="string"&&V!=="number")return!1;let G;return typeof A.value[0]=="string"?A.source?G=A.source:G=A.value[0].split(","):G=A.value[0],Array.isArray(G)?G.findIndex(function(he){return he==S})>-1:!1};const te=function(){let S=new Date;return S.setHours(0,0,0,0),S},ee={"one year ago":function(){let S=te();return S.setFullYear(S.getFullYear()-1),S},"one month ago":function(){let S=te();return S.setMonth(S.getMonth()-1),S},"one week ago":function(){let S=te();return S.setDate(S.getDate()-7),S},yesterday:function(){let S=te();return S.setDate(S.getDate()-1),S},today:te,tomorrow:function(){let S=te();return S.setDate(S.getDate()+1),S}};return B.date=function(S,A){if(w(S)&&S>0&&S<1e6&&(S=F.numToDate(S)),new Date(S)=="Invalid Date")return!1;if(!A||!A.criteria)return!0;if(!a[A.criteria])return!1;let V=A.value.map(function(G){return typeof G=="string"&&ee[G]?ee[G]().getTime():new Date(G).getTime()});return a[A.criteria](new Date(S).getTime(),V)},B.text=function(S,A){if(typeof S>"u"||S===null)S="";else if(typeof S!="string")return!1;return!A||!A.criteria?!0:r[A.criteria]?r[A.criteria](S,A.value):!1},B.textLength=function(S,A){let V;return typeof S=="string"?V=S.length:typeof S<"u"&&S!==null&&typeof S.toString=="function"?V=S.toString().length:V=0,B.number(V,A)},B.time=function(S,A){if(!w(S))return!1;if(!A||!A.criteria)return!0;if(!E[A.criteria])return!1;let V=A.value.map(function(G){return parseInt(parseFloat(G)*10**17)/10**17});return E[A.criteria](parseInt(parseFloat(S)*10**17)/10**17,V)},B}var Ae=tt();function Te(){var w=function(E,a){var r={};r.options={};var B={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(A,V){alert(V)}};for(var te in B)a&&a.hasOwnProperty(te)?r.options[te]=a[te]:r.options[te]=B[te];r.options.validations||(r.options.validations={}),r.options.submitButton||(r.options.submitButton=E.querySelector("input[type=submit]")),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=Ae.email),r.options.validations.length||(r.options.validations.length=Ae.length),r.options.validations.required||(r.options.validations.required=Ae.required),r.setUrl=function(A){r.options.url=A},r.load=function(){I({url:r.options.url,method:"GET",dataType:"json",queue:!0,success:function(A){if(typeof r.options.onbeforeload=="function"){var V=r.options.onbeforeload(E,A);V&&(A=V)}w.setElements(E,A),typeof r.options.onload=="function"&&r.options.onload(E,A)}})},r.save=function(){var A=r.validate();if(A)r.options.onerror(E,A);else{var V=w.getElements(E,!0);if(typeof r.options.onbeforesave=="function"){var V=r.options.onbeforesave(E,V);if(V===!1)return}I({url:r.options.url,method:"POST",dataType:"json",data:V,success:function(G){typeof r.options.onsave=="function"&&r.options.onsave(E,V,G)}})}},r.remove=function(){if(typeof r.options.onbeforeremove=="function"){var A=r.options.onbeforeremove(E,r);if(A===!1)return!1}I({url:r.options.url,method:"DELETE",dataType:"json",success:function(V){typeof r.options.onremove=="function"&&r.options.onremove(E,r,V),r.reset()}})};var ee=function(A){A.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var V=A.getAttribute("data-error")||"There is an error in the form";return A.setAttribute("title",V),V},S=function(A){var V=!1;A.classList.remove("error"),A.removeAttribute("title");for(var G=E.querySelectorAll("input, select, textarea, div[name]"),ne=0;ne<G.length;ne++)G[ne].getAttribute("data-validation")&&G[ne].classList.contains("error")&&(V=!0);r.options.submitButton&&(V?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))};return r.validateElement=function(A){var V=!1,G=w.getValue(A),ne=A.getAttribute("data-validation");return typeof r.options.validations[ne]=="function"&&!r.options.validations[ne](G,A)?V=ee(A):A.classList.contains("error")&&S(A),V},r.reset=function(){for(var A=E.querySelectorAll("input, select, textarea, div[name]"),V=0;V<A.length;V++)A[V].getAttribute("name")&&(A[V].type=="checkbox"||A[V].type=="radio"?A[V].checked=!1:typeof A[V].val=="function"?A[V].val(""):A[V].value="")},r.validate=function(){for(var A=[],V=E.querySelectorAll("input, select, textarea, div[name]"),G=0;G<V.length;G++)if(V[G].getAttribute("data-validation")){var ne=r.validateElement(V[G]);ne&&A.push(ne)}return A.length>0?A.join("<br>"):!1},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(w.getElements(E))},r.getHash=function(A){var V=0,G,ne;if(A.length===0)return V;for(G=0;G<A.length;G++)ne=A.charCodeAt(G),V=(V<<5)-V+ne,V|=0;return V},r.isChanged=function(){var A=r.setHash();return r.options.currentHash!=A},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(A){r.options.ignore=!!A},setTimeout(function(){r.options.currentHash=r.setHash()},1e3),E.addEventListener("keyup",function(A){A.target.getAttribute("data-validation")&&r.validateElement(A.target)}),w.hasEvents||(window.addEventListener("beforeunload",function(A){if(r.isChanged()&&r.options.ignore==!1){var V=r.options.message?r.options.message:"o/";return V?(typeof A>"u"&&(A=window.event),A&&(A.returnValue=V),V):void 0}}),w.hasEvents=!0),E.form=r,r};return w.getValue=function(E){var a=null;if(E.type=="checkbox")E.checked==!0&&(a=E.value||!0);else if(E.type=="radio")E.checked==!0&&(a=E.value);else if(E.type=="file")a=E.files;else if(E.tagName=="select"&&E.multiple==!0){a=[];for(var r=E.querySelectorAll("options[selected]"),B=0;B<r.length;B++)a.push(r[B].value)}else typeof E.val=="function"?a=E.val():a=E.value||"";return a},w.getElements=function(E,a){for(var r={},B=null,te=E.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<te.length;ee++)(B=te[ee].getAttribute("name"))&&(r[B]=w.getValue(te[ee])||"");return a==!0?r:JSON.stringify(r)},w.setElements=function(E,a){for(var r=null,B=null,te=E.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<te.length;ee++){var S=te[ee].getAttribute("type");if(r=te[ee].getAttribute("name")){if(r=r.replace(new RegExp(/\[(.*?)\]/ig),".$1"),B=null,r.match(/\./)){var A=j.call(a,r)||"";typeof A<"u"&&(B=A)}else typeof a[r]<"u"&&(B=a[r]);B!==null&&(S=="checkbox"||S=="radio"?te[ee].checked=!!B:S=="file"||(typeof te[ee].val=="function"?te[ee].val(B):te[ee].value=B))}}},w}var Be=Te();function ze(){var w=function(){var a=null,r=function(S){if(S.which==27)for(var A=document.querySelectorAll(".jmodal"),V=0;V<A.length;V++)A[V].parentNode.modal.close()},B=function(S){let A=S.composedPath();var V=s.findElement(A[0],"jmodal");if(V){var G=V.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0])var ne=S.changedTouches[0].clientX,he=S.changedTouches[0].clientY;else var ne=S.clientX,he=S.clientY;G.width-(ne-G.left)<50&&he-G.top<50&&V.parentNode.modal.close()}a&&(a.element.style.cursor="auto",a=null)},te=function(S){let A=S.composedPath();var V=s.findElement(A[0],"jmodal");if(V){var G=V.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0])var ne=S.changedTouches[0].clientX,he=S.changedTouches[0].clientY;else var ne=S.clientX,he=S.clientY;G.width-(ne-G.left)<50&&he-G.top<50||he-G.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),a={left:G.left,top:G.top,x:S.clientX,y:S.clientY,width:G.width,height:G.height,element:V})}},ee=function(S){if(a){if(S=S||window.event,S.buttons)var A=S.buttons;else if(S.button)var A=S.button;else var A=S.which;A?(a.element.style.top=a.top+(S.clientY-a.y)+a.height/2+"px",a.element.style.left=a.left+(S.clientX-a.x)+a.width/2+"px",a.element.style.cursor="move"):a.element.style.cursor="auto"}};document.addEventListener("keydown",r),document.addEventListener("mouseup",B),document.addEventListener("mousedown",te),document.addEventListener("mousemove",ee)},E=function(a,r){var B={};B.options={};var te={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in te)r&&r.hasOwnProperty(ee)?B.options[ee]=r[ee]:B.options[ee]=te[ee];!B.options.title&&a.getAttribute("title")&&(B.options.title=a.getAttribute("title"));for(var S=document.createElement("div");a.children[0];)S.appendChild(a.children[0]);for(B.title=document.createElement("div"),B.title.className="jmodal_title",B.options.icon&&B.title.setAttribute("data-icon",B.options.icon),B.content=document.createElement("div"),B.content.className="jmodal_content",B.content.innerHTML=a.innerHTML;S.children[0];)B.content.appendChild(S.children[0]);if(B.container=document.createElement("div"),B.container.className="jmodal",B.container.appendChild(B.title),B.container.appendChild(B.content),B.options.padding&&(B.content.style.padding=B.options.padding),B.options.width&&(B.container.style.width=B.options.width),B.options.height&&(B.container.style.height=B.options.height),B.options.title){var A=document.createElement("h4");A.innerText=B.options.title,B.title.appendChild(A)}if(a.innerHTML="",a.style.display="none",a.appendChild(B.container),B.options.backdrop){var V=document.createElement("div");V.className="jmodal_backdrop",V.onclick=function(){B.close()},a.appendChild(V)}return B.open=function(){a.style.display="block";var G=B.container.getBoundingClientRect();s.getWindowWidth()<G.width?(B.container.style.top="",B.container.style.left="",B.container.classList.add("jmodal_fullscreen"),O.slideBottom(B.container,1)):B.options.backdrop&&(V.style.display="block"),typeof B.options.onopen=="function"&&B.options.onopen(a,B)},B.resetPosition=function(){B.container.style.top="",B.container.style.left=""},B.isOpen=function(){return a.style.display!="none"},B.close=function(){B.isOpen()&&(a.style.display="none",B.options.backdrop&&(V.style.display=""),B.container.classList.remove("jmodal_fullscreen"),typeof B.options.onclose=="function"&&B.options.onclose(a,B))},B.options.url?I({url:B.options.url,method:"GET",dataType:"text/html",success:function(G){B.content.innerHTML=G,B.options.closed||B.open(),typeof B.options.onload=="function"&&B.options.onload(B)}}):(B.options.closed||B.open(),typeof B.options.onload=="function"&&B.options.onload(B)),a.modal=B,w(),w=function(){},B};return E}var Je=ze();function Qe(){var w=function(E){var a={};a.options={};var r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var B in r)E&&E.hasOwnProperty(B)?a.options[B]=E[B]:a.options[B]=r[B];var te=document.createElement("div");te.className="jnotification",a.options.error&&te.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",te.appendChild(ee);var S=document.createElement("div");S.className="jnotification-header",ee.appendChild(S);var A=document.createElement("div");if(A.className="jnotification-image",S.appendChild(A),a.options.icon){var V=document.createElement("img");V.src=a.options.icon,A.appendChild(V)}var G=document.createElement("div");if(G.className="jnotification-name",G.innerHTML=a.options.name,S.appendChild(G),a.options.closeable==!0){var ne=document.createElement("div");ne.className="jnotification-close",ne.onclick=function(){a.hide()},S.appendChild(ne)}var he=document.createElement("div");he.className="jnotification-date",S.appendChild(he);var ce=document.createElement("div");if(ce.className="jnotification-content",ee.appendChild(ce),a.options.title){var fe=document.createElement("div");fe.className="jnotification-title",fe.innerHTML=a.options.title,ce.appendChild(fe)}var Ee=document.createElement("div");if(Ee.className="jnotification-message",Ee.innerHTML=a.options.message,ce.appendChild(Ee),a.show=function(){document.body.appendChild(te),s.getWindowWidth()>800?O.fadeIn(te):O.slideTop(te,1)},a.hide=function(){s.getWindowWidth()>800?O.fadeOut(te,function(){te.parentNode&&(te.parentNode.removeChild(te),De&&clearTimeout(De))}):O.slideTop(te,0,function(){te.parentNode&&(te.parentNode.removeChild(te),De&&clearTimeout(De))})},a.show(),a.options.autoHide==!0)var De=setTimeout(function(){a.hide()},a.options.timeout);return s.getWindowWidth()<800&&te.addEventListener("swipeup",function(Se){a.hide(),Se.preventDefault(),Se.stopPropagation()}),a};return w.isVisible=function(){var E=document.querySelector(".jnotification");return!!(E&&E.parentNode)},w}var it=Qe();function dt(w,E){var a={};a.options={};var r={value:0,onchange:null,width:null};for(var B in r)E&&E.hasOwnProperty(B)?a.options[B]=E[B]:a.options[B]=r[B];w.classList.add("jprogressbar"),w.setAttribute("tabindex",1),w.setAttribute("data-value",a.options.value);var te=document.createElement("div");te.style.width=a.options.value+"%",te.style.color="#fff",w.appendChild(te),a.options.width&&(w.style.width=a.options.width),a.setValue=function(S){S=parseInt(S),a.options.value=S,te.style.width=S+"%",w.setAttribute("data-value",S+"%"),S<6?w.style.color="#000":w.style.color="#fff",a.options.value=S,typeof a.options.onchange=="function"&&a.options.onchange(w,S),w.value!=a.options.value&&(w.value=a.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},a.getValue=function(){return a.options.value};var ee=function(S){if(S.which){var A=w.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0]){var V=S.changedTouches[0].clientX;S.changedTouches[0].clientY}else{var V=S.clientX;S.clientY}a.setValue(Math.round((V-A.left)/A.width*100))}};return"touchstart"in document.documentElement?(w.addEventListener("touchstart",ee),w.addEventListener("touchend",ee)):(w.addEventListener("mousedown",ee),w.addEventListener("mousemove",ee)),w.change=a.setValue,w.val=function(S){if(S===void 0)return a.getValue();a.setValue(S)},w.progressbar=a,a}function mt(w,E){if(w.rating)return w.rating.setOptions(E,!0);var a={};a.options={},a.setOptions=function(B,te){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var S in ee)B&&B.hasOwnProperty(S)?a.options[S]=B[S]:(typeof a.options[S]>"u"||te===!0)&&(a.options[S]=ee[S]);w.innerHTML="";for(var A=0;A<a.options.number;A++){var V=document.createElement("div");V.setAttribute("data-index",A+1),V.setAttribute("title",a.options.tooltip[A]),w.appendChild(V)}if(a.options.value)for(var A=0;A<a.options.number;A++)A<a.options.value&&w.children[A].classList.add("jrating-selected");return a},a.setValue=function(B){for(var te=0;te<a.options.number;te++)te<B?w.children[te].classList.add("jrating-selected"):(w.children[te].classList.remove("jrating-over"),w.children[te].classList.remove("jrating-selected"));a.options.value=B,typeof a.options.onchange=="function"&&a.options.onchange(w,B),w.value!=a.options.value&&(w.value=a.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},a.getValue=function(){return a.options.value};var r=function(){a.setOptions(E),w.classList.add("jrating"),w.addEventListener("click",function(B){var te=B.target.getAttribute("data-index");te!=null&&(te==a.options.value?a.setValue(0):a.setValue(te))}),w.addEventListener("mouseover",function(B){for(var te=B.target.getAttribute("data-index"),ee=0;ee<a.options.number;ee++)ee<te?w.children[ee].classList.add("jrating-over"):w.children[ee].classList.remove("jrating-over")}),w.addEventListener("mouseout",function(B){for(var te=0;te<a.options.number;te++)w.children[te].classList.remove("jrating-over")}),w.change=a.setValue,w.val=function(B){if(B===void 0)return a.getValue();a.setValue(B)},w.rating=a};return r(),a}function ht(w,E){if(w.search)return w.search;var a=null,r=function(V){if(V.target.classList.contains("jsearch_item"))var G=V.target;else var G=V.target.parentNode;S.selectIndex(G),V.preventDefault()},B=function(V){if(typeof S.options.onsearch=="function"){var G=S.options.onsearch(S,V);G&&(V=G)}if(A.innerHTML="",!V.length)w.style.display="";else{w.style.display="block";for(var ne=V.length<11?V.length:10,he=0;he<ne;he++){if(typeof V[he]=="string")var ce=V[he],fe=V[he];else{var ce=V[he].text;!ce&&V[he].name&&(ce=V[he].name);var fe=V[he].value;!fe&&V[he].id&&(fe=V[he].id)}var Ee=document.createElement("div");Ee.setAttribute("data-value",fe),Ee.setAttribute("data-text",ce),Ee.className="jsearch_item",V[he].id&&Ee.setAttribute("id",V[he].id),S.options.forceSelect&&he==0&&Ee.classList.add("selected");var De=document.createElement("img");V[he].image?De.src=V[he].image:De.style.display="none",Ee.appendChild(De);var Se=document.createElement("div");Se.innerHTML=ce,Ee.appendChild(Se),A.appendChild(Ee)}}},te=function(V){if(V!=S.terms)if(S.terms=V,S.options.forceSelect?a=0:a=null,Array.isArray(S.options.data)){var G=function(he){if(typeof he=="string"){if((""+he).toLowerCase().search(V.toLowerCase())>=0)return!0}else for(var ce in he){var fe=he[ce];if((""+fe).toLowerCase().search(V.toLowerCase())>=0)return!0}return!1},ne=S.options.data.filter(function(he){return G(he)});B(ne)}else I({url:S.options.data+V,method:"GET",dataType:"json",success:function(he){B(he)}})},ee=null,S=function(V){ee&&clearTimeout(ee),ee=setTimeout(function(){te(V)},500)};E.forceSelect===null&&(E.forceSelect=!0),S.options={data:E.data||null,input:E.input||null,searchByNode:E.searchByNode||null,onselect:E.onselect||null,forceSelect:E.forceSelect,onsearch:E.onsearch||null,onbeforesearch:E.onbeforesearch||null},S.selectIndex=function(V){var G=V.getAttribute("id"),ne=V.getAttribute("data-text"),he=V.getAttribute("data-value"),ce=V.children[0].src||"";typeof S.options.onselect=="function"&&S.options.onselect(S,ne,he,G,ce),S.close()},S.open=function(){w.style.display="block"},S.close=function(){ee&&clearTimeout(ee),S.terms="",A.innerHTML="",w.style.display=""},S.isOpened=function(){return!!w.style.display},S.keydown=function(V){S.isOpened()&&(V.key=="Enter"?a!==null&&A.children[a]?(S.selectIndex(A.children[a]),V.preventDefault()):S.close():V.key==="ArrowUp"?(a!==null&&A.children[0]&&(A.children[a].classList.remove("selected"),!S.options.forceSelect&&a===0?a=null:(a=Math.max(0,a-1),A.children[a].classList.add("selected"))),V.preventDefault()):V.key==="ArrowDown"&&(a==null?a=-1:A.children[a].classList.remove("selected"),a<9&&A.children[a+1]&&a++,A.children[a].classList.add("selected"),V.preventDefault()))},S.keyup=function(V){if(!S.options.searchByNode&&S.options.input)if(S.options.input.tagName==="DIV")var G=S.options.input.innerText;else var G=S.options.input.value;else{var ne=s.getNode();if(ne)var G=ne.innerText}if(typeof S.options.onbeforesearch=="function"){var he=S.options.onbeforesearch(S,G);if(he)G=he;else if(he===!1)return}S(G)},S.blur=function(V){S.close()},S.options.input&&(S.options.input.addEventListener("keyup",S.keyup),S.options.input.addEventListener("keydown",S.keydown),S.options.input.addEventListener("blur",S.blur));var A=document.createElement("div");return A.classList.add("jsearch_container"),A.onmousedown=r,w.appendChild(A),w.classList.add("jsearch"),w.search=S,S}function St(w,E){var a={};if(a.options={},a.currentImage=null,E&&(a.options=E),w.setAttribute("tabindex","900"),a.options.items=[],!w.classList.contains("jslider")){if(w.classList.add("jslider"),w.classList.add("unselectable"),a.options.height&&(w.style.minHeight=parseInt(a.options.height)+"px"),a.options.width&&(w.style.width=parseInt(a.options.width)+"px"),a.options.grid){w.classList.add("jslider-grid");var r=w.children.length;r>4&&w.setAttribute("data-total",r-4),w.setAttribute("data-number",r>4?4:r)}var B=document.createElement("div");if(B.classList.add("jslider-counter"),w.children.length>0)for(var te=0;te<w.children.length;te++){a.options.items.push(w.children[te]);var ee=document.createElement("div");ee.onclick=function(){var ne=Array.prototype.slice.call(B.children).indexOf(this);a.show(a.currentImage=a.options.items[ne])},B.appendChild(ee)}var S=document.createElement("div");S.className="jslider-caption";var A=document.createElement("div"),V=document.createElement("div");V.className="jslider-close",V.innerHTML="",V.onclick=function(){a.close()},A.appendChild(S),A.appendChild(V)}a.updateCounter=function(ne){for(var he=0;he<B.children.length;he++)if(B.children[he].classList.contains("jslider-counter-focus")){B.children[he].classList.remove("jslider-counter-focus");break}B.children[ne].classList.add("jslider-counter-focus")},a.show=function(ne){if(!ne)var ne=w.children[0];w.classList.add("jslider-focus"),w.classList.remove("jslider-grid"),w.appendChild(A),w.appendChild(B);var he=a.options.items.indexOf(ne);a.updateCounter(he);for(var ce=0;ce<w.children.length;ce++)w.children[ce].style.display="";ne.style.display="block",ne.previousElementSibling?w.classList.add("jslider-left"):w.classList.remove("jslider-left"),ne.nextElementSibling&&ne.nextElementSibling.tagName=="IMG"?w.classList.add("jslider-right"):w.classList.remove("jslider-right"),a.currentImage=ne,a.currentImage.offsetHeight>a.currentImage.offsetWidth&&a.currentImage.classList.add("jslider-vertical"),A.children[0].innerText=a.currentImage.getAttribute("title")},a.open=function(){a.show(),typeof a.options.onopen=="function"&&a.options.onopen(w)},a.close=function(){w.classList.remove("jslider-focus"),w.classList.remove("jslider-left"),w.classList.remove("jslider-right"),a.options.grid&&w.classList.add("jslider-grid");for(var ne=0;ne<w.children.length;ne++)w.children[ne].style.display="";B.remove(),A.remove(),a.currentImage=null,typeof a.options.onclose=="function"&&a.options.onclose(w)},a.reset=function(){w.innerHTML=""},a.next=function(){var ne=a.currentImage.nextElementSibling;ne&&ne.tagName==="IMG"&&a.show(a.currentImage.nextElementSibling)},a.prev=function(){a.currentImage.previousElementSibling&&a.show(a.currentImage.previousElementSibling)};var G=function(ne){if(ne.target.tagName=="IMG")a.show(ne.target);else if(!ne.target.classList.contains("jslider-close")&&!(ne.target.parentNode.classList.contains("jslider-counter")||ne.target.classList.contains("jslider-counter"))){var he=ne.offsetX||ne.changedTouches[0].clientX;ne.target.clientWidth-he<40?a.next():he<40&&a.prev()}};return"ontouchend"in document.documentElement?w.addEventListener("touchend",G):w.addEventListener("mouseup",G),w.addEventListener("swipeleft",function(ne){a.next(),ne.preventDefault(),ne.stopPropagation()}),w.addEventListener("swiperight",function(ne){a.prev(),ne.preventDefault(),ne.stopPropagation()}),w.addEventListener("keydown",function(ne){ne.which==27&&a.close()}),w.slider=a,a}function Ft(w,E){if(w.tags)return w.tags.setOptions(E,!0);var a={type:"tags"};a.options={};var r=function(){return!!(a.options.limit&&w.children.length>=a.options.limit)},B=null,te=null;a.setOptions=function(Q,pe){var we={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var U in we)Q&&Q.hasOwnProperty(U)?a.options[U]=Q[U]:(typeof a.options[U]>"u"||pe===!0)&&(a.options[U]=we[U]);return a.options.placeholder?w.setAttribute("data-placeholder",a.options.placeholder):w.removeAttribute("data-placeholder"),w.placeholder=a.options.placeholder,a.setValue(a.options.value),V(),a.options.search?te||(te=document.createElement("div"),w.parentNode.insertBefore(te,w.nextSibling),B=ht(te,{data:a.options.search,onselect:function(J,v,D){a.selectIndex(v,D)}})):te&&(B=null,te.remove(),te=null),a},a.add=function(Q,pe){if(typeof a.options.onbeforechange=="function"){var we=a.options.onbeforechange(w,a,a.options.value,Q);if(we===!1)return!1;we!=null&&(Q=we)}if(B&&B.close(),r())typeof a.options.onlimit=="function"?a.options.onlimit(a,a.options.limit):alert(d.translate("You reach the limit number of entries")+" "+a.options.limit);else{var U=s.getNode();if(U&&U.parentNode&&U.parentNode.classList.contains("jtags")&&U.nextSibling&&!(U.nextSibling.innerText&&U.nextSibling.innerText.trim()))J=U.nextSibling;else{if(w.lastChild&&(w.lastChild.innerText.trim()||w.removeChild(w.lastChild)),!Q||typeof Q=="string")var J=S(Q,Q,U);else for(var v=0;v<=Q.length;v++)if(!r()){if(!Q[v]||typeof Q[v]=="string")var D=Q[v]||"",X=null;else var D=Q[v].text,X=Q[v].value;var J=S(D,X)}A()}pe&&ee(J)}},a.setLimit=function(Q){for(a.options.limit=Q,w.children.length-Q;w.children.length>Q;)w.removeChild(w.lastChild)},a.remove=function(Q){Q.parentNode.removeChild(Q),w.children.length?A():a.add("",!0),typeof a.options.onremoveitem=="function"&&a.options.onremoveitem(w,a,Q)},a.getData=function(){for(var Q=[],pe=0;pe<w.children.length;pe++){var we=w.children[pe].innerText.replace(`
`,""),U=w.children[pe].getAttribute("data-value");U||(U=we),(we||U)&&Q.push({text:we,value:U})}return Q},a.getValue=function(Q){var pe=null;if(Q!=null)pe=w.children[Q].getAttribute("data-value"),pe||(pe=w.children[Q].innerText.replace(`
`,""));else{for(var we=[],U=0;U<w.children.length;U++)pe=w.children[U].innerText.replace(`
`,""),pe&&we.push(a.getValue(U));pe=we.join(",")}return pe},a.setValue=function(Q){if(!Q)a.reset();else if(w.value!=Q)if(Array.isArray(Q))a.add(Q);else{var pe=(""+Q).trim(),we=ne(pe);w.innerHTML="",a.add(we)}},a.reset=function(){w.classList.add("jtags-empty"),w.innerHTML="<div></div>",A()},a.isValid=function(){for(var Q=0,pe=0;pe<w.children.length;pe++)w.children[pe].classList.contains("jtags_error")&&Q++;return Q==0},a.selectIndex=function(Q,pe){var we=s.getNode();we&&(we.innerText=Q,pe&&we.setAttribute("data-value",pe),we.classList.remove("jtags_error"),r()||a.add("",!0))},a.search=function(Q){Q.innerText},a.destroy=function(){w.removeEventListener("mouseup",De),w.removeEventListener("keydown",ce),w.removeEventListener("keyup",fe),w.removeEventListener("paste",Ee),w.removeEventListener("focus",Se),w.removeEventListener("blur",qe),w.parentNode.removeChild(w)};var ee=function(Q){if(w.children.length){var pe=document.createRange(),we=window.getSelection();if(!Q)var Q=w.childNodes[w.childNodes.length-1];pe.setStart(Q,Q.length),pe.collapse(!0),we.removeAllRanges(),we.addRange(pe),w.scrollLeft=w.scrollWidth}},S=function(Q,pe,we){var U=document.createElement("div");return U.textContent=Q||"",pe&&U.setAttribute("data-value",pe),we&&we.parentNode.classList.contains("jtags")?w.insertBefore(U,we.nextSibling):w.appendChild(U),U},A=function(){var Q=a.getValue();Q!=a.options.value&&(a.options.value=Q,typeof a.options.onchange=="function"&&a.options.onchange(w,a,a.options.value),w.value!=a.options.value&&(w.value=a.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))),V()},V=function(){for(var Q=0;Q<w.children.length;Q++)w.children[Q].tagName==="DIV"&&(a.getValue(Q)?(w.children[Q].classList.add("jtags_label"),typeof a.options.validation=="function"&&a.getValue(Q)?a.options.validation(w.children[Q],w.children[Q].innerText,w.children[Q].getAttribute("data-value"))?w.children[Q].classList.remove("jtags_error"):w.children[Q].classList.add("jtags_error"):w.children[Q].classList.remove("jtags_error")):w.children[Q].classList.remove("jtags_label"));G()},G=function(){w.innerText.trim()?w.classList.remove("jtags-empty"):(!w.children.length||w.children[0].tagName==="BR")&&(w.innerHTML="",ee(S()))},ne=function(Q){var pe=[],we="";if(Q=Q.trim(),Q){for(var U=0;U<Q.length;U++)Q[U]==","||Q[U]==";"||Q[U]==`
`?we&&(pe.push(we.trim()),we=""):we+=Q[U];we&&pe.push(we)}return pe},he=0,ce=function(Q){if(he=window.getSelection().anchorOffset,G(),Q.key==="Tab"||Q.key===";"||Q.key===","){var pe=window.getSelection().anchorOffset;pe>1&&(r()?typeof a.options.onlimit=="function"&&a.options.onlimit(a,a.options.limit):a.add("",!0)),Q.preventDefault()}else if(Q.key=="Enter"){if(!B||!B.isOpened()){var pe=window.getSelection().anchorOffset;pe>1&&(r()||a.add("",!0)),Q.preventDefault()}}else Q.key=="Backspace"&&w.children.length==1&&window.getSelection().anchorOffset<1&&Q.preventDefault();B&&B.keydown(Q),G()},fe=function(Q){if(Q.which==39){var pe=window.getSelection().anchorOffset;pe>1&&pe==he&&a.add("",!0)}else Q.which==13||Q.which==38||Q.which==40?Q.preventDefault():B&&B.keyup(Q);V()},Ee=function(Q){if(Q.clipboardData||Q.originalEvent.clipboardData)var pe=(Q.originalEvent||Q).clipboardData.getData("text/plain");else if(window.clipboardData)var pe=window.clipboardData.getData("Text");var we=ne(pe);if(typeof a.options.onbeforepaste=="function"){var U=a.options.onbeforepaste(w,a,we);if(U===!1)return Q.preventDefault(),!1;U&&(we=U)}we.length>1?(a.add(we,!0),Q.preventDefault()):we[0]&&(document.execCommand("insertText",!1,we[0]),Q.preventDefault())},De=function(Q){if(Q.target.parentNode&&Q.target.parentNode.classList.contains("jtags")&&(Q.target.classList.contains("jtags_label")||Q.target.classList.contains("jtags_error"))){var pe=Q.target.getBoundingClientRect();pe.width-(Q.clientX-pe.left)<16&&a.remove(Q.target)}Q.target==w&&ee()},Se=function(){w.classList.contains("jtags-focus")||((!w.children.length||a.getValue(w.children.length-1))&&(r()||S("")),typeof a.options.onfocus=="function"&&a.options.onfocus(w,a,a.getValue()),w.classList.add("jtags-focus"))},qe=function(){if(w.classList.contains("jtags-focus")){B&&B.close();for(var Q=0;Q<w.children.length-1;Q++)a.getValue(Q)||w.removeChild(w.children[Q]);A(),w.classList.remove("jtags-focus"),typeof a.options.onblur=="function"&&a.options.onblur(w,a,a.getValue())}},$e=function(){"touchend"in document.documentElement?w.addEventListener("touchend",De):w.addEventListener("mouseup",De),w.addEventListener("keydown",ce),w.addEventListener("keyup",fe),w.addEventListener("paste",Ee),w.addEventListener("focus",Se),w.addEventListener("blur",qe),w.setAttribute("contenteditable",!0),w.classList.add("jtags"),a.setOptions(E),typeof a.options.onload=="function"&&a.options.onload(w,a),w.change=a.setValue,w.val=function(Q){if(Q===void 0)return a.getValue();a.setValue(Q)},w.tags=a};return $e(),a}function Et(w,E){var a={};a.options={};var r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var B in r)E&&E.hasOwnProperty(B)?a.options[B]=E[B]:a.options[B]=r[B];a.options.multiple==!0&&w.setAttribute("data-multiple",!0),w.content=[],w.classList.add("jupload"),a.options.input==!0&&w.classList.add("input"),a.add=function(A){if(a.options.multiple==!1&&(w.content=[],w.innerText=""),a.options.type=="image"){var V=document.createElement("img");V.setAttribute("src",A.file),V.setAttribute("tabindex",-1),w.getAttribute("name")||(V.className="jfile",V.content=A),w.appendChild(V)}else{if(A.name)var G=A.name;else var G=A.file;var ne=document.createElement("div");ne.innerText=G||a.options.type,ne.classList.add("jupload-item"),ne.setAttribute("tabindex",-1),w.appendChild(ne)}A.content&&(A.file=s.guid()),w.content.push(A),typeof a.options.onchange=="function"&&a.options.onchange(w,A)},a.addFromFile=function(A){var V=A.type.split("/");if(V[0]==a.options.type){var G=new FileReader;G.addEventListener("load",function(ne){var he={file:ne.srcElement.result,extension:A.name.substr(A.name.lastIndexOf(".")+1),name:A.name,size:A.size,lastmodified:A.lastModified,content:ne.srcElement.result};a.add(he)}),G.readAsDataURL(A)}else alert(d.translate("This extension is not allowed"))},a.addFromUrl=function(A){if(A.substr(0,4)!="data"&&!a.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(A.substr(0,4)=="data"){var V=A.split(";");V=V[0].split("/");var G=V[0].replace("data:","");if(G==a.options.type){var ne={file:A,name:"",extension:V[1],content:A};a.add(ne)}else alert(a.options.text.extensionNotAllowed)}else{var V=A.substr(A.lastIndexOf(".")+1);A=a.options.remoteParser+A,I({url:A,type:"GET",dataType:"blob",success:function(ce){}})}};var te=a.options.type+"/"+a.options.extension,ee=document.createElement("input");ee.type="file",ee.setAttribute("accept",te),ee.onchange=function(){for(var A=0;A<this.files.length;A++)a.addFromFile(this.files[A])},a.options.multiple==!0&&ee.setAttribute("multiple",!0);var S=null;return w.addEventListener("click",function(A){S=null,!w.children.length||A.target===w?s.click(ee):A.target.parentNode==w&&(S=A.target)}),w.addEventListener("dblclick",function(A){s.click(ee)}),w.addEventListener("dragenter",function(A){w.style.border="1px dashed #000"}),w.addEventListener("dragleave",function(A){w.style.border="1px solid #eee"}),w.addEventListener("dragstop",function(A){w.style.border="1px solid #eee"}),w.addEventListener("dragover",function(A){A.preventDefault()}),w.addEventListener("keydown",function(A){if(S&&A.which==46){var V=Array.prototype.indexOf.call(w.children,S);V>=0&&(w.content.splice(V,1),S.remove(),S=null)}}),w.addEventListener("drop",function(A){A.preventDefault(),A.stopPropagation();var V=(A.originalEvent||A).dataTransfer.getData("text/html"),G=(A.originalEvent||A).dataTransfer.files;if(G.length)for(var ne=0;ne<A.dataTransfer.files.length;ne++)a.addFromFile(A.dataTransfer.files[ne]);else if(V){a.options.multiple==!1&&(w.innerText="");var he=document.createElement("div");he.innerHTML=V;var ce=he.querySelectorAll("img");if(ce.length)for(var ne=0;ne<ce.length;ne++)a.addFromUrl(ce[ne].src)}return w.style.border="1px solid #eee",!1}),w.val=function(A){if(A===void 0)return w.content&&w.content.length?w.content:null;if(w.innerText="",w.content=[],A)if(Array.isArray(A))for(var V=0;V<A.length;V++)typeof A[V]=="string"?a.add({file:A[V]}):a.add(A[V]);else typeof A=="string"&&a.add({file:A})},w.upload=w.image=a,a}var Ot=R(195),Tt=R.n(Ot),gt={...d,...s,version:"5.12.0",setExtensions:function(w){if(typeof w=="object")for(var E=Object.keys(w),a=0;a<E.length;a++)gt[E[a]]=w[E[a]]},tracking:P,path:j,sorting:h,lazyLoading:C,ajax:I,animation:O,calendar:ge,color:je,contextmenu:_e,dropdown:Ue,editor:Ne,floating:bt,form:Be,mask:q,modal:Je,notification:it,palette:me,picker:He,progressbar:dt,rating:mt,search:ht,slider:St,tabs:Le,tags:Ft,toolbar:ut,upload:Et,validations:Ae};gt.image=Et,gt.image.create=function(w){var E=document.createElement("img");return E.setAttribute("src",w.file),E.className="jfile",E.setAttribute("tabindex",-1),E.content=w,E},gt.tracker=Be,gt.loading=O.loading,gt.sha512=Tt(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const w=function(Q,pe){return Q[pe.type]&&Q[pe.type]==pe||Q.component&&Q.component==pe?!0:Q.parentNode?w(Q.parentNode,pe):!1},E=function(Q){let pe=window.jSuitesStateControl;if(pe&&pe.length>0)for(let we=0;we<pe.length;we++)pe[we]&&!w(Q,pe[we])&&pe[we].close()};let a=15,r=!1,B={x:null,y:null},te=document.createElement("div");te.classList.add("jtooltip");const ee=function(Q){return Q&&(Q.shadowRoot||Q.tagName&&Q.tagName.includes("-"))},S=function(Q){let pe,we,U=Q.path||Q.composedPath&&Q.composedPath();return U?(we=U[0],we&&ee(we)&&!we.shadowRoot&&Q.toElement&&(we=Q.toElement)):(Q.target&&ee(Q.target)?pe=Q.target.shadowRoot:pe=document,we=pe.elementFromPoint(x,y)),we},A=function(Q){if(Q.changedTouches&&Q.changedTouches[0])var pe=Q.changedTouches[0].clientX,we=Q.changedTouches[0].clientY;else var pe=Q.clientX,we=Q.clientY;let U=S(Q),J=U&&U.tagName==="DIV"&&U.getAttribute("contentEditable"),v=gt.findElement(U,"jpanel");if(v&&!v.classList.contains("readonly")&&!J){let D=v.getBoundingClientRect(),X=0;v.style.rotate&&(X=parseFloat(v.style.rotate));let ue="move";U.getAttribute("data-action")?ue=U.getAttribute("data-action"):v.style.cursor?ue="resize":v.style.cursor="move",r={action:ue,a:X,e:v,x:pe,y:we,l:D.left,t:D.top,b:D.bottom,r:D.right,w:D.width,h:D.height,d:v.style.cursor,actioned:!1},v.style.width||(v.style.width=D.width+"px"),v.style.height||(v.style.height=D.height+"px")}else r=!1;E(U),fe(Q)},V=function(Q,pe,we,U,J,v){const D=we-Q,X=U-pe,ue=J-Q,K=v-pe;let le=Math.atan2(X,D),Me=Math.atan2(K,ue)-le;return Me=Me*(180/Math.PI),Me<0&&(Me+=360),Me},G=function(Q){r&&r.e&&(typeof r.e.refresh=="function"&&B.actioned&&r.e.refresh(),r.e.style.cursor=""),B={x:null,y:null},r=!1},ne=function(Q){if(r){let v=Q.clientX||Q.pageX,D=Q.clientY||Q.pageY;if(B.x==null&&B.y==null&&(B.x=v,B.y=D),r.action==="move"){var pe=v-B.x,we=D-B.y,U=r.e.offsetTop+we,J=r.e.offsetLeft+pe;r.e.style.top=U+"px",r.e.style.left=J+"px",typeof r.e.refresh=="function"&&(B.actioned=!0,r.e.refresh("position",U,J))}else if(r.action==="rotate"){let X=r.l+r.w/2,ue=r.t+r.h/2,K=V(X,ue,r.x,r.y,v,D);K=K+r.a%360,K=Math.round(K/2)*2,r.e.style.rotate=`${K}deg`,typeof r.e.refresh=="function"&&(B.actioned=!0,r.e.refresh("rotate",K))}else if(r.action==="resize"){let X=null,ue=null,K=null,le=null;r.d=="e-resize"||r.d=="ne-resize"||r.d=="se-resize"?(K=r.e.offsetWidth+(v-B.x),Q.shiftKey&&(le=r.e.offsetHeight+(v-B.x)*(r.e.offsetHeight/r.e.offsetWidth))):(r.d==="w-resize"||r.d=="nw-resize"||r.d=="sw-resize")&&(ue=r.e.offsetLeft+(v-B.x),K=r.e.offsetLeft+r.e.offsetWidth-ue,Q.shiftKey&&(le=r.e.offsetHeight-(v-B.x)*(r.e.offsetHeight/r.e.offsetWidth))),r.d=="s-resize"||r.d=="se-resize"||r.d=="sw-resize"?le||(le=r.e.offsetHeight+(D-B.y)):(r.d==="n-resize"||r.d=="ne-resize"||r.d=="nw-resize")&&(X=r.e.offsetTop+(D-B.y),le=r.e.offsetTop+r.e.offsetHeight-X),X&&(r.e.style.top=X+"px"),ue&&(r.e.style.left=ue+"px"),K&&(r.e.style.width=K+"px"),le&&(r.e.style.height=le+"px"),typeof r.e.refresh=="function"&&(B.actioned=!0,r.e.refresh("dimensions",K,le))}B.x=v,B.y=D}else{let v=S(Q),D=gt.findElement(v,"jpanel");if(D){if(D.classList.contains("jpanel-controls")){let ue=v.getAttribute("data-position");ue?D.style.cursor=ue:D.style.cursor=""}else if(D.getAttribute("tabindex")){let ue=D.getBoundingClientRect();Q.clientY-ue.top<a?ue.width-(Q.clientX-ue.left)<a?D.style.cursor="ne-resize":Q.clientX-ue.left<a?D.style.cursor="nw-resize":D.style.cursor="n-resize":ue.height-(Q.clientY-ue.top)<a?ue.width-(Q.clientX-ue.left)<a?D.style.cursor="se-resize":Q.clientX-ue.left<a?D.style.cursor="sw-resize":D.style.cursor="s-resize":ue.width-(Q.clientX-ue.left)<a?D.style.cursor="e-resize":Q.clientX-ue.left<a?D.style.cursor="w-resize":D.style.cursor=""}}}};let he=["n","ne","e","se","s","sw","w","nw","rotate"];he.forEach(function(Q,pe){he[pe]=document.createElement("div"),he[pe].classList.add("jpanel-action"),Q==="rotate"?he[pe].setAttribute("data-action","rotate"):(he[pe].setAttribute("data-action","resize"),he[pe].setAttribute("data-position",Q+"-resize"))});let ce;const fe=function(Q){let pe=S(Q),we=gt.findElement(pe,"jpanel");we&&!we.classList.contains("readonly")&&we.classList.contains("jpanel-controls")?(we.append(...he),we.classList.contains("jpanel-rotate")||he[he.length-1].remove(),ce=we):Ee()},Ee=function(Q){ce&&(he.forEach(function(pe){pe.remove()}),ce=null)},De=function(Q){var we=S(Q).getAttribute("data-tooltip");if(we){if(te.innerText=we,Q.changedTouches&&Q.changedTouches[0])var U=Q.changedTouches[0].clientX,J=Q.changedTouches[0].clientY;else var U=Q.clientX,J=Q.clientY;te.style.top=J+"px",te.style.left=U+"px",document.body.appendChild(te)}else te.innerText&&(te.innerText="",document.body.removeChild(te))},Se=function(Q){var pe=document.activeElement;if(pe&&typeof pe.contextmenu=="function")pe.contextmenu(Q),Q.preventDefault(),Q.stopImmediatePropagation();else if(pe=gt.findElement(Q.target,function(U){return U.tagName&&U.getAttribute("aria-contextmenu-id")}),pe){var we=document.querySelector("#"+pe);we?(we.contextmenu.open(Q),Q.preventDefault(),Q.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+pe)}},qe=function(Q){let pe=document.activeElement;pe&&Q.key==="Delete"&&typeof pe.delete=="function"&&(pe.delete(),Q.preventDefault(),Q.stopImmediatePropagation());let we=window.jSuitesStateControl;we&&we.length>0&&(pe=we[we.length-1],pe&&Q.key==="Escape"&&typeof pe.isOpened=="function"&&typeof pe.close=="function"&&pe.isOpened()&&(pe.close(),Q.preventDefault(),Q.stopImmediatePropagation()))},$e=function(Q){(Q.target.getAttribute("data-mask")||Q.target.mask)&&gt.mask(Q)};document.addEventListener("focusin",fe),document.addEventListener("mouseup",G),document.addEventListener("mousedown",A),document.addEventListener("mousemove",ne),document.addEventListener("mouseover",De),document.addEventListener("keydown",qe),document.addEventListener("contextmenu",Se),document.addEventListener("input",$e)}();var Rt=gt})(),c=W.default}(),c})}(jsuites$1)),jsuites$1.exports}var dist=dist$1.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();(function(n,l){module.exports=l()})(dist,function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(n){var l;n.exports=(function(){var c={765:function(W,b){var u;u=function(d){d.version="1.0.2";var k=Math;function P(je,ie){for(var _e=0,Ye=0;_e<je.length;++_e)Ye=ie*Ye+je[_e];return Ye}function g(je,ie,_e,Ye,Ue){if(ie===0)return _e;if(ie===1)return Ye;for(var He=2/je,ut=Ye,Y=1;Y<ie;++Y)ut=Ye*Y*He+Ue*_e,_e=Ye,Ye=ut;return ut}function s(je,ie,_e,Ye,Ue){return function(He,ut){if(Ye){if(He===0)return Ye==1?-1/0:1/0;if(He<0)return NaN}return ut===0?je(He):ut===1?ie(He):ut<0?NaN:g(He,ut|=0,je(He),ie(He),Ue)}}var m,j,h,C,T,I,_,O,N,F,Z,q,se,ge=function(){var je=.636619772,ie=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),_e=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Ye=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ue=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function He(tt){var Ae=0,Te=0,Be=0,ze=tt*tt;if(tt<8)Ae=(Te=P(ie,ze))/(Be=P(_e,ze));else{var Je=tt-.785398164;Te=P(Ye,ze=64/ze),Be=P(Ue,ze),Ae=k.sqrt(je/tt)*(k.cos(Je)*Te-k.sin(Je)*Be*8/tt)}return Ae}var ut=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),Y=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Ne=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ve=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function bt(tt){var Ae=0,Te=0,Be=0,ze=tt*tt,Je=k.abs(tt)-2.356194491;return Math.abs(tt)<8?Ae=(Te=tt*P(ut,ze))/(Be=P(Y,ze)):(Te=P(Ne,ze=64/ze),Be=P(Ve,ze),Ae=k.sqrt(je/k.abs(tt))*(k.cos(Je)*Te-k.sin(Je)*Be*8/k.abs(tt)),tt<0&&(Ae=-Ae)),Ae}return function tt(Ae,Te){if(Te=Math.round(Te),!isFinite(Ae))return isNaN(Ae)?Ae:0;if(Te<0)return(Te%2?-1:1)*tt(Ae,-Te);if(Ae<0)return(Te%2?-1:1)*tt(-Ae,Te);if(Te===0)return He(Ae);if(Te===1)return bt(Ae);if(Ae===0)return 0;var Be=0;if(Ae>Te)Be=g(Ae,Te,He(Ae),bt(Ae),-1);else{for(var ze=!1,Je=0,Qe=0,it=1,dt=0,mt=2/Ae,ht=2*k.floor((Te+k.floor(k.sqrt(40*Te)))/2);ht>0;ht--)dt=ht*mt*it-Je,Je=it,it=dt,k.abs(it)>1e10&&(it*=1e-10,Je*=1e-10,Be*=1e-10,Qe*=1e-10),ze&&(Qe+=it),ze=!ze,ht==Te&&(Be=Je);Be/=Qe=2*Qe-it}return Be}}(),ae=(m=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),h=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),T=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),I=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),_=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),O=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),N=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),s(function(je){var ie=0,_e=0,Ye=0,Ue=je*je,He=je-.785398164;return je<8?ie=(_e=P(j,Ue))/(Ye=P(h,Ue))+m*ge(je,0)*k.log(je):(_e=P(C,Ue=64/Ue),Ye=P(T,Ue),ie=k.sqrt(m/je)*(k.sin(He)*_e+k.cos(He)*Ye*8/je)),ie},function(je){var ie=0,_e=0,Ye=0,Ue=je*je,He=je-2.356194491;return je<8?ie=(_e=je*P(I,Ue))/(Ye=P(_,Ue))+m*(ge(je,1)*k.log(je)-1/je):(_e=P(O,Ue=64/Ue),Ye=P(N,Ue),ie=k.sqrt(m/je)*(k.sin(He)*_e+k.cos(He)*Ye*8/je)),ie},0,1,-1)),me=(F=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Z=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),q=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),se=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function je(ie,_e){if((_e=Math.round(_e))===0)return function(Ve){return Ve<=3.75?P(F,Ve*Ve/14.0625):k.exp(k.abs(Ve))/k.sqrt(k.abs(Ve))*P(Z,3.75/k.abs(Ve))}(ie);if(_e===1)return function(Ve){return Ve<3.75?Ve*P(q,Ve*Ve/14.0625):(Ve<0?-1:1)*k.exp(k.abs(Ve))/k.sqrt(k.abs(Ve))*P(se,3.75/k.abs(Ve))}(ie);if(_e<0)return NaN;if(k.abs(ie)===0)return 0;if(ie==1/0)return 1/0;var Ye,Ue=0,He=2/k.abs(ie),ut=0,Y=1,Ne=0;for(Ye=2*k.round((_e+k.round(k.sqrt(40*_e)))/2);Ye>0;Ye--)Ne=Ye*He*Y+ut,ut=Y,Y=Ne,k.abs(Y)>1e10&&(Y*=1e-10,ut*=1e-10,Ue*=1e-10),Ye==_e&&(Ue=ut);return Ue*=je(ie,0)/Y,ie<0&&_e%2?-Ue:Ue}),Le=function(){var je=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ie=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),_e=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Ye=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return s(function(Ue){return Ue<=2?-k.log(Ue/2)*me(Ue,0)+P(je,Ue*Ue/4):k.exp(-Ue)/k.sqrt(Ue)*P(ie,2/Ue)},function(Ue){return Ue<=2?k.log(Ue/2)*me(Ue,1)+1/Ue*P(_e,Ue*Ue/4):k.exp(-Ue)/k.sqrt(Ue)*P(Ye,2/Ue)},0,2,1)}();d.besselj=ge,d.bessely=ae,d.besseli=me,d.besselk=Le},u(typeof DO_NOT_EXPORT_BESSEL>"u"?b:{})},162:function(W){var b;W.exports=(b=function(u,d){var k=Array.prototype.concat,P=Array.prototype.slice,g=Object.prototype.toString;function s(N,F){var Z=N>F?N:F;return u.pow(10,17-~~(u.log(Z>0?Z:-Z)*u.LOG10E))}var m=Array.isArray||function(N){return g.call(N)==="[object Array]"};function j(N){return g.call(N)==="[object Function]"}function h(N){return typeof N=="number"&&N-N==0}function C(){return new C._init(arguments)}function T(){return 0}function I(){return 1}function _(N,F){return N===F?1:0}C.fn=C.prototype,C._init=function(N){if(m(N[0]))if(m(N[0][0])){j(N[1])&&(N[0]=C.map(N[0],N[1]));for(var F=0;F<N[0].length;F++)this[F]=N[0][F];this.length=N[0].length}else this[0]=j(N[1])?C.map(N[0],N[1]):N[0],this.length=1;else if(h(N[0]))this[0]=C.seq.apply(null,N),this.length=1;else{if(N[0]instanceof C)return C(N[0].toArray());this[0]=[],this.length=1}return this},C._init.prototype=C.prototype,C._init.constructor=C,C.utils={calcRdx:s,isArray:m,isFunction:j,isNumber:h,toVector:function(N){return k.apply([],N)}},C._random_fn=u.random,C.setRandom=function(N){if(typeof N!="function")throw new TypeError("fn is not a function");C._random_fn=N},C.extend=function(N){var F,Z;if(arguments.length===1){for(Z in N)C[Z]=N[Z];return this}for(F=1;F<arguments.length;F++)for(Z in arguments[F])N[Z]=arguments[F][Z];return N},C.rows=function(N){return N.length||1},C.cols=function(N){return N[0].length||1},C.dimensions=function(N){return{rows:C.rows(N),cols:C.cols(N)}},C.row=function(N,F){return m(F)?F.map(function(Z){return C.row(N,Z)}):N[F]},C.rowa=function(N,F){return C.row(N,F)},C.col=function(N,F){if(m(F)){var Z=C.arange(N.length).map(function(){return new Array(F.length)});return F.forEach(function(ge,ae){C.arange(N.length).forEach(function(me){Z[me][ae]=N[me][ge]})}),Z}for(var q=new Array(N.length),se=0;se<N.length;se++)q[se]=[N[se][F]];return q},C.cola=function(N,F){return C.col(N,F).map(function(Z){return Z[0]})},C.diag=function(N){for(var F=C.rows(N),Z=new Array(F),q=0;q<F;q++)Z[q]=[N[q][q]];return Z},C.antidiag=function(N){for(var F=C.rows(N)-1,Z=new Array(F),q=0;F>=0;F--,q++)Z[q]=[N[q][F]];return Z},C.transpose=function(N){var F,Z,q,se,ge,ae=[];for(m(N[0])||(N=[N]),Z=N.length,q=N[0].length,ge=0;ge<q;ge++){for(F=new Array(Z),se=0;se<Z;se++)F[se]=N[se][ge];ae.push(F)}return ae.length===1?ae[0]:ae},C.map=function(N,F,Z){var q,se,ge,ae,me;for(m(N[0])||(N=[N]),se=N.length,ge=N[0].length,ae=Z?N:new Array(se),q=0;q<se;q++)for(ae[q]||(ae[q]=new Array(ge)),me=0;me<ge;me++)ae[q][me]=F(N[q][me],q,me);return ae.length===1?ae[0]:ae},C.cumreduce=function(N,F,Z){var q,se,ge,ae,me;for(m(N[0])||(N=[N]),se=N.length,ge=N[0].length,ae=Z?N:new Array(se),q=0;q<se;q++)for(ae[q]||(ae[q]=new Array(ge)),ge>0&&(ae[q][0]=N[q][0]),me=1;me<ge;me++)ae[q][me]=F(ae[q][me-1],N[q][me]);return ae.length===1?ae[0]:ae},C.alter=function(N,F){return C.map(N,F,!0)},C.create=function(N,F,Z){var q,se,ge=new Array(N);for(j(F)&&(Z=F,F=N),q=0;q<N;q++)for(ge[q]=new Array(F),se=0;se<F;se++)ge[q][se]=Z(q,se);return ge},C.zeros=function(N,F){return h(F)||(F=N),C.create(N,F,T)},C.ones=function(N,F){return h(F)||(F=N),C.create(N,F,I)},C.rand=function(N,F){return h(F)||(F=N),C.create(N,F,C._random_fn)},C.identity=function(N,F){return h(F)||(F=N),C.create(N,F,_)},C.symmetric=function(N){var F,Z,q=N.length;if(N.length!==N[0].length)return!1;for(F=0;F<q;F++)for(Z=0;Z<q;Z++)if(N[Z][F]!==N[F][Z])return!1;return!0},C.clear=function(N){return C.alter(N,T)},C.seq=function(N,F,Z,q){j(q)||(q=!1);var se,ge=[],ae=s(N,F),me=(F*ae-N*ae)/((Z-1)*ae),Le=N;for(se=0;Le<=F&&se<Z;Le=(N*ae+me*ae*++se)/ae)ge.push(q?q(Le,se):Le);return ge},C.arange=function(N,F,Z){var q,se=[];if(Z=Z||1,F===d&&(F=N,N=0),N===F||Z===0)return[];if(N<F&&Z<0)return[];if(N>F&&Z>0)return[];if(Z>0)for(q=N;q<F;q+=Z)se.push(q);else for(q=N;q>F;q+=Z)se.push(q);return se},C.slice=function(){function N(F,Z,q,se){var ge,ae=[],me=F.length;if(Z===d&&q===d&&se===d)return C.copy(F);if(se=se||1,(Z=(Z=Z||0)>=0?Z:me+Z)===(q=(q=q||F.length)>=0?q:me+q)||se===0)return[];if(Z<q&&se<0)return[];if(Z>q&&se>0)return[];if(se>0)for(ge=Z;ge<q;ge+=se)ae.push(F[ge]);else for(ge=Z;ge>q;ge+=se)ae.push(F[ge]);return ae}return function(F,Z){var q,se;return h((Z=Z||{}).row)?h(Z.col)?F[Z.row][Z.col]:N(C.rowa(F,Z.row),(q=Z.col||{}).start,q.end,q.step):h(Z.col)?N(C.cola(F,Z.col),(se=Z.row||{}).start,se.end,se.step):(se=Z.row||{},q=Z.col||{},N(F,se.start,se.end,se.step).map(function(ge){return N(ge,q.start,q.end,q.step)}))}}(),C.sliceAssign=function(N,F,Z){var q,se;if(h(F.row)){if(h(F.col))return N[F.row][F.col]=Z;F.col=F.col||{},F.col.start=F.col.start||0,F.col.end=F.col.end||N[0].length,F.col.step=F.col.step||1,q=C.arange(F.col.start,u.min(N.length,F.col.end),F.col.step);var ge=F.row;return q.forEach(function(me,Le){N[ge][me]=Z[Le]}),N}if(h(F.col)){F.row=F.row||{},F.row.start=F.row.start||0,F.row.end=F.row.end||N.length,F.row.step=F.row.step||1,se=C.arange(F.row.start,u.min(N[0].length,F.row.end),F.row.step);var ae=F.col;return se.forEach(function(me,Le){N[me][ae]=Z[Le]}),N}return Z[0].length===d&&(Z=[Z]),F.row.start=F.row.start||0,F.row.end=F.row.end||N.length,F.row.step=F.row.step||1,F.col.start=F.col.start||0,F.col.end=F.col.end||N[0].length,F.col.step=F.col.step||1,se=C.arange(F.row.start,u.min(N.length,F.row.end),F.row.step),q=C.arange(F.col.start,u.min(N[0].length,F.col.end),F.col.step),se.forEach(function(me,Le){q.forEach(function(je,ie){N[me][je]=Z[Le][ie]})}),N},C.diagonal=function(N){var F=C.zeros(N.length,N.length);return N.forEach(function(Z,q){F[q][q]=Z}),F},C.copy=function(N){return N.map(function(F){return h(F)?F:F.map(function(Z){return Z})})};var O=C.prototype;return O.length=0,O.push=Array.prototype.push,O.sort=Array.prototype.sort,O.splice=Array.prototype.splice,O.slice=Array.prototype.slice,O.toArray=function(){return this.length>1?P.call(this):P.call(this)[0]},O.map=function(N,F){return C(C.map(this,N,F))},O.cumreduce=function(N,F){return C(C.cumreduce(this,N,F))},O.alter=function(N){return C.alter(this,N),this},function(N){for(var F=0;F<N.length;F++)(function(Z){O[Z]=function(q){var se,ge=this;return q?(setTimeout(function(){q.call(ge,O[Z].call(ge))}),this):(se=C[Z](this),m(se)?C(se):se)}})(N[F])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(N){for(var F=0;F<N.length;F++)(function(Z){O[Z]=function(q,se){var ge=this;return se?(setTimeout(function(){se.call(ge,O[Z].call(ge,q))}),this):C(C[Z](this,q))}})(N[F])}("row col".split(" ")),function(N){for(var F=0;F<N.length;F++)(function(Z){O[Z]=function(){return C(C[Z].apply(null,arguments))}})(N[F])}("create zeros ones rand identity".split(" ")),C}(Math),function(u,d){var k=u.utils.isFunction;function P(m,j){return m-j}function g(m,j,h){return d.max(j,d.min(m,h))}u.sum=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h];return j},u.sumsqrd=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h]*m[h];return j},u.sumsqerr=function(m){for(var j,h=u.mean(m),C=0,T=m.length;--T>=0;)C+=(j=m[T]-h)*j;return C},u.sumrow=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h];return j},u.product=function(m){for(var j=1,h=m.length;--h>=0;)j*=m[h];return j},u.min=function(m){for(var j=m[0],h=0;++h<m.length;)m[h]<j&&(j=m[h]);return j},u.max=function(m){for(var j=m[0],h=0;++h<m.length;)m[h]>j&&(j=m[h]);return j},u.unique=function(m){for(var j={},h=[],C=0;C<m.length;C++)j[m[C]]||(j[m[C]]=!0,h.push(m[C]));return h},u.mean=function(m){return u.sum(m)/m.length},u.meansqerr=function(m){return u.sumsqerr(m)/m.length},u.geomean=function(m){var j=m.map(d.log),h=u.mean(j);return d.exp(h)},u.median=function(m){var j=m.length,h=m.slice().sort(P);return 1&j?h[j/2|0]:(h[j/2-1]+h[j/2])/2},u.cumsum=function(m){return u.cumreduce(m,function(j,h){return j+h})},u.cumprod=function(m){return u.cumreduce(m,function(j,h){return j*h})},u.diff=function(m){var j,h=[],C=m.length;for(j=1;j<C;j++)h.push(m[j]-m[j-1]);return h},u.rank=function(m){var j,h=[],C={};for(j=0;j<m.length;j++)C[O=m[j]]?C[O]++:(C[O]=1,h.push(O));var T=h.sort(P),I={},_=1;for(j=0;j<T.length;j++){var O,N=C[O=T[j]],F=(_+(_+N-1))/2;I[O]=F,_+=N}return m.map(function(Z){return I[Z]})},u.mode=function(m){var j,h=m.length,C=m.slice().sort(P),T=1,I=0,_=0,O=[];for(j=0;j<h;j++)C[j]===C[j+1]?T++:(T>I?(O=[C[j]],I=T,_=0):T===I&&(O.push(C[j]),_++),T=1);return _===0?O[0]:O},u.range=function(m){return u.max(m)-u.min(m)},u.variance=function(m,j){return u.sumsqerr(m)/(m.length-(j?1:0))},u.pooledvariance=function(m){return m.reduce(function(j,h){return j+u.sumsqerr(h)},0)/(m.reduce(function(j,h){return j+h.length},0)-m.length)},u.deviation=function(m){for(var j=u.mean(m),h=m.length,C=new Array(h),T=0;T<h;T++)C[T]=m[T]-j;return C},u.stdev=function(m,j){return d.sqrt(u.variance(m,j))},u.pooledstdev=function(m){return d.sqrt(u.pooledvariance(m))},u.meandev=function(m){for(var j=u.mean(m),h=[],C=m.length-1;C>=0;C--)h.push(d.abs(m[C]-j));return u.mean(h)},u.meddev=function(m){for(var j=u.median(m),h=[],C=m.length-1;C>=0;C--)h.push(d.abs(m[C]-j));return u.median(h)},u.coeffvar=function(m){return u.stdev(m)/u.mean(m)},u.quartiles=function(m){var j=m.length,h=m.slice().sort(P);return[h[d.round(j/4)-1],h[d.round(j/2)-1],h[d.round(3*j/4)-1]]},u.quantiles=function(m,j,h,C){var T,I,_,O,N,F=m.slice().sort(P),Z=[j.length],q=m.length;for(h===void 0&&(h=.375),C===void 0&&(C=.375),T=0;T<j.length;T++)_=q*(I=j[T])+(h+I*(1-h-C)),O=d.floor(g(_,1,q-1)),N=g(_-O,0,1),Z[T]=(1-N)*F[O-1]+N*F[O];return Z},u.percentile=function(m,j,h){var C=m.slice().sort(P),T=j*(C.length+(h?1:-1))+(h?0:1),I=parseInt(T),_=T-I;return I+1<C.length?C[I-1]+_*(C[I]-C[I-1]):C[I-1]},u.percentileOfScore=function(m,j,h){var C,T,I=0,_=m.length,O=!1;for(h==="strict"&&(O=!0),T=0;T<_;T++)C=m[T],(O&&C<j||!O&&C<=j)&&I++;return I/_},u.histogram=function(m,j){j=j||4;var h,C=u.min(m),T=(u.max(m)-C)/j,I=m.length,_=[];for(h=0;h<j;h++)_[h]=0;for(h=0;h<I;h++)_[d.min(d.floor((m[h]-C)/T),j-1)]+=1;return _},u.covariance=function(m,j){var h,C=u.mean(m),T=u.mean(j),I=m.length,_=new Array(I);for(h=0;h<I;h++)_[h]=(m[h]-C)*(j[h]-T);return u.sum(_)/(I-1)},u.corrcoeff=function(m,j){return u.covariance(m,j)/u.stdev(m,1)/u.stdev(j,1)},u.spearmancoeff=function(m,j){return m=u.rank(m),j=u.rank(j),u.corrcoeff(m,j)},u.stanMoment=function(m,j){for(var h=u.mean(m),C=u.stdev(m),T=m.length,I=0,_=0;_<T;_++)I+=d.pow((m[_]-h)/C,j);return I/m.length},u.skewness=function(m){return u.stanMoment(m,3)},u.kurtosis=function(m){return u.stanMoment(m,4)-3};var s=u.prototype;(function(m){for(var j=0;j<m.length;j++)(function(h){s[h]=function(C,T){var I=[],_=0,O=this;if(k(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(O,s[h].call(O,C))}),this;if(this.length>1){for(O=C===!0?this:this.transpose();_<O.length;_++)I[_]=u[h](O[_]);return I}return u[h](this[0],C)}})(m[j])})("cumsum cumprod".split(" ")),function(m){for(var j=0;j<m.length;j++)(function(h){s[h]=function(C,T){var I=[],_=0,O=this;if(k(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(O,s[h].call(O,C))}),this;if(this.length>1){for(h!=="sumrow"&&(O=C===!0?this:this.transpose());_<O.length;_++)I[_]=u[h](O[_]);return C===!0?u[h](u.utils.toVector(I)):I}return u[h](this[0],C)}})(m[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(m){for(var j=0;j<m.length;j++)(function(h){s[h]=function(){var C,T=[],I=0,_=this,O=Array.prototype.slice.call(arguments);if(k(O[O.length-1])){C=O[O.length-1];var N=O.slice(0,O.length-1);return setTimeout(function(){C.call(_,s[h].apply(_,N))}),this}C=void 0;var F=function(Z){return u[h].apply(_,[Z].concat(O))};if(this.length>1){for(_=_.transpose();I<_.length;I++)T[I]=F(_[I]);return T}return F(this[0])}})(m[j])}("quantiles percentileOfScore".split(" "))}(b,Math),function(u,d){u.gammaln=function(k){var P,g,s,m=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(s=(g=P=k)+5.5,s-=(P+.5)*d.log(s);m<6;m++)h+=j[m]/++g;return d.log(2.5066282746310007*h/P)-s},u.loggam=function(k){var P,g,s,m,j,h,C,T=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(P=k,C=0,k==1||k==2)return 0;for(k<=7&&(P=k+(C=d.floor(7-k))),g=1/(P*P),s=2*d.PI,j=T[9],h=8;h>=0;h--)j*=g,j+=T[h];if(m=j/P+.5*d.log(s)+(P-.5)*d.log(P)-P,k<=7)for(h=1;h<=C;h++)m-=d.log(P-1),P-=1;return m},u.gammafn=function(k){var P,g,s,m,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],C=!1,T=0,I=0,_=0,O=k;if(k>171.6243769536076)return 1/0;if(O<=0){if(!(m=O%1+36e-17))return 1/0;C=(1&O?-1:1)*d.PI/d.sin(d.PI*m),O=1-O}for(s=O,g=O<1?O++:(O-=T=(0|O)-1)-1,P=0;P<8;++P)_=(_+j[P])*g,I=I*g+h[P];if(m=_/I+1,s<O)m/=s;else if(s>O)for(P=0;P<T;++P)m*=O,O++;return C&&(m=C/m),m},u.gammap=function(k,P){return u.lowRegGamma(k,P)*u.gammafn(k)},u.lowRegGamma=function(k,P){var g,s=u.gammaln(k),m=k,j=1/k,h=j,C=P+1-k,T=1/1e-30,I=1/C,_=I,O=1,N=-~(8.5*d.log(k>=1?k:1/k)+.4*k+17);if(P<0||k<=0)return NaN;if(P<k+1){for(;O<=N;O++)j+=h*=P/++m;return j*d.exp(-P+k*d.log(P)-s)}for(;O<=N;O++)_*=(I=1/(I=(g=-O*(O-k))*I+(C+=2)))*(T=C+g/T);return 1-_*d.exp(-P+k*d.log(P)-s)},u.factorialln=function(k){return k<0?NaN:u.gammaln(k+1)},u.factorial=function(k){return k<0?NaN:u.gammafn(k+1)},u.combination=function(k,P){return k>170||P>170?d.exp(u.combinationln(k,P)):u.factorial(k)/u.factorial(P)/u.factorial(k-P)},u.combinationln=function(k,P){return u.factorialln(k)-u.factorialln(P)-u.factorialln(k-P)},u.permutation=function(k,P){return u.factorial(k)/u.factorial(k-P)},u.betafn=function(k,P){if(!(k<=0||P<=0))return k+P>170?d.exp(u.betaln(k,P)):u.gammafn(k)*u.gammafn(P)/u.gammafn(k+P)},u.betaln=function(k,P){return u.gammaln(k)+u.gammaln(P)-u.gammaln(k+P)},u.betacf=function(k,P,g){var s,m,j,h,C=1e-30,T=1,I=P+g,_=P+1,O=P-1,N=1,F=1-I*k/_;for(d.abs(F)<C&&(F=C),h=F=1/F;T<=100&&(F=1+(m=T*(g-T)*k/((O+(s=2*T))*(P+s)))*F,d.abs(F)<C&&(F=C),N=1+m/N,d.abs(N)<C&&(N=C),h*=(F=1/F)*N,F=1+(m=-(P+T)*(I+T)*k/((P+s)*(_+s)))*F,d.abs(F)<C&&(F=C),N=1+m/N,d.abs(N)<C&&(N=C),h*=j=(F=1/F)*N,!(d.abs(j-1)<3e-7));T++);return h},u.gammapinv=function(k,P){var g,s,m,j,h,C,T=0,I=P-1,_=u.gammaln(P);if(k>=1)return d.max(100,P+100*d.sqrt(P));if(k<=0)return 0;for(P>1?(h=d.log(I),C=d.exp(I*(h-1)-_),j=k<.5?k:1-k,g=(2.30753+.27061*(s=d.sqrt(-2*d.log(j))))/(1+s*(.99229+.04481*s))-s,k<.5&&(g=-g),g=d.max(.001,P*d.pow(1-1/(9*P)-g/(3*d.sqrt(P)),3))):g=k<(s=1-P*(.253+.12*P))?d.pow(k/s,1/P):1-d.log(1-(k-s)/(1-s));T<12;T++){if(g<=0)return 0;if((g-=s=(m=(u.lowRegGamma(P,g)-k)/(s=P>1?C*d.exp(-(g-I)+I*(d.log(g)-h)):d.exp(-g+I*d.log(g)-_)))/(1-.5*d.min(1,m*((P-1)/g-1))))<=0&&(g=.5*(g+s)),d.abs(s)<1e-8*g)break}return g},u.erf=function(k){var P,g,s,m,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=j.length-1,C=!1,T=0,I=0;for(k<0&&(k=-k,C=!0),g=4*(P=2/(2+k))-2;h>0;h--)s=T,T=g*T-I+j[h],I=s;return m=P*d.exp(-k*k+.5*(j[0]+g*T)-I),C?m-1:1-m},u.erfc=function(k){return 1-u.erf(k)},u.erfcinv=function(k){var P,g,s,m,j=0;if(k>=2)return-100;if(k<=0)return 100;for(m=k<1?k:2-k,P=-.70711*((2.30753+.27061*(s=d.sqrt(-2*d.log(m/2))))/(1+s*(.99229+.04481*s))-s);j<2;j++)P+=(g=u.erfc(P)-m)/(1.1283791670955126*d.exp(-P*P)-P*g);return k<1?P:-P},u.ibetainv=function(k,P,g){var s,m,j,h,C,T,I,_,O,N,F=P-1,Z=g-1,q=0;if(k<=0)return 0;if(k>=1)return 1;for(P>=1&&g>=1?(j=k<.5?k:1-k,T=(2.30753+.27061*(h=d.sqrt(-2*d.log(j))))/(1+h*(.99229+.04481*h))-h,k<.5&&(T=-T),I=(T*T-3)/6,_=2/(1/(2*P-1)+1/(2*g-1)),O=T*d.sqrt(I+_)/_-(1/(2*g-1)-1/(2*P-1))*(I+.8333333333333334-2/(3*_)),T=P/(P+g*d.exp(2*O))):(s=d.log(P/(P+g)),m=d.log(g/(P+g)),T=k<(h=d.exp(P*s)/P)/(O=h+(C=d.exp(g*m)/g))?d.pow(P*O*k,1/P):1-d.pow(g*O*(1-k),1/g)),N=-u.gammaln(P)-u.gammaln(g)+u.gammaln(P+g);q<10;q++){if(T===0||T===1)return T;if((T-=h=(C=(u.ibeta(T,P,g)-k)/(h=d.exp(F*d.log(T)+Z*d.log(1-T)+N)))/(1-.5*d.min(1,C*(F/T-Z/(1-T)))))<=0&&(T=.5*(T+h)),T>=1&&(T=.5*(T+h+1)),d.abs(h)<1e-8*T&&q>0)break}return T},u.ibeta=function(k,P,g){var s=k===0||k===1?0:d.exp(u.gammaln(P+g)-u.gammaln(P)-u.gammaln(g)+P*d.log(k)+g*d.log(1-k));return!(k<0||k>1)&&(k<(P+1)/(P+g+2)?s*u.betacf(k,P,g)/P:1-s*u.betacf(1-k,g,P)/g)},u.randn=function(k,P){var g,s,m,j,h;if(P||(P=k),k)return u.create(k,P,function(){return u.randn()});do g=u._random_fn(),s=1.7156*(u._random_fn()-.5),h=(m=g-.449871)*m+(j=d.abs(s)+.386595)*(.196*j-.25472*m);while(h>.27597&&(h>.27846||s*s>-4*d.log(g)*g*g));return s/g},u.randg=function(k,P,g){var s,m,j,h,C,T,I=k;if(g||(g=P),k||(k=1),P)return(T=u.zeros(P,g)).alter(function(){return u.randg(k)}),T;k<1&&(k+=1),s=k-.3333333333333333,m=1/d.sqrt(9*s);do{do h=1+m*(C=u.randn());while(h<=0);h*=h*h,j=u._random_fn()}while(j>1-.331*d.pow(C,4)&&d.log(j)>.5*C*C+s*(1-h+d.log(h)));if(k==I)return s*h;do j=u._random_fn();while(j===0);return d.pow(j,1/I)*s*h},function(k){for(var P=0;P<k.length;P++)(function(g){u.fn[g]=function(){return u(u.map(this,function(s){return u[g](s)}))}})(k[P])}("gammaln gammafn factorial factorialln".split(" ")),function(k){for(var P=0;P<k.length;P++)(function(g){u.fn[g]=function(){return u(u[g].apply(null,arguments))}})(k[P])}("randn".split(" "))}(b,Math),function(u,d){function k(g,s,m,j){for(var h,C=0,T=1,I=1,_=1,O=0,N=0;d.abs((I-N)/I)>j;)N=I,T=_+(h=-(s+O)*(s+m+O)*g/(s+2*O)/(s+2*O+1))*T,I=(C=I+h*C)+(h=(O+=1)*(m-O)*g/(s+2*O-1)/(s+2*O))*I,C/=_=T+h*_,T/=_,I/=_,_=1;return I/s}function P(g,s,m){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],h=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],C=.5*g;if(C>=8)return 1;var T,I=2*u.normal.cdf(C,0,1,1,0)-1;I=I>=d.exp(-50/m)?d.pow(I,m):0;for(var _=C,O=(8-C)/(T=g>3?2:3),N=_+O,F=0,Z=m-1,q=1;q<=T;q++){for(var se=0,ge=.5*(N+_),ae=.5*(N-_),me=1;me<=12;me++){var Le,je=ge+ae*(6<me?j[(Le=12-me+1)-1]:-j[(Le=me)-1]),ie=je*je;if(ie>60)break;var _e=2*u.normal.cdf(je,0,1,1,0)*.5-2*u.normal.cdf(je,g,1,1,0)*.5;_e>=d.exp(-30/Z)&&(se+=_e=h[Le-1]*d.exp(-.5*ie)*d.pow(_e,Z))}F+=se*=2*ae*m/d.sqrt(2*d.PI),_=N,N+=O}return(I+=F)<=d.exp(-30/s)?0:(I=d.pow(I,s))>=1?1:I}(function(g){for(var s=0;s<g.length;s++)(function(m){u[m]=function j(h,C,T){return this instanceof j?(this._a=h,this._b=C,this._c=T,this):new j(h,C,T)},u.fn[m]=function(j,h,C){var T=u[m](j,h,C);return T.data=this,T},u[m].prototype.sample=function(j){var h=this._a,C=this._b,T=this._c;return j?u.alter(j,function(){return u[m].sample(h,C,T)}):u[m].sample(h,C,T)},function(j){for(var h=0;h<j.length;h++)(function(C){u[m].prototype[C]=function(T){var I=this._a,_=this._b,O=this._c;return T||T===0||(T=this.data),typeof T!="number"?u.fn.map.call(T,function(N){return u[m][C](N,I,_,O)}):u[m][C](T,I,_,O)}})(j[h])}("pdf cdf inv".split(" ")),function(j){for(var h=0;h<j.length;h++)(function(C){u[m].prototype[C]=function(){return u[m][C](this._a,this._b,this._c)}})(j[h])}("mean median mode variance".split(" "))})(g[s])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),u.extend(u.beta,{pdf:function(g,s,m){return g>1||g<0?0:s==1&&m==1?1:s<512&&m<512?d.pow(g,s-1)*d.pow(1-g,m-1)/u.betafn(s,m):d.exp((s-1)*d.log(g)+(m-1)*d.log(1-g)-u.betaln(s,m))},cdf:function(g,s,m){return g>1||g<0?1*(g>1):u.ibeta(g,s,m)},inv:function(g,s,m){return u.ibetainv(g,s,m)},mean:function(g,s){return g/(g+s)},median:function(g,s){return u.ibetainv(.5,g,s)},mode:function(g,s){return(g-1)/(g+s-2)},sample:function(g,s){var m=u.randg(g);return m/(m+u.randg(s))},variance:function(g,s){return g*s/(d.pow(g+s,2)*(g+s+1))}}),u.extend(u.centralF,{pdf:function(g,s,m){var j;return g<0?0:s<=2?g===0&&s<2?1/0:g===0&&s===2?1:1/u.betafn(s/2,m/2)*d.pow(s/m,s/2)*d.pow(g,s/2-1)*d.pow(1+s/m*g,-(s+m)/2):(j=s*g/(m+g*s),s*(m/(m+g*s))/2*u.binomial.pdf((s-2)/2,(s+m-2)/2,j))},cdf:function(g,s,m){return g<0?0:u.ibeta(s*g/(s*g+m),s/2,m/2)},inv:function(g,s,m){return m/(s*(1/u.ibetainv(g,s/2,m/2)-1))},mean:function(g,s){return s>2?s/(s-2):void 0},mode:function(g,s){return g>2?s*(g-2)/(g*(s+2)):void 0},sample:function(g,s){return 2*u.randg(g/2)/g/(2*u.randg(s/2)/s)},variance:function(g,s){if(!(s<=4))return 2*s*s*(g+s-2)/(g*(s-2)*(s-2)*(s-4))}}),u.extend(u.cauchy,{pdf:function(g,s,m){return m<0?0:m/(d.pow(g-s,2)+d.pow(m,2))/d.PI},cdf:function(g,s,m){return d.atan((g-s)/m)/d.PI+.5},inv:function(g,s,m){return s+m*d.tan(d.PI*(g-.5))},median:function(g){return g},mode:function(g){return g},sample:function(g,s){return u.randn()*d.sqrt(1/(2*u.randg(.5)))*s+g}}),u.extend(u.chisquare,{pdf:function(g,s){return g<0?0:g===0&&s===2?.5:d.exp((s/2-1)*d.log(g)-g/2-s/2*d.log(2)-u.gammaln(s/2))},cdf:function(g,s){return g<0?0:u.lowRegGamma(s/2,g/2)},inv:function(g,s){return 2*u.gammapinv(g,.5*s)},mean:function(g){return g},median:function(g){return g*d.pow(1-2/(9*g),3)},mode:function(g){return g-2>0?g-2:0},sample:function(g){return 2*u.randg(g/2)},variance:function(g){return 2*g}}),u.extend(u.exponential,{pdf:function(g,s){return g<0?0:s*d.exp(-s*g)},cdf:function(g,s){return g<0?0:1-d.exp(-s*g)},inv:function(g,s){return-d.log(1-g)/s},mean:function(g){return 1/g},median:function(g){return 1/g*d.log(2)},mode:function(){return 0},sample:function(g){return-1/g*d.log(u._random_fn())},variance:function(g){return d.pow(g,-2)}}),u.extend(u.gamma,{pdf:function(g,s,m){return g<0?0:g===0&&s===1?1/m:d.exp((s-1)*d.log(g)-g/m-u.gammaln(s)-s*d.log(m))},cdf:function(g,s,m){return g<0?0:u.lowRegGamma(s,g/m)},inv:function(g,s,m){return u.gammapinv(g,s)*m},mean:function(g,s){return g*s},mode:function(g,s){if(g>1)return(g-1)*s},sample:function(g,s){return u.randg(g)*s},variance:function(g,s){return g*s*s}}),u.extend(u.invgamma,{pdf:function(g,s,m){return g<=0?0:d.exp(-(s+1)*d.log(g)-m/g-u.gammaln(s)+s*d.log(m))},cdf:function(g,s,m){return g<=0?0:1-u.lowRegGamma(s,m/g)},inv:function(g,s,m){return m/u.gammapinv(1-g,s)},mean:function(g,s){return g>1?s/(g-1):void 0},mode:function(g,s){return s/(g+1)},sample:function(g,s){return s/u.randg(g)},variance:function(g,s){if(!(g<=2))return s*s/((g-1)*(g-1)*(g-2))}}),u.extend(u.kumaraswamy,{pdf:function(g,s,m){return g===0&&s===1?m:g===1&&m===1?s:d.exp(d.log(s)+d.log(m)+(s-1)*d.log(g)+(m-1)*d.log(1-d.pow(g,s)))},cdf:function(g,s,m){return g<0?0:g>1?1:1-d.pow(1-d.pow(g,s),m)},inv:function(g,s,m){return d.pow(1-d.pow(1-g,1/m),1/s)},mean:function(g,s){return s*u.gammafn(1+1/g)*u.gammafn(s)/u.gammafn(1+1/g+s)},median:function(g,s){return d.pow(1-d.pow(2,-1/s),1/g)},mode:function(g,s){if(g>=1&&s>=1&&g!==1&&s!==1)return d.pow((g-1)/(g*s-1),1/g)},variance:function(){throw new Error("variance not yet implemented")}}),u.extend(u.lognormal,{pdf:function(g,s,m){return g<=0?0:d.exp(-d.log(g)-.5*d.log(2*d.PI)-d.log(m)-d.pow(d.log(g)-s,2)/(2*m*m))},cdf:function(g,s,m){return g<0?0:.5+.5*u.erf((d.log(g)-s)/d.sqrt(2*m*m))},inv:function(g,s,m){return d.exp(-1.4142135623730951*m*u.erfcinv(2*g)+s)},mean:function(g,s){return d.exp(g+s*s/2)},median:function(g){return d.exp(g)},mode:function(g,s){return d.exp(g-s*s)},sample:function(g,s){return d.exp(u.randn()*s+g)},variance:function(g,s){return(d.exp(s*s)-1)*d.exp(2*g+s*s)}}),u.extend(u.noncentralt,{pdf:function(g,s,m){return d.abs(m)<1e-14?u.studentt.pdf(g,s):d.abs(g)<1e-14?d.exp(u.gammaln((s+1)/2)-m*m/2-.5*d.log(d.PI*s)-u.gammaln(s/2)):s/g*(u.noncentralt.cdf(g*d.sqrt(1+2/s),s+2,m)-u.noncentralt.cdf(g,s,m))},cdf:function(g,s,m){var j=1e-14;if(d.abs(m)<j)return u.studentt.cdf(g,s);var h=!1;g<0&&(h=!0,m=-m);for(var C=u.normal.cdf(-m,0,1),T=j+1,I=T,_=g*g/(g*g+s),O=0,N=d.exp(-m*m/2),F=d.exp(-m*m/2-.5*d.log(2)-u.gammaln(1.5))*m;O<200||I>j||T>j;)I=T,O>0&&(N*=m*m/(2*O),F*=m*m/(2*(O+.5))),C+=.5*(T=N*u.beta.cdf(_,O+.5,s/2)+F*u.beta.cdf(_,O+1,s/2)),O++;return h?1-C:C}}),u.extend(u.normal,{pdf:function(g,s,m){return d.exp(-.5*d.log(2*d.PI)-d.log(m)-d.pow(g-s,2)/(2*m*m))},cdf:function(g,s,m){return .5*(1+u.erf((g-s)/d.sqrt(2*m*m)))},inv:function(g,s,m){return-1.4142135623730951*m*u.erfcinv(2*g)+s},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},sample:function(g,s){return u.randn()*s+g},variance:function(g,s){return s*s}}),u.extend(u.pareto,{pdf:function(g,s,m){return g<s?0:m*d.pow(s,m)/d.pow(g,m+1)},cdf:function(g,s,m){return g<s?0:1-d.pow(s/g,m)},inv:function(g,s,m){return s/d.pow(1-g,1/m)},mean:function(g,s){if(!(s<=1))return s*d.pow(g,s)/(s-1)},median:function(g,s){return g*(s*d.SQRT2)},mode:function(g){return g},variance:function(g,s){if(!(s<=2))return g*g*s/(d.pow(s-1,2)*(s-2))}}),u.extend(u.studentt,{pdf:function(g,s){return s=s>1e100?1e100:s,1/(d.sqrt(s)*u.betafn(.5,s/2))*d.pow(1+g*g/s,-(s+1)/2)},cdf:function(g,s){var m=s/2;return u.ibeta((g+d.sqrt(g*g+s))/(2*d.sqrt(g*g+s)),m,m)},inv:function(g,s){var m=u.ibetainv(2*d.min(g,1-g),.5*s,.5);return m=d.sqrt(s*(1-m)/m),g>.5?m:-m},mean:function(g){return g>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(g){return u.randn()*d.sqrt(g/(2*u.randg(g/2)))},variance:function(g){return g>2?g/(g-2):g>1?1/0:void 0}}),u.extend(u.weibull,{pdf:function(g,s,m){return g<0||s<0||m<0?0:m/s*d.pow(g/s,m-1)*d.exp(-d.pow(g/s,m))},cdf:function(g,s,m){return g<0?0:1-d.exp(-d.pow(g/s,m))},inv:function(g,s,m){return s*d.pow(-d.log(1-g),1/m)},mean:function(g,s){return g*u.gammafn(1+1/s)},median:function(g,s){return g*d.pow(d.log(2),1/s)},mode:function(g,s){return s<=1?0:g*d.pow((s-1)/s,1/s)},sample:function(g,s){return g*d.pow(-d.log(u._random_fn()),1/s)},variance:function(g,s){return g*g*u.gammafn(1+2/s)-d.pow(u.weibull.mean(g,s),2)}}),u.extend(u.uniform,{pdf:function(g,s,m){return g<s||g>m?0:1/(m-s)},cdf:function(g,s,m){return g<s?0:g<m?(g-s)/(m-s):1},inv:function(g,s,m){return s+g*(m-s)},mean:function(g,s){return .5*(g+s)},median:function(g,s){return u.mean(g,s)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,s){return g/2+s/2+(s/2-g/2)*(2*u._random_fn()-1)},variance:function(g,s){return d.pow(s-g,2)/12}}),u.extend(u.binomial,{pdf:function(g,s,m){return m===0||m===1?s*m===g?1:0:u.combination(s,g)*d.pow(m,g)*d.pow(1-m,s-g)},cdf:function(g,s,m){var j,h=1e-10;if(g<0)return 0;if(g>=s)return 1;if(m<0||m>1||s<=0)return NaN;var C=m,T=(g=d.floor(g))+1,I=s-g,_=T+I,O=d.exp(u.gammaln(_)-u.gammaln(I)-u.gammaln(T)+T*d.log(C)+I*d.log(1-C));return j=C<(T+1)/(_+2)?O*k(C,T,I,h):1-O*k(1-C,I,T,h),d.round(1/h*(1-j))/(1/h)}}),u.extend(u.negbin,{pdf:function(g,s,m){return g===g>>>0&&(g<0?0:u.combination(g+s-1,s-1)*d.pow(1-m,g)*d.pow(m,s))},cdf:function(g,s,m){var j=0,h=0;if(g<0)return 0;for(;h<=g;h++)j+=u.negbin.pdf(h,s,m);return j}}),u.extend(u.hypgeom,{pdf:function(g,s,m,j){if(g!=g|0)return!1;if(g<0||g<m-(s-j)||g>j||g>m)return 0;if(2*m>s)return 2*j>s?u.hypgeom.pdf(s-m-j+g,s,s-m,s-j):u.hypgeom.pdf(j-g,s,s-m,j);if(2*j>s)return u.hypgeom.pdf(m-g,s,m,s-j);if(m<j)return u.hypgeom.pdf(g,s,j,m);for(var h=1,C=0,T=0;T<g;T++){for(;h>1&&C<j;)h*=1-m/(s-C),C++;h*=(j-T)*(m-T)/((T+1)*(s-m-j+T+1))}for(;C<j;C++)h*=1-m/(s-C);return d.min(1,d.max(0,h))},cdf:function(g,s,m,j){if(g<0||g<m-(s-j))return 0;if(g>=j||g>=m)return 1;if(2*m>s)return 2*j>s?u.hypgeom.cdf(s-m-j+g,s,s-m,s-j):1-u.hypgeom.cdf(j-g-1,s,s-m,j);if(2*j>s)return 1-u.hypgeom.cdf(m-g-1,s,m,s-j);if(m<j)return u.hypgeom.cdf(g,s,j,m);for(var h=1,C=1,T=0,I=0;I<g;I++){for(;h>1&&T<j;){var _=1-m/(s-T);C*=_,h*=_,T++}h+=C*=(j-I)*(m-I)/((I+1)*(s-m-j+I+1))}for(;T<j;T++)h*=1-m/(s-T);return d.min(1,d.max(0,h))}}),u.extend(u.poisson,{pdf:function(g,s){return s<0||g%1!=0||g<0?0:d.pow(s,g)*d.exp(-s)/u.factorial(g)},cdf:function(g,s){var m=[],j=0;if(g<0)return 0;for(;j<=g;j++)m.push(u.poisson.pdf(j,s));return u.sum(m)},mean:function(g){return g},variance:function(g){return g},sampleSmall:function(g){var s=1,m=0,j=d.exp(-g);do m++,s*=u._random_fn();while(s>j);return m-1},sampleLarge:function(g){var s,m,j,h,C,T,I,_,O,N,F=g;for(h=d.sqrt(F),C=d.log(F),T=.02483*(I=.931+2.53*h)-.059,_=1.1239+1.1328/(I-3.4),O=.9277-3.6224/(I-2);;)if(m=d.random()-.5,j=d.random(),N=.5-d.abs(m),s=d.floor((2*T/N+I)*m+F+.43),N>=.07&&j<=O||!(s<0||N<.013&&j>N)&&d.log(j)+d.log(_)-d.log(T/(N*N)+I)<=s*C-F-u.loggam(s+1))return s},sample:function(g){return g<10?this.sampleSmall(g):this.sampleLarge(g)}}),u.extend(u.triangular,{pdf:function(g,s,m,j){return m<=s||j<s||j>m?NaN:g<s||g>m?0:g<j?2*(g-s)/((m-s)*(j-s)):g===j?2/(m-s):2*(m-g)/((m-s)*(m-j))},cdf:function(g,s,m,j){return m<=s||j<s||j>m?NaN:g<=s?0:g>=m?1:g<=j?d.pow(g-s,2)/((m-s)*(j-s)):1-d.pow(m-g,2)/((m-s)*(m-j))},inv:function(g,s,m,j){return m<=s||j<s||j>m?NaN:g<=(j-s)/(m-s)?s+(m-s)*d.sqrt(g*((j-s)/(m-s))):s+(m-s)*(1-d.sqrt((1-g)*(1-(j-s)/(m-s))))},mean:function(g,s,m){return(g+s+m)/3},median:function(g,s,m){return m<=(g+s)/2?s-d.sqrt((s-g)*(s-m))/d.sqrt(2):m>(g+s)/2?g+d.sqrt((s-g)*(m-g))/d.sqrt(2):void 0},mode:function(g,s,m){return m},sample:function(g,s,m){var j=u._random_fn();return j<(m-g)/(s-g)?g+d.sqrt(j*(s-g)*(m-g)):s-d.sqrt((1-j)*(s-g)*(s-m))},variance:function(g,s,m){return(g*g+s*s+m*m-g*s-g*m-s*m)/18}}),u.extend(u.arcsine,{pdf:function(g,s,m){return m<=s?NaN:g<=s||g>=m?0:2/d.PI*d.pow(d.pow(m-s,2)-d.pow(2*g-s-m,2),-.5)},cdf:function(g,s,m){return g<s?0:g<m?2/d.PI*d.asin(d.sqrt((g-s)/(m-s))):1},inv:function(g,s,m){return s+(.5-.5*d.cos(d.PI*g))*(m-s)},mean:function(g,s){return s<=g?NaN:(g+s)/2},median:function(g,s){return s<=g?NaN:(g+s)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,s){return(g+s)/2+(s-g)/2*d.sin(2*d.PI*u.uniform.sample(0,1))},variance:function(g,s){return s<=g?NaN:d.pow(s-g,2)/8}}),u.extend(u.laplace,{pdf:function(g,s,m){return m<=0?0:d.exp(-d.abs(g-s)/m)/(2*m)},cdf:function(g,s,m){return m<=0?0:g<s?.5*d.exp((g-s)/m):1-.5*d.exp(-(g-s)/m)},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},variance:function(g,s){return 2*s*s},sample:function(g,s){var m,j=u._random_fn()-.5;return g-s*((m=j)/d.abs(m))*d.log(1-2*d.abs(j))}}),u.extend(u.tukey,{cdf:function(g,s,m){var j=s,h=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(g<=0)return 0;if(m<2||j<2)return NaN;if(!Number.isFinite(g))return 1;if(m>25e3)return P(g,1,j);var T,I=.5*m,_=I*d.log(m)-m*d.log(2)-u.gammaln(I),O=I-1,N=.25*m;T=m<=100?1:m<=800?.5:m<=5e3?.25:.125,_+=d.log(T);for(var F=0,Z=1;Z<=50;Z++){for(var q=0,se=(2*Z-1)*T,ge=1;ge<=16;ge++){var ae,me;8<ge?(ae=ge-8-1,me=_+O*d.log(se+h[ae]*T)-(h[ae]*T+se)*N):(ae=ge-1,me=_+O*d.log(se-h[ae]*T)+(h[ae]*T-se)*N),me>=-30&&(q+=P(8<ge?g*d.sqrt(.5*(h[ae]*T+se)):g*d.sqrt(.5*(-h[ae]*T+se)),1,j)*C[ae]*d.exp(me))}if(Z*T>=1&&q<=1e-14)break;F+=q}if(q>1e-14)throw new Error("tukey.cdf failed to converge");return F>1&&(F=1),F},inv:function(g,s,m){if(m<2||s<2)return NaN;if(g<0||g>1)return NaN;if(g===0)return 0;if(g===1)return 1/0;var j,h=function(O,N,F){var Z=.5-.5*O,q=d.sqrt(d.log(1/(Z*Z))),se=q+((((-453642210148e-16*q-.204231210125)*q-.342242088547)*q-1)*q+.322232421088)/((((.0038560700634*q+.10353775285)*q+.531103462366)*q+.588581570495)*q+.099348462606);F<120&&(se+=(se*se*se+se)/F/4);var ge=.8832-.2368*se;return F<120&&(ge+=-1.214/F+1.208*se/F),se*(ge*d.log(N-1)+1.4142)}(g,s,m),C=u.tukey.cdf(h,s,m)-g;j=C>0?d.max(0,h-1):h+1;for(var T,I=u.tukey.cdf(j,s,m)-g,_=1;_<50;_++)if(T=j-I*(j-h)/(I-C),C=I,h=j,T<0&&(T=0,I=-g),I=u.tukey.cdf(T,s,m)-g,j=T,d.abs(j-h)<1e-4)return T;throw new Error("tukey.inv failed to converge")}})}(b,Math),function(u,d){var k,P,g=Array.prototype.push,s=u.utils.isArray;function m(j){return s(j)||j instanceof u}u.extend({add:function(j,h){return m(h)?(m(h[0])||(h=[h]),u.map(j,function(C,T,I){return C+h[T][I]})):u.map(j,function(C){return C+h})},subtract:function(j,h){return m(h)?(m(h[0])||(h=[h]),u.map(j,function(C,T,I){return C-h[T][I]||0})):u.map(j,function(C){return C-h})},divide:function(j,h){return m(h)?(m(h[0])||(h=[h]),u.multiply(j,u.inv(h))):u.map(j,function(C){return C/h})},multiply:function(j,h){var C,T,I,_,O,N,F,Z;if(j.length===void 0&&h.length===void 0)return j*h;if(O=j.length,N=j[0].length,F=u.zeros(O,I=m(h)?h[0].length:N),Z=0,m(h)){for(;Z<I;Z++)for(C=0;C<O;C++){for(_=0,T=0;T<N;T++)_+=j[C][T]*h[T][Z];F[C][Z]=_}return O===1&&Z===1?F[0][0]:F}return u.map(j,function(q){return q*h})},outer:function(j,h){return u.multiply(j.map(function(C){return[C]}),[h])},dot:function(j,h){m(j[0])||(j=[j]),m(h[0])||(h=[h]);for(var C,T,I=j[0].length===1&&j.length!==1?u.transpose(j):j,_=h[0].length===1&&h.length!==1?u.transpose(h):h,O=[],N=0,F=I.length,Z=I[0].length;N<F;N++){for(O[N]=[],C=0,T=0;T<Z;T++)C+=I[N][T]*_[N][T];O[N]=C}return O.length===1?O[0]:O},pow:function(j,h){return u.map(j,function(C){return d.pow(C,h)})},exp:function(j){return u.map(j,function(h){return d.exp(h)})},log:function(j){return u.map(j,function(h){return d.log(h)})},abs:function(j){return u.map(j,function(h){return d.abs(h)})},norm:function(j,h){var C=0,T=0;for(isNaN(h)&&(h=2),m(j[0])&&(j=j[0]);T<j.length;T++)C+=d.pow(d.abs(j[T]),h);return d.pow(C,1/h)},angle:function(j,h){return d.acos(u.dot(j,h)/(u.norm(j)*u.norm(h)))},aug:function(j,h){var C,T=[];for(C=0;C<j.length;C++)T.push(j[C].slice());for(C=0;C<T.length;C++)g.apply(T[C],h[C]);return T},inv:function(j){for(var h,C=j.length,T=j[0].length,I=u.identity(C,T),_=u.gauss_jordan(j,I),O=[],N=0;N<C;N++)for(O[N]=[],h=T;h<_[0].length;h++)O[N][h-T]=_[N][h];return O},det:function j(h){if(h.length===2)return h[0][0]*h[1][1]-h[0][1]*h[1][0];for(var C=0,T=0;T<h.length;T++){for(var I=[],_=1;_<h.length;_++){I[_-1]=[];for(var O=0;O<h.length;O++)O<T?I[_-1][O]=h[_][O]:O>T&&(I[_-1][O-1]=h[_][O])}var N=T%2?-1:1;C+=j(I)*h[0][T]*N}return C},gauss_elimination:function(j,h){var C,T,I,_,O=0,N=0,F=j.length,Z=j[0].length,q=1,se=0,ge=[];for(C=(j=u.aug(j,h))[0].length,O=0;O<F;O++){for(T=j[O][O],N=O,_=O+1;_<Z;_++)T<d.abs(j[_][O])&&(T=j[_][O],N=_);if(N!=O)for(_=0;_<C;_++)I=j[O][_],j[O][_]=j[N][_],j[N][_]=I;for(N=O+1;N<F;N++)for(q=j[N][O]/j[O][O],_=O;_<C;_++)j[N][_]=j[N][_]-q*j[O][_]}for(O=F-1;O>=0;O--){for(se=0,N=O+1;N<=F-1;N++)se+=ge[N]*j[O][N];ge[O]=(j[O][C-1]-se)/j[O][O]}return ge},gauss_jordan:function(j,h){var C,T,I,_=u.aug(j,h),O=_.length,N=_[0].length,F=0;for(T=0;T<O;T++){var Z=T;for(I=T+1;I<O;I++)d.abs(_[I][T])>d.abs(_[Z][T])&&(Z=I);var q=_[T];for(_[T]=_[Z],_[Z]=q,I=T+1;I<O;I++)for(F=_[I][T]/_[T][T],C=T;C<N;C++)_[I][C]-=_[T][C]*F}for(T=O-1;T>=0;T--){for(F=_[T][T],I=0;I<T;I++)for(C=N-1;C>T-1;C--)_[I][C]-=_[T][C]*_[I][T]/F;for(_[T][T]/=F,C=O;C<N;C++)_[T][C]/=F}return _},triaUpSolve:function(j,h){var C,T=j[0].length,I=u.zeros(1,T)[0],_=!1;return h[0].length!=null&&(h=h.map(function(O){return O[0]}),_=!0),u.arange(T-1,-1,-1).forEach(function(O){C=u.arange(O+1,T).map(function(N){return I[N]*j[O][N]}),I[O]=(h[O]-u.sum(C))/j[O][O]}),_?I.map(function(O){return[O]}):I},triaLowSolve:function(j,h){var C,T=j[0].length,I=u.zeros(1,T)[0],_=!1;return h[0].length!=null&&(h=h.map(function(O){return O[0]}),_=!0),u.arange(T).forEach(function(O){C=u.arange(O).map(function(N){return j[O][N]*I[N]}),I[O]=(h[O]-u.sum(C))/j[O][O]}),_?I.map(function(O){return[O]}):I},lu:function(j){var h,C=j.length,T=u.identity(C),I=u.zeros(j.length,j[0].length);return u.arange(C).forEach(function(_){I[0][_]=j[0][_]}),u.arange(1,C).forEach(function(_){u.arange(_).forEach(function(O){h=u.arange(O).map(function(N){return T[_][N]*I[N][O]}),T[_][O]=(j[_][O]-u.sum(h))/I[O][O]}),u.arange(_,C).forEach(function(O){h=u.arange(_).map(function(N){return T[_][N]*I[N][O]}),I[_][O]=j[h.length][O]-u.sum(h)})}),[T,I]},cholesky:function(j){var h,C=j.length,T=u.zeros(j.length,j[0].length);return u.arange(C).forEach(function(I){h=u.arange(I).map(function(_){return d.pow(T[I][_],2)}),T[I][I]=d.sqrt(j[I][I]-u.sum(h)),u.arange(I+1,C).forEach(function(_){h=u.arange(I).map(function(O){return T[I][O]*T[_][O]}),T[_][I]=(j[I][_]-u.sum(h))/T[I][I]})}),T},gauss_jacobi:function(j,h,C,T){for(var I,_,O,N,F=0,Z=0,q=j.length,se=[],ge=[],ae=[];F<q;F++)for(se[F]=[],ge[F]=[],ae[F]=[],Z=0;Z<q;Z++)F>Z?(se[F][Z]=j[F][Z],ge[F][Z]=ae[F][Z]=0):F<Z?(ge[F][Z]=j[F][Z],se[F][Z]=ae[F][Z]=0):(ae[F][Z]=j[F][Z],se[F][Z]=ge[F][Z]=0);for(O=u.multiply(u.multiply(u.inv(ae),u.add(se,ge)),-1),_=u.multiply(u.inv(ae),h),I=C,N=u.add(u.multiply(O,C),_),F=2;d.abs(u.norm(u.subtract(N,I)))>T;)I=N,N=u.add(u.multiply(O,I),_),F++;return N},gauss_seidel:function(j,h,C,T){for(var I,_,O,N,F,Z=0,q=j.length,se=[],ge=[],ae=[];Z<q;Z++)for(se[Z]=[],ge[Z]=[],ae[Z]=[],I=0;I<q;I++)Z>I?(se[Z][I]=j[Z][I],ge[Z][I]=ae[Z][I]=0):Z<I?(ge[Z][I]=j[Z][I],se[Z][I]=ae[Z][I]=0):(ae[Z][I]=j[Z][I],se[Z][I]=ge[Z][I]=0);for(N=u.multiply(u.multiply(u.inv(u.add(ae,se)),ge),-1),O=u.multiply(u.inv(u.add(ae,se)),h),_=C,F=u.add(u.multiply(N,C),O),Z=2;d.abs(u.norm(u.subtract(F,_)))>T;)_=F,F=u.add(u.multiply(N,_),O),Z+=1;return F},SOR:function(j,h,C,T,I){for(var _,O,N,F,Z,q=0,se=j.length,ge=[],ae=[],me=[];q<se;q++)for(ge[q]=[],ae[q]=[],me[q]=[],_=0;_<se;_++)q>_?(ge[q][_]=j[q][_],ae[q][_]=me[q][_]=0):q<_?(ae[q][_]=j[q][_],ge[q][_]=me[q][_]=0):(me[q][_]=j[q][_],ge[q][_]=ae[q][_]=0);for(F=u.multiply(u.inv(u.add(me,u.multiply(ge,I))),u.subtract(u.multiply(me,1-I),u.multiply(ae,I))),N=u.multiply(u.multiply(u.inv(u.add(me,u.multiply(ge,I))),h),I),O=C,Z=u.add(u.multiply(F,C),N),q=2;d.abs(u.norm(u.subtract(Z,O)))>T;)O=Z,Z=u.add(u.multiply(F,O),N),q++;return Z},householder:function(j){for(var h,C,T,I,_=j.length,O=j[0].length,N=0,F=[],Z=[];N<_-1;N++){for(h=0,I=N+1;I<O;I++)h+=j[I][N]*j[I][N];for(h=(j[N+1][N]>0?-1:1)*d.sqrt(h),C=d.sqrt((h*h-j[N+1][N]*h)/2),(F=u.zeros(_,1))[N+1][0]=(j[N+1][N]-h)/(2*C),T=N+2;T<_;T++)F[T][0]=j[T][N]/(2*C);Z=u.subtract(u.identity(_,O),u.multiply(u.multiply(F,u.transpose(F)),2)),j=u.multiply(Z,u.multiply(j,Z))}return j},QR:(k=u.sum,P=u.arange,function(j){var h,C,T,I=j.length,_=j[0].length,O=u.zeros(_,_);for(j=u.copy(j),C=0;C<_;C++){for(O[C][C]=d.sqrt(k(P(I).map(function(N){return j[N][C]*j[N][C]}))),h=0;h<I;h++)j[h][C]=j[h][C]/O[C][C];for(T=C+1;T<_;T++)for(O[C][T]=k(P(I).map(function(N){return j[N][C]*j[N][T]})),h=0;h<I;h++)j[h][T]=j[h][T]-j[h][C]*O[C][T]}return[j,O]}),lstsq:function(j,h){var C=!1;h[0].length===void 0&&(h=h.map(function(se){return[se]}),C=!0);var T=u.QR(j),I=T[0],_=T[1],O=j[0].length,N=u.slice(I,{col:{end:O}}),F=function(se){var ge=(se=u.copy(se)).length,ae=u.identity(ge);return u.arange(ge-1,-1,-1).forEach(function(me){u.sliceAssign(ae,{row:me},u.divide(u.slice(ae,{row:me}),se[me][me])),u.sliceAssign(se,{row:me},u.divide(u.slice(se,{row:me}),se[me][me])),u.arange(me).forEach(function(Le){var je=u.multiply(se[Le][me],-1),ie=u.slice(se,{row:Le}),_e=u.multiply(u.slice(se,{row:me}),je);u.sliceAssign(se,{row:Le},u.add(ie,_e));var Ye=u.slice(ae,{row:Le}),Ue=u.multiply(u.slice(ae,{row:me}),je);u.sliceAssign(ae,{row:Le},u.add(Ye,Ue))})}),ae}(u.slice(_,{row:{end:O}})),Z=u.transpose(N);Z[0].length===void 0&&(Z=[Z]);var q=u.multiply(u.multiply(F,Z),h);return q.length===void 0&&(q=[[q]]),C?q.map(function(se){return se[0]}):q},jacobi:function(j){for(var h,C,T,I,_,O,N,F=1,Z=j.length,q=u.identity(Z,Z),se=[];F===1;){for(_=j[0][1],T=0,I=1,h=0;h<Z;h++)for(C=0;C<Z;C++)h!=C&&_<d.abs(j[h][C])&&(_=d.abs(j[h][C]),T=h,I=C);for(O=j[T][T]===j[I][I]?j[T][I]>0?d.PI/4:-d.PI/4:d.atan(2*j[T][I]/(j[T][T]-j[I][I]))/2,(N=u.identity(Z,Z))[T][T]=d.cos(O),N[T][I]=-d.sin(O),N[I][T]=d.sin(O),N[I][I]=d.cos(O),q=u.multiply(q,N),j=u.multiply(u.multiply(u.inv(N),j),N),F=0,h=1;h<Z;h++)for(C=1;C<Z;C++)h!=C&&d.abs(j[h][C])>.001&&(F=1)}for(h=0;h<Z;h++)se.push(j[h][h]);return[q,se]},rungekutta:function(j,h,C,T,I,_){var O,N,F;if(_===2)for(;T<=C;)I+=((O=h*j(T,I))+(N=h*j(T+h,I+O)))/2,T+=h;if(_===4)for(;T<=C;)I+=((O=h*j(T,I))+2*(N=h*j(T+h/2,I+O/2))+2*(F=h*j(T+h/2,I+N/2))+h*j(T+h,I+F))/6,T+=h;return I},romberg:function(j,h,C,T){for(var I,_,O,N,F,Z=0,q=(C-h)/2,se=[],ge=[],ae=[];Z<T/2;){for(F=j(h),O=h,N=0;O<=C;O+=q,N++)se[N]=O;for(I=se.length,O=1;O<I-1;O++)F+=(O%2!=0?4:2)*j(se[O]);F=q/3*(F+j(C)),ae[Z]=F,q/=2,Z++}for(_=ae.length,I=1;_!==1;){for(O=0;O<_-1;O++)ge[O]=(d.pow(4,I)*ae[O+1]-ae[O])/(d.pow(4,I)-1);_=ge.length,ae=ge,ge=[],I++}return ae},richardson:function(j,h,C,T){function I(me,Le){for(var je,ie=0,_e=me.length;ie<_e;ie++)me[ie]===Le&&(je=ie);return je}for(var _,O,N,F,Z,q=d.abs(C-j[I(j,C)+1]),se=0,ge=[],ae=[];T>=q;)_=I(j,C+T),O=I(j,C),ge[se]=(h[_]-2*h[O]+h[2*O-_])/(T*T),T/=2,se++;for(F=ge.length,N=1;F!=1;){for(Z=0;Z<F-1;Z++)ae[Z]=(d.pow(4,N)*ge[Z+1]-ge[Z])/(d.pow(4,N)-1);F=ae.length,ge=ae,ae=[],N++}return ge},simpson:function(j,h,C,T){for(var I,_=(C-h)/T,O=j(h),N=[],F=h,Z=0,q=1;F<=C;F+=_,Z++)N[Z]=F;for(I=N.length;q<I-1;q++)O+=(q%2!=0?4:2)*j(N[q]);return _/3*(O+j(C))},hermite:function(j,h,C,T){for(var I,_=j.length,O=0,N=0,F=[],Z=[],q=[],se=[];N<_;N++){for(F[N]=1,I=0;I<_;I++)N!=I&&(F[N]*=(T-j[I])/(j[N]-j[I]));for(Z[N]=0,I=0;I<_;I++)N!=I&&(Z[N]+=1/(j[N]-j[I]));q[N]=(1-2*(T-j[N])*Z[N])*(F[N]*F[N]),se[N]=(T-j[N])*(F[N]*F[N]),O+=q[N]*h[N]+se[N]*C[N]}return O},lagrange:function(j,h,C){for(var T,I,_=0,O=0,N=j.length;O<N;O++){for(I=h[O],T=0;T<N;T++)O!=T&&(I*=(C-j[T])/(j[O]-j[T]));_+=I}return _},cubic_spline:function(j,h,C){for(var T,I,_=j.length,O=0,N=[],F=[],Z=[],q=[],se=[],ge=[];O<_-1;O++)q[O]=j[O+1]-j[O];for(Z[0]=0,O=1;O<_-1;O++)Z[O]=3/q[O]*(h[O+1]-h[O])-3/q[O-1]*(h[O]-h[O-1]);for(O=1;O<_-1;O++)N[O]=[],F[O]=[],N[O][O-1]=q[O-1],N[O][O]=2*(q[O-1]+q[O]),N[O][O+1]=q[O],F[O][0]=Z[O];for(I=u.multiply(u.inv(N),F),T=0;T<_-1;T++)se[T]=(h[T+1]-h[T])/q[T]-q[T]*(I[T+1][0]+2*I[T][0])/3,ge[T]=(I[T+1][0]-I[T][0])/(3*q[T]);for(T=0;T<_&&!(j[T]>C);T++);return h[T-=1]+(C-j[T])*se[T]+u.sq(C-j[T])*I[T]+(C-j[T])*u.sq(C-j[T])*ge[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var h,C,T,I,_,O=j.length,N=j[0].length,F=0,Z=[],q=[],se=[],ge=[],ae=[],me=[],Le=[];for(F=0;F<O;F++)Z[F]=u.sum(j[F])/N;for(F=0;F<N;F++)for(ae[F]=[],h=0;h<O;h++)ae[F][h]=j[h][F]-Z[h];for(ae=u.transpose(ae),F=0;F<O;F++)for(me[F]=[],h=0;h<O;h++)me[F][h]=u.dot([ae[F]],[ae[h]])/(N-1);for(_=(T=u.jacobi(me))[0],q=T[1],Le=u.transpose(_),F=0;F<q.length;F++)for(h=F;h<q.length;h++)q[F]<q[h]&&(C=q[F],q[F]=q[h],q[h]=C,se=Le[F],Le[F]=Le[h],Le[h]=se);for(I=u.transpose(ae),F=0;F<O;F++)for(ge[F]=[],h=0;h<I.length;h++)ge[F][h]=u.dot([Le[F]],[I[h]]);return[j,q,Le,ge]}}),function(j){for(var h=0;h<j.length;h++)(function(C){u.fn[C]=function(T,I){var _=this;return I?(setTimeout(function(){I.call(_,u.fn[C].call(_,T))},15),this):typeof u[C](this,T)=="number"?u[C](this,T):u(u[C](this,T))}})(j[h])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(b,Math),function(u,d){var k=[].slice,P=u.utils.isNumber,g=u.utils.isArray;function s(m,j,h,C){if(m>1||h>1||m<=0||h<=0)throw new Error("Proportions should be greater than 0 and less than 1");var T=(m*j+h*C)/(j+C);return(m-h)/d.sqrt(T*(1-T)*(1/j+1/C))}u.extend({zscore:function(){var m=k.call(arguments);return P(m[1])?(m[0]-m[1])/m[2]:(m[0]-u.mean(m[1]))/u.stdev(m[1],m[2])},ztest:function(){var m,j=k.call(arguments);return g(j[1])?(m=u.zscore(j[0],j[1],j[3]),j[2]===1?u.normal.cdf(-d.abs(m),0,1):2*u.normal.cdf(-d.abs(m),0,1)):j.length>2?(m=u.zscore(j[0],j[1],j[2]),j[3]===1?u.normal.cdf(-d.abs(m),0,1):2*u.normal.cdf(-d.abs(m),0,1)):(m=j[0],j[1]===1?u.normal.cdf(-d.abs(m),0,1):2*u.normal.cdf(-d.abs(m),0,1))}}),u.extend(u.fn,{zscore:function(m,j){return(m-this.mean())/this.stdev(j)},ztest:function(m,j,h){var C=d.abs(this.zscore(m,h));return j===1?u.normal.cdf(-C,0,1):2*u.normal.cdf(-C,0,1)}}),u.extend({tscore:function(){var m=k.call(arguments);return m.length===4?(m[0]-m[1])/(m[2]/d.sqrt(m[3])):(m[0]-u.mean(m[1]))/(u.stdev(m[1],!0)/d.sqrt(m[1].length))},ttest:function(){var m,j=k.call(arguments);return j.length===5?(m=d.abs(u.tscore(j[0],j[1],j[2],j[3])),j[4]===1?u.studentt.cdf(-m,j[3]-1):2*u.studentt.cdf(-m,j[3]-1)):P(j[1])?(m=d.abs(j[0]),j[2]==1?u.studentt.cdf(-m,j[1]-1):2*u.studentt.cdf(-m,j[1]-1)):(m=d.abs(u.tscore(j[0],j[1])),j[2]==1?u.studentt.cdf(-m,j[1].length-1):2*u.studentt.cdf(-m,j[1].length-1))}}),u.extend(u.fn,{tscore:function(m){return(m-this.mean())/(this.stdev(!0)/d.sqrt(this.cols()))},ttest:function(m,j){return j===1?1-u.studentt.cdf(d.abs(this.tscore(m)),this.cols()-1):2*u.studentt.cdf(-d.abs(this.tscore(m)),this.cols()-1)}}),u.extend({anovafscore:function(){var m,j,h,C,T,I,_,O,N=k.call(arguments);if(N.length===1){for(T=new Array(N[0].length),_=0;_<N[0].length;_++)T[_]=N[0][_];N=T}for(j=new Array,_=0;_<N.length;_++)j=j.concat(N[_]);for(h=u.mean(j),m=0,_=0;_<N.length;_++)m+=N[_].length*d.pow(u.mean(N[_])-h,2);for(m/=N.length-1,I=0,_=0;_<N.length;_++)for(C=u.mean(N[_]),O=0;O<N[_].length;O++)I+=d.pow(N[_][O]-C,2);return m/(I/(j.length-N.length))},anovaftest:function(){var m,j,h,C,T=k.call(arguments);if(P(T[0]))return 1-u.centralF.cdf(T[0],T[1],T[2]);var I=u.anovafscore(T);for(m=T.length-1,h=0,C=0;C<T.length;C++)h+=T[C].length;return j=h-m-1,1-u.centralF.cdf(I,m,j)},ftest:function(m,j,h){return 1-u.centralF.cdf(m,j,h)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){var m,j=0;for(m=0;m<this.length;m++)j+=this[m].length;return u.ftest(this.anovafscore(),this.length-1,j-this.length)}}),u.extend({qscore:function(){var m,j,h,C,T,I=k.call(arguments);return P(I[0])?(m=I[0],j=I[1],h=I[2],C=I[3],T=I[4]):(m=u.mean(I[0]),j=u.mean(I[1]),h=I[0].length,C=I[1].length,T=I[2]),d.abs(m-j)/(T*d.sqrt((1/h+1/C)/2))},qtest:function(){var m,j=k.call(arguments);j.length===3?(m=j[0],j=j.slice(1)):j.length===7?(m=u.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(m=u.qscore(j[0],j[1],j[2]),j=j.slice(3));var h=j[0],C=j[1];return 1-u.tukey.cdf(m,C,h-C)},tukeyhsd:function(m){for(var j=u.pooledstdev(m),h=m.map(function(N){return u.mean(N)}),C=m.reduce(function(N,F){return N+F.length},0),T=[],I=0;I<m.length;++I)for(var _=I+1;_<m.length;++_){var O=u.qtest(h[I],h[_],m[I].length,m[_].length,j,C,m.length);T.push([[I,_],O])}return T}}),u.extend({normalci:function(){var m,j=k.call(arguments),h=new Array(2);return m=j.length===4?d.abs(u.normal.inv(j[1]/2,0,1)*j[2]/d.sqrt(j[3])):d.abs(u.normal.inv(j[1]/2,0,1)*u.stdev(j[2])/d.sqrt(j[2].length)),h[0]=j[0]-m,h[1]=j[0]+m,h},tci:function(){var m,j=k.call(arguments),h=new Array(2);return m=j.length===4?d.abs(u.studentt.inv(j[1]/2,j[3]-1)*j[2]/d.sqrt(j[3])):d.abs(u.studentt.inv(j[1]/2,j[2].length-1)*u.stdev(j[2],!0)/d.sqrt(j[2].length)),h[0]=j[0]-m,h[1]=j[0]+m,h},significant:function(m,j){return m<j}}),u.extend(u.fn,{normalci:function(m,j){return u.normalci(m,j,this.toArray())},tci:function(m,j){return u.tci(m,j,this.toArray())}}),u.extend(u.fn,{oneSidedDifferenceOfProportions:function(m,j,h,C){var T=s(m,j,h,C);return u.ztest(T,1)},twoSidedDifferenceOfProportions:function(m,j,h,C){var T=s(m,j,h,C);return u.ztest(T,2)}})}(b,Math),b.models=function(){function u(d,k){var P=d.length,g=k[0].length-1,s=P-g-1,m=b.lstsq(k,d),j=b.multiply(k,m.map(function(O){return[O]})).map(function(O){return O[0]}),h=b.subtract(d,j),C=b.mean(d),T=b.sum(j.map(function(O){return Math.pow(O-C,2)})),I=b.sum(d.map(function(O,N){return Math.pow(O-j[N],2)})),_=T+I;return{exog:k,endog:d,nobs:P,df_model:g,df_resid:s,coef:m,predict:j,resid:h,ybar:C,SST:_,SSE:T,SSR:I,R2:T/_}}return{ols:function(d,k){var P=u(d,k),g=function(j){var h,C,T=(h=j.exog,C=h[0].length,b.arange(C).map(function(q){var se=b.arange(C).filter(function(ge){return ge!==q});return u(b.col(h,q).map(function(ge){return ge[0]}),b.col(h,se))})),I=Math.sqrt(j.SSR/j.df_resid),_=T.map(function(q){var se=q.SST,ge=q.R2;return I/Math.sqrt(se*(1-ge))}),O=j.coef.map(function(q,se){return(q-0)/_[se]}),N=O.map(function(q){var se=b.studentt.cdf(q,j.df_resid);return 2*(se>.5?1-se:se)}),F=b.studentt.inv(.975,j.df_resid),Z=j.coef.map(function(q,se){var ge=F*_[se];return[q-ge,q+ge]});return{se:_,t:O,p:N,sigmaHat:I,interval95:Z}}(P),s=function(j){var h,C,T,I=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:I,pvalue:1-(h=I,C=j.df_model,T=j.df_resid,b.beta.cdf(h/(T/C+h),C/2,T/2))}}(P),m=1-(1-P.R2)*((P.nobs-1)/P.df_resid);return P.t=g,P.f=s,P.adjust_R2=m,P}}}(),b.extend({buildxmatrix:function(){for(var u=new Array(arguments.length),d=0;d<arguments.length;d++)u[d]=[1].concat(arguments[d]);return b(u)},builddxmatrix:function(){for(var u=new Array(arguments[0].length),d=0;d<arguments[0].length;d++)u[d]=[1].concat(arguments[0][d]);return b(u)},buildjxmatrix:function(u){for(var d=new Array(u.length),k=0;k<u.length;k++)d[k]=u[k];return b.builddxmatrix(d)},buildymatrix:function(u){return b(u).transpose()},buildjymatrix:function(u){return u.transpose()},matrixmult:function(u,d){var k,P,g,s,m;if(u.cols()==d.rows()){if(d.rows()>1){for(s=[],k=0;k<u.rows();k++)for(s[k]=[],P=0;P<d.cols();P++){for(m=0,g=0;g<u.cols();g++)m+=u.toArray()[k][g]*d.toArray()[g][P];s[k][P]=m}return b(s)}for(s=[],k=0;k<u.rows();k++)for(s[k]=[],P=0;P<d.cols();P++){for(m=0,g=0;g<u.cols();g++)m+=u.toArray()[k][g]*d.toArray()[P];s[k][P]=m}return b(s)}},regress:function(u,d){var k=b.xtranspxinv(u),P=u.transpose(),g=b.matrixmult(b(k),P);return b.matrixmult(g,d)},regresst:function(u,d,k){var P=b.regress(u,d),g={anova:{}},s=b.jMatYBar(u,P);g.yBar=s;var m=d.mean();g.anova.residuals=b.residuals(d,s),g.anova.ssr=b.ssr(s,m),g.anova.msr=g.anova.ssr/(u[0].length-1),g.anova.sse=b.sse(d,s),g.anova.mse=g.anova.sse/(d.length-(u[0].length-1)-1),g.anova.sst=b.sst(d,m),g.anova.mst=g.anova.sst/(d.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=b.anovaftest(g.anova.fratio,u[0].length-1,d.length-(u[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(u[0].length);for(var j,h,C,T=b.xtranspxinv(u),I=0;I<P.length;I++)j=Math.sqrt(g.anova.mse*Math.abs(T[I][I])),h=Math.abs(P[I]/j),C=b.ttest(h,d.length-u[0].length-1,k),g.stats[I]=[P[I],j,h,C];return g.regress=P,g},xtranspx:function(u){return b.matrixmult(u.transpose(),u)},xtranspxinv:function(u){var d=b.matrixmult(u.transpose(),u);return b.inv(d)},jMatYBar:function(u,d){var k=b.matrixmult(u,d);return new b(k)},residuals:function(u,d){return b.matrixsubtract(u,d)},ssr:function(u,d){for(var k=0,P=0;P<u.length;P++)k+=Math.pow(u[P]-d,2);return k},sse:function(u,d){for(var k=0,P=0;P<u.length;P++)k+=Math.pow(u[P]-d[P],2);return k},sst:function(u,d){for(var k=0,P=0;P<u.length;P++)k+=Math.pow(u[P]-d,2);return k},matrixsubtract:function(u,d){for(var k=new Array(u.length),P=0;P<u.length;P++){k[P]=new Array(u[P].length);for(var g=0;g<u[P].length;g++)k[P][g]=u[P][g]-d[P][g]}return b(k)}}),b.jStat=b,b)},960:function(W,b,u){const d=u(592);W.exports=function(k){function P(I,_){const O=_.split(".");let N=I;for(const F of O){if(N==null)return;N=N[F]}return N}for(let I=0;I<Object.keys(d).length;I++){let _,O=Object.keys(d)[I],N=[];if(typeof d[O]=="object"){N=Object.keys(d[O]),_=Object.values(d[O]);for(let F=0;F<_.length;F++)if(typeof _[F]=="object"){let Z=N[F];d[O][Z]&&(N=[...N,...Object.keys(d[O][Z]).map(q=>Z+"."+q)],N.splice(N.indexOf(Z),1))}}if(N.length<1)k[O]=d[O];else for(let F=0;F<N.length;F++)typeof P(d[O],N[F])=="function"&&(k[O]=P(d[O],N[F]))}let g=function(I){return typeof I=="number"&&(I=parseInt(I)),I},s=null,m=null,j=null;k.TABLE=function(){return j},k.COLUMN=k.COL=function(){return j.tracking&&j.tracking.push(T.getColumnNameFromCoords(g(s),g(m))),g(s)+1},k.ROW=function(){return j.tracking&&j.tracking.push(T.getColumnNameFromCoords(g(s),g(m))),g(m)+1},k.CELL=function(){return T.getColumnNameFromCoords(s,m)},k.VALUE=function(I,_,O){return j.getValueFromCoords(g(I)-1,g(_)-1,O)},k.THISROWCELL=function(I){return j.getValueFromCoords(g(I)-1,g(m))};const h=function(I,_){for(let O=0;O<I.length;O++){let N=T.getTokensFromRange(I[O]);_=_.replace(I[O],"["+N.join(",")+"]")}return _},C=function(I){return typeof I=="string"&&(I=I.trim()),!isNaN(I)&&I!==null&&I!==""},T=function(I,_,O,N,F){j=F,s=O,m=N;let Z="",q={};if(_)if(_.size){let ae,me=null;_.forEach(function(Le,je){ae=je.replace(/!/g,"."),ae.indexOf(".")!==-1&&(ae=ae.split("."),q[ae[0]]=!0)}),ae=Object.keys(q);for(let Le=0;Le<ae.length;Le++)Z+="var "+ae[Le]+" = {};";_.forEach(function(Le,je){ae=je.replace(/!/g,"."),Le===null||C(Le)||(me=Le.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),me&&me.length&&(Le=updateRanges(me,Le))),ae.indexOf(".")>0?Z+=ae+" = "+_.get(je)+`;
`:Z+="var "+ae+" = "+Le+`;
`})}else{let ae=Object.keys(_);if(ae.length){let me,Le={};for(let je=0;je<ae.length;je++)if(me=ae[je].replace(/\!/g,"."),me.indexOf(".")>0){let ie=ie.split(".");Le[ie[0]]={}}me=Object.keys(Le);for(let je=0;je<me.length;je++)Z+="var "+me[je]+" = {};";for(let je=0;je<ae.length;je++){if(me=ae[je].replace(/!/g,"."),_[ae[je]]!==null&&!C(_[ae[je]])){let ie=_[ae[je]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ie&&ie.length&&(_[ae[je]]=h(ie,_[ae[je]]))}me.indexOf(".")>0?Z+=me+" = "+_[ae[je]]+`;
`:Z+="var "+me+" = "+_[ae[je]]+`;
`}}}let se=(I=function(ae,me){let Le="",je=0,ie=["=","!",">","<"];for(let _e=0;_e<ae.length;_e++)ae[_e]==='"'&&(je=je===0?1:0),je===1?Le+=ae[_e]:(Le+=ae[_e].toUpperCase(),_e>0&&ae[_e]==="="&&ie.indexOf(ae[_e-1])===-1&&ie.indexOf(ae[_e+1])===-1&&(Le+="="));return Le=Le.replace(/\^/g,"**"),Le=Le.replace(/<>/g,"!="),Le=Le.replace(/&/g,"+"),Le=Le.replace(/\$/g,""),Le}(I=(I=I.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);se&&se.length&&(I=h(se,I));let ge=new Function(Z+"; return "+I)();return ge===null&&(ge=0),ge};return T.getColumnNameFromCoords=function(I,_){return N="",(O=parseInt(I))>701?(N+=String.fromCharCode(64+parseInt(O/676)),N+=String.fromCharCode(64+parseInt(O%676/26))):O>25&&(N+=String.fromCharCode(64+parseInt(O/26))),N+String.fromCharCode(65+O%26)+(parseInt(_)+1);var O,N},T.getCoordsFromColumnName=function(I){var _=/^[a-zA-Z]+/.exec(I);if(_){for(var O=0,N=0;N<_[0].length;N++)O+=parseInt(_[0].charCodeAt(N)-64)*Math.pow(26,_[0].length-1-N);--O<0&&(O=0);var F=parseInt(/[0-9]+$/.exec(I))||null;return F>0&&F--,[O,F]}},T.getRangeFromTokens=function(I){I=I.filter(function(F){return F!="#REF!"});for(var _="",O="",N=0;N<I.length;N++)I[N].indexOf(".")>=0?_=".":I[N].indexOf("!")>=0&&(_="!"),_&&(O=I[N].split(_),I[N]=O[1],O=O[0]+_);return I.sort(function(F,Z){var q=Helpers.getCoordsFromColumnName(F),se=Helpers.getCoordsFromColumnName(Z);return q[1]>se[1]?1:q[1]<se[1]?-1:q[0]>se[0]?1:q[0]<se[0]?-1:0}),I.length?O+(I[0]+":")+I[I.length-1]:"#REF!"},T.getTokensFromRange=function(I){if(I.indexOf(".")>0){var _=I.split(".");I=_[1],_=_[0]+"."}else I.indexOf("!")>0?(_=I.split("!"),I=_[1],_=_[0]+"!"):_="";I=I.split(":");var O=T.getCoordsFromColumnName(I[0]),N=T.getCoordsFromColumnName(I[1]);if(O[0]<=N[0])var F=O[0],Z=N[0];else F=N[0],Z=O[0];if(O[1]===null&&N[1]==null)for(var q=null,se=null,ge=Object.keys(vars),ae=0;ae<ge.length;ae++){var me=T.getCoordsFromColumnName(ge[ae]);me[0]===O[0]&&(q===null||me[1]<q)&&(q=me[1]),me[0]===N[0]&&(se===null||me[1]>se)&&(se=me[1])}else O[1]<=N[1]?(q=O[1],se=N[1]):(q=N[1],se=O[1]);for(var Le=[],je=q;je<=se;je++){var ie=[];for(ae=F;ae<=Z;ae++)ie.push(_+T.getColumnNameFromCoords(ae,je));Le.push(ie)}return Le},T.setFormula=function(I){let _=Object.keys(I);for(let O=0;O<_.length;O++)typeof I[_[O]]=="function"&&(k[_[O]]=I[_[O]])},T.basic=!0,T}(typeof window>"u"?u.g:window)},592:function(W,b,u){var d=u(162),k=u(765);const P=new Error("#NULL!"),g=new Error("#DIV/0!"),s=new Error("#VALUE!"),m=new Error("#REF!"),j=new Error("#NAME?"),h=new Error("#NUM!"),C=new Error("#N/A"),T=new Error("#ERROR!"),I=new Error("#GETTING_DATA");var _=Object.freeze({__proto__:null,data:I,div0:g,error:T,na:C,name:j,nil:P,num:h,ref:m,value:s});function O(e){const t=[];return N(e,o=>{t.push(o)}),t}function N(e,t){let o=-1;const p=e.length;for(;++o<p&&t(e[o],o,e)!==!1;);return e}function F(e){let t,o=e.length;for(;o--;)if(t=e[o],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const p=Y(t);e[o]=p instanceof Error?0:p}}else e[o]=0;else e[o]=1;return e}function Z(e,t){if(!e)return s;e.every(M=>Array.isArray(M))&&e.length!==0||(e=[[...e]]),e.map((M,H)=>{M.map((z,oe)=>{z||(e[H][oe]=0)})});const o=e.reduce((M,H,z)=>H.length>e[M].length?z:M,0),p=e[o].length;return e.map(M=>[...M,...Array(p-M.length).fill(0)])}function q(){let e;if(arguments.length===1){const o=arguments[0];e=(t=o)!=null&&typeof t.length=="number"&&typeof t!="string"?O.apply(null,arguments):[o]}else e=Array.from(arguments);for(var t;!ge(e);)e=se(e);return e}function se(e){return e&&e.reduce?e.reduce((t,o)=>{const p=Array.isArray(t),M=Array.isArray(o);return p&&M?t.concat(o):p?(t.push(o),t):M?[t].concat(o):[t,o]}):[e]}function ge(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function ae(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function me(e){return e?e[0].map((t,o)=>e.map(p=>p[o])):s}function Le(e,t){let o=null;return N(e,(p,M)=>{if(p[0]===t)return o=M,!1}),o??s}function je(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ie(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function _e(e){return Math.round(e*1e14)/1e14}function Ye(){return q.apply(null,arguments).filter(e=>typeof e=="number")}function Ue(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||s}function He(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?h:function(o){o<60&&(o+=1);const p=Math.floor(o-25569),M=new Date(86400*p*1e3),H=o-Math.floor(o)+1e-7;let z=Math.floor(86400*H);const oe=z%60;z-=oe;const de=Math.floor(z/3600),Ce=Math.floor(z/60)%60;let ke=M.getUTCDate(),Pe=M.getUTCMonth();return o>=60&&o<61&&(ke=29,Pe=1),new Date(M.getUTCFullYear(),Pe,ke,de,Ce,oe)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?s:e}function ut(e){let t,o=e.length;for(;o--;){if(t=He(e[o]),t===s)return t;e[o]=t}return e}function Y(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?s:parseFloat(e))}function Ne(e){let t,o;if(!e||(t=e.length)===0)return s;for(;t--;){if(e[t]instanceof Error)return e[t];if(o=Y(e[t]),o instanceof Error)return o;e[t]=o}return e}function Ve(e){return e instanceof Error?e:e==null?"":e.toString()}function bt(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function tt(e){return e!=null}const Ae="=",Te=[">",">=","<","<=","=","<>"],Be="operator",ze="literal",Je=[Be,ze],Qe=Be,it=ze;function dt(e,t){if(Je.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function mt(e){return function(t){let o="";const p=[];for(let M=0;M<t.length;M++){const H=t[M];M===0&&Te.indexOf(H)>=0?p.push(dt(H,Qe)):o+=H}return o.length>0&&p.push(dt(function(M){return typeof M!="string"||/^\d+(\.\d+)?$/.test(M)&&(M=M.indexOf(".")===-1?parseInt(M,10):parseFloat(M)),M}(o),it)),p.length>0&&p[0].type!==Qe&&p.unshift(dt(Ae,Qe)),p}(function(t){const o=t.length,p=[];let M=0,H="",z="";for(;M<o;){const oe=t.charAt(M);switch(oe){case">":case"<":case"=":z+=oe,H.length>0&&(p.push(H),H="");break;default:z.length>0&&(p.push(z),z=""),H+=oe}M++}return H.length>0&&p.push(H),z.length>0&&p.push(z),p}(e))}const ht=function(e){const t=[];let o;for(let p=0;p<e.length;p++){const M=e[p];switch(M.type){case Qe:o=M.value;break;case it:t.push(M.value)}}return function(p,M){let H=!1;switch(M){case">":H=p[0]>p[1];break;case">=":H=p[0]>=p[1];break;case"<":H=p[0]<p[1];break;case"<=":H=p[0]<=p[1];break;case"=":H=p[0]==p[1];break;case"<>":H=p[0]!=p[1]}return H}(t,o)},St={};function Ft(e){return[s,m,g,h,j,P].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Et(e){return Ft(e)||e===C}function Ot(e){return e===!0||e===!1}function Tt(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function gt(e){return typeof e=="string"}function kt(){const e=[];for(let t=0;t<arguments.length;++t){let o=!1;const p=arguments[t];for(let M=0;M<e.length&&(o=e[M]===p,!o);++M);o||e.push(p)}return e}function Rt(e,t,o,p){if(!t||!o)return C;p=!(p===0||p===!1);let M=C;const H=typeof e=="number";let z=!1;for(let oe=0;oe<t.length;oe++){const de=t[oe];if(de[0]===e){M=o<de.length+1?de[o-1]:m;break}!z&&(H&&p&&de[0]<=e||p&&typeof de[0]=="string"&&de[0].localeCompare(e)<0)&&(M=o<de.length+1?de[o-1]:m),H&&de[0]>e&&(z=!0)}return M}function w(){const e=q(arguments).filter(tt);if(e.length===0)return g;const t=je.apply(void 0,e);if(t)return t;const o=Ye(e),p=o.length;let M,H=0,z=0;for(let oe=0;oe<p;oe++)H+=o[oe],z+=1;return M=H/z,isNaN(M)&&(M=h),M}function E(){const e=q(arguments).filter(tt);if(e.length===0)return g;const t=je.apply(void 0,e);if(t)return t;const o=e,p=o.length;let M,H=0,z=0;for(let oe=0;oe<p;oe++){const de=o[oe];typeof de=="number"&&(H+=de),de===!0&&H++,de!==null&&z++}return M=H/z,isNaN(M)&&(M=h),M}St.TYPE=e=>{switch(e){case P:return 1;case g:return 2;case s:return 3;case m:return 4;case j:return 5;case h:return 6;case C:return 7;case I:return 8}return C};const a={DIST:function(e,t,o,p,M,H){return arguments.length<4?s:(M=M===void 0?0:M,H=H===void 0?1:H,ie(e=Y(e),t=Y(t),o=Y(o),M=Y(M),H=Y(H))?s:(e=(e-M)/(H-M),p?d.beta.cdf(e,t,o):d.beta.pdf(e,t,o)))},INV:(e,t,o,p,M)=>(p=p===void 0?0:p,M=M===void 0?1:M,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M))?s:d.beta.inv(e,t,o)*(M-p)+p)},r={DIST:(e,t,o,p)=>ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p))?s:p?d.binomial.cdf(e,t,o):d.binomial.pdf(e,t,o)};r.DIST.RANGE=(e,t,o,p)=>{if(p=p===void 0?o:p,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p)))return s;let M=0;for(let H=o;H<=p;H++)M+=Ge(e,H)*Math.pow(t,H)*Math.pow(1-t,e-H);return M},r.INV=(e,t,o)=>{if(ie(e=Y(e),t=Y(t),o=Y(o)))return s;let p=0;for(;p<=e;){if(d.binomial.cdf(p,e,t)>=o)return p;p++}};const B={DIST:(e,t,o)=>ie(e=Y(e),t=Y(t))?s:o?d.chisquare.cdf(e,t):d.chisquare.pdf(e,t)};B.DIST.RT=(e,t)=>!e|!t?C:e<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?s:1-d.chisquare.cdf(e,t),B.INV=(e,t)=>ie(e=Y(e),t=Y(t))?s:d.chisquare.inv(e,t),B.INV.RT=(e,t)=>!e|!t?C:e<0||e>1||t<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?s:d.chisquare.inv(1-e,t),B.TEST=function(e,t){if(arguments.length!==2)return C;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return s;const o=e.length;let p,M,H;for(M=0;M<o;M++)e[M]instanceof Array||(p=e[M],e[M]=[],e[M].push(p)),t[M]instanceof Array||(p=t[M],t[M]=[],t[M].push(p));const z=e[0].length,oe=z===1?o-1:(o-1)*(z-1);let de=0;const Ce=Math.PI;for(M=0;M<o;M++)for(H=0;H<z;H++)de+=Math.pow(e[M][H]-t[M][H],2)/t[M][H];return Math.round(1e6*function(ke,Pe){let Re=Math.exp(-.5*ke);Pe%2==1&&(Re*=Math.sqrt(2*ke/Ce));let We=Pe;for(;We>=2;)Re=Re*ke/We,We-=2;let Ze=Re,rt=Pe;for(;Ze>1e-10*Re;)rt+=2,Ze=Ze*ke/rt,Re+=Ze;return 1-Re}(de,oe))/1e6};const te={};function ee(){return Ye(q(arguments)).length}function S(){const e=q(arguments);return e.length-A(e)}function A(){const e=q(arguments);let t,o=0;for(let p=0;p<e.length;p++)t=e[p],t!=null&&t!==""||o++;return o}te.NORM=(e,t,o)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:d.normalci(1,e,t,o)[1]-1,te.T=(e,t,o)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:d.tci(1,e,t,o)[1]-1;const V={P:(e,t)=>{if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const o=d.mean(e),p=d.mean(t);let M=0;const H=e.length;for(let z=0;z<H;z++)M+=(e[z]-o)*(t[z]-p);return M/H},S:(e,t)=>ie(e=Ne(q(e)),t=Ne(q(t)))?s:d.covariance(e,t)},G={DIST:(e,t,o)=>ie(e=Y(e),t=Y(t))?s:o?d.exponential.cdf(e,t):d.exponential.pdf(e,t)},ne={};function he(e,t,o){if(ie(e=Y(e),t=Ne(q(t)),o=Ne(q(o))))return s;const p=d.mean(o),M=d.mean(t),H=o.length;let z=0,oe=0;for(let Ce=0;Ce<H;Ce++)z+=(o[Ce]-p)*(t[Ce]-M),oe+=Math.pow(o[Ce]-p,2);const de=z/oe;return M-de*p+de*e}function ce(e){return(e=Y(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?h:d.gammafn(e)}function fe(e){return(e=Y(e))instanceof Error?e:d.gammaln(e)}ne.DIST=(e,t,o,p)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:p?d.centralF.cdf(e,t,o):d.centralF.pdf(e,t,o),ne.DIST.RT=function(e,t,o){return arguments.length!==3?C:e<0||t<1||o<1?h:typeof e!="number"||typeof t!="number"||typeof o!="number"?s:1-d.centralF.cdf(e,t,o)},ne.INV=(e,t,o)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:e<=0||e>1?h:d.centralF.inv(e,t,o),ne.INV.RT=function(e,t,o){return arguments.length!==3?C:e<0||e>1||t<1||t>Math.pow(10,10)||o<1||o>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"||typeof o!="number"?s:d.centralF.inv(1-e,t,o)},ne.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return C;if(e.length<2||t.length<2)return g;const o=(H,z)=>{let oe=0;for(let de=0;de<H.length;de++)oe+=Math.pow(H[de]-z,2);return oe},p=At(e)/e.length,M=At(t)/t.length;return o(e,p)/(e.length-1)/(o(t,M)/(t.length-1))},ce.DIST=function(e,t,o,p){return arguments.length!==4?C:e<0||t<=0||o<=0||typeof e!="number"||typeof t!="number"||typeof o!="number"?s:p?d.gamma.cdf(e,t,o,!0):d.gamma.pdf(e,t,o,!1)},ce.INV=function(e,t,o){return arguments.length!==3?C:e<0||e>1||t<=0||o<=0?h:typeof e!="number"||typeof t!="number"||typeof o!="number"?s:d.gamma.inv(e,t,o)},fe.PRECISE=function(e){return arguments.length!==1?C:e<=0?h:typeof e!="number"?s:d.gammaln(e)};const Ee={};function De(e,t){return ie(e=Ne(q(e)),t=Y(t))?e:t<0||e.length<t?s:e.sort((o,p)=>p-o)[t-1]}function Se(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const o=d.mean(e),p=d.mean(t),M=t.length;let H=0,z=0;for(let de=0;de<M;de++)H+=(t[de]-p)*(e[de]-o),z+=Math.pow(t[de]-p,2);const oe=H/z;return[oe,o-oe*p]}Ee.DIST=(e,t,o,p,M)=>{if(ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p)))return s;function H(z,oe,de,Ce){return Ge(de,z)*Ge(Ce-de,oe-z)/Ge(Ce,oe)}return M?function(z,oe,de,Ce){let ke=0;for(let Pe=0;Pe<=z;Pe++)ke+=H(Pe,oe,de,Ce);return ke}(e,t,o,p):H(e,t,o,p)};const qe={};function $e(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;const o=Ye(e);return o.length===0?0:Math.max.apply(Math,o)}function Q(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;const o=F(e);let p=d.median(o);return isNaN(p)&&(p=h),p}function pe(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;const o=Ye(e);return o.length===0?0:Math.min.apply(Math,o)}qe.DIST=(e,t,o,p)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:p?d.lognormal.cdf(e,t,o):d.lognormal.pdf(e,t,o),qe.INV=(e,t,o)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:d.lognormal.inv(e,t,o);const we={MULT:function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=e.length,o={};let p,M=[],H=0;for(let z=0;z<t;z++)p=e[z],o[p]=o[p]?o[p]+1:1,o[p]>H&&(H=o[p],M=[]),o[p]===H&&(M[M.length]=p);return M},SNGL:function(){const e=Ne(q(arguments));return e instanceof Error?e:we.MULT(e).sort((t,o)=>t-o)[0]}},U={DIST:(e,t,o,p)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:p?d.negbin.cdf(e,t,o):d.negbin.pdf(e,t,o)},J={};function v(e,t){if(ie(t=Ne(q(t)),e=Ne(q(e))))return s;const o=d.mean(e),p=d.mean(t),M=e.length;let H=0,z=0,oe=0;for(let de=0;de<M;de++)H+=(e[de]-o)*(t[de]-p),z+=Math.pow(e[de]-o,2),oe+=Math.pow(t[de]-p,2);return H/Math.sqrt(z*oe)}J.DIST=(e,t,o,p)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:o<=0?h:p?d.normal.cdf(e,t,o):d.normal.pdf(e,t,o),J.INV=(e,t,o)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:d.normal.inv(e,t,o),J.S={},J.S.DIST=(e,t)=>(e=Y(e))instanceof Error?s:t?d.normal.cdf(e,0,1):d.normal.pdf(e,0,1),J.S.INV=e=>(e=Y(e))instanceof Error?s:d.normal.inv(e,0,1);const D={EXC:(e,t)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;const o=(e=e.sort((H,z)=>H-z)).length;if(t<1/(o+1)||t>1-1/(o+1))return h;const p=t*(o+1)-1,M=Math.floor(p);return _e(p===M?e[p]:e[M]+(p-M)*(e[M+1]-e[M]))},INC:(e,t)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;const o=t*((e=e.sort((M,H)=>M-H)).length-1),p=Math.floor(o);return _e(o===p?e[o]:e[p]+(o-p)*(e[p+1]-e[p]))}},X={EXC:(e,t,o)=>{if(o=o===void 0?3:o,ie(e=Ne(q(e)),t=Y(t),o=Y(o)))return s;e=e.sort((ke,Pe)=>ke-Pe);const p=kt.apply(null,e),M=e.length,H=p.length,z=Math.pow(10,o);let oe=0,de=!1,Ce=0;for(;!de&&Ce<H;)t===p[Ce]?(oe=(e.indexOf(p[Ce])+1)/(M+1),de=!0):t>=p[Ce]&&(t<p[Ce+1]||Ce===H-1)&&(oe=(e.indexOf(p[Ce])+1+(t-p[Ce])/(p[Ce+1]-p[Ce]))/(M+1),de=!0),Ce++;return Math.floor(oe*z)/z},INC:(e,t,o)=>{if(o=o===void 0?3:o,ie(e=Ne(q(e)),t=Y(t),o=Y(o)))return s;e=e.sort((ke,Pe)=>ke-Pe);const p=kt.apply(null,e),M=e.length,H=p.length,z=Math.pow(10,o);let oe=0,de=!1,Ce=0;for(;!de&&Ce<H;)t===p[Ce]?(oe=e.indexOf(p[Ce])/(M-1),de=!0):t>=p[Ce]&&(t<p[Ce+1]||Ce===H-1)&&(oe=(e.indexOf(p[Ce])+(t-p[Ce])/(p[Ce+1]-p[Ce]))/(M-1),de=!0),Ce++;return Math.floor(oe*z)/z}},ue={DIST:(e,t,o)=>ie(e=Y(e),t=Y(t))?s:o?d.poisson.cdf(e,t):d.poisson.pdf(e,t)},K={EXC:(e,t)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;switch(t){case 1:return D.EXC(e,.25);case 2:return D.EXC(e,.5);case 3:return D.EXC(e,.75);default:return h}},INC:(e,t)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;switch(t){case 1:return D.INC(e,.25);case 2:return D.INC(e,.5);case 3:return D.INC(e,.75);default:return h}}},le={};function be(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=d.mean(e),o=e.length;let p=0;for(let M=0;M<o;M++)p+=Math.pow(e[M]-t,3);return o*p/((o-1)*(o-2)*Math.pow(d.stdev(e,!0),3))}function Me(e,t){return ie(e=Ne(q(e)),t=Y(t))?e:e.sort((o,p)=>o-p)[t-1]}le.AVG=(e,t,o)=>{if(ie(e=Y(e),t=Ne(q(t))))return s;const p=(o=o||!1)?(z,oe)=>z-oe:(z,oe)=>oe-z,M=(t=(t=q(t)).sort(p)).length;let H=0;for(let z=0;z<M;z++)t[z]===e&&H++;return H>1?(2*t.indexOf(e)+H+1)/2:t.indexOf(e)+1},le.EQ=(e,t,o)=>{if(ie(e=Y(e),t=Ne(q(t))))return s;const p=(o=o||!1)?(M,H)=>M-H:(M,H)=>H-M;return(t=t.sort(p)).indexOf(e)+1},be.P=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=d.mean(e),o=e.length;let p=0,M=0;for(let H=0;H<o;H++)M+=Math.pow(e[H]-t,3),p+=Math.pow(e[H]-t,2);return M/=o,p/=o,M/Math.pow(p,1.5)};const ve={P:function(){const e=Fe.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},S:function(){const e=Fe.S.apply(this,arguments);return Math.sqrt(e)}},Ie={DIST:(e,t,o)=>o!==1&&o!==2?h:o===1?Ie.DIST.RT(e,t):Ie.DIST["2T"](e,t)};Ie.DIST["2T"]=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?s:2*(1-d.studentt.cdf(e,t))},Ie.DIST.RT=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?s:1-d.studentt.cdf(e,t)},Ie.INV=(e,t)=>ie(e=Y(e),t=Y(t))?s:d.studentt.inv(e,t),Ie.INV["2T"]=(e,t)=>(e=Y(e),t=Y(t),e<=0||e>1||t<1?h:ie(e,t)?s:Math.abs(d.studentt.inv(e/2,t))),Ie.TEST=(e,t)=>{if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const o=d.mean(e),p=d.mean(t);let M,H=0,z=0;for(M=0;M<e.length;M++)H+=Math.pow(e[M]-o,2);for(M=0;M<t.length;M++)z+=Math.pow(t[M]-p,2);H/=e.length-1,z/=t.length-1;const oe=Math.abs(o-p)/Math.sqrt(H/e.length+z/t.length);return Ie.DIST["2T"](oe,e.length+t.length-2)};const Fe={};function et(){const e=q(arguments),t=e.length;let o=0,p=0;const M=E(e);for(let H=0;H<t;H++){const z=e[H];o+=Math.pow(typeof z=="number"?z-M:z===!0?1-M:0-M,2),z!==null&&p++}return o/(p-1)}function re(){const e=q(arguments),t=e.length;let o=0,p=0;const M=E(e);let H;for(let z=0;z<t;z++){const oe=e[z];o+=Math.pow(typeof oe=="number"?oe-M:oe===!0?1-M:0-M,2),oe!==null&&p++}return H=o/p,isNaN(H)&&(H=h),H}Fe.P=function(){const e=Ye(q(arguments)),t=e.length;let o=0;const p=w(e);let M;for(let H=0;H<t;H++)o+=Math.pow(e[H]-p,2);return M=o/t,isNaN(M)&&(M=h),M},Fe.S=function(){const e=Ye(q(arguments)),t=e.length;let o=0;const p=w(e);for(let M=0;M<t;M++)o+=Math.pow(e[M]-p,2);return o/(t-1)};const ye={DIST:(e,t,o,p)=>ie(e=Y(e),t=Y(t),o=Y(o))?s:p?1-Math.exp(-Math.pow(e/o,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/o,t))*t/Math.pow(o,t)},xe={};function Oe(e,t,o){const p=je(e=Y(e),t=Y(t),o=Y(o));if(p)return p;if(t===0)return 0;t=Math.abs(t);const M=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.ceil(e/t)*t,M):o===0?-xt(Math.floor(Math.abs(e)/t)*t,M):-xt(Math.ceil(Math.abs(e)/t)*t,M)}function Ge(e,t){return je(e=Y(e),t=Y(t))||(e<t?h:ot(e)/(ot(t)*ot(e-t)))}xe.TEST=(e,t,o)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;o=o||ve.S(e);const p=e.length;return 1-J.S.DIST((w(e)-t)/(o/Math.sqrt(p)),!0)},Oe.MATH=Oe,Oe.PRECISE=Oe;const Ke=[];function ot(e){if((e=Y(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(Ke[t]>0||(Ke[t]=ot(t-1)*t),Ke[t])}function ft(e,t){const o=je(e=Y(e),t=Y(t));if(o)return o;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return h;t=Math.abs(t);const p=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,p):-xt(Math.ceil(Math.abs(e)/t),p)}ft.MATH=(e,t,o)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const p=je(e=Y(e),t=Y(t),o=Y(o));if(p)return p;if(t===0)return 0;t=t?Math.abs(t):1;const M=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,M):o===0||o===void 0?-xt(Math.ceil(Math.abs(e)/t)*t,M):-xt(Math.floor(Math.abs(e)/t)*t,M)},ft.PRECISE=ft.MATH;const nt={CEILING:Oe};function lt(e,t){const o=je(e=Y(e),t=Y(t));if(o)return o;if(e===0&&t===0)return h;const p=Math.pow(e,t);return isNaN(p)?h:p}function Xe(){const e=q(arguments).filter(p=>p!=null);if(e.length===0)return 0;const t=Ne(e);if(t instanceof Error)return t;let o=1;for(let p=0;p<t.length;p++)o*=t[p];return o}function xt(e,t){return je(e=Y(e),t=Y(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function At(){let e=0;return N(O(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const o=parseFloat(t);!isNaN(o)&&(e+=o)}else if(Array.isArray(t)){const o=At.apply(null,t);o instanceof Error?e=o:e+=o}}),e}var dn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?C:je(e=Y(e),t=Y(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?C:je(e=Y(e),t=Y(t))||(t===0?g:e/t)},EQ:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(bt(e,t)?(e=Ve(e),t=Ve(t)):(e=Y(e),t=Y(t)),je(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?C:(bt(e,t)?(e=Ve(e),t=Ve(t)):(e=Y(e),t=Y(t)),je(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?C:(bt(e,t)?(e=Ve(e),t=Ve(t)):(e=Y(e),t=Y(t)),je(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?C:(bt(e,t)?(e=Ve(e),t=Ve(t)):(e=Y(e),t=Y(t)),je(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?C:je(e=Y(e),t=Y(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?C:je(e=Y(e),t=Y(t))||e*t},NE:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?C:lt(e,t)}});const fn=new Date(Date.UTC(1900,0,1)),pn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],hn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Ht=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function It(e,t,o){o=o.toUpperCase(),e=He(e),t=He(t);const p=e.getFullYear(),M=e.getMonth(),H=e.getDate(),z=t.getFullYear(),oe=t.getMonth(),de=t.getDate();let Ce;switch(o){case"Y":Ce=Math.floor(zt(e,t));break;case"D":Ce=Lt(t,e);break;case"M":Ce=oe-M+12*(z-p),de<H&&Ce--;break;case"MD":H<=de?Ce=de-H:(oe===0?(e.setFullYear(z-1),e.setMonth(12)):(e.setFullYear(z),e.setMonth(oe-1)),Ce=Lt(t,e));break;case"YM":Ce=oe-M+12*(z-p),de<H&&Ce--,Ce%=12;break;case"YD":oe>M||oe===M&&de<H?e.setFullYear(z):e.setFullYear(z-1),Ce=Lt(t,e)}return Ce}function Bt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Lt(e,t){return e=He(e),t=He(t),e instanceof Error?e:t instanceof Error?t:nn(Bt(e))-nn(Bt(t))}function wt(e,t,o){if(o=Ue(o||"false"),e=He(e),t=He(t),e instanceof Error)return e;if(t instanceof Error)return t;if(o instanceof Error)return o;const p=e.getMonth();let M,H,z=t.getMonth();if(o)M=e.getDate()===31?30:e.getDate(),H=t.getDate()===31?30:t.getDate();else{const oe=new Date(e.getFullYear(),p+1,0).getDate(),de=new Date(t.getFullYear(),z+1,0).getDate();M=e.getDate()===oe?30:e.getDate(),t.getDate()===de?M<30?(z++,H=1):H=30:H=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(z-p)+(H-M)}function tn(e){if((e=He(e))instanceof Error)return e;(e=Bt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Pt(e,t,o){return Pt.INTL(e,t,1,o)}function _t(e,t,o){return _t.INTL(e,t,1,o)}function Ut(e){return new Date(e,1,29).getMonth()===1}function Vt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function zt(e,t,o){if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;o=o||0;let p=e.getDate();const M=e.getMonth()+1,H=e.getFullYear();let z=t.getDate();const oe=t.getMonth()+1,de=t.getFullYear();switch(o){case 0:return p===31&&z===31?(p=30,z=30):p===31?p=30:p===30&&z===31&&(z=30),(z+30*oe+360*de-(p+30*M+360*H))/360;case 1:{const Ce=(We,Ze)=>{const rt=We.getFullYear(),jt=new Date(rt,2,1);if(Ut(rt)&&We<jt&&Ze>=jt)return!0;const ct=Ze.getFullYear(),Ct=new Date(ct,2,1);return Ut(ct)&&Ze>=Ct&&We<Ct};let ke=365;if(H===de||H+1===de&&(M>oe||M===oe&&p>=z))return(H===de&&Ut(H)||Ce(e,t)||oe===1&&z===29)&&(ke=366),Vt(e,t)/ke;const Pe=de-H+1,Re=(new Date(de+1,0,1)-new Date(H,0,1))/1e3/60/60/24/Pe;return Vt(e,t)/Re}case 2:return Vt(e,t)/360;case 3:return Vt(e,t)/365;case 4:return(z+30*oe+360*de-(p+30*M+360*H))/360}}function nn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-fn)/864e5)+t}function rn(e){return(e=Y(e))===0?s:e instanceof Error?e:String.fromCharCode(e)}function on(e){if(ie(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=s),t}function sn(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;let o=0;for(;(o=e.indexOf(!0))>-1;)e[o]="TRUE";let p=0;for(;(p=e.indexOf(!1))>-1;)e[p]="FALSE";return e.join("")}Pt.INTL=(e,t,o,p)=>{if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;let M=!1;const H=[],z=[1,2,3,4,5,6,0],oe=new RegExp("^[0|1]{7}$");if(o===void 0)o=Ht[1];else if(typeof o=="string"&&oe.test(o)){M=!0,o=o.split("");for(let Pe=0;Pe<o.length;Pe++)o[Pe]==="1"&&H.push(z[Pe])}else o=Ht[o];if(!(o instanceof Array))return s;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let Pe=0;Pe<p.length;Pe++){const Re=He(p[Pe]);if(Re instanceof Error)return Re;p[Pe]=Re}const de=Math.round((t-e)/864e5)+1;let Ce=de;const ke=e;for(let Pe=0;Pe<de;Pe++){const Re=new Date().getTimezoneOffset()>0?ke.getUTCDay():ke.getDay();let We=M?H.includes(Re):Re===o[0]||Re===o[1];for(let Ze=0;Ze<p.length;Ze++){const rt=p[Ze];if(rt.getDate()===ke.getDate()&&rt.getMonth()===ke.getMonth()&&rt.getFullYear()===ke.getFullYear()){We=!0;break}}We&&Ce--,ke.setDate(ke.getDate()+1)}return Ce},_t.INTL=(e,t,o,p)=>{if((e=He(e))instanceof Error)return e;if((t=Y(t))instanceof Error)return t;if(t<0)return h;if(!((o=o===void 0?Ht[1]:Ht[o])instanceof Array))return s;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let H=0;H<p.length;H++){const z=He(p[H]);if(z instanceof Error)return z;p[H]=z}let M=0;for(;M<t;){e.setDate(e.getDate()+1);const H=e.getDay();if(H!==o[0]&&H!==o[1]){for(let z=0;z<p.length;z++){const oe=p[z];if(oe.getDate()===e.getDate()&&oe.getMonth()===e.getMonth()&&oe.getFullYear()===e.getFullYear()){M--;break}}M++}}return e};const gn=sn;function an(e,t=2,o=!1){if(e=Y(e),isNaN(e)||(t=Y(t),isNaN(t)))return s;if(t<0){const p=Math.pow(10,-t);e=Math.round(e/p)*p}else e=e.toFixed(t);if(o)e=e.toString().replace(/,/g,"");else{const p=e.toString().split(".");p[0]=p[0].replace(/\B(?=(\d{3})+$)/g,","),e=p.join(".")}return e}function vt(e,t){return je(e,t)||(e=Ve(e),(t=Y(t))instanceof Error?t:new Array(t+1).join(e))}const bn=rn,mn=on;function Wt(e){return/^[01]{1,10}$/.test(e)}function pt(e,t,o){if(ie(e=Y(e),t=Y(t)))return e;if((o=o===void 0?"i":o)!=="i"&&o!=="j")return s;if(e===0&&t===0)return 0;if(e===0)return t===1?o:t.toString()+o;if(t===0)return e.toString();{const p=t>0?"+":"";return e.toString()+p+(t===1?o:t.toString()+o)}}function Xt(e,t){return t=t===void 0?0:t,ie(e=Y(e),t=Y(t))?s:d.erf(e)}function Gt(e){return isNaN(e)?s:d.erfc(e)}function $t(e){const t=at(e),o=st(e);return ie(t,o)?s:Math.sqrt(Math.pow(t,2)+Math.pow(o,2))}function st(e){if(e===void 0||e===!0||e===!1)return s;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),o=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),o===0&&(o=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),M=p==="i"||p==="j";return t>=0||o>=0?M?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?h:-Number(e.substring(o+1,e.length-1)):h:M?isNaN(e.substring(0,e.length-1))?h:e.substring(0,e.length-1):isNaN(e)?h:0}function Kt(e){const t=at(e),o=st(e);return ie(t,o)?s:t===0&&o===0?g:t===0&&o>0?Math.PI/2:t===0&&o<0?-Math.PI/2:o===0&&t>0?0:o===0&&t<0?-Math.PI:t>0?Math.atan(o/t):t<0&&o>=0?Math.atan(o/t)+Math.PI:Math.atan(o/t)-Math.PI}function qt(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(t)*(Math.exp(o)+Math.exp(-o))/2,-Math.sin(t)*(Math.exp(o)-Math.exp(-o))/2,p)}function ln(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(o)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(o)*(Math.exp(t)-Math.exp(-t))/2,p)}function Mt(e,t){const o=at(e),p=st(e),M=at(t),H=st(t);if(ie(o,p,M,H))return s;const z=e.substring(e.length-1),oe=t.substring(t.length-1);let de="i";if((z==="j"||oe==="j")&&(de="j"),M===0&&H===0)return h;const Ce=M*M+H*H;return pt((o*M+p*H)/Ce,(p*M-o*H)/Ce,de)}function at(e){if(e===void 0||e===!0||e===!1)return s;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),o=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),o===0&&(o=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),M=p==="i"||p==="j";return t>=0||o>=0?M?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(0,t)):isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?h:Number(e.substring(0,o)):h:M?isNaN(e.substring(0,e.length-1))?h:0:isNaN(e)?h:e}function Yt(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.sin(t)*(Math.exp(o)+Math.exp(-o))/2,Math.cos(t)*(Math.exp(o)-Math.exp(-o))/2,p)}function un(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(o)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(o)*(Math.exp(t)+Math.exp(-t))/2,p)}Xt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Gt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const jn=a.DIST,vn=a.INV,yn=r.DIST,xn=Oe.MATH,wn=Oe.PRECISE,Cn=B.DIST,En=B.DIST.RT,An=B.INV,Ln=B.INV.RT,Mn=B.TEST,Nn=V.P,Tn=V.P,In=V.S,Dn=r.INV,Sn=Gt.PRECISE,Fn=Xt.PRECISE,On=G.DIST,kn=ne.DIST,Rn=ne.DIST.RT,Hn=ne.INV,Bn=ne.INV.RT,Pn=ft.MATH,_n=ft.PRECISE,Vn=ne.TEST,qn=ce.DIST,Yn=ce.INV,Un=fe.PRECISE,zn=Ee.DIST,Wn=qe.INV,Xn=qe.DIST,Gn=qe.INV,$n=we.MULT,Kn=we.SNGL,Jn=U.DIST,Zn=Pt.INTL,Qn=J.DIST,er=J.INV,tr=J.S.DIST,nr=J.S.INV,rr=D.EXC,or=D.INC,ir=X.EXC,sr=X.INC,ar=ue.DIST,lr=K.EXC,ur=K.INC,cr=le.AVG,dr=le.EQ,fr=be.P,pr=ve.P,hr=ve.S,gr=Ie.DIST,br=Ie.DIST.RT,mr=Ie.INV,jr=Ie.TEST,vr=Fe.P,yr=Fe.S,xr=ye.DIST,wr=_t.INTL,Cr=xe.TEST;function Jt(e){const t=[];return N(e,o=>{o&&t.push(o)}),t}function yt(e,t){const o={};for(let H=1;H<e[0].length;++H)o[H]=!0;let p=t[0].length;for(let H=1;H<t.length;++H)t[H].length>p&&(p=t[H].length);for(let H=1;H<e.length;++H)for(let z=1;z<e[H].length;++z){let oe=!1,de=!1;for(let Ce=0;Ce<t.length;++Ce){const ke=t[Ce];if(ke.length<p)continue;const Pe=ke[0];if(e[H][0]===Pe){de=!0;for(let Re=1;Re<ke.length;++Re)if(!oe)if(ke[Re]===void 0||ke[Re]==="*")oe=!0;else{const We=mt(ke[Re]+""),Ze=[dt(e[H][z],it)].concat(We);oe=ht(Ze)}}}de&&(o[z]=o[z]&&oe)}const M=[];for(let H=0;H<e[0].length;++H)o[H]&&M.push(H-1);return M}function Zt(e){return e&&e.getTime&&!isNaN(e.getTime())}function Qt(e){return e instanceof Date?e:new Date(e)}function Nt(e,t,o,p,M){if(p=p||0,M=M||0,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M)))return s;let H;if(e===0)H=p+o*t;else{const z=Math.pow(1+e,t);H=M===1?p*z+o*(1+e)*(z-1)/e:p*z+o*(z-1)/e}return-H}function cn(e,t,o,p,M,H){if(M=M||0,H=H||0,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M),H=Y(H)))return s;const z=Dt(e,o,p,M,H);return(t===1?H===1?0:-p:H===1?Nt(e,t-2,z,p,1)-z:Nt(e,t-1,z,p,0))*e}function en(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=e[0];let o=0;for(let p=1;p<e.length;p++)o+=e[p]/Math.pow(1+t,p);return o}function Dt(e,t,o,p,M){if(p=p||0,M=M||0,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M)))return s;let H;if(e===0)H=(o+p)/t;else{const z=Math.pow(1+e,t);H=M===1?(p*e/(z-1)+o*e/(1-1/z))/(1+e):p*e/(z-1)+o*e/(1-1/z)}return-H}const Er={errors:_,symbols:dn};b.ABS=function(e){return(e=Y(e))instanceof Error?e:Math.abs(e)},b.ACCRINT=function(e,t,o,p,M,H,z){return e=Qt(e),t=Qt(t),o=Qt(o),Zt(e)&&Zt(t)&&Zt(o)?p<=0||M<=0||[1,2,4].indexOf(H)===-1||[0,1,2,3,4].indexOf(z)===-1||o<=e?h:(M=M||0)*p*zt(e,o,z=z||0):s},b.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},b.ACOS=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=h),t},b.ACOSH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=h),t},b.ACOT=function(e){return(e=Y(e))instanceof Error?e:Math.atan(1/e)},b.ACOTH=function(e){if((e=Y(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=h),t},b.AGGREGATE=function(e,t,o,p){if(ie(e=Y(e),Y(e)))return s;switch(e){case 1:return w(o);case 2:return ee(o);case 3:return S(o);case 4:return $e(o);case 5:return pe(o);case 6:return Xe(o);case 7:return ve.S(o);case 8:return ve.P(o);case 9:return At(o);case 10:return Fe.S(o);case 11:return Fe.P(o);case 12:return Q(o);case 13:return we.SNGL(o);case 14:return De(o,p);case 15:return Me(o,p);case 16:return D.INC(o,p);case 17:return K.INC(o,p);case 18:return D.EXC(o,p);case 19:return K.EXC(o,p)}},b.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},b.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},b.AND=function(){const e=q(arguments);let t=s;for(let o=0;o<e.length;o++){if(e[o]instanceof Error)return e[o];e[o]!==void 0&&e[o]!==null&&typeof e[o]!="string"&&(t===s&&(t=!0),e[o]||(t=!1))}return t},b.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return s;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,o=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[o]}),t},b.ASC=function(){throw new Error("ASC is not implemented")},b.ASIN=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=h),t},b.ASINH=function(e){return(e=Y(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},b.ATAN=function(e){return(e=Y(e))instanceof Error?e:Math.atan(e)},b.ATAN2=function(e,t){return je(e=Y(e),t=Y(t))||Math.atan2(e,t)},b.ATANH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=h),t},b.AVEDEV=function(){const e=q(arguments).filter(tt);if(e.length===0)return h;const t=Ne(e);return t instanceof Error?t:d.sum(d(t).subtract(d.mean(t)).abs()[0])/t.length},b.AVERAGE=w,b.AVERAGEA=E,b.AVERAGEIF=function(e,t,o){if(arguments.length<=1)return C;if(o=Ne(q(o=o||e).filter(tt)),e=q(e),o instanceof Error)return o;let p=0,M=0;const H=t===void 0||t==="*",z=H?null:mt(t+"");for(let oe=0;oe<e.length;oe++){const de=e[oe];if(H)M+=o[oe],p++;else{const Ce=[dt(de,it)].concat(z);ht(Ce)&&(M+=o[oe],p++)}}return M/p},b.AVERAGEIFS=function(){const e=O(arguments),t=(e.length-1)/2,o=q(e[0]);let p=0,M=0;for(let z=0;z<o.length;z++){let oe=!1;for(let de=0;de<t;de++){const Ce=e[2*de+1][z],ke=e[2*de+2];let Pe=!1;if(ke===void 0||ke==="*")Pe=!0;else{const Re=mt(ke+""),We=[dt(Ce,it)].concat(Re);Pe=ht(We)}if(!Pe){oe=!1;break}oe=!0}oe&&(M+=o[z],p++)}const H=M/p;return isNaN(H)?0:H},b.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},b.BASE=function(e,t,o){const p=je(e=Y(e),t=Y(t),o=Y(o));if(p)return p;if(t===0)return h;const M=e.toString(t);return new Array(Math.max(o+1-M.length,0)).join("0")+M},b.BESSELI=function(e,t){return ie(e=Y(e),t=Y(t))?s:k.besseli(e,t)},b.BESSELJ=function(e,t){return ie(e=Y(e),t=Y(t))?s:k.besselj(e,t)},b.BESSELK=function(e,t){return ie(e=Y(e),t=Y(t))?s:k.besselk(e,t)},b.BESSELY=function(e,t){return ie(e=Y(e),t=Y(t))?s:k.bessely(e,t)},b.BETA=a,b.BETADIST=jn,b.BETAINV=vn,b.BIN2DEC=function(e){if(!Wt(e))return h;const t=parseInt(e,2),o=e.toString();return o.length===10&&o.substring(0,1)==="1"?parseInt(o.substring(1),2)-512:t},b.BIN2HEX=function(e,t){if(!Wt(e))return h;const o=e.toString();if(o.length===10&&o.substring(0,1)==="1")return(0xfffffffe00+parseInt(o.substring(1),2)).toString(16);const p=parseInt(e,2).toString(16);return t===void 0?p:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},b.BIN2OCT=function(e,t){if(!Wt(e))return h;const o=e.toString();if(o.length===10&&o.substring(0,1)==="1")return(1073741312+parseInt(o.substring(1),2)).toString(8);const p=parseInt(e,2).toString(8);return t===void 0?p:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},b.BINOM=r,b.BINOMDIST=yn,b.BITAND=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e&t},b.BITLSHIFT=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e<<t:e>>-t},b.BITOR=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e|t},b.BITRSHIFT=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e>>t:e<<-t},b.BITXOR=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e^t},b.CEILING=Oe,b.CEILINGMATH=xn,b.CEILINGPRECISE=wn,b.CELL=function(){throw new Error("CELL is not implemented")},b.CHAR=rn,b.CHIDIST=Cn,b.CHIDISTRT=En,b.CHIINV=An,b.CHIINVRT=Ln,b.CHISQ=B,b.CHITEST=Mn,b.CHOOSE=function(){if(arguments.length<2)return C;const e=arguments[0];return e<1||e>254||arguments.length<e+1?s:arguments[e]},b.CLEAN=function(e){return ie(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},b.CODE=on,b.COLUMN=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?d.col(e,t):void 0:s},b.COLUMNS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:d.cols(e):s},b.COMBIN=Ge,b.COMBINA=function(e,t){return je(e=Y(e),t=Y(t))||(e<t?h:e===0&&t===0?1:Ge(e+t-1,e-1))},b.COMPLEX=pt,b.CONCAT=gn,b.CONCATENATE=sn,b.CONFIDENCE=te,b.CONVERT=function(e,t,o){if((e=Y(e))instanceof Error)return e;const p=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],M={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},H={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let z,oe=null,de=null,Ce=t,ke=o,Pe=1,Re=1;for(let We=0;We<p.length;We++)z=p[We][2]===null?[]:p[We][2],(p[We][1]===Ce||z.indexOf(Ce)>=0)&&(oe=p[We]),(p[We][1]===ke||z.indexOf(ke)>=0)&&(de=p[We]);if(oe===null){const We=M[t.substring(0,2)];let Ze=H[t.substring(0,1)];t.substring(0,2)==="da"&&(Ze=["dekao",10,"da"]),We?(Pe=We[2],Ce=t.substring(2)):Ze&&(Pe=Ze[1],Ce=t.substring(Ze[2].length));for(let rt=0;rt<p.length;rt++)z=p[rt][2]===null?[]:p[rt][2],(p[rt][1]===Ce||z.indexOf(Ce)>=0)&&(oe=p[rt])}if(de===null){const We=M[o.substring(0,2)];let Ze=H[o.substring(0,1)];o.substring(0,2)==="da"&&(Ze=["dekao",10,"da"]),We?(Re=We[2],ke=o.substring(2)):Ze&&(Re=Ze[1],ke=o.substring(Ze[2].length));for(let rt=0;rt<p.length;rt++)z=p[rt][2]===null?[]:p[rt][2],(p[rt][1]===ke||z.indexOf(ke)>=0)&&(de=p[rt])}return oe===null||de===null||oe[3]!==de[3]?C:e*oe[6]*Pe/(de[6]*Re)},b.CORREL=function(e,t){return ie(e=Ne(q(e)),t=Ne(q(t)))?s:d.corrcoeff(e,t)},b.COS=function(e){return(e=Y(e))instanceof Error?e:Math.cos(e)},b.COSH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},b.COT=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.tan(e)},b.COTH=function(e){if((e=Y(e))instanceof Error)return e;if(e===0)return g;const t=Math.exp(2*e);return(t+1)/(t-1)},b.COUNT=ee,b.COUNTA=S,b.COUNTBLANK=A,b.COUNTIF=function(e,t){if(e=q(e),t===void 0||t==="*")return e.length;let o=0;const p=mt(t+"");for(let M=0;M<e.length;M++){const H=[dt(e[M],it)].concat(p);ht(H)&&o++}return o},b.COUNTIFS=function(){const e=O(arguments),t=new Array(q(e[0]).length);for(let p=0;p<t.length;p++)t[p]=!0;for(let p=0;p<e.length;p+=2){const M=q(e[p]),H=e[p+1];if(H!==void 0&&H!=="*"){const z=mt(H+"");for(let oe=0;oe<M.length;oe++){const de=[dt(M[oe],it)].concat(z);t[oe]=t[oe]&&ht(de)}}}let o=0;for(let p=0;p<t.length;p++)t[p]&&o++;return o},b.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},b.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},b.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},b.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},b.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},b.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},b.COVAR=Nn,b.COVARIANCE=V,b.COVARIANCEP=Tn,b.COVARIANCES=In,b.CRITBINOM=Dn,b.CSC=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.sin(e)},b.CSCH=function(e){return(e=Y(e))instanceof Error?e:e===0?g:2/(Math.exp(e)-Math.exp(-e))},b.CUMIPMT=function(e,t,o,p,M,H){if(ie(e=Y(e),t=Y(t),o=Y(o)))return s;if(e<=0||t<=0||o<=0||p<1||M<1||p>M||H!==0&&H!==1)return h;const z=Dt(e,t,o,0,H);let oe=0;p===1&&(H===0&&(oe=-o),p++);for(let de=p;de<=M;de++)oe+=H===1?Nt(e,de-2,z,o,1)-z:Nt(e,de-1,z,o,0);return oe*=e,oe},b.CUMPRINC=function(e,t,o,p,M,H){if(ie(e=Y(e),t=Y(t),o=Y(o)))return s;if(e<=0||t<=0||o<=0||p<1||M<1||p>M||H!==0&&H!==1)return h;const z=Dt(e,t,o,0,H);let oe=0;p===1&&(oe=H===0?z+o*e:z,p++);for(let de=p;de<=M;de++)oe+=H>0?z-(Nt(e,de-2,z,o,1)-z)*e:z-Nt(e,de-1,z,o,0)*e;return oe},b.DATE=function(e,t,o){let p;return ie(e=Y(e),t=Y(t),o=Y(o))?p=s:(p=new Date(e,t-1,o),p.getFullYear()<0&&(p=h)),p},b.DATEDIF=It,b.DATEVALUE=function(e){if(typeof e!="string")return s;const t=Date.parse(e);return isNaN(t)?s:new Date(e)},b.DAVERAGE=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);let H=0;return N(p,z=>{H+=M[z]}),p.length===0?g:H/p.length},b.DAY=function(e){const t=He(e);return t instanceof Error?t:t.getDate()},b.DAYS=Lt,b.DAYS360=wt,b.DB=function(e,t,o,p,M){if(M=M===void 0?12:M,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M)))return s;if(e<0||t<0||o<0||p<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(M)===-1||p>o)return h;if(t>=e)return 0;const H=(1-Math.pow(t/e,1/o)).toFixed(3),z=e*H*M/12;let oe=z,de=0;const Ce=p===o?o-1:p;for(let ke=2;ke<=Ce;ke++)de=(e-oe)*H,oe+=de;return p===1?z:p===o?(e-oe)*H:de},b.DBCS=function(){throw new Error("DBCS is not implemented")},b.DCOUNT=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);const H=[];return N(p,z=>{H.push(M[z])}),ee(H)},b.DCOUNTA=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);const H=[];return N(p,z=>{H.push(M[z])}),S(H)},b.DDB=function(e,t,o,p,M){if(M=M===void 0?2:M,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M)))return s;if(e<0||t<0||o<0||p<0||M<=0||p>o)return h;if(t>=e)return 0;let H=0,z=0;for(let oe=1;oe<=p;oe++)z=Math.min(M/o*(e-H),e-t-H),H+=z;return z},b.DEC2BIN=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return h;if(e<0)return"1"+vt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const o=parseInt(e,10).toString(2);return t===void 0?o:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:h},b.DEC2HEX=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return h;if(e<0)return(1099511627776+e).toString(16);const o=parseInt(e,10).toString(16);return t===void 0?o:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:h},b.DEC2OCT=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return h;if(e<0)return(1073741824+e).toString(8);const o=parseInt(e,10).toString(8);return t===void 0?o:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:h},b.DECIMAL=function(e,t){return arguments.length<1?s:je(e=Y(e),t=Y(t))||(t===0?h:parseInt(e,t))},b.DEGREES=function(e){return(e=Y(e))instanceof Error?e:180*e/Math.PI},b.DELTA=function(e,t){return t=t===void 0?0:t,ie(e=Y(e),t=Y(t))?s:e===t?1:0},b.DEVSQ=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=d.mean(e);let o=0;for(let p=0;p<e.length;p++)o+=Math.pow(e[p]-t,2);return o},b.DGET=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];return M=ae(typeof t=="string"?e[Le(e,t)]:e[t]),p.length===0?s:p.length>1?h:M[p[0]]},b.DISC=function(e,t,o,p,M){if(ie(e=He(e),t=He(t),o=Y(o),p=Y(p),M=(M=Y(M))||0))return s;if(o<=0||p<=0)return h;if(e>=t)return s;let H,z;switch(M){case 0:H=360,z=wt(e,t,!1);break;case 1:case 3:H=365,z=It(e,t,"D");break;case 2:H=360,z=It(e,t,"D");break;case 4:H=360,z=wt(e,t,!0);break;default:return h}return(p-o)/p*H/z},b.DMAX=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);let H=M[p[0]];return N(p,z=>{H<M[z]&&(H=M[z])}),H},b.DMIN=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);let H=M[p[0]];return N(p,z=>{H>M[z]&&(H=M[z])}),H},b.DOLLAR=function(e,t=2){if(e=Y(e),isNaN(e))return s;const o={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},p=(e=xt(e,t)).toLocaleString("en-US",o);return e<0?"$("+p.slice(2)+")":p},b.DOLLARDE=function(e,t){if(ie(e=Y(e),t=Y(t)))return s;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let o=parseInt(e,10);o+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const p=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return o=Math.round(o*p)/p,o},b.DOLLARFR=function(e,t){if(ie(e=Y(e),t=Y(t)))return s;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let o=parseInt(e,10);return o+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,o},b.DPRODUCT=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const oe=Le(e,t);M=ae(e[oe])}else M=ae(e[t]);let H=[];N(p,oe=>{H.push(M[oe])}),H=Jt(H);let z=1;return N(H,oe=>{z*=oe}),z},b.DSTDEV=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);let H=[];return N(p,z=>{H.push(M[z])}),H=Jt(H),ve.S(H)},b.DSTDEVP=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);let H=[];return N(p,z=>{H.push(M[z])}),H=Jt(H),ve.P(H)},b.DSUM=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);const H=[];return N(p,z=>{H.push(M[z])}),At(H)},b.DURATION=function(){throw new Error("DURATION is not implemented")},b.DVAR=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);const H=[];return N(p,z=>{H.push(M[z])}),Fe.S(H)},b.DVARP=function(e,t,o){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,o);let M=[];if(typeof t=="string"){const z=Le(e,t);M=ae(e[z])}else M=ae(e[t]);const H=[];return N(p,z=>{H.push(M[z])}),Fe.P(H)},b.EDATE=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?s:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},b.EFFECT=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<=0||t<1?h:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},b.EOMONTH=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?s:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},b.ERF=Xt,b.ERFC=Gt,b.ERFCPRECISE=Sn,b.ERFPRECISE=Fn,b.ERROR=St,b.EVEN=function(e){return(e=Y(e))instanceof Error?e:Oe(e,-2,-1)},b.EXACT=function(e,t){return arguments.length!==2?C:je(e,t)||(e=Ve(e))===Ve(t)},b.EXP=function(e){return arguments.length<1?C:arguments.length>1?T:(e=Y(e))instanceof Error?e:e=Math.exp(e)},b.EXPON=G,b.EXPONDIST=On,b.F=ne,b.FACT=ot,b.FACTDOUBLE=function e(t){if((t=Y(t))instanceof Error)return t;const o=Math.floor(t);return o<=0?1:o*e(o-2)},b.FALSE=function(){return!1},b.FDIST=kn,b.FDISTRT=Rn,b.FIND=function(e,t,o){if(arguments.length<2)return C;e=Ve(e),o=o===void 0?0:o;const p=(t=Ve(t)).indexOf(e,o-1);return p===-1?s:p+1},b.FINV=Hn,b.FINVRT=Bn,b.FISHER=function(e){return(e=Y(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},b.FISHERINV=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},b.FIXED=an,b.FLOOR=ft,b.FLOORMATH=Pn,b.FLOORPRECISE=_n,b.FORECAST=he,b.FREQUENCY=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const o=e.length,p=t.length,M=[];for(let H=0;H<=p;H++){M[H]=0;for(let z=0;z<o;z++)H===0?e[z]<=t[0]&&(M[0]+=1):H<p?e[z]>t[H-1]&&e[z]<=t[H]&&(M[H]+=1):H===p&&e[z]>t[p-1]&&(M[p]+=1)}return M},b.FTEST=Vn,b.FV=Nt,b.FVSCHEDULE=function(e,t){if(ie(e=Y(e),t=Ne(q(t))))return s;const o=t.length;let p=e;for(let M=0;M<o;M++)p*=1+t[M];return p},b.GAMMA=ce,b.GAMMADIST=qn,b.GAMMAINV=Yn,b.GAMMALN=fe,b.GAMMALNPRECISE=Un,b.GAUSS=function(e){return(e=Y(e))instanceof Error?e:d.normal.cdf(e,0,1)-.5},b.GCD=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=e.length,o=e[0];let p=o<0?-o:o;for(let M=1;M<t;M++){const H=e[M];let z=H<0?-H:H;for(;p&&z;)p>z?p%=z:z%=p;p+=z}return p},b.GEOMEAN=function(){const e=Ne(q(arguments));return e instanceof Error?e:d.geomean(e)},b.GESTEP=function(e,t){return ie(t=t||0,e=Y(e))?e:e>=t?1:0},b.GROWTH=function(e,t,o,p){if((e=Ne(e))instanceof Error)return e;let M;if(t===void 0)for(t=[],M=1;M<=e.length;M++)t.push(M);if(o===void 0)for(o=[],M=1;M<=e.length;M++)o.push(M);if(ie(t=Ne(t),o=Ne(o)))return s;p===void 0&&(p=!0);const H=e.length;let z,oe,de=0,Ce=0,ke=0,Pe=0;for(M=0;M<H;M++){const We=t[M],Ze=Math.log(e[M]);de+=We,Ce+=Ze,ke+=We*Ze,Pe+=We*We}de/=H,Ce/=H,ke/=H,Pe/=H,p?(z=(ke-de*Ce)/(Pe-de*de),oe=Ce-z*de):(z=ke/Pe,oe=0);const Re=[];for(M=0;M<o.length;M++)Re.push(Math.exp(oe+z*o[M]));return Re},b.HARMEAN=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=e.length;let o=0;for(let p=0;p<t;p++)o+=1/e[p];return t/o},b.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const o=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),p=o?parseInt(e,16)-1099511627776:parseInt(e,16);if(p<-512||p>511)return h;if(o)return"1"+vt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const M=p.toString(2);return t===void 0?M:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=M.length?vt("0",t-M.length)+M:h},b.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},b.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const o=parseInt(e,16);if(o>536870911&&o<0xffe0000000)return h;if(o>=0xffe0000000)return(o-0xffc0000000).toString(8);const p=o.toString(8);return t===void 0?p:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},b.HLOOKUP=function(e,t,o,p){return Rt(e,me(t),o,p)},b.HOUR=function(e){return(e=He(e))instanceof Error?e:e.getHours()},b.HYPGEOM=Ee,b.HYPGEOMDIST=zn,b.IF=function(e,t,o){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(o=arguments.length===3&&o)==null&&(o=0),e?t:o)},b.IFERROR=function(e,t){return Et(e)?t:e},b.IFNA=function(e,t){return e===C?t:e},b.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return C},b.IMABS=$t,b.IMAGINARY=st,b.IMARGUMENT=Kt,b.IMCONJUGATE=function(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",o!==0?pt(t,-o,p):e},b.IMCOS=qt,b.IMCOSH=ln,b.IMCOT=function(e){return ie(at(e),st(e))?s:Mt(qt(e),Yt(e))},b.IMCSC=function(e){return e===!0||e===!1?s:ie(at(e),st(e))?h:Mt("1",Yt(e))},b.IMCSCH=function(e){return e===!0||e===!1?s:ie(at(e),st(e))?h:Mt("1",un(e))},b.IMDIV=Mt,b.IMEXP=function(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);p=p==="i"||p==="j"?p:"i";const M=Math.exp(t);return pt(M*Math.cos(o),M*Math.sin(o),p)},b.IMLN=function(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+o*o)),Math.atan(o/t),p)},b.IMLOG10=function(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+o*o))/Math.log(10),Math.atan(o/t)/Math.log(10),p)},b.IMLOG2=function(e){const t=at(e),o=st(e);if(ie(t,o))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+o*o))/Math.log(2),Math.atan(o/t)/Math.log(2),p)},b.IMPOWER=function(e,t){if(ie(t=Y(t),at(e),st(e)))return s;let o=e.substring(e.length-1);o=o==="i"||o==="j"?o:"i";const p=Math.pow($t(e),t),M=Kt(e);return pt(p*Math.cos(t*M),p*Math.sin(t*M),o)},b.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return s;for(let t=1;t<arguments.length;t++){const o=at(e),p=st(e),M=at(arguments[t]),H=st(arguments[t]);if(ie(o,p,M,H))return s;e=pt(o*M-p*H,o*H+p*M)}return e},b.IMREAL=at,b.IMSEC=function(e){return e===!0||e===!1||ie(at(e),st(e))?s:Mt("1",qt(e))},b.IMSECH=function(e){return ie(at(e),st(e))?s:Mt("1",ln(e))},b.IMSIN=Yt,b.IMSINH=un,b.IMSQRT=function(e){if(ie(at(e),st(e)))return s;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const o=Math.sqrt($t(e)),p=Kt(e);return pt(o*Math.cos(p/2),o*Math.sin(p/2),t)},b.IMSUB=function(e,t){const o=at(e),p=st(e),M=at(t),H=st(t);if(ie(o,p,M,H))return s;const z=e.substring(e.length-1),oe=t.substring(t.length-1);let de="i";return(z==="j"||oe==="j")&&(de="j"),pt(o-M,p-H,de)},b.IMSUM=function(){if(!arguments.length)return s;const e=q(arguments);let t=e[0];for(let o=1;o<e.length;o++){const p=at(t),M=st(t),H=at(e[o]),z=st(e[o]);if(ie(p,M,H,z))return s;t=pt(p+H,M+z)}return t},b.IMTAN=function(e){return e===!0||e===!1||ie(at(e),st(e))?s:Mt(Yt(e),qt(e))},b.INDEX=function(e,t,o){const p=je(e,t,o);if(p)return p;if(!Array.isArray(e))return s;const M=e.length>0&&!Array.isArray(e[0]);return M&&!o?(o=t,t=1):(o=o||1,t=t||1),o<0||t<0?s:M&&t===1&&o<=e.length?e[o-1]:t<=e.length&&o<=e[t-1].length?e[t-1][o-1]:m},b.INFO=function(){throw new Error("INFO is not implemented")},b.INT=function(e){return(e=Y(e))instanceof Error?e:Math.floor(e)},b.INTERCEPT=function(e,t){return ie(e=Ne(e),t=Ne(t))?s:e.length!==t.length?C:he(0,e,t)},b.INTRATE=function(){throw new Error("INTRATE is not implemented")},b.IPMT=cn,b.IRR=function(e,t){if(t=t||0,ie(e=Ne(q(e)),t=Y(t)))return s;const o=(Re,We,Ze)=>{const rt=Ze+1;let jt=Re[0];for(let ct=1;ct<Re.length;ct++)jt+=Re[ct]/Math.pow(rt,(We[ct]-We[0])/365);return jt},p=(Re,We,Ze)=>{const rt=Ze+1;let jt=0;for(let ct=1;ct<Re.length;ct++){const Ct=(We[ct]-We[0])/365;jt-=Ct*Re[ct]/Math.pow(rt,Ct+1)}return jt},M=[];let H=!1,z=!1;for(let Re=0;Re<e.length;Re++)M[Re]=Re===0?0:M[Re-1]+365,e[Re]>0&&(H=!0),e[Re]<0&&(z=!0);if(!H||!z)return h;let oe,de,Ce,ke=t=t===void 0?.1:t,Pe=!0;do Ce=o(e,M,ke),oe=ke-Ce/p(e,M,ke),de=Math.abs(oe-ke),ke=oe,Pe=de>1e-10&&Math.abs(Ce)>1e-10;while(Pe);return ke},b.ISBLANK=function(e){return e===null},b.ISERR=Ft,b.ISERROR=Et,b.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},b.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},b.ISLOGICAL=Ot,b.ISNA=function(e){return e===C},b.ISNONTEXT=function(e){return typeof e!="string"},b.ISNUMBER=Tt,b.ISO=nt,b.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},b.ISOWEEKNUM=tn,b.ISPMT=function(e,t,o,p){return ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p))?s:p*e*(t/o-1)},b.ISREF=function(){throw new Error("ISREF is not implemented")},b.ISTEXT=gt,b.KURT=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=d.mean(e),o=e.length;let p=0;for(let M=0;M<o;M++)p+=Math.pow(e[M]-t,4);return p/=Math.pow(d.stdev(e,!0),4),o*(o+1)/((o-1)*(o-2)*(o-3))*p-3*(o-1)*(o-1)/((o-2)*(o-3))},b.LARGE=De,b.LCM=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;for(var t,o,p,M,H=1;(p=e.pop())!==void 0;){if(p===0)return 0;for(;p>1;){if(p%2){for(t=3,o=Math.floor(Math.sqrt(p));t<=o&&p%t;t+=2);M=t<=o?t:p}else M=2;for(p/=M,H*=M,t=e.length;t;e[--t]%M==0&&(e[t]/=M)==1&&e.splice(t,1));}}return H},b.LEFT=function(e,t){return je(e,t)||(e=Ve(e),(t=Y(t=t===void 0?1:t))instanceof Error||typeof e!="string"?s:e.substring(0,t))},b.LEN=function(e){return arguments.length===0?T:e instanceof Error?e:Array.isArray(e)?s:Ve(e).length},b.LINEST=Se,b.LN=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)},b.LOG=function(e,t){return je(e=Y(e),t=Y(t))||(e===0||t===0?h:Math.log(e)/Math.log(t))},b.LOG10=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)/Math.log(10)},b.LOGEST=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t)))||e.length!==t.length)return s;for(let p=0;p<e.length;p++)e[p]=Math.log(e[p]);const o=Se(e,t);return o[0]=Math.round(1e6*Math.exp(o[0]))/1e6,o[1]=Math.round(1e6*Math.exp(o[1]))/1e6,o},b.LOGINV=Wn,b.LOGNORM=qe,b.LOGNORMDIST=Xn,b.LOGNORMINV=Gn,b.LOOKUP=function(e,t,o){t=q(t),o=o?q(o):t;const p=typeof e=="number";let M=C;for(let H=0;H<t.length;H++){if(t[H]===e)return o[H];if(p&&t[H]<=e||typeof t[H]=="string"&&t[H].localeCompare(e)<0)M=o[H];else if(p&&t[H]>e)return M}return M},b.LOWER=function(e){return arguments.length!==1?s:ie(e=Ve(e))?e:e.toLowerCase()},b.MATCH=function(e,t,o){if(!e||!t||(arguments.length===2&&(o=1),!((t=q(t))instanceof Array))||o!==-1&&o!==0&&o!==1)return C;let p,M;for(let H=0;H<t.length;H++)if(o===1){if(t[H]===e)return H+1;t[H]<e&&(M?t[H]>M&&(p=H+1,M=t[H]):(p=H+1,M=t[H]))}else if(o===0){if(typeof e=="string"&&typeof t[H]=="string"){const z=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+z+"$").test(t[H].toLowerCase()))return H+1}else if(t[H]===e)return H+1}else if(o===-1){if(t[H]===e)return H+1;t[H]>e&&(M?t[H]<M&&(p=H+1,M=t[H]):(p=H+1,M=t[H]))}return p||C},b.MAX=$e,b.MAXA=function(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;let o=F(e);return o=o.map(p=>p??0),o.length===0?0:Math.max.apply(Math,o)},b.MDURATION=function(){throw new Error("MDURATION is not implemented")},b.MEDIAN=Q,b.MID=function(e,t,o){if(t==null)return s;if(ie(t=Y(t),o=Y(o))||typeof e!="string")return o;const p=t-1,M=p+o;return e.substring(p,M)},b.MIN=pe,b.MINA=function(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;let o=F(e);return o=o.map(p=>p??0),o.length===0?0:Math.min.apply(Math,o)},b.MINUTE=function(e){return(e=He(e))instanceof Error?e:e.getMinutes()},b.MIRR=function(e,t,o){if(ie(e=Ne(q(e)),t=Y(t),o=Y(o)))return s;const p=e.length,M=[],H=[];for(let de=0;de<p;de++)e[de]<0?M.push(e[de]):H.push(e[de]);const z=-en(o,H)*Math.pow(1+o,p-1),oe=en(t,M)*(1+t);return Math.pow(z/oe,1/(p-1))-1},b.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(o=>!o.length)||t.some(o=>!o.length)||se(e).some(o=>typeof o!="number")||se(t).some(o=>typeof o!="number")||e[0].length!==t.length?s:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((o,p)=>o.map((M,H)=>e[p].reduce((z,oe,de)=>z+oe*t[de][H],0)))},b.MOD=function(e,t){const o=je(e=Y(e),t=Y(t));if(o)return o;if(t===0)return g;let p=Math.abs(e%t);return p=e<0?t-p:p,t>0?p:-p},b.MODE=we,b.MODEMULT=$n,b.MODESNGL=Kn,b.MONTH=function(e){return(e=He(e))instanceof Error?e:e.getMonth()+1},b.MROUND=function(e,t){return je(e=Y(e),t=Y(t))||(e*t==0?0:e*t<0?h:Math.round(e/t)*t)},b.MULTINOMIAL=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;let t=0,o=1;for(let p=0;p<e.length;p++)t+=e[p],o*=ot(e[p]);return ot(t)/o},b.MUNIT=function(e){return arguments.length>1?C:!(e=parseInt(e))||e<=0?s:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,o)=>(t[o]=1,t))},b.N=function(e){return Tt(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Et(e)?e:0},b.NA=function(){return C},b.NEGBINOM=U,b.NEGBINOMDIST=Jn,b.NETWORKDAYS=Pt,b.NETWORKDAYSINTL=Zn,b.NOMINAL=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<=0||t<1?h:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},b.NORM=J,b.NORMDIST=Qn,b.NORMINV=er,b.NORMSDIST=tr,b.NORMSINV=nr,b.NOT=function(e){return typeof e=="string"?s:e instanceof Error?e:!e},b.NOW=function(){return new Date},b.NPER=function(e,t,o,p,M){if(M=M===void 0?0:M,p=p===void 0?0:p,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M)))return s;if(e===0)return-(o+p)/t;{const H=t*(1+e*M)-p*e,z=o*e+t*(1+e*M);return Math.log(H/z)/Math.log(1+e)}},b.NPV=en,b.NUMBERVALUE=function(e,t,o){return typeof(e=tt(e)?e:"")=="number"?e:typeof e!="string"?C:(t=t===void 0?".":t,o=o===void 0?",":o,Number(e.replace(t,".").replace(o,"")))},b.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const o=!(e.length!==10||e.substring(0,1)!=="7"),p=o?parseInt(e,8)-1073741824:parseInt(e,8);if(p<-512||p>511)return h;if(o)return"1"+vt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const M=p.toString(2);return t===void 0?M:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=M.length?vt("0",t-M.length)+M:h},b.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return h;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},b.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const o=parseInt(e,8);if(o>=536870912)return"ff"+(o+3221225472).toString(16);const p=o.toString(16);return t===void 0?p:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},b.ODD=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},b.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},b.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},b.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},b.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},b.OR=function(){const e=q(arguments);let t=s;for(let o=0;o<e.length;o++){if(e[o]instanceof Error)return e[o];e[o]!==void 0&&e[o]!==null&&typeof e[o]!="string"&&(t===s&&(t=!1),e[o]&&(t=!0))}return t},b.PDURATION=function(e,t,o){return ie(e=Y(e),t=Y(t),o=Y(o))?s:e<=0?h:(Math.log(o)-Math.log(t))/Math.log(1+e)},b.PEARSON=v,b.PERCENTILE=D,b.PERCENTILEEXC=rr,b.PERCENTILEINC=or,b.PERCENTRANK=X,b.PERCENTRANKEXC=ir,b.PERCENTRANKINC=sr,b.PERMUT=function(e,t){return ie(e=Y(e),t=Y(t))?s:ot(e)/ot(e-t)},b.PERMUTATIONA=function(e,t){return ie(e=Y(e),t=Y(t))?s:Math.pow(e,t)},b.PHI=function(e){return(e=Y(e))instanceof Error?s:Math.exp(-.5*e*e)/2.5066282746310002},b.PI=function(){return Math.PI},b.PMT=Dt,b.POISSON=ue,b.POISSONDIST=ar,b.POWER=lt,b.PPMT=function(e,t,o,p,M,H){return M=M||0,H=H||0,ie(e=Y(e),o=Y(o),p=Y(p),M=Y(M),H=Y(H))?s:Dt(e,o,p,M,H)-cn(e,t,o,p,M,H)},b.PRICE=function(){throw new Error("PRICE is not implemented")},b.PRICEDISC=function(e,t,o,p,M){if(ie(e=He(e),t=He(t),o=Y(o),p=Y(p),M=(M=Y(M))||0))return s;if(o<=0||p<=0)return h;if(e>=t)return s;let H,z;switch(M){case 0:H=360,z=wt(e,t,!1);break;case 1:case 3:H=365,z=It(e,t,"D");break;case 2:H=360,z=It(e,t,"D");break;case 4:H=360,z=wt(e,t,!0);break;default:return h}return p-o*p*z/H},b.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},b.PROB=function(e,t,o,p){if(o===void 0)return 0;if(p=p===void 0?o:p,ie(e=Ne(q(e)),t=Ne(q(t)),o=Y(o),p=Y(p)))return s;if(o===p)return e.indexOf(o)>=0?t[e.indexOf(o)]:0;const M=e.sort((oe,de)=>oe-de),H=M.length;let z=0;for(let oe=0;oe<H;oe++)M[oe]>=o&&M[oe]<=p&&(z+=t[e.indexOf(M[oe])]);return z},b.PRODUCT=Xe,b.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},b.PROPER=function(e){return ie(e)?e:isNaN(e)&&typeof e=="number"?s:(e=Ve(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},b.PV=function(e,t,o,p,M){return p=p||0,M=M||0,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M))?s:e===0?-o*t-p:((1-Math.pow(1+e,t))/e*o*(1+e*M)-p)/Math.pow(1+e,t)},b.QUARTILE=K,b.QUARTILEEXC=lr,b.QUARTILEINC=ur,b.QUOTIENT=function(e,t){return je(e=Y(e),t=Y(t))||parseInt(e/t,10)},b.RADIANS=function(e){return(e=Y(e))instanceof Error?e:e*Math.PI/180},b.RAND=function(){return Math.random()},b.RANDBETWEEN=function(e,t){return je(e=Y(e),t=Y(t))||e+Math.ceil((t-e+1)*Math.random())-1},b.RANK=le,b.RANKAVG=cr,b.RANKEQ=dr,b.RATE=function(e,t,o,p,M,H){if(H=H===void 0?.01:H,p=p===void 0?0:p,M=M===void 0?0:M,ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p),M=Y(M),H=Y(H)))return s;const z=1e-10;let oe=H;M=M?1:0;for(let de=0;de<20;de++){if(oe<=-1)return h;let Ce,ke,Pe;if(Math.abs(oe)<z?Ce=o*(1+e*oe)+t*(1+oe*M)*e+p:(ke=Math.pow(1+oe,e),Ce=o*ke+t*(1/oe+M)*(ke-1)+p),Math.abs(Ce)<z)return oe;if(Math.abs(oe)<z)Pe=o*e+t*M*e;else{ke=Math.pow(1+oe,e);const Re=e*Math.pow(1+oe,e-1);Pe=o*Re+t*(1/oe+M)*Re+t*(-1/(oe*oe))*(ke-1)}oe-=Ce/Pe}return oe},b.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},b.REPLACE=function(e,t,o,p){return ie(t=Y(t),o=Y(o))||typeof e!="string"||typeof p!="string"?s:e.substr(0,t-1)+p+e.substr(t-1+o)},b.REPT=vt,b.RIGHT=function(e,t){return je(e,t)||(e=Ve(e),(t=Y(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},b.ROMAN=function(e){if((e=Y(e))instanceof Error)return e;const t=String(e).split(""),o=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let p="",M=3;for(;M--;)p=(o[+t.pop()+10*M]||"")+p;return new Array(+t.join("")+1).join("M")+p},b.ROUND=xt,b.ROUNDDOWN=function(e,t){return je(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.ROUNDUP=function(e,t){return je(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.ROW=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?d.row(e,t):void 0:s},b.ROWS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:d.rows(e):s},b.RRI=function(e,t,o){return ie(e=Y(e),t=Y(t),o=Y(o))?s:e===0||t===0?h:Math.pow(o/t,1/e)-1},b.RSQ=function(e,t){return ie(e=Ne(q(e)),t=Ne(q(t)))?s:Math.pow(v(e,t),2)},b.SEARCH=function(e,t,o){let p;return typeof e!="string"||typeof t!="string"?s:(o=o===void 0?0:o,p=t.toLowerCase().indexOf(e.toLowerCase(),o-1)+1,p===0?s:p)},b.SEC=function(e){return(e=Y(e))instanceof Error?e:1/Math.cos(e)},b.SECH=function(e){return(e=Y(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},b.SECOND=function(e){return(e=He(e))instanceof Error?e:e.getSeconds()},b.SERIESSUM=function(e,t,o,p){if(ie(e=Y(e),t=Y(t),o=Y(o),p=Ne(p)))return s;let M=p[0]*Math.pow(e,t);for(let H=1;H<p.length;H++)M+=p[H]*Math.pow(e,t+H*o);return M},b.SHEET=function(){throw new Error("SHEET is not implemented")},b.SHEETS=function(){throw new Error("SHEETS is not implemented")},b.SIGN=function(e){return(e=Y(e))instanceof Error?e:e<0?-1:e===0?0:1},b.SIN=function(e){return(e=Y(e))instanceof Error?e:Math.sin(e)},b.SINH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},b.SKEW=be,b.SKEWP=fr,b.SLN=function(e,t,o){return ie(e=Y(e),t=Y(t),o=Y(o))?s:o===0?h:(e-t)/o},b.SLOPE=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const o=d.mean(t),p=d.mean(e),M=t.length;let H=0,z=0;for(let oe=0;oe<M;oe++)H+=(t[oe]-o)*(e[oe]-p),z+=Math.pow(t[oe]-o,2);return H/z},b.SMALL=Me,b.SORT=function(e,t=1,o=1,p=!1){if(!e||!Array.isArray(e))return C;if(e.length===0)return 0;if(!(t=Y(t))||t<1||(o=Y(o))!==1&&o!==-1)return s;if(typeof(p=Ue(p))!="boolean")return j;const M=oe=>oe.sort((de,Ce)=>(de=Ve(de[t-1]),Ce=Ve(Ce[t-1]),o===1?de<Ce?-1*o:o:de>Ce?o:-1*o)),H=Z(e),z=p?me(H):H;return t>=1&&t<=z[0].length?p?me(M(z)):M(z):s},b.SQRT=function(e){return(e=Y(e))instanceof Error?e:e<0?h:Math.sqrt(e)},b.SQRTPI=function(e){return(e=Y(e))instanceof Error?e:Math.sqrt(e*Math.PI)},b.STANDARDIZE=function(e,t,o){return ie(e=Y(e),t=Y(t),o=Y(o))?s:(e-t)/o},b.STDEV=ve,b.STDEVA=function(){const e=et.apply(this,arguments);return Math.sqrt(e)},b.STDEVP=pr,b.STDEVPA=function(){const e=re.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},b.STDEVS=hr,b.STEYX=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const o=d.mean(t),p=d.mean(e),M=t.length;let H=0,z=0,oe=0;for(let de=0;de<M;de++)H+=Math.pow(e[de]-p,2),z+=(t[de]-o)*(e[de]-p),oe+=Math.pow(t[de]-o,2);return Math.sqrt((H-z*z/oe)/(M-2))},b.SUBSTITUTE=function(e,t,o,p){if(arguments.length<3)return C;if(e&&t){if(p===void 0)return e.split(t).join(o);{if(p=Math.floor(Number(p)),Number.isNaN(p)||p<=0)return s;let M=0,H=0;for(;M>-1&&e.indexOf(t,M)>-1;)if(M=e.indexOf(t,M+1),H++,M>-1&&H===p)return e.substring(0,M)+o+e.substring(M+t.length);return e}}return e},b.SUBTOTAL=function(e,t){if((e=Y(e))instanceof Error)return e;switch(e){case 1:case 101:return w(t);case 2:case 102:return ee(t);case 3:case 103:return S(t);case 4:case 104:return $e(t);case 5:case 105:return pe(t);case 6:case 106:return Xe(t);case 7:case 107:return ve.S(t);case 8:case 108:return ve.P(t);case 9:case 109:return At(t);case 10:case 110:return Fe.S(t);case 11:case 111:return Fe.P(t)}},b.SUM=At,b.SUMIF=function(e,t,o){if(e=q(e),o=o?q(o):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let p=0;const M=t==="*",H=M?null:mt(t+"");for(let z=0;z<e.length;z++){const oe=e[z],de=o[z];if(M)p+=oe;else{const Ce=[dt(oe,it)].concat(H);p+=ht(Ce)?de:0}}return p},b.SUMIFS=function(){const e=O(arguments),t=Ne(q(e.shift()));if(t instanceof Error)return t;const o=e,p=o.length/2;for(let H=0;H<p;H++)o[2*H]=q(o[2*H]);let M=0;for(let H=0;H<t.length;H++){let z=!1;for(let oe=0;oe<p;oe++){const de=o[2*oe][H],Ce=o[2*oe+1];let ke=!1;if(Ce===void 0||Ce==="*")ke=!0;else{const Pe=mt(Ce+""),Re=[dt(de,it)].concat(Pe);ke=ht(Re)}if(!ke){z=!1;break}z=!0}z&&(M+=t[H])}return M},b.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return s;const e=arguments.length+1;let t,o,p,M,H=0;for(let z=0;z<arguments[0].length;z++)if(arguments[0][z]instanceof Array)for(let oe=0;oe<arguments[0][z].length;oe++){for(t=1,o=1;o<e;o++){const de=arguments[o-1][z][oe];if(de instanceof Error)return de;if(M=Y(de),M instanceof Error)return M;t*=M}H+=t}else{for(t=1,o=1;o<e;o++){const oe=arguments[o-1][z];if(oe instanceof Error)return oe;if(p=Y(oe),p instanceof Error)return p;t*=p}H+=t}return H},b.SUMSQ=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;let t=0;const o=e.length;for(let p=0;p<o;p++)t+=Tt(e[p])?e[p]*e[p]:0;return t},b.SUMX2MY2=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;let o=0;for(let p=0;p<e.length;p++)o+=e[p]*e[p]-t[p]*t[p];return o},b.SUMX2PY2=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;let o=0;e=Ne(q(e)),t=Ne(q(t));for(let p=0;p<e.length;p++)o+=e[p]*e[p]+t[p]*t[p];return o},b.SUMXMY2=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;let o=0;e=q(e),t=q(t);for(let p=0;p<e.length;p++)o+=Math.pow(e[p]-t[p],2);return o},b.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],o=arguments.length-1,p=Math.floor(o/2);let M=!1;const H=o%2!=0,z=o%2==0?null:arguments[arguments.length-1];if(p){for(let oe=0;oe<p;oe++)if(t===arguments[2*oe+1]){e=arguments[2*oe+2],M=!0;break}}M||(e=H?z:C)}else e=s;return e},b.SYD=function(e,t,o,p){return ie(e=Y(e),t=Y(t),o=Y(o),p=Y(p))?s:o===0||p<1||p>o?h:(e-t)*(o-(p=parseInt(p,10))+1)*2/(o*(o+1))},b.T=function(e){return e instanceof Error||typeof e=="string"?e:""},b.TAN=function(e){return(e=Y(e))instanceof Error?e:Math.tan(e)},b.TANH=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},b.TBILLEQ=function(e,t,o){return ie(e=He(e),t=He(t),o=Y(o))?s:o<=0||e>t||t-e>31536e6?h:365*o/(360-o*wt(e,t,!1))},b.TBILLPRICE=function(e,t,o){return ie(e=He(e),t=He(t),o=Y(o))?s:o<=0||e>t||t-e>31536e6?h:100*(1-o*wt(e,t,!1)/360)},b.TBILLYIELD=function(e,t,o){return ie(e=He(e),t=He(t),o=Y(o))?s:o<=0||e>t||t-e>31536e6?h:360*(100-o)/(o*wt(e,t,!1))},b.TDIST=gr,b.TDISTRT=br,b.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return C;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return s;const o=t.startsWith("$")?"$":"",p=t.endsWith("%");return p&&(e*=100),e=(e=an(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+o+(e=e.replace("-","")):o+e,p&&(e+="%"),e},b.TEXTJOIN=function(e,t,...o){if(typeof t!="boolean"&&(t=Ue(t)),arguments.length<3)return C;e=e??"";let p=q(o),M=t?p.filter(H=>H):p;if(Array.isArray(e)){e=q(e);let H=M.map(oe=>[oe]),z=0;for(let oe=0;oe<H.length-1;oe++)H[oe].push(e[z]),z++,z===e.length&&(z=0);return M=q(H),M.join("")}return M.join(e)},b.TIME=function(e,t,o){return ie(e=Y(e),t=Y(t),o=Y(o))?s:e<0||t<0||o<0?h:(3600*e+60*t+o)/86400},b.TIMEVALUE=function(e){return(e=He(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},b.TINV=mr,b.TODAY=function(){return Bt(new Date)},b.TRANSPOSE=function(e){return e?me(Z(e)):C},b.TREND=function(e,t,o){if(ie(e=Ne(q(e)),t=Ne(q(t)),o=Ne(q(o))))return s;const p=Se(e,t),M=p[0],H=p[1],z=[];return o.forEach(oe=>{z.push(M*oe+H)}),z},b.TRIM=function(e){return(e=Ve(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},b.TRIMMEAN=function(e,t){if(ie(e=Ne(q(e)),t=Y(t)))return s;const o=ft(e.length*t,2)/2;return d.mean((M=(M=o)||1,(p=ae(e.sort((H,z)=>H-z),o))&&typeof p.slice=="function"?p.slice(0,p.length-M):p));var p,M},b.TRUE=function(){return!0},b.TRUNC=function(e,t){return je(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},b.TTEST=jr,b.TYPE=function(e){return Tt(e)?1:gt(e)?2:Ot(e)?4:Et(e)?16:Array.isArray(e)?64:void 0},b.UNICHAR=bn,b.UNICODE=mn,b.UNIQUE=kt,b.UPPER=function(e){return(e=Ve(e))instanceof Error?e:e.toUpperCase()},b.VALUE=function(e){const t=je(e);if(t)return t;if(typeof e=="number")return e;if(tt(e)||(e=""),typeof e!="string")return s;const o=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let p=Number(e);return isNaN(p)?s:(p=p||0,o&&(p*=.01),p)},b.VAR=Fe,b.VARA=et,b.VARP=vr,b.VARPA=re,b.VARS=yr,b.VDB=function(){throw new Error("VDB is not implemented")},b.VLOOKUP=Rt,b.WEEKDAY=function(e,t){if((e=He(e))instanceof Error)return e;t===void 0&&(t=1);const o=e.getDay();return hn[t][o]},b.WEEKNUM=function(e,t){if((e=He(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return tn(e);const o=pn[t];let p=new Date(e.getFullYear(),0,1);const M=p.getDay()<o?1:0;return p-=24*Math.abs(p.getDay()-o)*60*60*1e3,Math.floor((e-p)/864e5/7+1)+M},b.WEIBULL=ye,b.WEIBULLDIST=xr,b.WORKDAY=_t,b.WORKDAYINTL=wr,b.XIRR=function(e,t,o){if(ie(e=Ne(q(e)),t=ut(q(t)),o=Y(o)))return s;const p=(Re,We,Ze)=>{const rt=Ze+1;let jt=Re[0];for(let ct=1;ct<Re.length;ct++)jt+=Re[ct]/Math.pow(rt,Lt(We[ct],We[0])/365);return jt},M=(Re,We,Ze)=>{const rt=Ze+1;let jt=0;for(let ct=1;ct<Re.length;ct++){const Ct=Lt(We[ct],We[0])/365;jt-=Ct*Re[ct]/Math.pow(rt,Ct+1)}return jt};let H=!1,z=!1;for(let Re=0;Re<e.length;Re++)e[Re]>0&&(H=!0),e[Re]<0&&(z=!0);if(!H||!z)return h;let oe,de,Ce,ke=o=o||.1,Pe=!0;do Ce=p(e,t,ke),oe=ke-Ce/M(e,t,ke),de=Math.abs(oe-ke),ke=oe,Pe=de>1e-10&&Math.abs(Ce)>1e-10;while(Pe);return ke},b.XNPV=function(e,t,o){if(ie(e=Y(e),t=Ne(q(t)),o=ut(q(o))))return s;let p=0;for(let M=0;M<t.length;M++)p+=t[M]/Math.pow(1+e,Lt(o[M],o[0])/365);return p},b.XOR=function(){const e=q(arguments);let t=s;for(let o=0;o<e.length;o++){if(e[o]instanceof Error)return e[o];e[o]!==void 0&&e[o]!==null&&typeof e[o]!="string"&&(t===s&&(t=0),e[o]&&t++)}return t===s?t:!!(1&Math.floor(Math.abs(t)))},b.YEAR=function(e){return(e=He(e))instanceof Error?e:e.getFullYear()},b.YEARFRAC=zt,b.YIELD=function(){throw new Error("YIELD is not implemented")},b.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},b.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},b.Z=xe,b.ZTEST=Cr,b.utils=Er}},f={};function L(W){var b=f[W];if(b!==void 0)return b.exports;var u=f[W]={exports:{}};return c[W].call(u.exports,u,u.exports,L),u.exports}L.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var R=L(960);l=R}(),l)},44:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(463);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var l=(""+n)[0];return l=="="||l=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var l={};return n.mask?l.mask=n.mask:n.format?l.mask=n.format:(l.locale=n.locale,l.options=n.options),n.decimal&&(l.options||(l.options={}),l.options={decimal:n.decimal}),l}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var l=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(l=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var c=obj.options.persistance==1?obj.options.url:obj.options.persistance,f=obj.prepareJson(arguments[2]);obj.save(c,f)}return l},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var l=Object.keys(obj.options.data[0]);l.length>n&&(n=l.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var c=[],f=0;f<n;f++)obj.options.colHeaders[f]||(obj.options.colHeaders[f]=""),obj.options.colWidths[f]||(obj.options.colWidths[f]=obj.options.defaultColWidth),obj.options.colAlignments[f]||(obj.options.colAlignments[f]=obj.options.defaultColAlign),obj.options.columns[f]?obj.options.columns[f].type||(obj.options.columns[f].type="text"):obj.options.columns[f]={type:"text"},obj.options.columns[f].name||(obj.options.columns[f].name=l&&l[f]?l[f]:f),obj.options.columns[f].source||(obj.options.columns[f].source=[]),obj.options.columns[f].options||(obj.options.columns[f].options=[]),obj.options.columns[f].editor||(obj.options.columns[f].editor=null),obj.options.columns[f].allowEmpty||(obj.options.columns[f].allowEmpty=!1),obj.options.columns[f].title||(obj.options.columns[f].title=obj.options.colHeaders[f]?obj.options.colHeaders[f]:""),obj.options.columns[f].width||(obj.options.columns[f].width=obj.options.colWidths[f]?obj.options.colWidths[f]:obj.options.defaultColWidth),obj.options.columns[f].align||(obj.options.columns[f].align=obj.options.colAlignments[f]?obj.options.colAlignments[f]:"center"),obj.options.columns[f].type=="autocomplete"||obj.options.columns[f].type=="dropdown"?obj.options.columns[f].url&&c.push({url:obj.options.columns[f].url,index:f,method:"GET",dataType:"json",success:function(L){for(var R=0;R<L.length;R++)obj.options.columns[this.index].source.push(L[R])}}):obj.options.columns[f].type=="calendar"&&(obj.options.columns[f].options.format||(obj.options.columns[f].options.format="DD/MM/YYYY"));c.length?jSuites.ajax(c,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(j){obj.scrollControls(j)},obj.content.onwheel=function(j){obj.wheelControls(j)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),l=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(l),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var c=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var f=0;f<obj.options.paginationOptions.length;f++){var L=document.createElement("option");L.value=obj.options.paginationOptions[f],L.innerHTML=obj.options.paginationOptions[f],obj.paginationDropdown.appendChild(L)}obj.paginationDropdown.value=obj.options.pagination,c.appendChild(document.createTextNode(obj.options.text.show)),c.appendChild(obj.paginationDropdown),c.appendChild(document.createTextNode(obj.options.text.entries))}var R,W=document.createElement("div");if(W.classList.add("jexcel_filter"),W.appendChild(c),W.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(R=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(R),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var b=0;b<obj.options.nestedHeaders.length;b++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[b]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(R=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(R),f=0;f<obj.options.columns.length;f++)obj.createCellHeader(f),obj.headerContainer.appendChild(obj.headers[f]),obj.colgroupContainer.appendChild(obj.colgroup[f]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var u=document.createElement("td");for(obj.filter.appendChild(u),f=0;f<obj.options.columns.length;f++)(u=document.createElement("td")).innerHTML="&nbsp;",u.setAttribute("data-x",f),u.className="jexcel_column_filter",obj.options.columns[f].type=="hidden"&&(u.style.display="none"),obj.filter.appendChild(u);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var d=document.createElement("a");d.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var k=document.createElement("span");k.innerHTML="Jspreadsheet CE",d.appendChild(k),obj.ads.appendChild(d),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var P=document.createElement("div"),g=document.createElement("div");if(obj.pagination.appendChild(P),obj.pagination.appendChild(g),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(W),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var s=Object.keys(obj.options.classes);for(f=0;f<s.length;f++){var m=jexcel.getIdFromColumnName(s[f],!0);obj.records[m[1]][m[0]].classList.add(obj.options.classes[s[f]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var l=0;l<obj.options.data.length;l++){for(var c=[],f=0;f<obj.options.columns.length;f++)c[f]=obj.options.data[l][obj.options.columns[f].name];n.push(c)}obj.options.data=n}l=0,f=0;var L=obj.options.columns.length,R=obj.options.data.length,W=obj.options.minDimensions[0],b=obj.options.minDimensions[1],u=W>L?W:L,d=b>R?b:R;for(l=0;l<d;l++)for(f=0;f<u;f++)obj.options.data[l]==null&&(obj.options.data[l]=[]),obj.options.data[l][f]==null&&(obj.options.data[l][f]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var k=0,P=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,k=obj.options.pagination*obj.pageNumber,P=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<P&&(P=obj.options.data.length)):(k=0,P=obj.options.data.length);for(l=0;l<obj.options.data.length;l++){var g=obj.createRow(l,obj.options.data[l]);l>=k&&l<P&&obj.tbody.appendChild(g)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var s=Object.keys(obj.options.mergeCells);for(f=0;f<s.length;f++){var m=obj.options.mergeCells[s[f]];obj.setMerge(s[f],m[0],m[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,l){for(var c=[],f=0,L=0,R=l==1||obj.options.copyCompatibility==0,W=obj.options.columns.length,b=obj.options.data.length,u=0;u<b;u++){f=0;for(var d=0;d<W;d++)n&&!obj.records[u][d].classList.contains("highlight")||(c[L]||(c[L]=[]),c[L][f]=R?obj.options.data[u][d]:obj.records[u][d].innerHTML,f++);f>0&&L++}return c},obj.getJsonRow=function(n){for(var l=obj.options.data[n],c=obj.options.columns.length,f={},L=0;L<c;L++)obj.options.columns[L].name||(obj.options.columns[L].name=L),f[obj.options.columns[L].name]=l[L];return f},obj.getJson=function(n){for(var l=[],c=obj.options.columns.length,f=obj.options.data.length,L=0;L<f;L++){for(var R=null,W=0;W<c;W++)n&&!obj.records[L][W].classList.contains("highlight")||(R==null&&(R={}),obj.options.columns[W].name||(obj.options.columns[W].name=W),R[obj.options.columns[W].name]=obj.options.data[L][W]);R!=null&&l.push(R)}return l},obj.prepareJson=function(n){for(var l=[],c=0;c<n.length;c++){var f=n[c].x,L=n[c].y,R=obj.options.columns[f].name?obj.options.columns[f].name:f;l[L]||(l[L]={row:L,data:{}}),l[L].data[R]=n[c].newValue}return l.filter(function(W){return W!=null})},obj.save=function(n,l){var c=obj.dispatch("onbeforesave",el,obj,l);if(c)l=c;else if(c===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(l)},success:function(f){obj.dispatch("onsave",el,obj,l)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,l){for(var c=0;c<obj.headers.length;c++){var f=jexcel.getColumnNameFromId([c,n]);l[c]!=null&&obj.setValue(f,l[c])}},obj.getColumnData=function(n){for(var l=[],c=0;c<obj.options.data.length;c++)l.push(obj.options.data[c][n]);return l},obj.setColumnData=function(n,l){for(var c=0;c<obj.rows.length;c++){var f=jexcel.getColumnNameFromId([n,c]);l[c]!=null&&obj.setValue(f,l[c])}},obj.createRow=function(n,l){obj.records[n]||(obj.records[n]=[]),l||(l=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var c=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(c=obj.options.rows[n].title)),c||(c=parseInt(n+1));var f=document.createElement("td");f.innerHTML=c,f.setAttribute("data-y",n),f.className="jexcel_row",obj.rows[n].appendChild(f);for(var L=0;L<obj.options.columns.length;L++)obj.records[n][L]=obj.createCell(L,n,l[L]),obj.rows[n].appendChild(obj.records[n][L]);return obj.rows[n]},obj.parseValue=function(n,l,c,f){(""+c).substr(0,1)=="="&&obj.options.parseFormulas==1&&(c=obj.executeFormula(c,n,l));var L=obj.options.columns[n];if(L&&!isFormula(c)){var R=null;if(R=getMask(L)){c&&c==Number(c)&&(c=Number(c));var W=jSuites.mask.render(c,R,!0);if(f&&R.mask){var b=R.mask.split(";");b[1]&&(b[1].match(new RegExp("\\[Red\\]","gi"))&&(c<0?f.classList.add("red"):f.classList.remove("red")),b[1].match(new RegExp("\\(","gi"))&&c<0&&(W="("+W+")"))}W&&(c=W)}}return c};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,l,c){var f=document.createElement("td");if(f.setAttribute("data-x",n),f.setAttribute("data-y",l),(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1){var L=secureFormula(c);L!=c&&(c=L)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=c:f.textContent=c,typeof obj.options.columns[n].editor.createCell=="function"&&(f=obj.options.columns[n].editor.createCell(f));else if(obj.options.columns[n].type=="hidden")f.style.display="none",f.textContent=c;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var R=document.createElement("input");R.type=obj.options.columns[n].type,R.name="c"+n,R.checked=c==1||c==1||c=="true",R.onclick=function(){obj.setValue(f,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||R.setAttribute("disabled","disabled"),f.appendChild(R),obj.options.data[l][n]=R.checked}else if(obj.options.columns[n].type=="calendar"){var W=null;if(!validDate(c)){var b=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);b&&(W=b)}f.textContent=jSuites.calendar.getDateString(W||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")f.classList.add("jexcel_dropdown"),f.textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=c,f.appendChild(u)}else f.style.color=c,f.textContent=c;else if(obj.options.columns[n].type=="image"){if(c&&c.substr(0,10)=="data:image"){var d=document.createElement("img");d.src=c,f.appendChild(d)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=stripScript(obj.parseValue(n,l,c,f)):f.textContent=obj.parseValue(n,l,c,f);obj.options.columns[n].readOnly==1&&(f.className="readonly");var k=obj.options.columns[n].align?obj.options.columns[n].align:"center";return f.style.textAlign=k,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||f.innerHTML.length>200)&&(f.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(c||f.innerHTML?obj.records[l][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(f.style.overflow="hidden")),f},obj.createCellHeader=function(n){var l=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,c=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=c,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",l),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,l,c){obj.options.nestedHeaders[l][n].title&&(obj.options.nestedHeaders[l][n].title=c,obj.options.nestedHeaders[l].element.children[n+1].textContent=c)},obj.createNestedHeader=function(n){var l=document.createElement("tr");l.classList.add("jexcel_nested");var c=document.createElement("td");l.appendChild(c),n.element=l;for(var f=0,L=0;L<n.length;L++){n[L].colspan||(n[L].colspan=1),n[L].align||(n[L].align="center"),n[L].title||(n[L].title=""),n[L].id||(n[L].id="");for(var R=n[L].colspan,W=[],b=0;b<R;b++)obj.options.columns[f]&&obj.options.columns[f].type=="hidden"&&R++,W.push(f),f++;(c=document.createElement("td")).setAttribute("data-column",W.join(",")),c.setAttribute("colspan",n[L].colspan),c.setAttribute("align",n[L].align),c.setAttribute("id",n[L].id),c.textContent=n[L].title,l.appendChild(c)}return l},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var l=0;l<n.length;l++)if(n[l].type=="i")(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",n[l].k),R.setAttribute("data-v",n[l].v),R.setAttribute("id",n[l].id),n[l].tooltip&&R.setAttribute("title",n[l].tooltip),n[l].onclick&&(n[l].onclick,1)?R.onclick=function(W){var b=W;return function(){n[b].onclick(el,obj,this)}}(l):R.onclick=function(){var W=this.getAttribute("data-k"),b=this.getAttribute("data-v");obj.setStyle(obj.highlighted,W,b)},R.textContent=n[l].content,obj.toolbar.appendChild(R);else if(n[l].type=="select"){var c=!1;(R=document.createElement("select")).classList.add("jexcel_toolbar_item"),R.setAttribute("data-k",n[l].k),n[l].tooltip&&R.setAttribute("title",n[l].tooltip),n[l].onchange&&(n[l].onchange,1)?(R.onchange=n[l].onchange,c=!0):R.onchange=function(){var W=this.getAttribute("data-k");obj.setStyle(obj.highlighted,W,this.value)};for(var f=0;f<n[l].v.length;f++){var L=document.createElement("option");L.value=n[l].v[f],L.textContent=n[l].v[f],n[l].selectedValue&&L.value===n[l].selectedValue&&(L.selected=!0),R.appendChild(L)}c&&R.dispatchEvent(new Event("change")),obj.toolbar.appendChild(R)}else if(n[l].type=="color"){var R;(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",n[l].k),R.setAttribute("data-v",""),n[l].tooltip&&R.setAttribute("title",n[l].tooltip),obj.toolbar.appendChild(R),R.textContent=n[l].content,jSuites.color(R,{onchange:function(W,b){var u=W.getAttribute("data-k");obj.setStyle(obj.highlighted,u,b)}})}},obj.setMerge=function(n,l,c,f){var L=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var R=parseInt(obj.highlighted[0].getAttribute("data-x")),W=parseInt(obj.highlighted[0].getAttribute("data-y")),b=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),u=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([R,W]),l=b-R+1,c=u-W+1}var d=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[d[1]][d[0]].getAttribute("data-merged")&&(L=obj.options.text.cellAlreadyMerged);else if((!l||l<2)&&(!c||c<2))L=obj.options.text.invalidMergeProperties;else for(var k=d[1];k<d[1]+c;k++)for(var P=d[0];P<d[0]+l;P++)jexcel.getColumnNameFromId([P,k]),obj.records[k][P].getAttribute("data-merged")&&(L=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(L)alert(L);else{l>1?obj.records[d[1]][d[0]].setAttribute("colspan",l):l=1,c>1?obj.records[d[1]][d[0]].setAttribute("rowspan",c):c=1,obj.options.mergeCells[n]=[l,c,[]],obj.records[d[1]][d[0]].setAttribute("data-merged","true"),obj.records[d[1]][d[0]].style.overflow="hidden";for(var g=[],s=d[1];s<d[1]+c;s++)for(var m=d[0];m<d[0]+l;m++)d[0]==m&&d[1]==s||(g.push(obj.options.data[s][m]),obj.updateCell(m,s,"",!0),obj.options.mergeCells[n][2].push(obj.records[s][m]),obj.records[s][m].style.display="none",obj.records[s][m]=obj.records[d[1]][d[0]]);obj.updateSelection(obj.records[d[1]][d[0]]),f||(obj.setHistory({action:"setMerge",column:n,colspan:l,rowspan:c,data:g}),obj.dispatch("onmerge",el,n,l,c))}},obj.getMerge=function(n){var l={};if(n)l=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var c=Object.keys(obj.options.mergeCells),f=0;f<c.length;f++)l[c[f]]=[obj.options.mergeCells[c[f]][0],obj.options.mergeCells[c[f]][1]]}return l},obj.removeMerge=function(n,l,c){if(obj.options.mergeCells[n]){var f=jexcel.getIdFromColumnName(n,!0);obj.records[f[1]][f[0]].removeAttribute("colspan"),obj.records[f[1]][f[0]].removeAttribute("rowspan"),obj.records[f[1]][f[0]].removeAttribute("data-merged");for(var L=obj.options.mergeCells[n],R=0,W=0;W<L[1];W++)for(var b=0;b<L[0];b++)(W>0||b>0)&&(obj.records[f[1]+W][f[0]+b]=L[2][R],obj.records[f[1]+W][f[0]+b].style.display="",l&&l[R]&&obj.updateCell(f[0]+b,f[1]+W,l[R]),R++);obj.updateSelection(obj.records[f[1]][f[0]],obj.records[f[1]+W-1][f[0]+b-1]),c||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var l=Object.keys(obj.options.mergeCells),c=0;c<l.length;c++)obj.removeMerge(l[c],null,n)}},obj.isColMerged=function(n,l){var c=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),L=0;L<f.length;L++){var R=jexcel.getIdFromColumnName(f[L],!0),W=obj.options.mergeCells[f[L]][0],b=R[0],u=R[0]+(W>1?W-1:0);l==null?b<=n&&u>=n&&c.push(f[L]):l?b<n&&u>=n&&c.push(f[L]):b<=n&&u>n&&c.push(f[L])}return c},obj.isRowMerged=function(n,l){var c=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),L=0;L<f.length;L++){var R=jexcel.getIdFromColumnName(f[L],!0),W=obj.options.mergeCells[f[L]][1],b=R[1],u=R[1]+(W>1?W-1:0);l==null?b<=n&&u>=n&&c.push(f[L]):l?b<n&&u>=n&&c.push(f[L]):b<=n&&u>n&&c.push(f[L])}return c},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var l=[];if(obj.options.columns[n].type=="checkbox")l.push({id:"true",name:"True"}),l.push({id:"false",name:"False"});else{for(var c=[],f=!1,L=0;L<obj.options.data.length;L++){var R=obj.options.data[L][n],W=obj.records[L][n].innerHTML;R&&W?c[R]=W:f=!0}var b=Object.keys(c);for(l=[],L=0;L<b.length;L++)l.push({id:b[L],name:c[b[L]]});f&&l.push({value:"",id:"",name:"(Blanks)"})}var u=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(u),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var d={data:l,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(k){obj.resetFilters(),obj.filters[n]=k.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=k.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(u,d)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var l=0;l<obj.filter.children.length;l++)obj.filters[l]&&(n=l);var c=function(R,W,b){for(var u=0;u<R.length;u++){var d=""+obj.options.data[b][W],k=""+obj.records[b][W].innerHTML;if(R[u]==d||R[u]==k)return!0}return!1},f=obj.filters[n];obj.results=[];for(var L=0;L<obj.options.data.length;L++)c(f,n,L)&&obj.results.push(L);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,l,c){var f=n.getAttribute("data-y"),L=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,L,f),L>0&&(obj.records[f][L-1].style.overflow="hidden");var R=function(T){var I=n.getBoundingClientRect(),_=document.createElement(T);return _.style.width=I.width+"px",_.style.height=I.height-2+"px",_.style.minHeight=I.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(_),obj.dispatch("oncreateeditor",el,n,L,f,_),_};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[f][L],obj.records[f][L].innerHTML,L,f],obj.options.columns[L].editor)obj.options.columns[L].editor.openEditor(n,el,l,c);else if(obj.options.columns[L].type!="hidden")if(obj.options.columns[L].type=="checkbox"||obj.options.columns[L].type=="radio"){var W=!n.children[0].checked;obj.setValue(n,W),obj.edition=null}else if(obj.options.columns[L].type=="dropdown"||obj.options.columns[L].type=="autocomplete"){if(W=obj.options.data[f][L],obj.options.columns[L].multiple&&!Array.isArray(W)&&(W=W.split(";")),typeof obj.options.columns[L].filter=="function")var b=obj.options.columns[L].filter(el,n,L,f,obj.options.columns[L].source);else b=obj.options.columns[L].source;for(var u=[],d=0;d<b.length;d++)u.push(b[d]);var k=R("div"),P={data:u,multiple:!!obj.options.columns[L].multiple,autocomplete:!(!obj.options.columns[L].autocomplete&&obj.options.columns[L].type!="autocomplete"),opened:!0,value:W,width:"100%",height:k.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[L].options&&obj.options.columns[L].options.type&&(P.type=obj.options.columns[L].options.type),jSuites.dropdown(k,P)}else if(obj.options.columns[L].type=="calendar"||obj.options.columns[L].type=="color")W=obj.options.data[f][L],(k=R("input")).value=W,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[L].options.position=!0),obj.options.columns[L].options.value=obj.options.data[f][L],obj.options.columns[L].options.opened=!0,obj.options.columns[L].options.onclose=function(T,I){obj.closeEditor(n,!0)},obj.options.columns[L].type=="color"?jSuites.color(k,obj.options.columns[L].options):jSuites.calendar(k,obj.options.columns[L].options),k.focus();else if(obj.options.columns[L].type=="html"){W=obj.options.data[f][L],(k=R("div")).style.position="relative",(m=document.createElement("div")).classList.add("jexcel_richtext"),k.appendChild(m),jSuites.editor(m,{focus:!0,value:W});var g=n.getBoundingClientRect(),s=m.getBoundingClientRect();window.innerHeight<g.bottom+s.height?m.style.top=g.top-(s.height+2)+"px":m.style.top=g.top+"px"}else if(obj.options.columns[L].type=="image"){var m,j=n.children[0];(k=R("div")).style.position="relative",(m=document.createElement("div")).classList.add("jclose"),j&&j.src&&m.appendChild(j),k.appendChild(m),jSuites.image(m,obj.options.imageOptions),g=n.getBoundingClientRect(),s=m.getBoundingClientRect(),window.innerHeight<g.bottom+s.height?m.style.top=g.top-(s.height+2)+"px":m.style.top=g.top+"px"}else{W=l==1?"":obj.options.data[f][L],obj.options.columns[L].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[L].wordWrap!=1?k=R("input"):k=R("textarea"),k.focus(),k.value=W,P=obj.options.columns[L];var h=null;if(!isFormula(W)&&(h=getMask(P))){if(!P.disabledMaskOnEdition)if(P.mask){var C=P.mask.split(";");k.setAttribute("data-mask",C[0])}else P.locale&&k.setAttribute("data-locale",P.locale);h.input=k,k.mask=h,jSuites.mask.render(W,h,!1)}k.onblur=function(){obj.closeEditor(n,!0)},k.scrollLeft=k.scrollWidth}}},obj.closeEditor=function(n,l){var c=parseInt(n.getAttribute("data-x")),f=parseInt(n.getAttribute("data-y"));if(l==1){if(obj.options.columns[c].editor)var L=obj.options.columns[c].editor.closeEditor(n,l);else if(!(obj.options.columns[c].type=="checkbox"||obj.options.columns[c].type=="radio"||obj.options.columns[c].type=="hidden"))if(obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete")L=n.children[0].dropdown.close(!0);else if(obj.options.columns[c].type=="calendar")L=n.children[0].calendar.close(!0);else if(obj.options.columns[c].type=="color")L=n.children[0].color.close(!0);else if(obj.options.columns[c].type=="html")L=n.children[0].children[0].editor.getData();else if(obj.options.columns[c].type=="image"){var R=n.children[0].children[0].children[0];L=R&&R.tagName=="IMG"?R.src:""}else if(obj.options.columns[c].type=="numeric")(""+(L=n.children[0].value)).substr(0,1)!="="&&L==""&&(L=obj.options.columns[c].allowEmpty?"":0),n.children[0].onblur=null;else{L=n.children[0].value,n.children[0].onblur=null;var W,b=obj.options.columns[c];if((W=getMask(b))&&L!==""&&!isFormula(L)&&typeof L!="number"){var u=jSuites.mask.extract(L,W,!0);u&&u.value!==""&&(L=u.value)}}obj.options.data[f][c]==L?n.innerHTML=obj.edition[1]:obj.setValue(n,L)}else obj.options.columns[c].editor?obj.options.columns[c].editor.closeEditor(n,l):obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[c].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[c].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,c,f,L,l),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var l=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][l]},obj.getColumnOptions=function(n,l){var c=obj.options.columns[n];return c||(c={type:"text"}),c},obj.getCellFromCoords=function(n,l){return obj.records[l][n]},obj.getLabel=function(n){var l=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][l].innerHTML},obj.getLabelFromCoords=function(n,l){return obj.records[l][n].innerHTML},obj.getValue=function(n,l){if(typeof n=="object")var c=n.getAttribute("data-x"),f=n.getAttribute("data-y");else c=(n=jexcel.getIdFromColumnName(n,!0))[0],f=n[1];var L=null;return c!=null&&f!=null&&(obj.records[f]&&obj.records[f][c]&&(l||obj.options.copyCompatibility==1)?L=obj.records[f][c].innerHTML:obj.options.data[f]&&obj.options.data[f][c]!="undefined"&&(L=obj.options.data[f][c])),L},obj.getValueFromCoords=function(n,l,c){var f=null;return n!=null&&l!=null&&(obj.records[l]&&obj.records[l][n]&&c||obj.options.copyCompatibility==1?f=obj.records[l][n].innerHTML:obj.options.data[l]&&obj.options.data[l][n]!="undefined"&&(f=obj.options.data[l][n])),f},obj.setValue=function(n,l,c){var f=[];if(typeof n=="string"){var L=(u=jexcel.getIdFromColumnName(n,!0))[0],R=u[1];f.push(obj.updateCell(L,R,l,c)),obj.updateFormulaChain(L,R,f)}else if(L=null,R=null,n&&n.getAttribute&&(L=n.getAttribute("data-x"),R=n.getAttribute("data-y")),L!=null&&R!=null)f.push(obj.updateCell(L,R,l,c)),obj.updateFormulaChain(L,R,f);else{var W=Object.keys(n);if(W.length>0)for(var b=0;b<W.length;b++){var u;typeof n[b]=="string"?(L=(u=jexcel.getIdFromColumnName(n[b],!0))[0],R=u[1]):n[b].x!=null&&n[b].y!=null?(L=n[b].x,R=n[b].y,n[b].newValue!=null?l=n[b].newValue:n[b].value!=null&&(l=n[b].value)):(L=n[b].getAttribute("data-x"),R=n[b].getAttribute("data-y")),L!=null&&R!=null&&(f.push(obj.updateCell(L,R,l,c)),obj.updateFormulaChain(L,R,f))}}obj.setHistory({action:"setValue",records:f,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,f)},obj.setValueFromCoords=function(n,l,c,f){var L=[];L.push(obj.updateCell(n,l,c,f)),obj.updateFormulaChain(n,l,L),obj.setHistory({action:"setValue",records:L,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,L)},obj.setCheckRadioValue=function(){for(var n=[],l=Object.keys(obj.highlighted),c=0;c<l.length;c++){var f=obj.highlighted[c].getAttribute("data-x"),L=obj.highlighted[c].getAttribute("data-y");obj.options.columns[f].type!="checkbox"&&obj.options.columns[f].type!="radio"||n.push(obj.updateCell(f,L,!obj.options.data[L][f]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var l=new Option;l.innerHTML=n;var c=null;for(n=l.getElementsByTagName("script");c=n[0];)c.parentNode.removeChild(c);return l.innerHTML};obj.updateCell=function(n,l,c,f){if(obj.records[l][n].classList.contains("readonly")!=1||f){var L;(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1&&(L=secureFormula(c))!=c&&(c=L),(L=obj.dispatch("onbeforechange",el,obj.records[l][n],n,l,c))!=null&&(c=L),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(c=obj.options.columns[n].editor.updateCell(obj.records[l][n],c,f)),k={x:n,y:l,col:n,row:l,newValue:c,oldValue:obj.options.data[l][n]};let P=obj.options.columns[n].editor;if(P)obj.options.data[l][n]=c,typeof P.setValue=="function"&&P.setValue(obj.records[l][n],c);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var R=0;R<obj.options.data.length;R++)obj.options.data[R][n]=!1;obj.records[l][n].children[0].checked=c==1||c==1||c=="true"||c=="TRUE",obj.options.data[l][n]=obj.records[l][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[l][n]=c,obj.records[l][n].textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="calendar"){var W=null;if(!validDate(c)){var b=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);b&&(W=b)}obj.options.data[l][n]=c,obj.records[l][n].textContent=jSuites.calendar.getDateString(W||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[l][n]=c,obj.options.columns[n].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=c,obj.records[l][n].textContent="",obj.records[l][n].appendChild(u)}else obj.records[l][n].style.color=c,obj.records[l][n].textContent=c;else if(obj.options.columns[n].type=="image"){if(c=""+c,obj.options.data[l][n]=c,obj.records[l][n].innerHTML="",c&&c.substr(0,10)=="data:image"){var d=document.createElement("img");d.src=c,obj.records[l][n].appendChild(d)}}else obj.options.data[l][n]=c,obj.options.columns[n].type=="html"?obj.records[l][n].innerHTML=stripScript(obj.parseValue(n,l,c)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[l][n].innerHTML=stripScript(obj.parseValue(n,l,c,obj.records[l][n])):obj.records[l][n].textContent=obj.parseValue(n,l,c,obj.records[l][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[l][n].innerHTML.length>200)?obj.records[l][n].style.whiteSpace="pre-wrap":obj.records[l][n].style.whiteSpace="";n>0&&(obj.records[l][n-1].style.overflow=c?"hidden":""),obj.dispatch("onchange",el,obj.records[l]&&obj.records[l][n]?obj.records[l][n]:null,n,l,c,k.oldValue)}else var k={x:n,y:l,col:n,row:l};return k},obj.copyData=function(n,l){var c=obj.getData(!0,!0),f=obj.selectedContainer,L=parseInt(n.getAttribute("data-x")),R=parseInt(n.getAttribute("data-y")),W=parseInt(l.getAttribute("data-x")),b=parseInt(l.getAttribute("data-y")),u=[],d=!1;if(f[0]==L){if(R<f[1])var k=R-f[1];else k=1;var P=0}else P=L<f[0]?L-f[0]:1,k=0;for(var g=0,s=0,m=R;m<=b;m++)if(!obj.rows[m]||obj.rows[m].style.display!="none"){c[s]==null&&(s=0),g=0,f[0]!=L&&(P=L<f[0]?L-f[0]:1);for(var j=L;j<=W;j++){if(obj.records[m][j]&&!obj.records[m][j].classList.contains("readonly")&&obj.records[m][j].style.display!="none"&&d==0){if(!obj.selection.length&&obj.options.data[m][j]!=""){d=!0;continue}(c[s]==null||c[s][g]==null)&&(g=0);var h=c[s][g];if(h&&!c[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+h).substr(0,1)=="="){var C=h.match(/([A-Z]+[0-9]+)/g);if(C){for(var T=[],I=0;I<C.length;I++){var _=jexcel.getIdFromColumnName(C[I],1);_[0]+=P,_[1]+=k,_[1]<0&&(_[1]=0);var O=jexcel.getColumnNameFromId([_[0],_[1]]);O!=C[I]&&(T[C[I]]=O)}T&&(h=obj.updateFormula(h,T))}}else h==Number(h)&&(h=Number(h)+k);else if(obj.options.columns[j].type=="calendar"){var N=new Date(h);N.setDate(N.getDate()+k),h=N.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(N.getMonth()+1))+"-"+jexcel.doubleDigitFormat(N.getDate())+" 00:00:00"}}u.push(obj.updateCell(j,m,h)),obj.updateFormulaChain(j,m,u)}g++,f[0]!=L&&P++}s++,k++}obj.setHistory({action:"setValue",records:u,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,u)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,l,c){if(n==1){if(obj.selectedCell&&(l>=obj.selectedCell[1]&&l<=obj.selectedCell[3]||c>=obj.selectedCell[1]&&c<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(l>=obj.selectedCell[0]&&l<=obj.selectedCell[2]||c>=obj.selectedCell[0]&&c<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){d=1;for(var l=0;l<obj.highlighted.length;l++){obj.highlighted[l].classList.remove("highlight"),obj.highlighted[l].classList.remove("highlight-left"),obj.highlighted[l].classList.remove("highlight-right"),obj.highlighted[l].classList.remove("highlight-top"),obj.highlighted[l].classList.remove("highlight-bottom"),obj.highlighted[l].classList.remove("highlight-selected");var c=parseInt(obj.highlighted[l].getAttribute("data-x")),f=parseInt(obj.highlighted[l].getAttribute("data-y"));if(obj.highlighted[l].getAttribute("data-merged"))var L=parseInt(obj.highlighted[l].getAttribute("colspan")),R=parseInt(obj.highlighted[l].getAttribute("rowspan")),W=L>0?c+(L-1):c,b=R>0?f+(R-1):f;else W=c,b=f;for(var u=c;u<=W;u++)obj.headers[u]&&obj.headers[u].classList.remove("selected");for(u=f;u<=b;u++)obj.rows[u]&&obj.rows[u].classList.remove("selected")}}else var d=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&d==1&&obj.dispatch("onblur",el),d},obj.updateSelection=function(n,l,c){var f=n.getAttribute("data-x"),L=n.getAttribute("data-y");if(l)var R=l.getAttribute("data-x"),W=l.getAttribute("data-y");else R=f,W=L;obj.updateSelectionFromCoords(f,L,R,W,c)},obj.updateSelectionFromCoords=function(n,l,c,f,L){var R=obj.resetSelection();if(l==null&&(l=0,f=obj.rows.length-1),c==null&&(c=n),f==null&&(f=l),n>=obj.headers.length&&(n=obj.headers.length-1),l>=obj.rows.length&&(l=obj.rows.length-1),c>=obj.headers.length&&(c=obj.headers.length-1),f>=obj.rows.length&&(f=obj.rows.length-1),obj.selectedCell=[n,l,c,f],n!=null){if(obj.records[l][n]&&obj.records[l][n].classList.add("highlight-selected"),parseInt(n)<parseInt(c))var W=parseInt(n),b=parseInt(c);else W=parseInt(c),b=parseInt(n);if(parseInt(l)<parseInt(f))var u=parseInt(l),d=parseInt(f);else u=parseInt(f),d=parseInt(l);for(var k=W;k<=b;k++)for(var P=u;P<=d;P++)if(obj.records[P][k]&&obj.records[P][k].getAttribute("data-merged")){var g=parseInt(obj.records[P][k].getAttribute("data-x")),s=parseInt(obj.records[P][k].getAttribute("data-y")),m=parseInt(obj.records[P][k].getAttribute("colspan")),j=parseInt(obj.records[P][k].getAttribute("rowspan"));m>1&&(g<W&&(W=g),g+m>b&&(b=g+m-1)),j&&(s<u&&(u=s),s+j>d&&(d=s+j-1))}var h=null,C=null,T=null,I=null;for(P=u;P<=d;P++)obj.rows[P].style.display!="none"&&(T==null&&(T=P),I=P);for(k=W;k<=b;k++){for(P=u;P<=d;P++)obj.rows[P].style.display!="none"&&obj.records[P][k].style.display!="none"&&(obj.records[P][k].classList.add("highlight"),obj.highlighted.push(obj.records[P][k]));obj.options.columns[k].type!="hidden"&&(h==null&&(h=k),C=k)}for(h||(h=0),C||(C=0),k=h;k<=C;k++)obj.options.columns[k].type!="hidden"&&obj.colgroup[k].style&&obj.colgroup[k].style.display!="none"&&(obj.records[T]&&obj.records[T][k]&&obj.records[T][k].classList.add("highlight-top"),obj.records[I]&&obj.records[I][k]&&obj.records[I][k].classList.add("highlight-bottom"),obj.headers[k].classList.add("selected"));for(P=T;P<=I;P++)obj.rows[P]&&obj.rows[P].style.display!="none"&&(obj.records[P][h].classList.add("highlight-left"),obj.records[P][C].classList.add("highlight-right"),obj.rows[P].classList.add("selected"));obj.selectedContainer=[h,T,C,I]}R==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,h,T,C,I,L),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,l){obj.removeCopySelection();var c=obj.selectedContainer[0],f=obj.selectedContainer[1],L=obj.selectedContainer[2],R=obj.selectedContainer[3];if(n!=null&&l!=null){if(n-L>0)var W=parseInt(L)+1,b=parseInt(n);else W=parseInt(n),b=parseInt(c)-1;if(l-R>0)var u=parseInt(R)+1,d=parseInt(l);else u=parseInt(l),d=parseInt(f)-1;b-W<=d-u?(W=parseInt(c),b=parseInt(L)):(u=parseInt(f),d=parseInt(R));for(var k=u;k<=d;k++)for(var P=W;P<=b;P++)obj.records[k][P]&&obj.rows[k].style.display!="none"&&obj.records[k][P].style.display!="none"&&(obj.records[k][P].classList.add("selection"),obj.records[u][P].classList.add("selection-top"),obj.records[d][P].classList.add("selection-bottom"),obj.records[k][W].classList.add("selection-left"),obj.records[k][b].classList.add("selection-right"),obj.selection.push(obj.records[k][P]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],l=n.getAttribute("data-x"),c=obj.content.getBoundingClientRect(),f=c.left,L=c.top,R=n.getBoundingClientRect(),W=R.left,b=R.top,u=R.width,d=R.height,k=W-f+obj.content.scrollLeft+u-4,P=b-L+obj.content.scrollTop+d-4;if(obj.corner.style.top=P+"px",obj.corner.style.left=k+"px",obj.options.freezeColumns){var g=obj.getFreezeWidth();l>obj.options.freezeColumns-1&&W-f+u<g?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var l=obj.content.getBoundingClientRect(),c=l.left,f=l.top,L=l.width,R=l.height,W=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),b=W.left,u=W.top,d=W.width,k=W.height;if(n==0||n==1)var P=b-c+obj.content.scrollLeft,g=u-f+obj.content.scrollTop-2;else P=b-c+obj.content.scrollLeft+d,g=u-f+obj.content.scrollTop+k;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+R||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-k:obj.content.scrollTop=g-(R-2));var s=obj.getFreezeWidth();P>obj.content.scrollLeft+s&&P<obj.content.scrollLeft+L||(P<obj.content.scrollLeft+30?(obj.content.scrollLeft=P,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):P<obj.content.scrollLeft+s?obj.content.scrollLeft=P-s-1:obj.content.scrollLeft=P-(L-20))},obj.getWidth=function(n){if(n===void 0)for(var l=[],c=0;c<obj.headers.length;c++)l.push(obj.options.columns[c].width);else typeof n=="object"&&(n=n.getAttribute("data-x")),l=obj.colgroup[n].getAttribute("width");return l},obj.setWidth=function(n,l,c){if(l){if(Array.isArray(n)){c||(c=[]);for(var f=0;f<n.length;f++){c[f]||(c[f]=obj.colgroup[n[f]].getAttribute("width"));var L=Array.isArray(l)&&l[f]?l[f]:l;obj.colgroup[n[f]].setAttribute("width",L),obj.options.columns[n[f]].width=L}}else c||(c=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",l),obj.options.columns[n].width=l;obj.setHistory({action:"setWidth",column:n,oldValue:c,newValue:l}),obj.dispatch("onresizecolumn",el,n,l,c),obj.updateCornerPosition()}},obj.setHeight=function(n,l,c){l>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),c||(c=obj.rows[n].getAttribute("height"))||(c=obj.rows[n].getBoundingClientRect().height),l=parseInt(l),obj.rows[n].style.height=l+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=l,obj.setHistory({action:"setHeight",row:n,oldValue:c,newValue:l}),obj.dispatch("onresizerow",el,n,l,c),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var l=[],c=0;c<obj.rows.length;c++){var f=obj.rows[c].style.height;f&&(l[c]=f)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),l=obj.rows[n].style.height;return l},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var l=0;l<obj.options.footers.length;l++){if(obj.tfoot.children[l])var c=obj.tfoot.children[l];else{c=document.createElement("tr");var f=document.createElement("td");c.appendChild(f),obj.tfoot.appendChild(c)}for(var L=0;L<obj.headers.length;L++){if(obj.options.footers[l][L]||(obj.options.footers[l][L]=""),obj.tfoot.children[l].children[L+1])f=obj.tfoot.children[l].children[L+1];else{f=document.createElement("td"),c.appendChild(f);var R=obj.options.columns[L].align?obj.options.columns[L].align:"center";f.style.textAlign=R}f.textContent=obj.parseValue(+obj.records.length+L,l,obj.options.footers[l][L]),f.style.display=obj.colgroup[L].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,l){if(obj.headers[n]){var c=obj.headers[n].textContent;l||(l=prompt(obj.options.text.columnName,c)),l&&(obj.headers[n].textContent=l,obj.headers[n].setAttribute("title",l),obj.options.columns[n].title=l),obj.setHistory({action:"setHeader",column:n,oldValue:c,newValue:l}),obj.dispatch("onchangeheader",el,n,c,l)}},obj.getHeaders=function(n){for(var l=[],c=0;c<obj.headers.length;c++)l.push(obj.getHeader(c));return n?l:l.join(obj.options.csvDelimiter)},obj.getMeta=function(n,l){return n?l?obj.options.meta[n]&&obj.options.meta[n][l]?obj.options.meta[n][l]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,l,c){if(obj.options.meta||(obj.options.meta={}),l&&c)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][l]=c;else for(var f=Object.keys(n),L=0;L<f.length;L++){obj.options.meta[f[L]]||(obj.options.meta[f[L]]={});for(var R=Object.keys(n[f[L]]),W=0;W<R.length;W++)obj.options.meta[f[L]][R[W]]=n[f[L]][R[W]]}obj.dispatch("onchangemeta",el,n,l,c)},obj.updateMeta=function(n){if(obj.options.meta){for(var l={},c=Object.keys(obj.options.meta),f=0;f<c.length;f++)n[c[f]]?l[n[c[f]]]=obj.options.meta[c[f]]:l[c[f]]=obj.options.meta[c[f]];obj.options.meta=l}},obj.getStyle=function(n,l){if(n)return n=jexcel.getIdFromColumnName(n,!0),l?obj.records[n[1]][n[0]].style[l]:obj.records[n[1]][n[0]].getAttribute("style");for(var c={},f=obj.options.data[0].length,L=obj.options.data.length,R=0;R<L;R++)for(var W=0;W<f;W++){var b=l?obj.records[R][W].style[l]:obj.records[R][W].getAttribute("style");b&&(c[jexcel.getColumnNameFromId([W,R])]=b)}return c},obj.resetStyle=function(n,l){for(var c=Object.keys(n),f=0;f<c.length;f++){var L=jexcel.getIdFromColumnName(c[f],!0);obj.records[L[1]]&&obj.records[L[1]][L[0]]&&obj.records[L[1]][L[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,l)},obj.setStyle=function(n,l,c,f,L){var R={},W={},b=function(h,C,T){var I=jexcel.getIdFromColumnName(h,!0);if(obj.records[I[1]]&&obj.records[I[1]][I[0]]&&(obj.records[I[1]][I[0]].classList.contains("readonly")==0||f)){var _=obj.records[I[1]][I[0]].style[C];_!=T||f?obj.records[I[1]][I[0]].style[C]=T:(T="",obj.records[I[1]][I[0]].style[C]=""),W[h]||(W[h]=[]),R[h]||(R[h]=[]),W[h].push([C+":"+_]),R[h].push([C+":"+T])}};if(l&&c)if(typeof n=="string")b(n,l,c);else for(var u=[],d=0;d<n.length;d++){var k=n[d].getAttribute("data-x"),P=n[d].getAttribute("data-y"),g=jexcel.getColumnNameFromId([k,P]);u[g]||(b(g,l,c),u[g]=!0)}else{var s=Object.keys(n);for(d=0;d<s.length;d++){var m=n[s[d]];typeof m=="string"&&(m=m.split(";"));for(var j=0;j<m.length;j++)typeof m[j]=="string"&&(m[j]=m[j].split(":")),m[j][0].trim()&&b(s[d],m[j][0].trim(),m[j][1])}}for(s=Object.keys(W),d=0;d<s.length;d++)W[s[d]]=W[s[d]].join(";");for(s=Object.keys(R),d=0;d<s.length;d++)R[s[d]]=R[s[d]].join(";");L||obj.setHistory({action:"setStyle",oldValue:W,newValue:R}),obj.dispatch("onchangestyle",el,n,l,c)},obj.getComments=function(n,l){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),l?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var c={},f=0;f<obj.options.data.length;f++)for(var L=0;L<obj.options.columns.length;L++){var R=obj.records[f][L].getAttribute("title");R&&(c[n=jexcel.getColumnNameFromId([L,f])]=R)}return c},obj.setComments=function(n,l,c){if(typeof n=="string")var f=jexcel.getIdFromColumnName(n,!0);else f=n;var L=obj.records[f[1]][f[0]].getAttribute("title"),R=[L,c=obj.records[f[1]][f[0]].getAttribute("data-author")];obj.records[f[1]][f[0]].setAttribute("title",l||""),obj.records[f[1]][f[0]].setAttribute("data-author",c||""),l?obj.records[f[1]][f[0]].classList.add("jexcel_comments"):obj.records[f[1]][f[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[l,c],oldValue:R}),obj.dispatch("oncomments",el,l,L,f,f[0],f[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,l){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}l=l==null?obj.headers[n].classList.contains("arrow-down")?1:0:l?1:0;var c=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var f=0;f<obj.options.data.length;f++)c[f]=[f,Number(obj.options.data[f][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(f=0;f<obj.options.data.length;f++)c[f]=[f,obj.options.data[f][n]];else for(f=0;f<obj.options.data.length;f++)c[f]=[f,obj.records[f][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(R){return function(W,b){var u=W[1],d=b[1];return R?u===""&&d!==""?1:u!==""&&d===""||u>d?-1:u<d?1:0:u===""&&d!==""?1:u!==""&&d===""?-1:u>d?1:u<d?-1:0}}),c=c.sort(obj.options.sorting(l));var L=[];for(f=0;f<c.length;f++)L[f]=c[f][0];return obj.setHistory({action:"orderBy",rows:L,column:n,order:l}),obj.updateOrderArrow(n,l),obj.updateOrder(L),obj.dispatch("onsort",el,n,l),!0}},obj.updateOrderArrow=function(n,l){for(var c=0;c<obj.headers.length;c++)obj.headers[c].classList.remove("arrow-up"),obj.headers[c].classList.remove("arrow-down");l?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var l=[],c=0;c<n.length;c++)l[c]=obj.options.data[n[c]];for(obj.options.data=l,l=[],c=0;c<n.length;c++)l[c]=obj.records[n[c]];for(obj.records=l,l=[],c=0;c<n.length;c++)l[c]=obj.rows[n[c]];if(obj.rows=l,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(c=0;c<obj.rows.length;c++)obj.tbody.appendChild(obj.rows[c])},obj.moveRow=function(n,l,c){if(Object.keys(obj.options.mergeCells).length>0){if(n>l)var f=1;else f=0;if(obj.isRowMerged(n).length||obj.isRowMerged(l,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}c||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[l])>=0?n>l?obj.tbody.insertBefore(obj.rows[n],obj.rows[l]):obj.tbody.insertBefore(obj.rows[n],obj.rows[l].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(l,0,obj.rows.splice(n,1)[0]),obj.records.splice(l,0,obj.records.splice(n,1)[0]),obj.options.data.splice(l,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:l}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,l)},obj.insertRow=function(n,l,c){if(obj.options.allowInsertRow==1){var f=[];if(n>0)var L=n;else L=1,n&&(f=n);c=!!c;var R=obj.options.data.length-1;if((l==null||l>=parseInt(R)||l<0)&&(l=R),obj.dispatch("onbeforeinsertrow",el,l,L,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var W=c?l:l+1,b=obj.records.splice(W),u=obj.options.data.splice(W),d=obj.rows.splice(W),k=[],P=[],g=[],s=W;s<L+W;s++){obj.options.data[s]=[];for(var m=0;m<obj.options.columns.length;m++)obj.options.data[s][m]=f[m]?f[m]:"";var j=obj.createRow(s,obj.options.data[s]);d[0]?Array.prototype.indexOf.call(obj.tbody.children,d[0])>=0&&obj.tbody.insertBefore(j,d[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[l])>=0&&obj.tbody.appendChild(j),k.push(obj.records[s]),P.push(obj.options.data[s]),g.push(j)}Array.prototype.push.apply(obj.records,b),Array.prototype.push.apply(obj.options.data,u),Array.prototype.push.apply(obj.rows,d),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:l,numOfRows:L,insertBefore:c,rowRecords:k,rowData:P,rowNode:g}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,l,L,k,c)}},obj.deleteRow=function(n,l){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var c=obj.getSelectedRows();c[0]?(n=parseInt(c[0].getAttribute("data-y")),l=c.length):(n=obj.options.data.length-1,l=1)}var f=obj.options.data.length-1;if((n==null||n>f||n<0)&&(n=f),l||(l=1),n+l>=obj.options.data.length&&(l=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,l)===!1)return!1;if(parseInt(n)>-1){var L=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=n;R<n+l;R++)obj.isRowMerged(R,!1).length&&(L=!0);if(L){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&f+1===l&&(l--,console.error("Jspreadsheet: It is not possible to delete the last row")),R=n;R<n+l;R++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[R])>=0&&(obj.rows[R].className="",obj.rows[R].parentNode.removeChild(obj.rows[R]));var W=obj.records.splice(n,l),b=obj.options.data.splice(n,l),u=obj.rows.splice(n,l);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+l-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:l,insertBefore:1,rowRecords:W,rowData:b,rowNode:u}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,l,W)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,l){if(Object.keys(obj.options.mergeCells).length>0){if(n>l)var c=1;else c=0;if(obj.isColMerged(n).length||obj.isColMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(l=parseInt(l))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[l]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[l]);for(var f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][l])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[l].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[l].nextSibling),f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][l].nextSibling);for(obj.options.columns.splice(l,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(l,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(l,0,obj.colgroup.splice(n,1)[0]),f=0;f<obj.rows.length;f++)obj.options.data[f].splice(l,0,obj.options.data[f].splice(n,1)[0]),obj.records[f].splice(l,0,obj.records[f].splice(n,1)[0]);if(obj.options.footers)for(f=0;f<obj.options.footers.length;f++)obj.options.footers[f].splice(l,0,obj.options.footers[f].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:l}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,l)},obj.insertColumn=function(n,l,c,f){if(obj.options.allowInsertColumn==1){var L=[];if(n>0)var R=n;else R=1,n&&(L=n);c=!!c;var W=obj.options.columns.length-1;if((l==null||l>=parseInt(W)||l<0)&&(l=W),obj.dispatch("onbeforeinsertcolumn",el,l,R,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}f||(f=[]);for(var b=0;b<R;b++)f[b]||(f[b]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var u=c?l:l+1;obj.options.columns=jexcel.injectArray(obj.options.columns,u,f);for(var d=obj.headers.splice(u),k=obj.colgroup.splice(u),P=[],g=[],s=[],m=[],j=[],h=u;h<R+u;h++)obj.createCellHeader(h),obj.headerContainer.insertBefore(obj.headers[h],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(obj.colgroup[h],obj.colgroupContainer.children[h+1]),P.push(obj.headers[h]),g.push(obj.colgroup[h]);if(obj.options.footers)for(var C=0;C<obj.options.footers.length;C++){for(j[C]=[],b=0;b<R;b++)j[C].push("");obj.options.footers[C].splice(u,0,j[C])}for(var T=0;T<obj.options.data.length;T++){var I=obj.options.data[T].splice(u),_=obj.records[T].splice(u);for(m[T]=[],s[T]=[],h=u;h<R+u;h++){var O=L[T]?L[T]:"";obj.options.data[T][h]=O;var N=obj.createCell(h,T,obj.options.data[T][h]);obj.records[T][h]=N,obj.rows[T]&&obj.rows[T].insertBefore(N,obj.rows[T].children[h+1]),m[T].push(O),s[T].push(N)}Array.prototype.push.apply(obj.options.data[T],I),Array.prototype.push.apply(obj.records[T],_)}if(Array.prototype.push.apply(obj.headers,d),Array.prototype.push.apply(obj.colgroup,k),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(C=0;C<obj.options.nestedHeaders.length;C++){var F=parseInt(obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan)+R;obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan=F,obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("colspan",F);var Z=obj.thead.children[C].children[obj.thead.children[C].children.length-1].getAttribute("data-column");for(Z=Z.split(","),h=u;h<R+u;h++)Z.push(h);obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("data-column",Z)}else F=parseInt(obj.options.nestedHeaders[0].colspan)+R,obj.options.nestedHeaders[0].colspan=F,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",F);obj.setHistory({action:"insertColumn",columnNumber:l,numOfColumns:R,insertBefore:c,columns:f,headers:P,colgroup:g,records:s,footers:j,data:m}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,l,R,s,c)}},obj.deleteColumn=function(n,l){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var c=obj.getSelectedColumns(!0);c.length?(n=parseInt(c[0]),l=parseInt(c.length)):(n=obj.headers.length-1,l=1)}var f=obj.options.data[0].length-1;if((n==null||n>f||n<0)&&(n=f),l||(l=1),l>obj.options.data[0].length-n&&(l=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,l)===!1)return!1;if(parseInt(n)>-1){var L=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=n;R<n+l;R++)obj.isColMerged(R,!1).length&&(L=!0);if(L){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var W=obj.options.columns.splice(n,l);for(R=n;R<n+l;R++)obj.colgroup[R].className="",obj.headers[R].className="",obj.colgroup[R].parentNode.removeChild(obj.colgroup[R]),obj.headers[R].parentNode.removeChild(obj.headers[R]);for(var b=obj.headers.splice(n,l),u=obj.colgroup.splice(n,l),d=[],k=[],P=[],g=0;g<obj.options.data.length;g++)for(R=n;R<n+l;R++)obj.records[g][R].className="",obj.records[g][R].parentNode.removeChild(obj.records[g][R]);for(g=0;g<obj.options.data.length;g++)k[g]=obj.options.data[g].splice(n,l),d[g]=obj.records[g].splice(n,l);if(obj.options.footers)for(g=0;g<obj.options.footers.length;g++)P[g]=obj.options.footers[g].splice(n,l);if(obj.conditionalSelectionUpdate(0,n,n+l-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var s=0;s<obj.options.nestedHeaders.length;s++){var m=parseInt(obj.options.nestedHeaders[s][obj.options.nestedHeaders[s].length-1].colspan)-l;obj.options.nestedHeaders[s][obj.options.nestedHeaders[s].length-1].colspan=m,obj.thead.children[s].children[obj.thead.children[s].children.length-1].setAttribute("colspan",m)}else m=parseInt(obj.options.nestedHeaders[0].colspan)-l,obj.options.nestedHeaders[0].colspan=m,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",m);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:l,insertBefore:1,columns:W,headers:b,colgroup:u,records:d,footers:P,data:k}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,l,d)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var l=[],c=0;c<obj.rows.length;c++)obj.rows[c].classList.contains("selected")&&(n?l.push(c):l.push(obj.rows[c]));return l},obj.getSelectedColumns=function(){for(var n=[],l=0;l<obj.headers.length;l++)obj.headers[l].classList.contains("selected")&&n.push(l);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(R=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var l=0;l<obj.rows.length;l++)obj.rows[l]&&(W=obj.rows[l].getAttribute("data-y"))!=l&&(obj.rows[l].setAttribute("data-y",l),obj.rows[l].children[0].setAttribute("data-y",l),obj.rows[l].children[0].innerHTML=l+1);var c=[],f=[],L=function(s,m,j,h){if(s!=j&&obj.records[h][j].setAttribute("data-x",j),m!=h&&obj.records[h][j].setAttribute("data-y",h),s!=j||m!=h){var C=jexcel.getColumnNameFromId([s,m]),T=jexcel.getColumnNameFromId([j,h]);c[C]=T}};for(l=0;l<obj.records.length;l++)for(n=0;n<obj.records[0].length;n++)if(obj.records[l][n]){var R=obj.records[l][n].getAttribute("data-x"),W=obj.records[l][n].getAttribute("data-y");if(obj.records[l][n].getAttribute("data-merged")){var b=jexcel.getColumnNameFromId([R,W]),u=jexcel.getColumnNameFromId([n,l]);if(f[b]==null)if(b==u)f[b]=!1;else{var d=parseInt(n-R),k=parseInt(l-W);f[b]=[u,d,k]}}else L(R,W,n,l)}var P=Object.keys(f);if(P.length){for(n=0;n<P.length;n++)if(f[P[n]]){var g=jexcel.getIdFromColumnName(P[n],!0);for(L(R=g[0],W=g[1],R+f[P[n]][1],W+f[P[n]][2]),b=P[n],u=f[P[n]][0],l=0;l<obj.options.mergeCells[b][2].length;l++)R=parseInt(obj.options.mergeCells[b][2][l].getAttribute("data-x")),W=parseInt(obj.options.mergeCells[b][2][l].getAttribute("data-y")),obj.options.mergeCells[b][2][l].setAttribute("data-x",R+f[P[n]][1]),obj.options.mergeCells[b][2][l].setAttribute("data-y",W+f[P[n]][2]);obj.options.mergeCells[u]=obj.options.mergeCells[b],delete obj.options.mergeCells[b]}}obj.updateFormulas(c),obj.updateMeta(c),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,l=obj.rows.length-1;l>=0;l--){for(var c=!1,f=0;f<obj.headers.length;f++)obj.options.data[l][f]&&(c=!0);if(c)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var L=0;for(f=obj.headers.length-1;f>=0;f--){for(c=!1,l=0;l<obj.rows.length;l++)obj.options.data[l][f]&&(c=!0);if(c)break;L++}obj.options.minSpareCols-L>0&&obj.insertColumn(obj.options.minSpareCols-L)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),l=0;l<obj.rows.length;l++)for(f=0;f<obj.headers.length;f++)obj.options.updateTable(el,obj.records[l][f],f,l,obj.options.data[l][f],obj.records[l][f].textContent,jexcel.getColumnNameFromId([f,l]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,l){(n=obj.getCell(n))&&(l?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var l=0;l<obj.options.data.length;l++)obj.records[l][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var l=0;l<obj.options.data.length;l++)obj.records[l][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,l,c){var f=jexcel.getColumnNameFromId([n,l]);if(obj.formula[f]&&obj.formula[f].length>0)if(chainLoopProtection[f])obj.records[l][n].innerHTML="#ERROR",obj.formula[f]="";else{chainLoopProtection[f]=!0;for(var L=0;L<obj.formula[f].length;L++){var R=jexcel.getIdFromColumnName(obj.formula[f][L],!0),W=""+obj.options.data[R[1]][R[0]];W.substr(0,1)=="="?c.push(obj.updateCell(R[0],R[1],W,!0)):Object.keys(obj.formula)[L]=null,obj.updateFormulaChain(R[0],R[1],c)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var l=0;l<obj.options.data.length;l++)for(var c=0;c<obj.options.data[0].length;c++)if((b=""+obj.options.data[l][c]).substr(0,1)=="="){var f=obj.updateFormula(b,n);f!=b&&(obj.options.data[l][c]=f)}var L=[],R=Object.keys(obj.formula);for(l=0;l<R.length;l++){var W=R[l],b=obj.formula[W];for(n[W]&&(W=n[W]),L[W]=[],c=0;c<b.length;c++){var u=b[c];n[u]&&(u=n[u]),L[W].push(u)}}obj.formula=L},obj.updateFormula=function(n,l){for(var c=/[A-Z]/,f=/[0-9]/,L="",R=null,W=null,b="",u=0;u<n.length;u++)c.exec(n[u])?(R=1,W=0,b+=n[u]):f.exec(n[u])?(W=R?1:0,b+=n[u]):(R&&W&&(b=l[b]?l[b]:b),L+=b,L+=n[u],R=0,W=0,b="");return b&&(R&&W&&(b=l[b]?l[b]:b),L+=b),L};var secureFormula=function(n){for(var l="",c=0,f=0;f<n.length;f++)n[f]=='"'&&(c=c==0?1:0),l+=c==1?n[f]:n[f].toUpperCase();return l};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var l=0;l<n.length;l++){var c=[],f=n[l].split(":"),L=jexcel.getIdFromColumnName(f[0],!0),R=jexcel.getIdFromColumnName(f[1],!0);if(L[0]<=R[0])var W=L[0],b=R[0];else W=R[0],b=L[0];if(L[1]<=R[1])var u=L[1],d=R[1];else u=R[1],d=L[1];for(var k=u;k<=d;k++)for(var P=W;P<=b;P++)c.push(jexcel.getColumnNameFromId([P,k]));expression=expression.replace(n[l],c.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,l){var c=l&&obj.options.columns[l].decimal?obj.options.columns[l].decimal:".",f=""+n;return(f=f.split(c))[0]=f[0].match(/[+-]?[0-9]/g),f[0]&&(f[0]=f[0].join("")),f[1]&&(f[1]=f[1].match(/[0-9]*/g).join("")),f[0]&&Number.isInteger(Number(f[0]))?f[1]?n=+(f[0]+"."+f[1]):n=+(f[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,l){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,l?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-c<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}obj.updateScroll(1)},obj.up.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(l==0){for(var L=0;L<f;L++)if(obj.records[L][c].style.display!="none"&&obj.rows[L].style.display!="none"){f=L;break}}else f=obj.up.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.up.get=function(n,l){n=parseInt(n);for(var c=(l=parseInt(l))-1;c>=0;c--)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[l][n])continue;l=c;break}return l},obj.down=function(n,l){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,l?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}obj.updateScroll(3)},obj.down.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(l==0){for(var L=obj.rows.length-1;L>f;L--)if(obj.records[L][c].style.display!="none"&&obj.rows[L].style.display!="none"){f=L;break}}else f=obj.down.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.down.get=function(n,l){n=parseInt(n);for(var c=(l=parseInt(l))+1;c<obj.rows.length;c++)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[l][n])continue;l=c;break}return l},obj.right=function(n,l){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,l?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(l==0){for(var L=obj.headers.length-1;L>c;L--)if(obj.records[f][L].style.display!="none"){c=L;break}}else c=obj.right.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.right.get=function(n,l){n=parseInt(n),l=parseInt(l);for(var c=n+1;c<obj.headers.length;c++)if(obj.records[l][c].style.display!="none"){if(obj.records[l][c].getAttribute("data-merged")&&obj.records[l][c]==obj.records[l][n])continue;n=c;break}return n},obj.left=function(n,l){n?obj.selectedCell[2]>0&&obj.left.visible(1,l?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(l==0){for(var L=0;L<c;L++)if(obj.records[f][L].style.display!="none"){c=L;break}}else c=obj.left.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.left.get=function(n,l){n=parseInt(n),l=parseInt(l);for(var c=n-1;c>=0;c--)if(obj.records[l][c].style.display!="none"){if(obj.records[l][c].getAttribute("data-merged")&&obj.records[l][c]==obj.records[l][n])continue;n=c;break}return n},obj.first=function(n,l){if(n?l?obj.selectedCell[3]=0:obj.left.visible(1,0):(l?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,l){if(n?l?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(l?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)l=obj.rows;else var l=obj.results;var c=100;n!=null&&n!=-1||(n=Math.ceil(l.length/c)-1);var f=n*c,L=n*c+c;L>l.length&&(L=l.length),(f=L-100)<0&&(f=0);for(var R=f;R<L;R++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[R]):obj.tbody.appendChild(obj.rows[l[R]]),obj.tbody.children.length>c&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var l=0;if(n.length>100){var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c>0)for(var f=0;f<30;f++)(c-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[c],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[c]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),l=1))}return l},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var l=0;if(n.length>100){var c=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c<obj.rows.length-1)for(var f=0;f<=30;f++)c<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[c]):obj.tbody.appendChild(obj.rows[n[c]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),l=1)),c+=1}return l},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,l=parseInt(obj.selectedCell[3]/100),c=parseInt(obj.rows.length/100);if(n!=l&&l<=c&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(l),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var l=function(f){obj.results.indexOf(f)==-1&&obj.results.push(f)},c=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c=new RegExp(c,"i"),obj.options.data.forEach(function(f,L){if(function(d,k,P){for(var g=0;g<d.length;g++)if((""+d[g]).toLowerCase().search(k)>=0||(""+obj.records[P][g].innerHTML).toLowerCase().search(k)>=0)return!0;return!1}(f,c,L)){var R=obj.isRowMerged(L);if(R.length)for(var W=0;W<R.length;W++)for(var b=jexcel.getIdFromColumnName(R[W],!0),u=0;u<obj.options.mergeCells[R[W]][1];u++)l(b[1]+u);else l(L)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,l=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var c=0;c<obj.rows.length;c++)!obj.results||obj.results.indexOf(c)>-1?(l<n&&(obj.tbody.appendChild(obj.rows[c]),l++),obj.rows[c].style.display=""):obj.rows[c].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var l=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)c=obj.rows;else var c=obj.results;var f=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(c.length/f)-1),obj.pageNumber=n;var L=n*f,R=n*f+f;for(R>c.length&&(R=c.length),L<0&&(L=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var W=L;W<R;W++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[W]):obj.tbody.appendChild(obj.rows[c[W]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,l)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var l=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var c=1,f=l<10?l:10;else l-obj.pageNumber<5?(f=l,(c=l-9)<1&&(c=1)):(c=obj.pageNumber-4,f=obj.pageNumber+5);c>1&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML="<",R.title=1,obj.pagination.children[1].appendChild(R));for(var L=c;L<=f;L++){var R;(R=document.createElement("div")).className="jexcel_page",R.innerHTML=L,obj.pagination.children[1].appendChild(R),obj.pageNumber==L-1&&R.classList.add("jexcel_page_selected")}f<l&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML=">",R.title=l,obj.pagination.children[1].appendChild(R)),obj.pagination.children[0].innerHTML=function(W){var b=Array.prototype.slice.call(arguments,1);return W.replace(/{(\d+)}/g,function(u,d){return b[d]!==void 0?b[d]:u})}(obj.options.text.showingPage,obj.pageNumber+1,l)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var l="";l+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var c=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(c,obj.options.csvFileName+".csv");else{var f=document.createElement("a"),L=URL.createObjectURL(c);f.href=L,f.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(f),f.click(),f.parentNode.removeChild(f)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var l=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,l+1),obj.history[l]=n}},obj.copy=function(n,l,c,f,L){l||(l="	");for(var R=new RegExp(l,"ig"),W=[],b=[],u=[],d=[],k=[],P=obj.options.data[0].length,g=obj.options.data.length,s="",m=!1,j="",h="",C=0,T=0,I=0,_=0,O=!0,N=0;N<g;N++)for(var F=0;F<P;F++)n&&!obj.records[N][F].classList.contains("highlight")||(I<=F&&(I=F),_<=N&&(_=N));if(P===I+1&&g===_+1&&(O=!1),L&&obj.options.includeHeadersOnDownload==1||!L&&obj.options.includeHeadersOnCopy==1&&!O||f){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(s=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],N=0;N<s.length;N++){var Z=[];for(F=0;F<s[N].length;F++){var q=parseInt(s[N][F].colspan);Z.push(s[N][F].title);for(var se=0;se<q-1;se++)Z.push("")}h+=Z.join(l)+`\r
`}m=!0}for(obj.style=[],N=0;N<g;N++){for(b=[],u=[],F=0;F<P;F++)if(!n||obj.records[N][F].classList.contains("highlight")){m==1&&W.push(obj.headers[F].textContent);var ge=obj.options.data[N][F];if(ge.match&&(ge.match(R)||ge.match(/,/g)||ge.match(/\n/)||ge.match(/\"/))&&(ge='"'+(ge=ge.replace(new RegExp('"',"g"),'""'))+'"'),b.push(ge),obj.options.columns[F].type=="checkbox"||obj.options.columns[F].type=="radio")var ae=ge;else(ae=obj.options.stripHTMLOnCopy==1?obj.records[N][F].textContent:obj.records[N][F].innerHTML).match&&(ae.match(R)||ae.match(/,/g)||ae.match(/\n/)||ae.match(/\"/))&&(ae='"'+(ae=ae.replace(new RegExp('"',"g"),'""'))+'"');u.push(ae),s=(s=obj.records[N][F].getAttribute("style")).replace("display: none;",""),obj.style.push(s||"")}b.length&&(m&&(C=b.length,d.push(W.join(l))),d.push(b.join(l))),u.length&&(T++,m&&(k.push(W.join(l)),m=!1),k.push(u.join(l)))}P==C&&g==T&&(j=h);var me=j+d.join(`\r
`),Le=j+k.join(`\r
`);if(c||(obj.options.copyCompatibility==1?obj.textarea.value=Le:obj.textarea.value=me,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Le:obj.data=me,obj.hashString=obj.hash(obj.data),!c){if(obj.removeCopyingSelection(),obj.highlighted)for(F=0;F<obj.highlighted.length;F++)obj.highlighted[F].classList.add("copying"),obj.highlighted[F].classList.contains("highlight-left")&&obj.highlighted[F].classList.add("copying-left"),obj.highlighted[F].classList.contains("highlight-right")&&obj.highlighted[F].classList.add("copying-right"),obj.highlighted[F].classList.contains("highlight-top")&&obj.highlighted[F].classList.add("copying-top"),obj.highlighted[F].classList.contains("highlight-bottom")&&obj.highlighted[F].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?k:d,obj.hashString)}return obj.data},obj.paste=function(n,l,c){var f=parseInt(n),L=parseInt(l),R=parseInt(obj.selectedCell[2]),W=parseInt(obj.selectedCell[3]),b=R-f+1,u=W-L+1;R<f&&(n=R.toString(),b=f-R+1),W<L&&(l=W.toString(),u=L-W+1);var d=obj.dispatch("onbeforepaste",el,c,n,l);if(d===!1)return!1;d&&(c=d);var k=obj.hash(c),P=k==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&k==obj.hashString&&(c=obj.data),c=obj.parseCSV(c,"	"),b>1&Number.isInteger(b/c[0].length)){P=null,s=b/c[0].length;var g=c.map(function(q,se){var ge=Array.apply(null,{length:s*q.length}).map(function(ae,me){return q[me%q.length]});return ge});c=g}if(u>1&Number.isInteger(u/c.length)){P=null;var s=u/c.length;g=Array.apply(null,{length:s*c.length}).map(function(q,se){return c[se%c.length]}),c=g}if(n!=null&&l!=null&&c){for(var m=0,j=0,h=[],C={},T={},I=0,_=parseInt(n),O=parseInt(l),N=null;N=c[j];){for(m=0,_=parseInt(n);N[m]!=null;){var F=obj.updateCell(_,O,N[m]);if(h.push(F),obj.updateFormulaChain(_,O,h),P&&P[I]){var Z=jexcel.getColumnNameFromId([_,O]);C[Z]=P[I],T[Z]=obj.getStyle(Z),obj.records[O][_].setAttribute("style",P[I]),I++}if(N[++m]!=null){if(_>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}_=obj.right.get(_,O)}}if(j++,c[j]){if(O>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}O=obj.down.get(n,O)}}obj.updateSelectionFromCoords(n,l,_,O),obj.setHistory({action:"setValue",records:h,selection:obj.selectedCell,newStyle:C,oldStyle:T}),obj.updateTable(),obj.dispatch("onpaste",el,c),obj.onafterchanges(el,h)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),l=0;l<n.length;l++)n[l].classList.remove("copying"),n[l].classList.remove("copying-left"),n[l].classList.remove("copying-right"),n[l].classList.remove("copying-top"),n[l].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,l){var c=l.insertBefore?+l.rowNumber:l.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var f=l.numOfRows,L=c;L<f+c;L++)obj.rows[L].parentNode.removeChild(obj.rows[L]);obj.records.splice(c,f),obj.options.data.splice(c,f),obj.rows.splice(c,f),obj.conditionalSelectionUpdate(1,c,f+c-1)}else{obj.records=jexcel.injectArray(obj.records,c,l.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,c,l.rowData),obj.rows=jexcel.injectArray(obj.rows,c,l.rowNode);var R=0;for(L=c;L<l.numOfRows+c;L++)obj.tbody.insertBefore(l.rowNode[R],obj.tbody.children[L]),R++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,l){var c=l.insertBefore?l.columnNumber:l.columnNumber+1;if(n==1){var f=l.numOfColumns;obj.options.columns.splice(c,f);for(var L=c;L<f+c;L++)obj.headers[L].parentNode.removeChild(obj.headers[L]),obj.colgroup[L].parentNode.removeChild(obj.colgroup[L]);obj.headers.splice(c,f),obj.colgroup.splice(c,f);for(var R=0;R<l.data.length;R++){for(L=c;L<f+c;L++)obj.records[R][L].parentNode.removeChild(obj.records[R][L]);obj.records[R].splice(c,f),obj.options.data[R].splice(c,f)}if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R].splice(c,f)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,c,l.columns),obj.headers=jexcel.injectArray(obj.headers,c,l.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,c,l.colgroup);var W=0;for(L=c;L<l.numOfColumns+c;L++)obj.headerContainer.insertBefore(l.headers[W],obj.headerContainer.children[L+1]),obj.colgroupContainer.insertBefore(l.colgroup[W],obj.colgroupContainer.children[L+1]),W++;for(R=0;R<l.data.length;R++)for(obj.options.data[R]=jexcel.injectArray(obj.options.data[R],c,l.data[R]),obj.records[R]=jexcel.injectArray(obj.records[R],c,l.records[R]),W=0,L=c;L<l.numOfColumns+c;L++)obj.rows[R].insertBefore(l.records[R][W],obj.rows[R].children[L+1]),W++;if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R]=jexcel.injectArray(obj.options.footers[R],c,l.footers[R])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(R=0;R<obj.options.nestedHeaders.length;R++){if(n==1)var b=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)-l.numOfColumns;else b=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)+l.numOfColumns;obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan=b,obj.thead.children[R].children[obj.thead.children[R].children.length-1].setAttribute("colspan",b)}else b=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-l.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+l.numOfColumns,obj.options.nestedHeaders[0].colspan=b,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",b);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,l=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var c=[];if(obj.historyIndex>=0){var f=obj.history[obj.historyIndex--];if(f.action=="insertRow")obj.historyProcessRow(1,f);else if(f.action=="deleteRow")obj.historyProcessRow(0,f);else if(f.action=="insertColumn")obj.historyProcessColumn(1,f);else if(f.action=="deleteColumn")obj.historyProcessColumn(0,f);else if(f.action=="moveRow")obj.moveRow(f.newValue,f.oldValue);else if(f.action=="moveColumn")obj.moveColumn(f.newValue,f.oldValue);else if(f.action=="setMerge")obj.removeMerge(f.column,f.data);else if(f.action=="setStyle")obj.setStyle(f.oldValue,null,null,1);else if(f.action=="setWidth")obj.setWidth(f.column,f.oldValue);else if(f.action=="setHeight")obj.setHeight(f.row,f.oldValue);else if(f.action=="setHeader")obj.setHeader(f.column,f.oldValue);else if(f.action=="setComments")obj.setComments(f.column,f.oldValue[0],f.oldValue[1]);else if(f.action=="orderBy"){for(var L=[],R=0;R<f.rows.length;R++)L[f.rows[R]]=R;obj.updateOrderArrow(f.column,f.order?0:1),obj.updateOrder(L)}else if(f.action=="setValue"){for(var W=0;W<f.records.length;W++)c.push({x:f.records[W].x,y:f.records[W].y,newValue:f.records[W].oldValue}),f.oldStyle&&obj.resetStyle(f.oldStyle);obj.setValue(c),f.selection&&obj.updateSelectionFromCoords(f.selection[0],f.selection[1],f.selection[2],f.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=l,obj.dispatch("onundo",el,f)},obj.redo=function(){var n=!!obj.ignoreEvents,l=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var c=obj.history[++obj.historyIndex];if(c.action=="insertRow")obj.historyProcessRow(0,c);else if(c.action=="deleteRow")obj.historyProcessRow(1,c);else if(c.action=="insertColumn")obj.historyProcessColumn(0,c);else if(c.action=="deleteColumn")obj.historyProcessColumn(1,c);else if(c.action=="moveRow")obj.moveRow(c.oldValue,c.newValue);else if(c.action=="moveColumn")obj.moveColumn(c.oldValue,c.newValue);else if(c.action=="setMerge")obj.setMerge(c.column,c.colspan,c.rowspan,1);else if(c.action=="setStyle")obj.setStyle(c.newValue,null,null,1);else if(c.action=="setWidth")obj.setWidth(c.column,c.newValue);else if(c.action=="setHeight")obj.setHeight(c.row,c.newValue);else if(c.action=="setHeader")obj.setHeader(c.column,c.newValue);else if(c.action=="setComments")obj.setComments(c.column,c.newValue[0],c.newValue[1]);else if(c.action=="orderBy")obj.updateOrderArrow(c.column,c.order),obj.updateOrder(c.rows);else if(c.action=="setValue"){obj.setValue(c.records);for(var f=0;f<c.records.length;f++)c.oldStyle&&obj.resetStyle(c.newStyle);c.selection&&obj.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=l,obj.dispatch("onredo",el,c)},obj.getDropDownValue=function(n,l){var c=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var f=[],L=obj.options.columns[n].source,R=0;R<L.length;R++)typeof L[R]=="object"?f[L[R].id]=L[R].name:f[L[R]]=L[R];var W=Array.isArray(l)?l:(""+l).split(";");for(R=0;R<W.length;R++)typeof W[R]=="object"?c.push(f[W[R].id]):f[W[R]]&&c.push(f[W[R]])}else console.error("Invalid column");return c.length>0?c.join("; "):""},obj.parseCSV=function(n,l){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),l=l||",";for(var c=[],f=!1,L=0,R=0,W=0;W<n.length;W++){var b=n[W],u=n[W+1];c[L]=c[L]||[],c[L][R]=c[L][R]||"",b=='"'&&f&&u=='"'?(c[L][R]+=b,++W):b!='"'?b!=l||f?b!="\r"||u!=`
`||f?b==`
`&&!f||b=="\r"&&!f?(++L,R=0):c[L][R]+=b:(++L,R=0,++W):++R:f=!f}return c},obj.hash=function(n){var l,c=0;if(n.length===0)return c;for(l=0;l<n.length;l++)c=(c<<5)-c+n.charCodeAt(l),c|=0;return c},obj.onafterchanges=function(n,l){obj.dispatch("onafterchanges",n,l)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var l=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&l.length>0)for(var c=l.shift(),f=0;f<c.length;f++)obj.options.columns[f]||(obj.options.columns[f]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[f].title===void 0&&(obj.options.columns[f].title=c[f]);obj.options.data=l,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,l,c,f){var L=[];if(c==null)obj.options.allowInsertColumn==1&&L.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(l),1)}}),obj.options.allowInsertColumn==1&&L.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(l),0)}}),obj.options.allowDeleteColumn==1&&L.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(l))}}),obj.options.allowRenameColumn==1&&L.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(l)}}),obj.options.columnSorting==1&&(L.push({type:"line"}),L.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(l,0)}}),L.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(l,1)}}));else if(obj.options.allowInsertRow==1&&(L.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(c),1)}}),L.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(c))}})),obj.options.allowDeleteRow==1&&L.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(c))}}),l&&obj.options.allowComments==1){L.push({type:"line"});var R=obj.records[c][l].getAttribute("title")||"";L.push({title:R?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var W=prompt(obj.options.text.comments,R);W&&obj.setComments([l,c],W)}}),R&&L.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([l,c],"")}})}return L.push({type:"line"}),L.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&L.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(W){W&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],W)})}}),obj.options.allowExport&&L.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&L.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),L},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var l=0;l<obj.options.freezeColumns;l++)n+=parseInt(obj.options.columns[l].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var l=0;l<obj.options.freezeColumns;l++){l>0&&obj.options.columns[l-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[l-1].width)),obj.headers[l].classList.add("jexcel_freezed"),obj.headers[l].style.left=n+"px";for(var c=0;c<obj.rows.length;c++)if(obj.rows[c]&&obj.records[c][l]){var f=scrollLeft+(l>0?obj.records[c][l-1].style.width:0)-51+"px";obj.records[c][l].classList.add("jexcel_freezed"),obj.records[c][l].style.left=f}}else for(l=0;l<obj.options.freezeColumns;l++)for(obj.headers[l].classList.remove("jexcel_freezed"),obj.headers[l].style.left="",c=0;c<obj.rows.length;c++)obj.records[c][l]&&(obj.records[c][l].classList.remove("jexcel_freezed"),obj.records[c][l].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var l=Object.keys(n),c=0;c<l.length;c++)typeof n[l[c]]=="function"&&(jexcel[l[c]]=n[l[c]],jexcel.license&&typeof n[l[c]].license=="function"&&n[l[c]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,l){if(n.jexcel){var c=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",l&&(destroyEvents(c),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var l=jexcel.current.edition[0].children[0],c=jexcel.current.edition[0].children[0].value,f=l.selectionStart;c=c.slice(0,f)+`
`+c.slice(f),l.value=c,l.focus(),l.selectionStart=f+1,l.selectionEnd=f+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46||n.which==8)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var L=jexcel.current.selectedCell[1],R=jexcel.current.selectedCell[0];jexcel.current.options.columns[R].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[R].type=="checkbox"||jexcel.current.options.columns[R].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[L][R],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[L][R],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[L][R],!0),jexcel.current.options.columns[R].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;var c=jexcel.getElement(n.target);if(c[0]?jexcel.current!=c[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=c[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&l==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(c[1]==1){if(s=n.target.getAttribute("data-x")){var f=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&f.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:s,width:f.width},jexcel.current.headers[s].classList.add("resizing");for(var L=0;L<jexcel.current.records.length;L++)jexcel.current.records[L][s]&&jexcel.current.records[L][s].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&f.height-n.offsetY<6)if(jexcel.current.isColMerged(s).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:s,destination:s},jexcel.current.headers[s].classList.add("dragging"),L=0;L<jexcel.current.records.length;L++)jexcel.current.records[L][s]&&jexcel.current.records[L][s].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var R=jexcel.current.selectedHeader,W=s;else jexcel.current.selectedHeader==s&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(s)},800)),jexcel.current.selectedHeader=s,R=s,W=s;jexcel.current.updateSelectionFromCoords(R,0,W,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var b=n.target.getAttribute("data-column").split(","),u=parseInt(b[0]),d=parseInt(b[b.length-1]);else u=0,d=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(u,0,d,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(c[1]==2){var k=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))f=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&f.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:k,height:f.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&f.width-n.offsetX<6?jexcel.current.isRowMerged(k).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:k,destination:k},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(R=jexcel.current.selectedRow,W=k):(jexcel.current.selectedRow=k,R=k,W=k),jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,W));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var P=function(m){var j=m.getAttribute("data-x"),h=m.getAttribute("data-y");return j&&h?[j,h]:m.parentNode?P(m.parentNode):void 0},g=P(n.target);if(g){var s=g[0];k=g[1],jexcel.current.edition&&(jexcel.current.edition[2]==s&&jexcel.current.edition[3]==k||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],s,k):jexcel.current.updateSelectionFromCoords(s,k)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var l=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),c=jexcel.current.getSelectedColumns();if(c.length>1){for(var f=[],L=0;L<c.length;L++)f.push(parseInt(jexcel.current.colgroup[c[L]].getAttribute("width")));f[c.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(c,l,f)}else jexcel.current.setWidth(jexcel.current.resizing.column,l,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var R=0;R<jexcel.current.records.length;R++)jexcel.current.records[R][jexcel.current.resizing.column]&&jexcel.current.records[R][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var W=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,W,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var b=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),R=0;R<jexcel.current.rows.length;R++)jexcel.current.records[R][jexcel.current.dragging.column]&&jexcel.current.records[R][jexcel.current.dragging.column].classList.remove("dragging");for(L=0;L<jexcel.current.headers.length;L++)jexcel.current.headers[L].classList.remove("dragging-left"),jexcel.current.headers[L].classList.remove("dragging-right");b&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var u=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<u&&(u-=1)}else u=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,u,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;if(l||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var c=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+c>0){var f=jexcel.current.resizing.width+c;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",f),jexcel.current.updateCornerPosition()}}else{var L=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+L>0){var R=jexcel.current.resizing.height+L;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",R),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var W=n.target.getAttribute("data-x");if(W)if(jexcel.current.isColMerged(W).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var b=0;b<jexcel.current.headers.length;b++)jexcel.current.headers[b].classList.remove("dragging-left"),jexcel.current.headers[b].classList.remove("dragging-right");jexcel.current.dragging.column==W?jexcel.current.dragging.destination=parseInt(W):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<W?jexcel.current.dragging.destination=parseInt(W)-1:jexcel.current.dragging.destination=parseInt(W),jexcel.current.headers[W].classList.add("dragging-left")):(jexcel.current.dragging.column<W?jexcel.current.dragging.destination=parseInt(W):jexcel.current.dragging.destination=parseInt(W)+1,jexcel.current.headers[W].classList.add("dragging-right"))}}else{var u=n.target.getAttribute("data-y");if(u)if(jexcel.current.isRowMerged(u).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var d=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=d&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,d),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var k=n.target.getAttribute("data-x"),P=n.target.getAttribute("data-y"),g=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&k&&!P&&g.width-(n.clientX-g.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!k&&P&&g.height-(n.clientY-g.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!k&&P&&g.width-(n.clientX-g.left)<6||n.target&&k&&!P&&g.height-(n.clientY-g.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;if(l||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var c=jexcel.getElement(n.target);if(c[0]){if(jexcel.current!=c[0].jexcel&&jexcel.current)return!1;var f=n.target.getAttribute("data-x"),L=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(c[1]==1&&jexcel.current.selectedHeader){f=n.target.getAttribute("data-x");var R=jexcel.current.selectedHeader,W=f;jexcel.current.updateSelectionFromCoords(R,0,W,jexcel.current.options.data.length-1)}c[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(R=jexcel.current.selectedRow,W=L,jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,W)):jexcel.current.edition||f&&L&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(f,L):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,L)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var l=jexcel.current.highlighted[0].getAttribute("data-x"),c=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,f=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),L=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[c][l],jexcel.current.records[L][f])}}else if(n.target.classList.contains("jexcel_column_filter")){var R=n.target.getAttribute("data-x");jexcel.current.openFilter(R)}else{var W=jexcel.getElement(n.target);if(W[1]==1&&jexcel.current.options.columnSorting==1&&(R=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(R),W[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var b=function(d){if(d.parentNode){var k=d.getAttribute("data-x"),P=d.getAttribute("data-y");return k&&P?d:b(d.parentNode)}},u=b(n.target);u&&u.classList.contains("highlight")&&jexcel.current.openEditor(u)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var l=n.target.getAttribute("data-x"),c=n.target.getAttribute("data-y");if(l||c){(l<parseInt(jexcel.current.selectedCell[0])||l>parseInt(jexcel.current.selectedCell[2])||c<parseInt(jexcel.current.selectedCell[1])||c>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(l,c,l,c);var f=jexcel.current.options.contextMenu(jexcel.current,l,c,n);jexcel.current.contextMenu.contextmenu.open(n,f),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var l=jexcel.getElement(n.target);if(l[0]?jexcel.current!=l[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=l[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var c=n.target.getAttribute("data-x"),f=n.target.getAttribute("data-y");c&&f&&(jexcel.current.updateSelectionFromCoords(c,f),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[c].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,l){var c=[];if(n.classList.contains("jexcel_tabs"))L=n.children[0],R=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var f=document.createElement("div"),L=n.appendChild(f),R=(f=document.createElement("div"),n.appendChild(f))}for(var W=[],b=[],u=0;u<l.length;u++){W[u]=document.createElement("div"),W[u].classList.add("jexcel_tab");var d=jexcel(W[u],l[u]);R.appendChild(W[u]),c[u]=n.jexcel.push(d),b[u]=document.createElement("div"),b[u].classList.add("jexcel_tab_link"),b[u].setAttribute("data-spreadsheet",n.jexcel.length-1),b[u].innerHTML=l[u].sheetName,b[u].onclick=function(){for(var P=0;P<L.children.length;P++)L.children[P].classList.remove("selected"),R.children[P].style.display="none";var g=this.getAttribute("data-spreadsheet");R.children[g].style.display="block",L.children[g].classList.add("selected")},L.appendChild(b[u])}for(var k=0;k<L.children.length;k++)L.children[k].classList.remove("selected"),R.children[k].style.display="none";return L.children[L.children.length-1].classList.add("selected"),R.children[L.children.length-1].style.display="block",c},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,l){var c,f=function(L){var R=[];return L.SheetNames.forEach(function(W){var b={rows:[],columns:[],data:[],style:{}};if(b.sheetName=W,(h=L.Sheets[W]["!cols"])&&h.length)for(var u=0;u<h.length;u++)b.columns[u]={},h[u]&&h[u].wpx&&(b.columns[u].width=h[u].wpx+"px");if((h=L.Sheets[W]["!rows"])&&h.length)for(u=0;u<h.length;u++)h[u]&&h[u].hpx&&(b.rows[u]={},b.rows[u].height=h[u].hpx+"px");if((h=L.Sheets[W]["!merges"])&&h.length>0)for(b.mergeCells=[],u=0;u<h.length;u++){var d=h[u].s.c,k=h[u].s.r,P=h[u].e.c,g=h[u].e.r,s=jexcel.getColumnNameFromId([d,k]);b.mergeCells[s]=[P-d+1,g-k+1]}var m=0,j=0,h=Object.keys(L.Sheets[W]);for(u=0;u<h.length;u++)if(h[u].substr(0,1)!="!"){var C=L.Sheets[W][h[u]],T=jexcel.getIdFromColumnName(h[u],!0);b.data[T[1]]||(b.data[T[1]]=[]),b.data[T[1]][T[0]]=C.f?"="+C.f:C.w,m<T[0]&&(m=T[0]),j<T[1]&&(j=T[1]),C.style&&Object.keys(C.style).length>0&&(b.style[h[u]]=C.style),C.s&&C.s.fgColor&&(b.style[h[u]]&&(b.style[h[u]]+=";"),b.style[h[u]]+="background-color:#"+C.s.fgColor.rgb)}for(var I=b.columns,_=0;_<=j;_++)for(u=0;u<=m;u++)b.data[_]||(b.data[_]=[]),b.data[_][u]||I<u&&(b.data[_][u]="");R.push(b)}),R};(c=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array<"u"?(c.responseType="arraybuffer",c.onload=function(L){var R=c.response,W=new Uint8Array(R),b=XLSX.read(W,{type:"array",cellFormula:!0,cellStyles:!0});l(f(b))}):(c.setRequestHeader("Accept-Charset","x-user-defined"),c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var L=convertResponseBodyToText(c.responseBody),R=XLSX.read(L,{type:"binary",cellFormula:!0,cellStyles:!0});l(f(R))}}),c.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,l,c){return n.slice(0,l).concat(c).concat(n.slice(l))},jexcel.getColumnName=function(n){return jexcel.helpers.getColumnName(n)},jexcel.getIdFromColumnName=function(n,l){var c=/^[a-zA-Z]+/.exec(n);if(c){for(var f=0,L=0;L<c[0].length;L++)f+=parseInt(c[0].charCodeAt(L)-64)*Math.pow(26,c[0].length-1-L);--f<0&&(f=0);var R=parseInt(/[0-9]+$/.exec(n));R>0&&R--,n=l==1?[f,R]:f+"-"+R}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var l=0,c=0;return function f(L){L.className&&L.classList.contains("jexcel_container")&&(c=L),L.tagName=="THEAD"?l=1:L.tagName=="TBODY"&&(l=2),L.parentNode&&(c||f(L.parentNode))}(n),[c,l]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,l){if(n.tagName=="TABLE"){l||(l={}),l.columns=[],l.data=[];var c=n.querySelectorAll("colgroup > col");if(c.length)for(var f=0;f<c.length;f++){if(!(L=c[f].style.width))var L=c[f].getAttribute("width");L&&(l.columns[f]||(l.columns[f]={}),l.columns[f].width=L)}var R=function(me){var Le=me.getBoundingClientRect(),je=Le.width>50?Le.width:50;l.columns[f]||(l.columns[f]={}),me.getAttribute("data-celltype")?l.columns[f].type=me.getAttribute("data-celltype"):l.columns[f].type="text",l.columns[f].width=je+"px",l.columns[f].title=me.innerHTML,l.columns[f].align=me.style.textAlign||"center",(Le=me.getAttribute("name"))&&(l.columns[f].name=Le),(Le=me.getAttribute("id"))&&(l.columns[f].id=Le),(Le=me.getAttribute("data-mask"))&&(l.columns[f].mask=Le)},W=[],b=n.querySelectorAll(":scope > thead > tr");if(b.length){for(var u=0;u<b.length-1;u++){var d=[];for(f=0;f<b[u].children.length;f++){var k={title:b[u].children[f].textContent,colspan:b[u].children[f].getAttribute("colspan")||1};d.push(k)}W.push(d)}for(b=b[b.length-1].children,f=0;f<b.length;f++)R(b[f])}var P=0,g={},s={},m={},j={},h=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(u=0;u<h.length;u++)if(l.data[P]=[],l.parseTableFirstRowAsHeader!=1||b.length||u!=0){for(f=0;f<h[u].children.length;f++){if(C=h[u].children[f].getAttribute("data-formula"))C.substr(0,1)!="="&&(C="="+C);else var C=h[u].children[f].innerHTML;l.data[P].push(C);var T=jexcel.getColumnNameFromId([f,u]),I=h[u].children[f].getAttribute("class");I&&(j[T]=I);var _=parseInt(h[u].children[f].getAttribute("colspan"))||0,O=parseInt(h[u].children[f].getAttribute("rowspan"))||0;(_||O)&&(g[T]=[_||1,O||1]),h[u].children[f].style&&h[u].children[f].style.display=="none"&&(h[u].children[f].style.display="");var N=h[u].children[f].getAttribute("style");N&&(m[T]=N),h[u].children[f].classList.contains("styleBold")&&(m[T]?m[T]+="; font-weight:bold;":m[T]="font-weight:bold;")}h[u].style&&h[u].style.height&&(s[u]={height:h[u].style.height}),P++}else for(f=0;f<h[u].children.length;f++)R(h[u].children[f]);if(Object.keys(W).length>0&&(l.nestedHeaders=W),Object.keys(m).length>0&&(l.style=m),Object.keys(g).length>0&&(l.mergeCells=g),Object.keys(s).length>0&&(l.rows=s),Object.keys(j).length>0&&(l.classes=j),(h=n.querySelectorAll("tfoot tr")).length){var F=[];for(u=0;u<h.length;u++){var Z=[];for(f=0;f<h[u].children.length;f++)Z.push(h[u].children[f].textContent);F.push(Z)}Object.keys(F).length>0&&(l.footers=F)}if(l.parseTableAutoCellType==1){var q=[];for(f=0;f<l.columns.length;f++){var se=!0,ge=!0;for(q[f]=[],u=0;u<l.data.length;u++)C=l.data[u][f],q[f][C]||(q[f][C]=0),q[f][C]++,C.length>25&&(se=!1),C.length==10&&C.substr(4,1)=="-"&&C.substr(7,1)=="-"||(ge=!1);var ae=Object.keys(q[f]).length;ge?l.columns[f].type="calendar":se==1&&ae>1&&ae<=parseInt(.1*l.data.length)&&(l.columns[f].type="dropdown",l.columns[f].source=Object.keys(q[f]))}}return l}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var l=this.config.root;else l=window;var c=0,f=l.getSelection();if(f&&f.rangeCount!==0){var L=f.getRangeAt(0),R=L.cloneRange();R.selectNodeContents(n),R.setEnd(L.endContainer,L.endOffset),c=R.toString().length}return c},invert:function(n){for(var l=[],c=Object.keys(n),f=0;f<c.length;f++)l[n[c[f]]]=c[f];return l},getColumnName:function(n){let l,c=n+1,f="";for(;c>0;)l=(c-1)%26,f=String.fromCharCode(65+l).toString()+f,c=parseInt((c-l)/26);return f},getColumnNameFromCoords:function(n,l){return component.getColumnName(parseInt(n))+(parseInt(l)+1)},getCoordsFromColumnName:function(n){var l=/^[a-zA-Z]+/.exec(n);if(l){for(var c=0,f=0;f<l[0].length;f++)c+=parseInt(l[0].charCodeAt(f)-64)*Math.pow(26,l[0].length-1-f);--c<0&&(c=0);var L=parseInt(/[0-9]+$/.exec(n))||null;return L>0&&L--,[c,L]}},createFromTable:function(){},injectArray:function(n,l,c){return n.slice(0,l).concat(c).concat(n.slice(l))},parseCSV:function(n,l){l=l||",";for(var c=0,f=0,L=[[]],R=0,W=null,b=!1,u=!1,d=0;d<n.length;d++)if(L[f]||(L[f]=[]),L[f][c]||(L[f][c]=""),n[d]!="\r")if(n[d]!=`
`&&n[d]!=l||b!=0&&u!=1&&W){if(n[d]=='"'&&(b=!b),W===null){if((W=b)==1)continue}else if(W===!0&&!u&&n[d]=='"'){n[d+1]=='"'?(b=!0,L[f][c]+=n[d],d++):u=!0;continue}L[f][c]+=n[d]}else{if(W=null,b=!1,u=!1,L[f][c][0]=='"'){var k=L[f][c].trim();k[k.length-1]=='"'&&(L[f][c]=k.substr(1,k.length-2))}n[d]==`
`?(c=0,f++):++c>R&&(R=c)}for(var P=0;P<L.length;P++)for(d=0;d<=R;d++)L[P][d]===void 0&&(L[P][d]="");return L}},component),typeof jQuery<"u"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(l){var c=n(this).get(0);return c.jexcel?Array.isArray(c.jexcel)?c.jexcel[l][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):c.jexcel[l].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(n){var l=__webpack_module_cache__[n];if(l!==void 0)return l.exports;var c=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(c.exports,c,c.exports,__webpack_require__),c.exports}var __webpack_exports__=__webpack_require__(44);jspreadsheet=__webpack_exports__}(),jspreadsheet})}(dist$1)),dist$1.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs(distExports);export{jspreadsheet as j};
