import{u as S,r as f,G as O,d as R,c as k,f as b,g as M,h as U,k as d,j as o,D as H,l as y,i as u,t as I,V as F,m as v,H as P,x as A,o as L}from"./app-deaa25d8.js";/* empty css                   */import{f as $}from"./format-45c98358.js";const q={class:"h-full w-full text-center content-center"},z={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},J={class:"grid grid-cols-2 md:grid-cols-3 gap-3 items-end"},K={__name:"EditGraphicTimesModal",props:["params"],setup(w){const{init:_}=S(),t=w,p=f(!1),h=f([]),V=f([]),T=O("onupdated"),l=R({GraphicId:"",ChangeId:"",Name:"",StartTime:"",EndTime:null,id:t.params.data.id}),{t:r}=k();function x(c){const[s,e,a]=c.split(":"),m=new Date;return m.setHours(parseInt(s,10)),m.setMinutes(parseInt(e,10)),m.setSeconds(parseInt(a,10)),m}function n(c){return c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}const C={StartTime:"08:00:00.0000000",EndTime:"08:05:00.0000000"},D=x(C.StartTime),E=x(C.EndTime);n(D),n(E);const G=async()=>{try{const c=await v.get("/graphics"),s=await v.get("/changes");h.value=c.data.map(a=>({value:a.id,text:a.Name})),V.value=s.data.map(a=>({value:a.Change,text:a.Change}));const e=await v.get(`graphictimes/${t.params.data.id}`);l.GraphicId=+e.data.Gid,l.ChangeId=+e.data.Chid}catch(c){console.error("Error fetching data:",c)}},N=async()=>{try{const{data:c}=await v.put("/graphictimes",l);c.status===200?(p.value=!1,T(t.params.node,c.unit),_({message:r("login.successMessage"),color:"success"})):console.error("Error saving data:",c.message)}catch(c){console.error("Error saving data:",c)}};return(c,s)=>{const e=b("VaSelect"),a=b("VaTimeInput"),m=b("VaModal");return M(),U("main",q,[d(o(H),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:s[0]||(s[0]=i=>p.value=!0)}),d(m,{modelValue:p.value,"onUpdate:modelValue":s[6]||(s[6]=i=>p.value=i),"ok-text":o(r)("modals.apply"),"cancel-text":o(r)("modals.cancel"),onOk:N,onClose:s[7]||(s[7]=i=>p.value=!1),"close-button":""},{default:y(()=>[u("h3",{class:"va-h3",onVnodeMounted:G},I(o(r)("modals.editFactory")),513),u("div",null,[d(o(F),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:y(()=>[u("div",z,[d(e,{modelValue:l.GraphicId,"onUpdate:modelValue":s[1]||(s[1]=i=>l.GraphicId=i),"value-by":"value",class:"mb-6",label:o(r)("form.selectGraphic"),options:h.value,clearable:""},null,8,["modelValue","label","options"]),d(e,{modelValue:l.ChangeId,"onUpdate:modelValue":s[2]||(s[2]=i=>l.ChangeId=i),"value-by":"value",class:"mb-6",label:o(r)("form.selectChange"),options:V.value,clearable:""},null,8,["modelValue","label","options"])]),u("div",J,[d(a,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(r)("form.name"),modelValue:l.Name,"onUpdate:modelValue":s[3]||(s[3]=i=>l.Name=i)},null,8,["label","modelValue"]),d(a,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(r)("form.startTime"),modelValue:l.Name,"onUpdate:modelValue":s[4]||(s[4]=i=>l.Name=i)},null,8,["label","modelValue"]),d(a,{modelValue:l.EndTime,"onUpdate:modelValue":s[5]||(s[5]=i=>l.EndTime=i),clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(r)("form.endTime")},null,8,["modelValue","label"])])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},Q={class:"h-full w-full text-center content-center"},W={class:"va-h3"},X={__name:"DeleteGraphicTimesModal",props:["params"],setup(w){const{init:_}=S(),{t}=k(),p=f(!1),h=w,V=O("ondeleted"),T=async()=>{try{const{data:l}=await v.delete(`/graphictimes/${h.params.data.id}`);l.status===200?(V(h.params.data),_({message:t("login.successMessage"),color:"success"}),p.value=!1):console.error("Error deleting data:",l.message)}catch(l){console.error("Error deleting data:",l)}};return(l,r)=>{const x=b("VaModal");return M(),U("main",Q,[d(o(H),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:r[0]||(r[0]=n=>p.value=!0)}),d(x,{modelValue:p.value,"onUpdate:modelValue":r[1]||(r[1]=n=>p.value=n),"ok-text":o(t)("modals.apply"),"cancel-text":o(t)("modals.cancel"),onClose:r[2]||(r[2]=n=>p.value=!1),onOk:T,"close-button":""},{default:y(()=>[u("h3",W,I(o(t)("modals.title")),1),u("p",null,I(o(t)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}};const Y={class:"grid grid-rows-[55px,1fr]"},Z={class:"flex justify-between"},ee=u("span",{class:"flex w-full"},null,-1),ae={class:"va-h3"},te={class:"grid grid-cols-1 md:grid-cols-1 gap-1 items-end w-full"},le={class:"grid grid-cols-2 md:grid-cols-3 gap-3 items-end"},oe={class:"flex-grow"},de={__name:"GraphicTimesPage",props:{id:Number},setup(w){const{locale:_,t}=k(),{init:p}=S(),h=w,V=f([]),T=f(null),l=f(!1),r=f([]),x=f([]),n=R({GraphicId:h.id,ChangeId:"",Name:"",StartTime:"",EndTime:""});function C(e){T.value.applyTransaction({remove:[e]})}function D(e,a){e.setData(a)}P("ondeleted",C),P("onupdated",D);const E=A(()=>[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:"ID",field:"id",width:80},{headerName:t("table.change"),field:"Change",width:120},{headerName:t("table.graphicName"),field:"GName",flex:1},{headerName:t("table.name"),field:"Name",flex:1,valueFormatter:e=>$(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.startTime"),field:"StartTime",valueFormatter:e=>$(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.endTime"),field:"EndTime",valueFormatter:e=>$(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.comment"),field:"Comment",flex:1},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:K},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:X}]),G={sortable:!0,filter:!0},N=async()=>{try{const e=await v.get(`/getTimes/${h.id}`);V.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},c=async()=>{try{const e=await v.get("/graphics"),a=await v.get("/changes");r.value=e.data.map(m=>({value:m.id,text:m.Name})),x.value=a.data.map(m=>({value:m.Change,text:m.Change}))}catch(e){console.error("Error fetching graphics data:",e)}},s=async()=>{try{const{data:e}=await v.post("/graphictimes",n);e.status===200?(l.value=!1,n.GraphicId="",n.ChangeId="",n.Name="",n.StartTime="",n.EndTime="",await N(),p({message:t("login.successMessage"),color:"success"})):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return L(()=>{const e=localStorage.getItem("locale");e&&(_.value=e),N(),c()}),(e,a)=>{const m=b("VaSelect"),i=b("VaTimeInput"),B=b("VaModal"),j=b("ag-grid-vue");return M(),U("div",Y,[u("main",null,[u("div",Z,[ee,d(o(H),{onClick:a[0]||(a[0]=g=>l.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),d(B,{modelValue:l.value,"onUpdate:modelValue":a[5]||(a[5]=g=>l.value=g),"ok-text":o(t)("buttons.save"),"cancel-text":o(t)("buttons.cancel"),onOk:s,"close-button":""},{default:y(()=>[u("h3",ae,I(o(t)("modals.addGraphicTimesTitle")),1),u("div",null,[d(o(F),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:y(()=>[u("div",te,[d(m,{modelValue:n.ChangeId,"onUpdate:modelValue":a[1]||(a[1]=g=>n.ChangeId=g),"value-by":"value",class:"mb-6",label:o(t)("form.selectChange"),options:x.value,clearable:""},null,8,["modelValue","label","options"])]),u("div",le,[d(i,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(t)("form.name"),modelValue:n.Name,"onUpdate:modelValue":a[2]||(a[2]=g=>n.Name=g)},null,8,["label","modelValue"]),d(i,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(t)("form.startTime"),modelValue:n.Name,"onUpdate:modelValue":a[3]||(a[3]=g=>n.Name=g)},null,8,["label","modelValue"]),d(i,{modelValue:n.EndTime,"onUpdate:modelValue":a[4]||(a[4]=g=>n.EndTime=g),clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(t)("form.endTime")},null,8,["modelValue","label"])])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),u("main",oe,[d(j,{rowData:V.value,columnDefs:E.value,defaultColDef:G,animateRows:"true",class:"ag-theme-material h-full",onGridReady:a[6]||(a[6]=g=>T.value=g.api)},null,8,["rowData","columnDefs"])])])}}};export{de as default};
