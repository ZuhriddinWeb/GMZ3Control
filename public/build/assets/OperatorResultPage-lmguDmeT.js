import{u as I,c as S,r as n,s as m,K as R,o as k,N as z,f as O,g as C,h as B,i as u,j as c,l as G,k as v,m as T,n as g}from"./app-BnZHz_BC.js";/* empty css                   */import{V as $}from"./VueShiftCalendar-BSucxU8d.js";const A={class:"grid grid-rows-[55px,1fr]"},E={class:"flex-grow"},F={class:"m-2"},K={__name:"OperatorResultPage",props:{id:Number},setup(h){const{init:U}=I(),{locale:s,t:r}=S(),w=h,f=n([]),y=n(null);n(!1);const _=n([]),a=n({smena:null,day:null}),N=m(()=>[{headerName:r("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:r("table.structure"),field:x(),flex:1},{headerName:r("table.name"),field:b(),flex:1},{headerName:r("table.want"),field:"multiplied_parameter_count"},{headerName:r("table.be"),field:"kiritilgan"},{headerName:"%",field:"foiz",valueFormatter:t=>`${t.value}%`},{headerName:r("table.operator"),field:"kiritgan_operator"}]),p=m(()=>a.value.day?`${a.value.day} - ${a.value.smena}`:""),D={sortable:!0,filter:!0},b=()=>(s.value==="uz","page_name"),x=()=>(s.value==="uz","factory_structure_name"),d=async()=>{try{const t={day:a.value.day,smena:a.value.smena},e=await g.get(`/getRowPageResult/${w.id}`,{params:t});f.value=Array.isArray(e.data)?e.data:e.data.items}catch(t){console.error("Error fetching data:",t)}},V=async()=>{try{const t=await g.get("/structure");_.value=t.data.map(e=>({value:e.id,text:s.value==="uz"?e.Name:e.NameRus}))}catch(t){console.error("Error fetching graphics data:",t)}};R(()=>a.value,()=>{d()},{deep:!0});let i=null;return k(()=>{const t=localStorage.getItem("locale");t&&(s.value=t);const e=new Date,o=e.getHours();if(o>=8&&o<20)a.value.smena=1,a.value.day=e.toISOString().split("T")[0];else if(a.value.smena=2,o<8){const l=new Date(e);l.setDate(e.getDate()-1),a.value.day=l.toISOString().split("T")[0]}else a.value.day=e.toISOString().split("T")[0];d(),V(),i=setInterval(()=>{d()},3e5)}),z(()=>{i&&clearInterval(i)}),m(()=>s.value==="uz"?"Русский":"O‘zbek"),(t,e)=>{const o=O("ag-grid-vue");return B(),C("div",A,[e[3]||(e[3]=u("main",null,[u("div",{class:"flex justify-between"},[u("span",{class:"flex w-full"})])],-1)),u("main",E,[u("div",F,[c(v($),{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value=l),"with-slot":!0},{default:G(()=>[c(v(T),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),label:"Smena",readonly:""},null,8,["modelValue"])]),_:1},8,["modelValue"])]),c(o,{rowData:f.value,columnDefs:N.value,defaultColDef:D,animateRows:"true",class:"ag-theme-material h-full",onGridReady:e[2]||(e[2]=l=>y.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{K as default};
