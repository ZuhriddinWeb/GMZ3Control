import{u as U,r as b,c as O,E as q,f as g,g as E,h as C,j as u,k as e,z as M,l as S,i as p,t as w,n as h,d as _,V as T,m as V,a as J,s as x,o as K,F as Q,G as W,H as F}from"./app-W1L24GQ1.js";/* empty css                   */const X={class:"h-full w-full text-center content-center"},Y={class:"va-h3"},Z={__name:"DeleteStructure",props:["params"],setup(R){const{init:v}=U(),i=b(!1),o=R,{t:N}=O(),n=q("ondeleted"),d=async()=>{try{const{data:c}=await h.delete(`/structure/${o.params.data.id}`);c.status===200?(n(o.params.data),i.value=!1,v({message:N("login.successMessage"),color:"success"})):console.error("Error deleting data:",c.message)}catch(c){console.error("Error deleting data:",c)}};return(c,f)=>{const m=g("VaModal");return C(),E("main",X,[u(e(M),{round:"",icon:"delete",color:"red",preset:"primary",class:"mt-1",onClick:f[0]||(f[0]=s=>i.value=!0)}),u(m,{modelValue:i.value,"onUpdate:modelValue":f[1]||(f[1]=s=>i.value=s),"ok-text":e(N)("modals.apply"),"cancel-text":e(N)("modals.cancel"),onClose:f[2]||(f[2]=s=>i.value=!1),onOk:d,"close-button":""},{default:S(()=>[p("h3",Y,w(e(N)("modals.title")),1),p("p",null,w(e(N)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ee={class:"h-full w-full text-center content-center"},le={__name:"EditStructure",props:["params"],setup(R){const v=R,i=b(!1),o=q("onupdated"),{init:N}=U(),{t:n}=O(),d=_({Name:"",NameRus:"",ShortNameRus:"",ShortName:"",OrderNumberSex:"",Comment:"",id:v.params.data.id}),c=async()=>{h.get(`structure/${v.params.data.id}`).then(m=>{Object.assign(d,m.data)}).catch(m=>{console.error("Error fetching data:",m)})},f=async()=>{try{const{data:m}=await h.put("/structure",d);m.status===200?(o(v.params.node,m.unit),i.value=!1,N({message:n("login.successMessage"),color:"success"})):console.error("Error saving data:",m.message)}catch(m){console.error("Error saving data:",m)}};return(m,s)=>{const k=g("VaTextarea"),D=g("VaModal");return C(),E("main",ee,[u(e(M),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:s[0]||(s[0]=l=>i.value=!0)}),u(D,{modelValue:i.value,"onUpdate:modelValue":s[7]||(s[7]=l=>i.value=l),"ok-text":e(n)("modals.apply"),"cancel-text":e(n)("modals.cancel"),onOk:f,onClose:s[8]||(s[8]=l=>i.value=!1),"close-button":""},{default:S(()=>[p("h3",{class:"va-h3",onVnodeMounted:c},w(e(n)("modals.editFactory")),513),p("div",null,[u(e(T),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:S(()=>[u(e(V),{class:"w-full",modelValue:d.Name,"onUpdate:modelValue":s[1]||(s[1]=l=>d.Name=l),rules:[l=>!!l||e(n)("validation.required")],label:e(n)("form.name")},null,8,["modelValue","rules","label"]),u(e(V),{class:"w-full",modelValue:d.NameRus,"onUpdate:modelValue":s[2]||(s[2]=l=>d.NameRus=l),rules:[l=>!!l||e(n)("validation.required")],label:e(n)("form.nameRus")},null,8,["modelValue","rules","label"]),u(e(V),{class:"w-full",modelValue:d.ShortName,"onUpdate:modelValue":s[3]||(s[3]=l=>d.ShortName=l),rules:[l=>!!l||e(n)("validation.required")],label:e(n)("form.shortName")},null,8,["modelValue","rules","label"]),u(e(V),{class:"w-full",modelValue:d.ShortNameRus,"onUpdate:modelValue":s[4]||(s[4]=l=>d.ShortNameRus=l),rules:[l=>!!l||e(n)("validation.required")],label:e(n)("form.shortNameRus")},null,8,["modelValue","rules","label"]),u(e(V),{class:"w-full",modelValue:d.OrderNumberSex,"onUpdate:modelValue":s[5]||(s[5]=l=>d.OrderNumberSex=l),rules:[l=>!!l||e(n)("validation.required")],label:e(n)("table.OrderNumber")},null,8,["modelValue","rules","label"]),u(k,{class:"w-full",modelValue:d.Comment,"onUpdate:modelValue":s[6]||(s[6]=l=>d.Comment=l),"max-length":125,label:e(n)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ae={class:"grid grid-rows-[55px,1fr]"},te={class:"flex justify-between"},oe={class:"va-h3"},se={class:"flex-grow"},ue={__name:"FactoriesStructurePage",setup(R){const{init:v}=U(),{locale:i,t:o}=O(),N=J(),n=b([]),d=b(null),c=b(!1);b([]);const f=x(()=>N.state.user.roles[4]),m=r=>{var t,y;return((y=(t=f.value)==null?void 0:t.pivot)==null?void 0:y[r])==="1"},s=x(()=>m("create")),k=x(()=>m("update")),D=x(()=>m("delete")),l=_({Name:"",NameRus:"",OrderNumberSex:"",ShortNameRus:"",ShortName:"",Comment:""});function B(r){d.value.applyTransaction({remove:[r]})}function j(r,t){r.setData(t)}F("ondeleted",B),F("onupdated",j);const I=x(()=>{const r=[{headerName:o("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:o("table.name"),field:A(),flex:1},{headerName:o("table.shortName"),field:G()},{headerName:o("table.OrderNumber"),field:"OrderNumberSex"}];return k.value&&r.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:le}),D.value&&r.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:Z}),r}),z={sortable:!0,filter:!0},A=()=>i.value==="uz"?"Name":"NameRus",G=()=>i.value==="uz"?"ShortName":"ShortNameRus",$=async()=>{try{const r=await h.get("/structure");n.value=Array.isArray(r.data)?r.data:r.data.items}catch(r){console.error("Error fetching data:",r)}},P=async()=>{try{const{data:r}=await h.post("/structure",l);r.status===200?(c.value=!1,l.Name="",l.NameRus="",l.OrderNumberSex="",l.ShortName="",l.ShortNameRus="",l.Comment="",await $(),v({message:o("login.successMessage"),color:"success"})):console.error("Error saving data:",r.message)}catch(r){console.error("Error saving data:",r)}};return K(()=>{const r=localStorage.getItem("locale");r&&(i.value=r),$()}),(r,t)=>{const y=g("VaTextarea"),H=g("VaModal"),L=g("ag-grid-vue");return C(),E("div",ae,[p("main",null,[p("div",te,[t[9]||(t[9]=p("span",{class:"flex w-full"},null,-1)),s.value?(C(),Q(e(M),{key:0,onClick:t[0]||(t[0]=a=>c.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):W("",!0)]),u(H,{modelValue:c.value,"onUpdate:modelValue":t[7]||(t[7]=a=>c.value=a),"ok-text":e(o)("buttons.save"),"cancel-text":e(o)("buttons.cancel"),onOk:P,"close-button":""},{default:S(()=>[p("h3",oe,w(e(o)("modals.addStructureTitle"))+w(),1),p("div",null,[u(e(T),{ref:"formRef",class:"flex flex-col items-baseline gap-1"},{default:S(()=>[u(e(V),{class:"w-full",modelValue:l.Name,"onUpdate:modelValue":t[1]||(t[1]=a=>l.Name=a),rules:[a=>a&&a.length>0||e(o)("validation.requiredField")],label:e(o)("form.name")},null,8,["modelValue","rules","label"]),u(e(V),{class:"w-full",modelValue:l.NameRus,"onUpdate:modelValue":t[2]||(t[2]=a=>l.NameRus=a),rules:[a=>a&&a.length>0||e(o)("validation.requiredField")],label:e(o)("form.nameRus")},null,8,["modelValue","rules","label"]),u(e(V),{class:"w-full",modelValue:l.ShortName,"onUpdate:modelValue":t[3]||(t[3]=a=>l.ShortName=a),rules:[a=>a&&a.length>0||e(o)("validation.requiredField")],label:e(o)("form.shortName")},null,8,["modelValue","rules","label"]),u(e(V),{class:"w-full",modelValue:l.OrderNumberSex,"onUpdate:modelValue":t[4]||(t[4]=a=>l.OrderNumberSex=a),rules:[a=>a&&a.length>0||e(o)("validation.requiredField")],label:e(o)("table.OrderNumber")},null,8,["modelValue","rules","label"]),u(e(V),{class:"w-full",modelValue:l.ShortNameRus,"onUpdate:modelValue":t[5]||(t[5]=a=>l.ShortNameRus=a),rules:[a=>a&&a.length>0||e(o)("validation.requiredField")],label:e(o)("form.shortNameRus")},null,8,["modelValue","rules","label"]),u(y,{class:"w-full",modelValue:l.Comment,"onUpdate:modelValue":t[6]||(t[6]=a=>l.Comment=a),"max-length":"125",label:e(o)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),p("main",se,[u(L,{rowData:n.value,columnDefs:I.value,defaultColDef:z,animateRows:"true",class:"ag-theme-material h-full",onGridReady:t[8]||(t[8]=a=>d.value=a.api)},null,8,["rowData","columnDefs"])])])}}};export{ue as default};
