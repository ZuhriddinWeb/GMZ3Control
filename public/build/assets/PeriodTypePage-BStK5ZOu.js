import{u as C,r as N,E as R,c as E,f as _,g as $,h as k,j as m,k as e,z as T,l as y,i as v,t as O,n as V,d as F,V as S,m as D,a as H,s as b,o as L,F as J,G as K,H as U}from"./app-A8jI9ma8.js";/* empty css                   */const Q={class:"h-full w-full text-center content-center"},W={class:"va-h3"},X={__name:"DeleteModal",props:["params"],setup(w){const{init:x}=C(),p=N(!1),u=w,r=R("ondeleted"),{t:l}=E(),c=async()=>{try{const{data:i}=await V.delete(`/periodType/${u.params.data.id}`);i.status===200?(r(u.params.data),p.value=!1,x({message:l("login.successMessage"),color:"success"})):console.error("Error deleting data:",i.message)}catch(i){console.error("Error deleting data:",i)}};return(i,f)=>{const o=_("VaModal");return k(),$("main",Q,[m(e(T),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:f[0]||(f[0]=s=>p.value=!0)}),m(o,{modelValue:p.value,"onUpdate:modelValue":f[1]||(f[1]=s=>p.value=s),"ok-text":e(l)("modals.apply"),"cancel-text":e(l)("modals.cancel"),onClose:f[2]||(f[2]=s=>p.value=!1),onOk:c,"close-button":""},{default:y(()=>[v("h3",W,O(e(l)("modals.title")),1),v("p",null,O(e(l)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},Y={class:"h-full w-full text-center content-center"},Z={__name:"EditModal",props:["params"],setup(w){const{init:x}=C(),p=w,u=N(!1),r=R("onupdated"),{t:l}=E(),c=F({Name:"",OrderNumber:"",id:p.params.data.id}),i=async()=>{V.get(`/periodType/${p.params.data.id}`).then(o=>{c.Name=o.data.name,c.OrderNumber=o.data.OrderNumber}).catch(o=>{console.error("Error fetching data:",o)})},f=async()=>{try{const{data:o}=await V.put("/periodType",c);o.status===200?(r(p.params.node,o.unit),u.value=!1,x({message:l("login.successMessage"),color:"success"})):console.error("Error saving data:",o.message)}catch(o){console.error("Error saving data:",o)}};return(o,s)=>{const M=_("VaModal");return k(),$("main",Y,[m(e(T),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:s[0]||(s[0]=d=>u.value=!0)}),m(M,{modelValue:u.value,"onUpdate:modelValue":s[3]||(s[3]=d=>u.value=d),"ok-text":e(l)("modals.apply"),"cancel-text":e(l)("modals.cancel"),onOk:f,onClose:s[4]||(s[4]=d=>u.value=!1),"close-button":""},{default:y(()=>[v("h3",{class:"va-h3",onVnodeMounted:i},O(e(l)("modals.editFactory")),513),v("div",null,[m(e(S),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:y(()=>[m(e(D),{class:"w-full",modelValue:c.Name,"onUpdate:modelValue":s[1]||(s[1]=d=>c.Name=d),rules:[d=>!!d||e(l)("validation.required")],label:e(l)("form.name")},null,8,["modelValue","rules","label"]),m(e(D),{class:"w-full",modelValue:c.OrderNumber,"onUpdate:modelValue":s[2]||(s[2]=d=>c.OrderNumber=d),rules:[d=>!!d||e(l)("validation.required")],label:e(l)("table.OrderNumber")},null,8,["modelValue","rules","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ee={class:"grid grid-rows-[55px,1fr]"},ae={class:"flex justify-between"},te={class:"va-h3"},le={class:"flex-grow"},re={__name:"PeriodTypePage",setup(w){const x=H(),{init:p}=C(),{locale:u,t:r}=E(),l=N([]),c=N(null),i=N(!1),f=b(()=>x.state.user.roles[6]),o=a=>{var t,h;return((h=(t=f.value)==null?void 0:t.pivot)==null?void 0:h[a])==="1"},s=b(()=>o("create")),M=b(()=>o("update")),d=b(()=>o("delete")),g=F({Name:"",OrderNumber:""});function B(a){c.value.applyTransaction({remove:[a]})}function q(a,t){a.setData(t)}U("ondeleted",B),U("onupdated",q);const z=b(()=>{const a=[{headerName:r("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:r("table.name"),field:P(),flex:1},{headerName:r("table.OrderNumber"),field:"OrderNumber",flex:1}];return M.value&&a.push({headerName:"",field:"",width:70,cellClass:["px-0"],cellRenderer:Z}),d.value&&a.push({headerName:"",field:"",width:70,cellClass:["px-0"],cellRenderer:X}),a}),I={sortable:!0,filter:!0},P=()=>(u.value==="uz","name"),j=async()=>{try{const a=await V.get("/periodType");console.log(a.data),l.value=a.data}catch(a){console.error("Error fetching data:",a)}},G=async()=>{try{const{data:a}=await V.post("/periodType",g);a.status===200?(i.value=!1,g.Name="",g.OrderNumber="",await j(),p({message:r("login.successMessage"),color:"success"})):console.error("Error saving data:",a.message)}catch(a){console.error("Error saving data:",a)}};return L(()=>{const a=localStorage.getItem("locale");a&&(u.value=a),(async()=>{try{const t=await V.get("/periodType");l.value=t.data}catch(t){console.error("Error fetching data:",t)}})()}),b(()=>u.value==="uz"?"Русский":"O‘zbek"),(a,t)=>{const h=_("VaModal"),A=_("ag-grid-vue");return k(),$("div",ee,[v("main",null,[v("div",ae,[t[5]||(t[5]=v("span",{class:"flex w-full"},null,-1)),s.value?(k(),J(e(T),{key:0,onClick:t[0]||(t[0]=n=>i.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):K("",!0)]),m(h,{modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=n=>i.value=n),"ok-text":e(r)("buttons.save"),"cancel-text":e(r)("buttons.cancel"),onOk:G,"close-button":""},{default:y(()=>[v("h3",te,O(e(r)("modals.addUnitTitle")),1),v("div",null,[m(e(S),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:y(()=>[m(e(D),{class:"w-full",modelValue:g.Name,"onUpdate:modelValue":t[1]||(t[1]=n=>g.Name=n),rules:[n=>n&&n.length>0||e(r)("validation.requiredField")],label:e(r)("form.name")},null,8,["modelValue","rules","label"]),m(e(D),{class:"w-full",modelValue:g.OrderNumber,"onUpdate:modelValue":t[2]||(t[2]=n=>g.OrderNumber=n),rules:[n=>n&&n.length>0||e(r)("validation.requiredField")],label:e(r)("table.OrderNumber")},null,8,["modelValue","rules","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),v("main",le,[m(A,{rowData:l.value,columnDefs:z.value,defaultColDef:I,animateRows:"true",class:"ag-theme-material h-full",onGridReady:t[4]||(t[4]=n=>c.value=n.api)},null,8,["rowData","columnDefs"])])])}}};export{re as default};
