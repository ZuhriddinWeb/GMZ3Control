import{u as $,r as f,G as O,d as R,c as k,f as x,g as M,h as U,k as d,j as l,D as H,l as _,i as u,t as I,V as F,m as v,H as P,x as j,o as A}from"./app-ff54b203.js";/* empty css                   */import{f as S}from"./format-45c98358.js";const L={class:"h-full w-full text-center content-center"},q={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},z={class:"grid grid-cols-2 md:grid-cols-3 gap-3 items-end"},J={__name:"EditGraphicTimesModal",props:["params"],setup(y){const{init:w}=$(),t=y,p=f(!1),h=f([]),T=f([]),b=O("onupdated"),o=R({GraphicId:"",ChangeId:"",Name:"",StartTime:"",EndTime:null,id:t.params.data.id}),{t:r}=k();function s(i){const[e,a,n]=i.split(":"),g=new Date;return g.setHours(parseInt(e,10)),g.setMinutes(parseInt(a,10)),g.setSeconds(parseInt(n,10)),g}function V(i){return i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}const C={StartTime:"08:00:00.0000000",EndTime:"08:05:00.0000000"},G=s(C.StartTime),D=s(C.EndTime);V(G),V(D);const N=async()=>{try{const i=await v.get("/graphics"),e=await v.get("/changes");h.value=i.data.map(n=>({value:n.id,text:n.Name})),T.value=e.data.map(n=>({value:n.Change,text:n.Change}));const a=await v.get(`graphictimes/${t.params.data.id}`);o.GraphicId=+a.data.Gid,o.ChangeId=+a.data.Chid}catch(i){console.error("Error fetching data:",i)}},E=async()=>{try{const{data:i}=await v.put("/graphictimes",o);i.status===200?(p.value=!1,b(t.params.node,i.unit),w({message:r("login.successMessage"),color:"success"})):console.error("Error saving data:",i.message)}catch(i){console.error("Error saving data:",i)}};return(i,e)=>{const a=x("VaSelect"),n=x("VaTimeInput"),g=x("VaModal");return M(),U("main",L,[d(l(H),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:e[0]||(e[0]=c=>p.value=!0)}),d(g,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=c=>p.value=c),"ok-text":l(r)("modals.apply"),"cancel-text":l(r)("modals.cancel"),onOk:E,onClose:e[7]||(e[7]=c=>p.value=!1),"close-button":""},{default:_(()=>[u("h3",{class:"va-h3",onVnodeMounted:N},I(l(r)("modals.editFactory")),513),u("div",null,[d(l(F),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:_(()=>[u("div",q,[d(a,{modelValue:o.GraphicId,"onUpdate:modelValue":e[1]||(e[1]=c=>o.GraphicId=c),"value-by":"value",class:"mb-6",label:l(r)("form.selectGraphic"),options:h.value,clearable:""},null,8,["modelValue","label","options"]),d(a,{modelValue:o.ChangeId,"onUpdate:modelValue":e[2]||(e[2]=c=>o.ChangeId=c),"value-by":"value",class:"mb-6",label:l(r)("form.selectChange"),options:T.value,clearable:""},null,8,["modelValue","label","options"])]),u("div",z,[d(n,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(r)("form.name"),modelValue:o.Name,"onUpdate:modelValue":e[3]||(e[3]=c=>o.Name=c)},null,8,["label","modelValue"]),d(n,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(r)("form.startTime"),modelValue:o.Name,"onUpdate:modelValue":e[4]||(e[4]=c=>o.Name=c)},null,8,["label","modelValue"]),d(n,{modelValue:o.EndTime,"onUpdate:modelValue":e[5]||(e[5]=c=>o.EndTime=c),clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(r)("form.endTime")},null,8,["modelValue","label"])])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},K={class:"h-full w-full text-center content-center"},Q={class:"va-h3"},W={__name:"DeleteGraphicTimesModal",props:["params"],setup(y){const{init:w}=$(),{t}=k(),p=f(!1),h=y,T=O("ondeleted"),b=async()=>{try{const{data:o}=await v.delete(`/graphictimes/${h.params.data.id}`);o.status===200?(T(h.params.data),w({message:t("login.successMessage"),color:"success"}),p.value=!1):console.error("Error deleting data:",o.message)}catch(o){console.error("Error deleting data:",o)}};return(o,r)=>{const s=x("VaModal");return M(),U("main",K,[d(l(H),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:r[0]||(r[0]=V=>p.value=!0)}),d(s,{modelValue:p.value,"onUpdate:modelValue":r[1]||(r[1]=V=>p.value=V),"ok-text":l(t)("modals.apply"),"cancel-text":l(t)("modals.cancel"),onClose:r[2]||(r[2]=V=>p.value=!1),onOk:b,"close-button":""},{default:_(()=>[u("h3",Q,I(l(t)("modals.title")),1),u("p",null,I(l(t)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}};const X={class:"grid grid-rows-[55px,1fr]"},Y={class:"flex justify-between"},Z=u("span",{class:"flex w-full"},null,-1),ee={class:"va-h3"},ae={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},te={class:"grid grid-cols-2 md:grid-cols-3 gap-3 items-end"},le={class:"flex-grow"},re={__name:"GraphicTimesPage",setup(y){const{locale:w,t}=k(),{init:p}=$(),h=f([]),T=f(null),b=f(!1),o=f([]),r=f([]),s=R({GraphicId:"",ChangeId:"",Name:"",StartTime:"",EndTime:""});function V(e){T.value.applyTransaction({remove:[e]})}function C(e,a){e.setData(a)}P("ondeleted",V),P("onupdated",C);const G=j(()=>[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:"ID",field:"id",width:80},{headerName:t("table.change"),field:"Change",width:120},{headerName:t("table.graphicName"),field:"GName",flex:1},{headerName:t("table.name"),field:"Name",flex:1,valueFormatter:e=>S(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.startTime"),field:"StartTime",valueFormatter:e=>S(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.endTime"),field:"EndTime",valueFormatter:e=>S(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.comment"),field:"Comment",flex:1},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:J},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:W}]),D={sortable:!0,filter:!0},N=async()=>{try{const e=await v.get("/graphictimes");h.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},E=async()=>{try{const e=await v.get("/graphics"),a=await v.get("/changes");o.value=e.data.map(n=>({value:n.id,text:n.Name})),r.value=a.data.map(n=>({value:n.Change,text:n.Change}))}catch(e){console.error("Error fetching graphics data:",e)}},i=async()=>{try{const{data:e}=await v.post("/graphictimes",s);e.status===200?(b.value=!1,s.GraphicId="",s.ChangeId="",s.Name="",s.StartTime="",s.EndTime="",await N(),p({message:t("login.successMessage"),color:"success"})):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return A(()=>{const e=localStorage.getItem("locale");e&&(w.value=e),N(),E()}),(e,a)=>{const n=x("VaSelect"),g=x("VaTimeInput"),c=x("VaModal"),B=x("ag-grid-vue");return M(),U("div",X,[u("main",null,[u("div",Y,[Z,d(l(H),{onClick:a[0]||(a[0]=m=>b.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),d(c,{modelValue:b.value,"onUpdate:modelValue":a[6]||(a[6]=m=>b.value=m),"ok-text":l(t)("buttons.save"),"cancel-text":l(t)("buttons.cancel"),onOk:i,"close-button":""},{default:_(()=>[u("h3",ee,I(l(t)("modals.addGraphicTimesTitle")),1),u("div",null,[d(l(F),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:_(()=>[u("div",ae,[d(n,{modelValue:s.GraphicId,"onUpdate:modelValue":a[1]||(a[1]=m=>s.GraphicId=m),"value-by":"value",class:"mb-6",label:l(t)("form.selectGraphic"),options:o.value,clearable:""},null,8,["modelValue","label","options"]),d(n,{modelValue:s.ChangeId,"onUpdate:modelValue":a[2]||(a[2]=m=>s.ChangeId=m),"value-by":"value",class:"mb-6",label:l(t)("form.selectChange"),options:r.value,clearable:""},null,8,["modelValue","label","options"])]),u("div",te,[d(g,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(t)("form.name"),modelValue:s.Name,"onUpdate:modelValue":a[3]||(a[3]=m=>s.Name=m)},null,8,["label","modelValue"]),d(g,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(t)("form.startTime"),modelValue:s.Name,"onUpdate:modelValue":a[4]||(a[4]=m=>s.Name=m)},null,8,["label","modelValue"]),d(g,{modelValue:s.EndTime,"onUpdate:modelValue":a[5]||(a[5]=m=>s.EndTime=m),clearable:"","clearable-icon":"cancel",color:"textPrimary",label:l(t)("form.endTime")},null,8,["modelValue","label"])])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),u("main",le,[d(B,{rowData:h.value,columnDefs:G.value,defaultColDef:D,animateRows:"true",class:"ag-theme-material h-full",onGridReady:a[7]||(a[7]=m=>T.value=m.api)},null,8,["rowData","columnDefs"])])])}}};export{re as default};
