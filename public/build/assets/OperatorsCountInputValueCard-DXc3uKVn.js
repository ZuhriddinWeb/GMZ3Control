import{u as E,c as L,s as I,b as M,r as d,o as P,D as H,n as _,R as J,g as R,h as F,i as e,I as U,J as G,t as c,k as v,j as N,z as O}from"./app-DBuN4kKe.js";/* empty css                   */const K={class:"grid grid-rows-[55px,1fr]"},Q={class:"flex justify-between"},W={class:"w-4/6"},X={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 my-6 shadow-sm border border-slate-200 mt-24 p-4"},Y=["onClick"],Z={class:"mb-2 text-slate-800 text-xl font-semibold flex items-start"},tt={class:"flex-grow leading-none w-5/6"},et={class:"flex justify-between"},at={class:"flex justify-between flex-col"},st={class:"flex justify-end"},lt={class:"absolute top-2 right-2 w-24 grid grid-cols-[min-content,1fr] gap-x-2 gap-y-1 text-xl font-semibold text-right"},ot={class:"text-green-600 text-base"},nt={class:"text-red-600 text-base"},rt={class:"text-blue-600 text-base"},it={class:"text-teal-600 text-base"},ft={__name:"OperatorsCountInputValueCard",setup(ut){const{init:dt}=E(),{locale:m,t:ct}=L(),S=I(()=>route.query.type),p=M(),x=d([]);d(null);const y=d(null);function T(a){p.push({name:"OperatorDetail",params:{id:a}})}function V(a){y.value=a,w()}function z(a){p.push({name:"OperatorDetail",params:{id:a},query:{type:"inputed"}})}function A(a){p.push({name:"OperatorDetail",params:{id:a},query:{type:"not_inputed"}})}I(()=>S.value==="inputed"?allData.value.filter(a=>a.Value!==null):S.value==="not_inputed"?allData.value.filter(a=>a.Value===null):allData.value);const h=d(0),b=d(0);async function w(){const a=new Date,t=a.toISOString().split("T")[0],s=a.getHours(),f=s>=8&&s<20?1:2;if(h.value=0,b.value=0,y.value){const{data:r}=await _.get(`/getRowPageResult/${y.value}`,{params:{day:t,smena:f}}),g=r.reduce((l,o)=>(l.total+=o.multiplied_parameter_count,l.filled+=o.kiritilgan,l.formula+=o.multiplied_formula_count,l.manual+=o.multiplied_manual_count,l),{total:0,filled:0,formula:0,manual:0});h.value=g.formula,b.value=g.manual}else{const{data:r}=await _.get("/structure"),g=[];for(const l of r){const o=await _.get(`/getRowPageResult/${l.id}`,{params:{day:t,smena:f}}),C=o.data.reduce((n,i)=>n+i.multiplied_parameter_count,0),D=o.data.reduce((n,i)=>n+i.kiritilgan,0),$=o.data.reduce((n,i)=>n+i.multiplied_formula_count,0),j=o.data.reduce((n,i)=>n+i.multiplied_manual_count,0),B=C-D;h.value+=$,b.value+=j;const u=x.value.find(n=>n.id===l.id);u&&(u.filled=D,u.notFilled=B,u.formula=$,u.manual=j);const q=C>0?D/C*100:0;g.push({name:m.value==="uz"?l.Name:l.NameRus,y:parseFloat(q.toFixed(2))})}}}let k=null;return P(async()=>{const a=localStorage.getItem("locale");a&&(m.value=a);try{const t=H.state.user.structure_id;if(Array.isArray(t)&&t.length===1){const s=t[0];p.push({name:"OperatorDetail",params:{id:s}})}else if(Array.isArray(t)&&t.length>1){const s=await _.get(`/structures/${t.join(",")}`);x.value=s.data}else console.warn("structure_id bo'sh yoki noto'g'ri formatda")}catch(t){console.error("Error fetching data:",t)}await w(),k=setInterval(()=>{w()},6e5)}),I(()=>m.value==="uz"?"Русский":"O‘zbek"),J(()=>{k&&clearInterval(k)}),(a,t)=>(F(),R("div",K,[e("div",Q,[e("div",W,[e("div",X,[(F(!0),R(U,null,G(x.value,(s,f)=>(F(),R("div",{onClick:r=>V(s.id),key:f,class:"relative p-4 border-2 bg-white shadow-xl border-slate-400 cursor-pointer"},[e("h5",Z,[t[0]||(t[0]=e("span",{class:"material-symbols-outlined w-1"},"circles_ext",-1)),e("span",tt,c(v(m)==="ru"?s.NameRus:s.Name),1)]),e("div",et,[e("div",at,[e("div",st,[e("div",null,[N(v(O),{onClick:r=>T(s.id),preset:"primary",icon:"va-warning",class:"mr-2 mt-8",round:"","border-color":"primary"},null,8,["onClick"]),N(v(O),{onClick:r=>z(s.id),round:"",icon:"va-check",class:"mr-2 mt-8",color:"success"},null,8,["onClick"]),N(v(O),{onClick:r=>A(s.id),round:"",icon:"clear",class:"mr-2 mt-8",color:"danger"},null,8,["onClick"])]),e("div",null,[e("div",lt,[t[1]||(t[1]=e("span",{class:"text-green-600 material-symbols-outlined"},"edit",-1)),e("span",ot,c(s.filled),1),t[2]||(t[2]=e("span",{class:"material-symbols-outlined text-red-600"},"warning",-1)),e("span",nt,c(s.notFilled),1),t[3]||(t[3]=e("span",{class:"material-symbols-outlined text-blue-600"},"support_agent",-1)),e("span",rt,c(s.manual),1),t[4]||(t[4]=e("span",{class:"material-symbols-outlined text-teal-600"},"function",-1)),e("span",it,c(s.formula),1)])])])])])],8,Y))),128))])])])]))}};export{ft as default};
