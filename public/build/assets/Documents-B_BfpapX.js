import{O as getDefaultExportFromCjs,r as ref,o as onMounted,K as watch,f as resolveComponent,g as createElementBlock,h as openBlock,i as createBaseVNode,j as createVNode}from"./app-auAGtMLF.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules-TDtrdbi3.js";var dist$1={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(n,l){(function(c,d){n.exports=d()})(jsuites,function(){var c;return function(){var d={195:function(j){(function(u,f){j.exports=f()})(this,function(){return function(qe){function f(Ae,Ne){this.highOrder=Ae,this.lowOrder=Ne}var k=[new f(1779033703,4089235720),new f(3144134277,2227873595),new f(1013904242,4271175723),new f(2773480762,1595750129),new f(1359893119,2917565137),new f(2600822924,725511199),new f(528734635,4215389547),new f(1541459225,327033209)],P=[new f(1116352408,3609767458),new f(1899447441,602891725),new f(3049323471,3964484399),new f(3921009573,2173295548),new f(961987163,4081628472),new f(1508970993,3053834265),new f(2453635748,2937671579),new f(2870763221,3664609560),new f(3624381080,2734883394),new f(310598401,1164996542),new f(607225278,1323610764),new f(1426881987,3590304994),new f(1925078388,4068182383),new f(2162078206,991336113),new f(2614888103,633803317),new f(3248222580,3479774868),new f(3835390401,2666613458),new f(4022224774,944711139),new f(264347078,2341262773),new f(604807628,2007800933),new f(770255983,1495990901),new f(1249150122,1856431235),new f(1555081692,3175218132),new f(1996064986,2198950837),new f(2554220882,3999719339),new f(2821834349,766784016),new f(2952996808,2566594879),new f(3210313671,3203337956),new f(3336571891,1034457026),new f(3584528711,2466948901),new f(113926993,3758326383),new f(338241895,168717936),new f(666307205,1188179964),new f(773529912,1546045734),new f(1294757372,1522805485),new f(1396182291,2643833823),new f(1695183700,2343527390),new f(1986661051,1014477480),new f(2177026350,1206759142),new f(2456956037,344077627),new f(2730485921,1290863460),new f(2820302411,3158454273),new f(3259730800,3505952657),new f(3345764771,106217008),new f(3516065817,3606008344),new f(3600352804,1432725776),new f(4094571909,1467031594),new f(275423344,851169720),new f(430227734,3100823752),new f(506948616,1363258195),new f(659060556,3750685593),new f(883997877,3785050280),new f(958139571,3318307427),new f(1322822218,3812723403),new f(1537002063,2003034995),new f(1747873779,3602036899),new f(1955562222,1575990012),new f(2024104815,1125592928),new f(2227730452,2716904306),new f(2361852424,442776044),new f(2428436474,593698344),new f(2756734187,3733110249),new f(3204031479,2999351573),new f(3329325298,3815920427),new f(3391569614,3928383900),new f(3515267271,566280711),new f(3940187606,3454069534),new f(4118630271,4000239992),new f(116418474,1914138554),new f(174292421,2731055270),new f(289380356,3203993006),new f(460393269,320620315),new f(685471733,587496836),new f(852142971,1086792851),new f(1017036298,365543100),new f(1126000580,2618297676),new f(1288033470,3409855158),new f(1501505948,4234509866),new f(1607167915,987167468),new f(1816402316,1246189591)],b=new Array(64),o,g,m,p,C,T,I,_,O,M,D,Z,q=8;function ae(Ae){return unescape(encodeURIComponent(Ae))}function he(Ae){for(var Ne=[],Ve=(1<<q)-1,ze=Ae.length*q,Je=0;Je<ze;Je+=q)Ne[Je>>5]|=(Ae.charCodeAt(Je/q)&Ve)<<32-q-Je%32;return Ne}function se(Ae){for(var Ne="0123456789abcdef",Ve="",ze=Ae.length*4,Je,et=0;et<ze;et+=1)Je=Ae[et>>2]>>(3-et%4)*8,Ve+=Ne.charAt(Je>>4&15)+Ne.charAt(Je&15);return Ve}function be(Ae,Ne){var Ve,ze,Je,et;return Ve=(Ae.lowOrder&65535)+(Ne.lowOrder&65535),ze=(Ae.lowOrder>>>16)+(Ne.lowOrder>>>16)+(Ve>>>16),Je=(ze&65535)<<16|Ve&65535,Ve=(Ae.highOrder&65535)+(Ne.highOrder&65535)+(ze>>>16),ze=(Ae.highOrder>>>16)+(Ne.highOrder>>>16)+(Ve>>>16),et=(ze&65535)<<16|Ve&65535,new f(et,Je)}function Le(Ae,Ne,Ve,ze){var Je,et,it,dt;return Je=(Ae.lowOrder&65535)+(Ne.lowOrder&65535)+(Ve.lowOrder&65535)+(ze.lowOrder&65535),et=(Ae.lowOrder>>>16)+(Ne.lowOrder>>>16)+(Ve.lowOrder>>>16)+(ze.lowOrder>>>16)+(Je>>>16),it=(et&65535)<<16|Je&65535,Je=(Ae.highOrder&65535)+(Ne.highOrder&65535)+(Ve.highOrder&65535)+(ze.highOrder&65535)+(et>>>16),et=(Ae.highOrder>>>16)+(Ne.highOrder>>>16)+(Ve.highOrder>>>16)+(ze.highOrder>>>16)+(Je>>>16),dt=(et&65535)<<16|Je&65535,new f(dt,it)}function me(Ae,Ne,Ve,ze,Je){var et,it,dt,mt;return et=(Ae.lowOrder&65535)+(Ne.lowOrder&65535)+(Ve.lowOrder&65535)+(ze.lowOrder&65535)+(Je.lowOrder&65535),it=(Ae.lowOrder>>>16)+(Ne.lowOrder>>>16)+(Ve.lowOrder>>>16)+(ze.lowOrder>>>16)+(Je.lowOrder>>>16)+(et>>>16),dt=(it&65535)<<16|et&65535,et=(Ae.highOrder&65535)+(Ne.highOrder&65535)+(Ve.highOrder&65535)+(ze.highOrder&65535)+(Je.highOrder&65535)+(it>>>16),it=(Ae.highOrder>>>16)+(Ne.highOrder>>>16)+(Ve.highOrder>>>16)+(ze.highOrder>>>16)+(Je.highOrder>>>16)+(et>>>16),mt=(it&65535)<<16|et&65535,new f(mt,dt)}function ie(Ae,Ne,Ve){return new f(Ae.highOrder&Ne.highOrder^Ae.highOrder&Ve.highOrder^Ne.highOrder&Ve.highOrder,Ae.lowOrder&Ne.lowOrder^Ae.lowOrder&Ve.lowOrder^Ne.lowOrder&Ve.lowOrder)}function Re(Ae,Ne,Ve){return new f(Ae.highOrder&Ne.highOrder^~Ae.highOrder&Ve.highOrder,Ae.lowOrder&Ne.lowOrder^~Ae.lowOrder&Ve.lowOrder)}function _e(Ae,Ne){return Ne<=32?new f(Ae.highOrder>>>Ne|Ae.lowOrder<<32-Ne,Ae.lowOrder>>>Ne|Ae.highOrder<<32-Ne):new f(Ae.lowOrder>>>Ne|Ae.highOrder<<32-Ne,Ae.highOrder>>>Ne|Ae.lowOrder<<32-Ne)}function Be(Ae){var Ne=_e(Ae,28),Ve=_e(Ae,34),ze=_e(Ae,39);return new f(Ne.highOrder^Ve.highOrder^ze.highOrder,Ne.lowOrder^Ve.lowOrder^ze.lowOrder)}function He(Ae){var Ne=_e(Ae,14),Ve=_e(Ae,18),ze=_e(Ae,41);return new f(Ne.highOrder^Ve.highOrder^ze.highOrder,Ne.lowOrder^Ve.lowOrder^ze.lowOrder)}function lt(Ae){var Ne=_e(Ae,1),Ve=_e(Ae,8),ze=Me(Ae,7);return new f(Ne.highOrder^Ve.highOrder^ze.highOrder,Ne.lowOrder^Ve.lowOrder^ze.lowOrder)}function Y(Ae){var Ne=_e(Ae,19),Ve=_e(Ae,61),ze=Me(Ae,6);return new f(Ne.highOrder^Ve.highOrder^ze.highOrder,Ne.lowOrder^Ve.lowOrder^ze.lowOrder)}function Me(Ae,Ne){return Ne<=32?new f(Ae.highOrder>>>Ne,Ae.lowOrder>>>Ne|Ae.highOrder<<32-Ne):new f(0,Ae.highOrder<<32-Ne)}var qe=ae(qe),pt=qe.length*q;qe=he(qe),qe[pt>>5]|=128<<24-pt%32,qe[(pt+128>>10<<5)+31]=pt;for(var O=0;O<qe.length;O+=32){o=k[0],g=k[1],m=k[2],p=k[3],C=k[4],T=k[5],I=k[6],_=k[7];for(var M=0;M<80;M++)M<16?b[M]=new f(qe[M*2+O],qe[M*2+O+1]):b[M]=Le(Y(b[M-2]),b[M-7],lt(b[M-15]),b[M-16]),D=me(_,He(C),Re(C,T,I),P[M],b[M]),Z=be(Be(o),ie(o,g,m)),_=I,I=T,T=C,C=be(p,D),p=m,m=g,g=o,o=be(D,Z);k[0]=be(o,k[0]),k[1]=be(g,k[1]),k[2]=be(m,k[2]),k[3]=be(p,k[3]),k[4]=be(C,k[4]),k[5]=be(T,k[5]),k[6]=be(I,k[6]),k[7]=be(_,k[7])}for(var Ze=[],O=0;O<k.length;O++)Ze.push(k[O].highOrder),Ze.push(k[O].lowOrder);return se(Ze)}})}},E={};function R(j){var u=E[j];if(u!==void 0)return u.exports;var f=E[j]={exports:{}};return d[j].call(f.exports,f,f.exports,R),f.exports}(function(){R.n=function(j){var u=j&&j.__esModule?function(){return j.default}:function(){return j};return R.d(u,{a:u}),u}})(),function(){R.d=function(j,u){for(var f in u)R.o(u,f)&&!R.o(j,f)&&Object.defineProperty(j,f,{enumerable:!0,get:u[f]})}}(),function(){R.o=function(j,u){return Object.prototype.hasOwnProperty.call(j,u)}}();var W={};(function(){R.d(W,{default:function(){return Rt}});var j=function(w){document.dictionary||(document.dictionary={});var A=null,s=Object.keys(w);for(A=0;A<s.length;A++)document.dictionary[s[A]]=w[s[A]]},u=function(w){return typeof document<"u"&&document.dictionary&&document.dictionary[w]||w},f={setDictionary:j,translate:u},P=function(w,A){if(A===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(r){return r!==null}),setTimeout(function(){window.jSuitesStateControl.push(w)},0);else{var s=window.jSuitesStateControl.indexOf(w);s>=0&&window.jSuitesStateControl.splice(s,1)}},b={};b.two=function(w){return w=""+w,w.length==1&&(w="0"+w),w},b.focus=function(w){if(w.textContent.length){const A=document.createRange(),s=window.getSelection();let r=w;for(;r.lastChild;)r=r.lastChild;r.nodeType===Node.TEXT_NODE?A.setStart(r,r.length):A.setStart(r,r.childNodes.length),A.collapse(!0),s.removeAllRanges(),s.addRange(A),w.scrollLeft=w.scrollWidth}},b.isNumeric=function(w){return typeof w=="string"&&(w=w.trim()),!isNaN(w)&&w!==null&&w!==""},b.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(w){var A=Math.random()*16|0,s=w=="x"?A:A&3|8;return s.toString(16)})},b.getNode=function(){var w=document.getSelection().anchorNode;return w?w.nodeType==3?w.parentNode:w:null},b.hash=function(w){var A=0,s,r;if(w.length===0)return A;for(s=0;s<w.length;s++)r=w.charCodeAt(s),r>32&&(A=(A<<5)-A+r,A|=0);return A},b.randomColor=function(w){var A=-.25,s=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");s.length<6&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]);var r=[],B,te;for(te=0;te<3;te++)B=parseInt(s.substr(te*2,2),16),B=Math.round(Math.min(Math.max(0,B+B*A),255)).toString(16),r.push(("00"+B).substr(B.length));return w==!0?"#"+b.two(r[0].toString(16))+b.two(r[1].toString(16))+b.two(r[2].toString(16)):r},b.getWindowWidth=function(){var w=window,A=document,s=A.documentElement,r=A.getElementsByTagName("body")[0],B=w.innerWidth||s.clientWidth||r.clientWidth;return B},b.getWindowHeight=function(){var w=window,A=document,s=A.documentElement,r=A.getElementsByTagName("body")[0],B=w.innerHeight||s.clientHeight||r.clientHeight;return B},b.getPosition=function(w){if(w.changedTouches&&w.changedTouches[0])var A=w.changedTouches[0].pageX,s=w.changedTouches[0].pageY;else var A=window.Event?w.pageX:w.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),s=window.Event?w.pageY:w.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[A,s]},b.click=function(w){if(w.click)w.click();else{var A=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});w.dispatchEvent(A)}},b.findElement=function(w,A){var s=!1;function r(B){B&&!s&&(typeof A=="function"?s=A(B):typeof A=="string"&&B.classList&&B.classList.contains(A)&&(s=B)),B.parentNode&&!s&&r(B.parentNode)}return r(w),s};var o=b;const g=function(w){return typeof w=="object"||typeof w=="function"};function m(w,A,s){if(typeof w!="string"||w.length===0)return;const r=w.split(".");if(r.length===0)return;let B=this;if(typeof A>"u"&&typeof s>"u"){for(let ee=0;ee<r.length;ee++){const F=r[ee];if(B!=null&&g(B)&&Object.prototype.hasOwnProperty.call(B,F))B=B[F];else return}return B}for(let ee=0;ee<r.length-1;ee++){const F=r[ee];if(B==null||!g(B))return console.warn(`Cannot set value: path '${w}' blocked by invalid object at '${F}'`),!1;Object.prototype.hasOwnProperty.call(B,F)&&(B[F]==null||!g(B[F]))?B[F]={}:Object.prototype.hasOwnProperty.call(B,F)||(B[F]={}),B=B[F]}const te=r[r.length-1];return B==null||!g(B)?!1:s===!0?Object.prototype.hasOwnProperty.call(B,te)?(delete B[te],!0):!1:(B[te]=A,!0)}function p(w,A){var s={};s.options={};var r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},B=null;for(var te in r)A&&A.hasOwnProperty(te)?s.options[te]=A[te]:s.options[te]=r[te];w.classList.add("jsorting"),w.addEventListener("dragstart",function(L){let V=L.target;if(V.nodeType===3)if(V.parentNode.getAttribute("draggable")==="true")V=V.parentNode;else{L.preventDefault(),L.stopPropagation();return}if(V.getAttribute("draggable")==="true"){let G=Array.prototype.indexOf.call(V.parentNode.children,V);B={element:V,o:G,d:G},V.style.opacity="0.25",typeof s.options.ondragstart=="function"&&s.options.ondragstart(w,V,L),L.dataTransfer.setDragImage(V,0,0)}}),w.addEventListener("dragover",function(L){if(L.preventDefault(),B&&ee(L.target)&&L.target.getAttribute("draggable")=="true"&&B.element!=L.target){if(s.options.direction)var V=L.target.clientWidth/2>L.offsetX;else var V=L.target.clientHeight/2>L.offsetY;V?L.target.parentNode.insertBefore(B.element,L.target):L.target.parentNode.insertBefore(B.element,L.target.nextSibling),B.d=Array.prototype.indexOf.call(L.target.parentNode.children,B.element)}}),w.addEventListener("dragleave",function(L){L.preventDefault()}),w.addEventListener("dragend",function(L){L.preventDefault(),B&&(typeof s.options.ondragend=="function"&&s.options.ondragend(w,B.element,L),B.o<B.d?L.target.parentNode.insertBefore(B.element,L.target.parentNode.children[B.o]):L.target.parentNode.insertBefore(B.element,L.target.parentNode.children[B.o].nextSibling),B.element.style.opacity="",B=null)}),w.addEventListener("drop",function(L){L.preventDefault(),B&&(B.o!==B.d&&typeof s.options.ondrop=="function"&&s.options.ondrop(w,B.o,B.d,B.element,L.target,L),B.element.style.opacity="",B=null)});for(var ee=function(L){var V=!1;function G(ne){ne.className&&ne.classList.contains("jsorting")&&(V=!0),V||G(ne.parentNode)}return G(L),V},F=0;F<w.children.length;F++)w.children[F].hasAttribute("draggable")||w.children[F].setAttribute("draggable","true");return w.val=function(){for(var L=null,V=[],G=0;G<w.children.length;G++)(L=w.children[G].getAttribute("data-id"))&&V.push(L);return V},w}function C(w,A){var s={};(!A.loadUp||typeof A.loadUp!="function")&&(A.loadUp=function(){return!1}),(!A.loadDown||typeof A.loadDown!="function")&&(A.loadDown=function(){return!1}),A.timer||(A.timer=100);var r=null,B=function(te){if(r==null){var ee=!1,F=w.scrollTop;w.scrollTop+w.clientHeight*2>=w.scrollHeight?A.loadDown()&&(F==w.scrollTop&&(w.scrollTop=w.scrollTop-w.clientHeight),ee=!0):w.scrollTop<=w.clientHeight&&A.loadUp()&&(F==w.scrollTop&&(w.scrollTop=w.scrollTop+w.clientHeight),ee=!0),r=setTimeout(function(){r=null},A.timer),ee&&typeof A.onupdate=="function"&&A.onupdate()}};return w.onscroll=function(te){B()},w.onwheel=function(te){B()},s}function T(){var w=function(A,s){if(Array.isArray(A)){var r={instance:[],complete:s};if(A.length>0)for(var B=0;B<A.length;B++)A[B].multiple=r,r.instance.push(w(A[B]));return r}if(A.data||(A.data={}),A.type&&(A.method=A.type),A.method||(A.method="GET"),A.dataType||(A.dataType="json"),A.data){var te=function(ne,ge){var ce=[];if(ne){var fe=Object.keys(ne);if(fe.length)for(var Ee=0;Ee<fe.length;Ee++){if(ge)var De=ge+"["+fe[Ee]+"]";else var De=fe[Ee];if(ne[De]instanceof FileList)ce[De]=ne[fe[Ee]];else if(ne[fe[Ee]]===null||ne[fe[Ee]]===void 0)ce[De]="";else if(typeof ne[fe[Ee]]=="object")for(var Se=te(ne[fe[Ee]],De),Ue=Object.keys(Se),$e=0;$e<Ue.length;$e++)ce[Ue[$e]]=Se[Ue[$e]];else ce[De]=ne[fe[Ee]]}}return ce},ee=te(A.data),F=Object.keys(ee);if(A.method=="GET"){if(F.length){for(var L=[],B=0;B<F.length;B++)L.push(F[B]+"="+encodeURIComponent(ee[F[B]]));A.url.indexOf("?")<0&&(A.url+="?"),A.url+=L.join("&")}}else for(var L=new FormData,B=0;B<F.length;B++)if(ee[F[B]]instanceof FileList){if(ee[F[B]].length)for(var V=0;V<ee[F[B]].length;V++)L.append(F[B],ee[F[B]][V],ee[F[B]][V].name)}else L.append(F[B],ee[F[B]])}var G=new XMLHttpRequest;return G.open(A.method,A.url,!0),A.requestedWith?G.setRequestHeader("X-Requested-With",A.requestedWith):A.requestedWith!==!1&&G.setRequestHeader("X-Requested-With","XMLHttpRequest"),A.contentType&&G.setRequestHeader("Content-Type",A.contentType),A.method==="POST"?G.setRequestHeader("Accept","application/json"):A.dataType==="blob"?G.responseType="blob":A.contentType||(A.dataType==="json"?G.setRequestHeader("Content-Type","text/json"):A.dataType==="html"&&G.setRequestHeader("Content-Type","text/html")),A.cache!==!0&&(G.setRequestHeader("pragma","no-cache"),G.setRequestHeader("cache-control","no-cache")),A.withCredentials===!0&&(G.withCredentials=!0),typeof A.beforeSend=="function"&&A.beforeSend(G),typeof w.beforeSend=="function"&&w.beforeSend(G),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(G),G.onerror=function(){A.error&&typeof A.error=="function"&&A.error({message:"Network error: Unable to reach the server.",status:0})},G.ontimeout=function(){A.error&&typeof A.error=="function"&&A.error({message:"Request timed out after "+G.timeout+"ms.",status:0})},G.onload=function(){if(G.status>=200&&G.status<300)if(A.dataType==="json")try{var ne=JSON.parse(G.responseText);A.success&&typeof A.success=="function"&&A.success(ne)}catch(ce){A.error&&typeof A.error=="function"&&A.error(ce,ne)}else{if(A.dataType==="blob")var ne=G.response;else var ne=G.responseText;A.success&&typeof A.success=="function"&&A.success(ne)}else A.error&&typeof A.error=="function"&&A.error(G.responseText,G.status);if(w.queue&&w.queue.length>0&&w.send(w.queue.shift()),w.requests&&w.requests.length){var ge=w.requests.indexOf(G);if(w.requests.splice(ge,1),w.requests.length||A.complete&&typeof A.complete=="function"&&A.complete(ne),A.group&&w.oncomplete&&typeof w.oncomplete[A.group]=="function"&&(w.pending(A.group)||(w.oncomplete[A.group](),w.oncomplete[A.group]=null)),A.multiple&&A.multiple.instance){var ge=A.multiple.instance.indexOf(G);A.multiple.instance.splice(ge,1),A.multiple.instance.length||A.multiple.complete&&typeof A.multiple.complete=="function"&&A.multiple.complete(ne)}}},G.options=A,G.data=L,A.queue===!0&&w.requests.length>0?w.queue.push(G):w.send(G),G};return w.send=function(A){A.data?Array.isArray(A.data)?A.send(A.data.join("&")):A.send(A.data):A.send(),w.requests.push(A)},w.exists=function(A,s){var r=new XMLHttpRequest;r.open("HEAD",A,!1),r.send(),r.status&&s(r.status)},w.pending=function(A){var s=0,r=w.requests;if(r&&r.length)for(var B=0;B<r.length;B++)(!A||A==r[B].options.group)&&s++;return s},w.oncomplete={},w.requests=[],w.queue=[],w}var I=T();function _(){const w={loading:{}};return w.loading.show=function(A){w.loading.element||(w.loading.element=document.createElement("div"),w.loading.element.className="jloading"),document.body.appendChild(w.loading.element),A>0&&setTimeout(function(){w.loading.hide()},A*1e3)},w.loading.hide=function(){w.loading.element&&w.loading.element.parentNode&&document.body.removeChild(w.loading.element)},w.slideLeft=function(A,s,r){s==!0?(A.classList.add("jslide-left-in"),setTimeout(function(){A.classList.remove("jslide-left-in"),typeof r=="function"&&r()},400)):(A.classList.add("jslide-left-out"),setTimeout(function(){A.classList.remove("jslide-left-out"),typeof r=="function"&&r()},400))},w.slideRight=function(A,s,r){s===!0?(A.classList.add("jslide-right-in"),setTimeout(function(){A.classList.remove("jslide-right-in"),typeof r=="function"&&r()},400)):(A.classList.add("jslide-right-out"),setTimeout(function(){A.classList.remove("jslide-right-out"),typeof r=="function"&&r()},400))},w.slideTop=function(A,s,r){s===!0?(A.classList.add("jslide-top-in"),setTimeout(function(){A.classList.remove("jslide-top-in"),typeof r=="function"&&r()},400)):(A.classList.add("jslide-top-out"),setTimeout(function(){A.classList.remove("jslide-top-out"),typeof r=="function"&&r()},400))},w.slideBottom=function(A,s,r){s===!0?(A.classList.add("jslide-bottom-in"),setTimeout(function(){A.classList.remove("jslide-bottom-in"),typeof r=="function"&&r()},400)):(A.classList.add("jslide-bottom-out"),setTimeout(function(){A.classList.remove("jslide-bottom-out"),typeof r=="function"&&r()},100))},w.fadeIn=function(A,s){A.style.display="",A.classList.add("jfade-in"),setTimeout(function(){A.classList.remove("jfade-in"),typeof s=="function"&&s()},2e3)},w.fadeOut=function(A,s){A.classList.add("jfade-out"),setTimeout(function(){A.style.display="none",A.classList.remove("jfade-out"),typeof s=="function"&&s()},1e3)},w}var O=_();function M(){var w={};w.now=function(ee,F){var L=null,V=null,G=null,ne=null,ge=null,ce=null;return Array.isArray(ee)?(L=ee[0],V=ee[1],G=ee[2],ne=ee[3],ge=ee[4],ce=ee[5]):(ee||(ee=new Date),L=ee.getFullYear(),V=ee.getMonth()+1,G=ee.getDate(),ne=ee.getHours(),ge=ee.getMinutes(),ce=ee.getSeconds()),F==!0?o.two(L)+"-"+o.two(V)+"-"+o.two(G):o.two(L)+"-"+o.two(V)+"-"+o.two(G)+" "+o.two(ne)+":"+o.two(ge)+":"+o.two(ce)},w.toArray=function(ee){var L=ee.split(ee.indexOf("T")!==-1?"T":" "),F=L[1],L=L[0].split("-"),V=parseInt(L[0]),G=parseInt(L[1]),ne=parseInt(L[2]),ge=0,ce=0;return F&&(F=F.split(":"),ge=parseInt(F[0]),ce=parseInt(F[1])),[V,G,ne,ge,ce,0]};var A=Date.UTC(1900,0,0),s=Date.UTC(1900,1,29),r=864e5;w.dateToNum=function(ee){typeof ee=="string"&&(ee=new Date(ee+"  GMT+0"));var F=ee.getTime();return F>=s&&(F+=r),F-=A,F/r},w.numToDate=function(ee){var F=A+ee*r;F>=s&&(F-=r);const L=new Date(F);var V=[L.getUTCFullYear(),L.getUTCMonth()+1,L.getUTCDate(),L.getUTCHours(),L.getUTCMinutes(),L.getUTCSeconds()];return w.now(V)};let B=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],te=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(w,"weekdays",{get:function(){return B.map(function(ee){return f.translate(ee)})}}),Object.defineProperty(w,"weekdaysShort",{get:function(){return B.map(function(ee){return f.translate(ee).substring(0,3)})}}),Object.defineProperty(w,"months",{get:function(){return te.map(function(ee){return f.translate(ee)})}}),Object.defineProperty(w,"monthsShort",{get:function(){return te.map(function(ee){return f.translate(ee).substring(0,3)})}}),w}var D=M();function Z(){var w={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},A=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var v=0;this.date[4]&&(v=parseFloat(this.date[4]/60));var S=parseInt(this.date[3])+v;S/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?S=o.two(this.date[3])+":"+o.two(this.date[4])+":"+o.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),S=o.two(this.date[0])+"-"+o.two(this.date[1])+"-"+o.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(S+=" "+o.two(this.date[3])+":"+o.two(this.date[4])+":"+o.two(this.date[5])));return S},s=function(){var v="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)v=parseInt(this.date[3]);else{let X=parseInt(this.date[3]);X<13&&this.values.indexOf("PM")!==-1?v=(X+12)%24:v=X%24}this.date[4]&&(v+=parseFloat(this.date[4]/60)),this.date[5]&&(v+=parseFloat(this.date[5]/3600)),v/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var S=D.now(this.date);v=D.dateToNum(S)}return isNaN(v)&&(v=""),v},r=function(v){return v===null||v===""||v===void 0},B=function(v){var S=(""+v)[0];return S=="="},te=function(v){return v==="currency"||v==="percentage"||v==="scientific"||v==="numeric"},ee=function(v){if(v&&Number(v)==v)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var S=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=S[1]}else{v||(v=this.mask);var X=new RegExp("0{1}(.{1})0+","ig"),S=X.exec(v);if(S&&S[1]&&S[1].length==1)return this.options.decimal=S[1],S[1];var X=new RegExp("#{1}(.{1})#+","ig"),S=X.exec(v);S&&S[1]&&S[1].length==1?S[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},F=function(v,S){if(v=="")return"";S||(S=ee.call(this)),v=(""+v).split(S);var X=v[0].match(/[-]+/g);if(X&&X.length?X=!0:X=!1,v[0]=v[0].match(/[0-9]+/g),v[0]?(X&&v[0].unshift("-"),v[0]=v[0].join("")):X&&(v[0]="-"),v[0]||v[1])v[1]!==void 0&&(v[1]=v[1].match(/[0-9]+/g),v[1]?v[1]=v[1].join(""):v[1]="");else return"";return v},L=function(v,S){if(v==="")return"";var X=ee.call(this),ue=this.options;if(v=F.call(this,v),v==="")return"";var K=null;if(v[0]&&(ue.style==="percent"?K=parseFloat(v[0])/100:K=parseFloat(v[0]+".1")),(v[0]==="-"||v[0]==="-00")&&!v[1]&&S&&S.inputType=="deleteContentBackward")return"";var le=new Intl.NumberFormat(this.locale,ue).format(K);if(le=le.split(X),ue.style==="percent"&&le[0].indexOf("%")!==-1&&(le[0]=le[0].replace("%",""),le[2]="%"),typeof le[1]<"u"){var je=le[1].replace(/[0-9]*/g,"");je&&(le[2]=je)}return v[1]!==void 0?le[1]=X+v[1]:le[1]="",le.join("")},V=function(v,S){var X=ge.call(v);if(X){var ue=L.call(this,X,S),K=ue.length-X.length,le=ne.call(v)+K;ge.call(v,ue,le,!0)}},G=function(v){var S=F.call(this,v);return S?(S[0]==="-"&&(S[0]="-0"),parseFloat(S.join("."))):null},ne=function(v,S){if(v===void 0)if(this.tagName=="DIV"){var X=0,ue=window.getSelection();if(ue&&ue.rangeCount!==0){var K=ue.getRangeAt(0),le=K.cloneRange();le.selectNodeContents(this),le.setEnd(K.endContainer,K.endOffset),X=le.toString().length}return X}else return this.selectionStart;else{var je=ge.call(this);if(S){for(var le=null,Te=0;Te<je.length;Te++)(je[Te].match(/[\-0-9]/g)||je[Te]==="."||je[Te]===",")&&(le=Te);le===null&&(le=je.indexOf(" ")),v>=le&&(v=le+1)}if(v>je.length&&(v=je.length),v)if(this.tagName=="DIV"){var ue=window.getSelection(),K=document.createRange();this.childNodes[0]&&(K.setStart(this.childNodes[0],v),ue.removeAllRanges(),ue.addRange(K))}else this.selectionStart=v,this.selectionEnd=v}},ge=function(v,S,X){if(this.tagName=="DIV")if(v===void 0){var v=this.innerText;return this.value&&this.value.length>v.length&&(v=this.value),v}else this.innerText!==v&&(this.innerText=v,S&&ne.call(this,S,X));else{if(v===void 0)return this.value;this.value!==v&&(this.value=v,S&&ne.call(this,S,X))}},ce=D.weekdays,fe=D.weekdaysShort,Ee=D.months,De=D.monthsShort,Se={YEAR:function(v,S){var X=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<=10&&this.values[this.index].length<S&&(this.values[this.index]+=v),this.values[this.index].length==S){if(S==2)var X=X.substr(0,2)+this.values[this.index];else if(S==3)var X=X.substr(0,1)+this.values[this.index];else if(S==4)var X=this.values[this.index];this.date[0]=X,this.index++}},YYYY:function(v){Se.YEAR.call(this,v,4)},YYY:function(v){Se.YEAR.call(this,v,3)},YY:function(v){Se.YEAR.call(this,v,2)},FIND:function(v,S){if(r(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=v;return}for(var X=0,ue=0,K=(this.values[this.index]+v).toLowerCase(),le=0;le<S.length;le++)S[le].toLowerCase().indexOf(K)==0&&(X=le,ue++);if(ue>1)this.values[this.index]+=v;else if(ue==1){var je=S[X].length-this.values[this.index].length-1;return this.position+=je,this.values[this.index]=S[X],this.index++,X}},MMM:function(v){var S=Se.FIND.call(this,v,De);S!==void 0&&(this.date[1]=S+1)},MON:function(v){Se.MMM.call(this,v)},MMMM:function(v){var S=Se.FIND.call(this,v,Ee);S!==void 0&&(this.date[1]=S+1)},MONTH:function(v){Se.MMMM.call(this,v)},MMMMM:function(v){r(this.values[this.index])&&(this.values[this.index]="");for(var S=(this.values[this.index]+v).toLowerCase(),X=0;X<Ee.length;X++)if(Ee[X][0].toLowerCase().indexOf(S)==0){this.values[this.index]=Ee[X][0],this.date[1]=X+1,this.index++;break}},MM:function(v){r(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(this.date[1]=this.values[this.index]="0"+v,this.index++):parseInt(v)<2&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[1]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[1]=this.values[this.index]+=v,this.index++)},M:function(v){var S=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))this.values[this.index]=v,v>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[1]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[1]=this.values[this.index]+=v,this.index++;else var S=!0;else var S=!0;if(S==!0){var X=parseInt(this.values[this.index]);X>0&&X<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(v){var S=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))this.values[this.index]=v,parseInt(v)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(v)<2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[2]=this.values[this.index]+=v,this.index++;else var S=!0;else var S=!0;if(S==!0){var X=parseInt(this.values[this.index]);X>0&&X<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(v){r(this.values[this.index])?parseInt(v)>3&&parseInt(v)<10?(this.date[2]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==3&&parseInt(v)<2?(this.date[2]=this.values[this.index]+=v,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(v)<10?(this.date[2]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[2]=this.values[this.index]+=v,this.index++)},DDD:function(v){Se.FIND.call(this,v,fe)},DY:function(v){Se.DDD.call(this,v)},DDDD:function(v){Se.FIND.call(this,v,ce)},DAY:function(v){Se.DDDD.call(this,v)},HH12:function(v,S){var X=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(r(this.values[this.index]))parseInt(v)>1&&parseInt(v)<10?(S&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[3]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]<1&&parseInt(v)<10)this.date[3]=this.values[this.index]+=v,this.index++;else var X=!0;else var X=!0;if(X==!0){var ue=parseInt(this.values[this.index]);ue>=0&&ue<=12&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH24:function(v,S){var X=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(this.values[this.index]==null||this.values[this.index]=="")parseInt(v)>2&&parseInt(v)<10?(S&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v);else if(this.values[this.index]==2&&parseInt(v)<4)!S&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]<2&&parseInt(v)<10)!S&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++;else var X=!0;else var X=!0;if(X==!0){var ue=parseInt(this.values[this.index]);ue>=0&&ue<24&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH:function(v){Se.HH24.call(this,v,1)},H:function(v){Se.HH24.call(this,v,0)},"\\[H\\]":function(v){this.values[this.index]==null&&(this.values[this.index]=""),v.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=v:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(v,S){this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>5&&parseInt(v)<10?(this.date[S]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):parseInt(v)<10&&(this.date[S]=this.values[this.index]+=v,this.index++)},MI:function(v){Se.N60.call(this,v,4)},SS:function(v){Se.N60.call(this,v,5)},"AM/PM":function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?v.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":v.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<7&&(this.values[this.index]=v),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(v){var S=ee.call(this),X=!1;r(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(X=!0);var ue=F.call(this,this.values[this.index],S);ue&&(this.values[this.index]=ue.join(S)),parseInt(v)>=0&&parseInt(v)<10?(this.values[this.index]=="0"&&v>0?this.values[this.index]="":this.values[this.index]=="-0"&&v>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||v==S)&&(this.values[this.index]+=v)):S&&v==S?this.values[this.index].indexOf(S)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=v):v=="-"&&(X=!0),X===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(v){Se["0{1}(.{1}0+)?"].call(this,v)},"0{1}(.{1}0+)?%":function(v){Se["0{1}(.{1}0+)?"].call(this,v),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(v){Se["0{1}(.{1}0+)?"].call(this,v);var S=ee.call(this),X=this.tokens[this.index].substr(1,1),ue=this.values[this.index][0]==="-",K=F.call(this,this.values[this.index],S);if(K!==""){var le=K[0].match(/[0-9]/g);if(le){le=le.join("");for(var je=[],Te=0,ve=le.length-1;ve>=0;ve--)je.push(le[ve]),Te++,Te%3||je.push(X);je=je.reverse(),K[0]=je.join(""),K[0].substr(0,1)==X&&(K[0]=K[0].substr(1))}else K[0]="";this.values[this.index]=K.join(S),ue&&(this.values[this.index]="-"+this.values[this.index])}},0:function(v){v.match(/[0-9]/g)&&(this.values[this.index]=v,this.index++)},"[0-9a-zA-Z$]+":function(v){r(this.values[this.index])&&(this.values[this.index]="");var S=this.tokens[this.index],X=this.values[this.index],ue=X.length;S[ue]==v?(this.values[this.index]+=v,this.values[this.index]==S&&this.index++):(this.values[this.index]=S,this.index++,v.match(/[\-0-9]/g)&&this.position--)},A:function(v){v.match(/[a-zA-Z]/gi)&&(this.values[this.index]=v,this.index++)},".":function(v){Se["[0-9a-zA-Z$]+"].call(this,v)},"@":function(v){r(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=v}},Ue=function(v){if(this.type=="general")var S=[].concat(w.general);else var S=[].concat(w.currency,w.datetime,w.percentage,w.scientific,w.numeric,w.text,w.general);var X=new RegExp(S.join("|"),"gi");return v.match(X)},$e=function(v){if(this.type)if(this.type=="text")var S=["text"];else if(this.type=="general")var S=["general"];else if(this.type=="datetime")var S=["numeric","datetime","general"];else var S=["currency","percentage","scientific","numeric","general"];else var S=Object.keys(w);for(var X=0;X<S.length;X++)for(var ue=S[X],K=0;K<w[ue].length;K++){var le=new RegExp(w[ue][K],"gi"),je=v.match(le);if(je)return{type:ue,method:w[ue][K]}}},Q=function(v){for(var S=[],X=0;X<v.length;X++){var ue=$e.call(this,v[X]);ue?S.push(ue.method):S.push(null)}for(var X=0;X<S.length;X++)S[X]=="MM"&&(S[X-1]&&S[X-1].indexOf("H")>=0||S[X-2]&&S[X-2].indexOf("H")>=0||S[X+1]&&S[X+1].indexOf("S")>=0||S[X+2]&&S[X+2].indexOf("S")>=0)&&(S[X]="MI");return S},pe=function(v){var S=$e.call(this,v);if(S)var X=S.type;if(X){for(var ue=0,K=Ue.call(this,v),le=0;le<K.length;le++)S=$e.call(this,K[le]),S&&te(S.type)&&ue++;ue>1&&(X="general")}return X},we=function(){typeof Se[this.methods[this.index]]=="function"?(Se[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},U=function(v){return(""+ +v).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(S,X,ue,K,le){return le<0?X+"0."+Array(1-le-ue.length).join(0)+ue+K:X+ue+K+Array(le-K.length+1).join(0)})},J=function(v,S,X){var ue=null,K={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof v=="object"){if(K.input=v.target,K.value=ge.call(v.target),K.caret=ne.call(v.target),(ue=v.target.getAttribute("data-mask"))&&(K.mask=ue),(ue=v.target.getAttribute("data-type"))&&(K.type=ue),v.target.mask?(v.target.mask.options&&(K.options=v.target.mask.options),v.target.mask.locale&&(K.locale=v.target.mask.locale)):(ue=v.target.getAttribute("data-locale"))&&(K.locale=ue,K.mask&&(K.options.style=K.mask)),v.target.attributes&&v.target.attributes.length)for(var le=0;le<v.target.attributes.length;le++){var je=v.target.attributes[le].name,Te=v.target.attributes[le].value;je.substr(0,4)=="data"&&(K.options[je.substr(5)]=Te)}}else{if(typeof S=="string")K.mask=S;else for(var je=Object.keys(S),le=0;le<je.length;le++)K[je[le]]=S[je[le]];typeof v=="number"&&(ee.call(K,K.mask),v=(""+v).replace(".",K.options.decimal)),K.value=v,K.input&&(ge.call(K.input,v),o.focus(K.input),K.caret=ne.call(K.input))}if(!B(K.value)&&(K.mask||K.locale)){if(K.mask){if(K.mask=K.mask.replace(new RegExp(/\[h]/),"|h|"),K.mask=K.mask.replace(new RegExp(/\[.*?\]/),""),K.mask=K.mask.replace(new RegExp(/\|h\|/),"[h]"),K.mask.indexOf(";")!==-1){var ue=K.mask.split(";");K.mask=ue[0]}if(K.mask.indexOf("##")!==-1){var ve=K.mask.split(";");ve[0]&&(typeof v=="object"&&(ve[0]=ve[0].replace(new RegExp(/_\)/g),""),ve[0]=ve[0].replace(new RegExp(/_\(/g),"")),ve[0]=ve[0].replace("*","	"),ve[0]=ve[0].replace(new RegExp(/_-/g),""),ve[0]=ve[0].replace(new RegExp(/_/g),""),ve[0]=ve[0].replace(new RegExp(/"/g),""),ve[0]=ve[0].replace("##0.###","##0.000"),ve[0]=ve[0].replace("##0.##","##0.00"),ve[0]=ve[0].replace("##0.#","##0.0"),ve[0]=ve[0].replace("##0,###","##0,000"),ve[0]=ve[0].replace("##0,##","##0,00"),ve[0]=ve[0].replace("##0,#","##0,0")),K.mask=ve[0]}if(K.mask.indexOf("\\")!==-1){var ve=K.mask.split(";");ve[0]=ve[0].replace(new RegExp(/\\/g),""),K.mask=ve[0]}K.type||(K.type=pe.call(K,K.mask)),K.tokens=Ue.call(K,K.mask)}if(typeof v!="object"||!v.inputType||!v.inputType.indexOf("insert")||!v.inputType.indexOf("delete"))if(K.locale)if(K.input)V.call(K,K.input,v);else var Ie=L.call(K,K.value);else{for(K.methods=Q.call(K,K.tokens),K.event=v;K.position<K.value.length&&typeof K.tokens[K.index]<"u";)we.call(K);var Ie=K.values.join("");if(te(K.type)&&Ie!==""){for(;typeof K.tokens[K.index]<"u";){var ue=$e.call(K,K.tokens[K.index]);ue&&ue.type=="general"&&(K.values[K.index]=K.tokens[K.index]),K.index++}var Fe=!0}else var Fe=!1;if(Ie=K.values.join(""),K.input){if(ue=Ie.length-K.value.length,ue>0)var tt=K.caret+ue;else var tt=K.caret;ge.call(K.input,Ie,tt,Fe)}}if(K.input){var re=null;if(te(K.type)){let ye=ge.call(K.input);K.number=G.call(K,ye),K.type=="percentage"&&(""+ye).indexOf("%")!==-1?re=J.adjustPrecision(K.number/100):re=K.number}else K.type=="datetime"&&(re=A.call(K),K.date[0]&&K.date[1]&&K.date[2]&&K.input.setAttribute("data-completed",!0));re&&K.input.setAttribute("data-value",re)}if(Ie!==void 0)return X?K:Ie}};return J.adjustPrecision=function(v){if(typeof v=="number"&&!Number.isInteger(v)){const S=v.toString().split(".");if(S[1]&&S[1].length>10){let X=0;const ue=S[1][S[1].length-2];if(ue==0||ue==9){for(let K=S[1].length-2;K>0;K--)if(X>=0&&S[1][K]==ue){if(X++,X>6)break}else{X=0;break}if(X)return parseFloat(parseFloat(v).toFixed(S[1].length-1))}}}return v},J.getType=pe,J.prepare=function(v,S){return S||(S={}),Ue.call(S,v)},J.apply=function(v){var S=ge.call(v.target);v.key.length==1&&(S+=v.key),ge.call(v.target,J(S,v.target.getAttribute("data-mask")))},J.run=function(v,S,X){return J(v,{mask:S,decimal:X})},J.extract=function(v,S,X){if(r(v)||typeof S!="object")return v;if(S=Object.assign({},S),S.options||(S.options={}),!S.mask&&S.format&&(S.mask=S.format),S.mask){if(S.mask.indexOf(";")!==-1){var ue=S.mask.split(";");S.mask=ue[0]}S.mask=S.mask.replace(new RegExp(/\[h]/),"|h|"),S.mask=S.mask.replace(new RegExp(/\[.*?\]/),""),S.mask=S.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(S,S.mask);var K=null,le=null;if(S.type=="percent"||S.options.style=="percent"?K="percentage":S.mask&&(K=pe.call(S,S.mask)),K==="text"){var je={};le=v}else if(K==="general"){var je=J(v,S,!0);le=v}else if(K==="datetime"){v instanceof Date&&(v=J.getDateString(v,S.mask));var je=J(v,S,!0);o.isNumeric(v)?le=v:le=s.call(je)}else if(K==="scientific"){le=v,typeof v=="string"&&(le=Number(le));var je=S}else{le=G.call(S,v),K==="percentage"&&(""+v).indexOf("%")!==-1&&(le/=100);var je=S}return je.value=le,!je.type&&K&&(je.type=K),X?je:le},J.render=function(v,S,X,ue){if(r(v)||typeof S!="object")return v;if(S=Object.assign({},S),S.options||(S.options={}),!S.mask&&S.format&&(S.mask=S.format),S.mask){if(S.mask.indexOf(";")!==-1){var K=S.mask.split(";");X||(K[0]=K[0].replace(new RegExp(/_\)/g),""),K[0]=K[0].replace(new RegExp(/_\(/g),"")),S.mask=K[0]}S.mask=S.mask.replace(new RegExp(/\[h]/),"|h|"),S.mask=S.mask.replace(new RegExp(/\[.*?\]/),""),S.mask=S.mask.replace(new RegExp(/\|h\|/),"[h]")}var le=null;S.type=="percent"||S.options.style=="percent"?le="percentage":S.mask?le=pe.call(S,S.mask):v instanceof Date&&(le="datetime");var je=!1;if(le=="datetime"||S.type=="calendar"){var K=J.getDateString(v,S.mask);K&&(v=K),S.mask&&X&&(je=!0)}else if(le==="text")typeof v=="number"&&(v=v.toString());else if(typeof v=="string"&&c.isNumeric(v)&&(v=Number(v)),le==="percentage"&&(v=J.adjustPrecision(v*100)),typeof v=="number"){var K=null;if(S.mask&&X){var Te=ee.call(S,S.mask);if(le==="scientific")if(S.mask.indexOf(Te)!==-1){let xe=S.mask.split("E");xe=xe[0].split(Te),xe=""+xe[1].match(/[0-9]+/g),xe=xe.length,K=v.toExponential(xe)}else K=v.toExponential(0);else{if(S.mask.indexOf(Te)!==-1){Te=S.mask.split(Te),Te=""+Te[1].match(/[0-9]+/g),Te=Te.length,K=v.toFixed(Te);let xe=v.toString().split("."),Oe=xe[1];Oe&&Oe.length>Te&&Oe[Oe.length-1]==="5"&&(K=parseFloat(xe[0]+"."+Oe+"1").toFixed(Te))}else K=v.toFixed(0);(""+K).indexOf("e")!==-1&&(K=U(K))}}else if(S.locale&&X){var Te=(""+v).split(".");if(S.options){typeof Te[1]>"u"&&(Te[1]="");var Ie=Te[1].length;if(S.options.minimumFractionDigits>Ie)for(var ve=0;ve<S.options.minimumFractionDigits-Ie;ve++)Te[1]+="0"}Te[1].length?K=Te.join("."):K=Te[0];var Ie=Te[1].length;S.options&&S.options.maximumFractionDigits<Ie&&(K=parseFloat(K).toFixed(S.options.maximumFractionDigits))}else K=U(v);K!==null&&(v=K,ee.call(S,S.mask),S.options.decimal&&(v=v.replace(".",S.options.decimal)))}else S.mask&&X&&(je=!0);if(je){var Fe=S.mask.length-v.length;if(Fe>0)for(var ve=0;ve<Fe;ve++)v+=" "}if(le==="scientific")if(!X)v=U(v);else return v;if(le==="numeric"&&ue===!1&&typeof v=="string")return v;if(v=J(v,S),X&&le==="numeric"){var tt=S.mask.match(new RegExp(/^[0]+$/gm));if(tt&&tt.length===1){var re=tt[0].length;if(re>3)for(v=""+v;v.length<re;)v="0"+v}}return v},J.set=function(v,S){if(S){v.setAttribute("data-mask",S);var X=new Event("input",{bubbles:!0,cancelable:!0});v.dispatchEvent(X)}},J.extractDateFromString=function(v,S){var X=J(v,{mask:S},!0);if(v>0&&Number(v)==v&&(X.values.join("")!==X.value||X.type=="numeric")){var ue=new Date(Math.round((v-25569)*86400*1e3));return ue.getFullYear()+"-"+o.two(ue.getMonth())+"-"+o.two(ue.getDate())+" 00:00:00"}var K=!1;return X.values&&X.values.length===X.tokens.length&&X.values[X.values.length-1].length>=X.tokens[X.tokens.length-1].length&&(K=!0),X.date[0]&&X.date[1]&&(X.date[2]||K)?(X.date[2]||(X.date[2]=1),X.date[0]+"-"+o.two(X.date[1])+"-"+o.two(X.date[2])+" "+o.two(X.date[3])+":"+o.two(X.date[4])+":"+o.two(X.date[5])):""},J.getDateString=function(v,S){if(!S)var S={};if(S&&typeof S=="object"){if(S.format)var X=S.format;else if(S.mask)var X=S.mask}else var X=S;if(X||(X="YYYY-MM-DD"),X.indexOf("[h]")>=0){var ue=0;if(v&&o.isNumeric(v)&&(ue=parseFloat(24*Number(v)),X.indexOf("mm")>=0)){var K=(""+ue).split(".");if(K[1]){var le=60*parseFloat("0."+K[1]);le=parseFloat(le.toFixed(2))}else var le=0;ue=parseInt(K[0])+":"+o.two(le)}return ue}v instanceof Date?v=D.now(v):v&&o.isNumeric(v)&&(v=D.numToDate(v));for(var je=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Te=new RegExp(je.join("|"),"gi"),ve=X.match(Te),Ie=0;Ie<ve.length;Ie++)ve[Ie].toUpperCase()=="MM"&&(ve[Ie-1]&&ve[Ie-1].toUpperCase().indexOf("H")>=0||ve[Ie-2]&&ve[Ie-2].toUpperCase().indexOf("H")>=0||ve[Ie+1]&&ve[Ie+1].toUpperCase().indexOf("S")>=0||ve[Ie+2]&&ve[Ie+2].toUpperCase().indexOf("S")>=0)&&(ve[Ie]="mi");var Fe={tokens:ve};if(v){var le=""+v,tt=le.indexOf("T")!==-1?"T":" ";le=le.split(tt);var K=0,re=0,ye=0;le[1]&&(K=le[1].split(":"),re=K[1]?K[1]:0,ye=K[2]?K[2]:0,K=K[0]?K[0]:0),le=le[0].split("-");let ot=new Date(le[0],le[1],0).getDate();if(le[0]&&le[1]&&le[2]&&le[0]>0&&le[1]>0&&le[1]<13&&le[2]>0&&le[2]<=ot){Fe.data=[le[0],le[1],le[2],K,re,ye],Fe.value=[];for(var xe=new Date(Fe.data[0],Fe.data[1]-1,Fe.data[2],Fe.data[3],Fe.data[4],Fe.data[5]),Oe=function(ft){var nt=this.tokens[ft],ut=nt.toUpperCase(),Xe=null;ut==="YYYY"?Xe=this.data[0]:ut==="YYY"?Xe=this.data[0].substring(1,4):ut==="YY"?Xe=this.data[0].substring(2,4):ut==="Y"?Xe=this.data[0].substring(3,4):nt==="MON"?Xe=D.months[xe.getMonth()].substr(0,3).toUpperCase():nt==="mon"?Xe=D.months[xe.getMonth()].substr(0,3).toLowerCase():nt==="MONTH"?Xe=D.months[xe.getMonth()].toUpperCase():nt==="month"?Xe=D.months[xe.getMonth()].toLowerCase():ut==="MMMMM"?Xe=D.months[xe.getMonth()].substr(0,1):ut==="MMMM"||nt==="Month"?Xe=D.months[xe.getMonth()]:ut==="MMM"||nt=="Mon"?Xe=D.months[xe.getMonth()].substr(0,3):ut==="MM"?Xe=o.two(this.data[1]):ut==="M"?Xe=xe.getMonth()+1:nt==="DAY"?Xe=D.weekdays[xe.getDay()].toUpperCase():nt==="day"?Xe=D.weekdays[xe.getDay()].toLowerCase():ut==="DDDD"||nt=="Day"?Xe=D.weekdays[xe.getDay()]:ut==="DDD"?Xe=D.weekdays[xe.getDay()].substr(0,3):ut==="DD"?Xe=o.two(this.data[2]):ut==="D"?Xe=parseInt(this.data[2]):ut==="Q"?Xe=Math.floor((xe.getMonth()+3)/3):ut==="HH24"||ut==="HH"?(Xe=this.data[3],Xe>12&&this.tokens.indexOf("am/pm")!==-1&&(Xe-=12),Xe=o.two(Xe)):ut==="HH12"?this.data[3]>12?Xe=o.two(this.data[3]-12):Xe=o.two(this.data[3]):ut==="H"?(Xe=this.data[3],Xe>12&&this.tokens.indexOf("am/pm")!==-1&&(Xe-=12,Xe=o.two(Xe))):ut==="MI"?Xe=o.two(this.data[4]):ut==="SS"?Xe=o.two(this.data[5]):ut==="MS"?Xe=xe.getMilliseconds():ut==="AM/PM"?this.data[3]>=12?Xe="PM":Xe="AM":ut==="WD"&&(Xe=D.weekdays[xe.getDay()]),Xe===null?this.value[ft]=this.tokens[ft]:this.value[ft]=Xe},Ie=0;Ie<Fe.tokens.length;Ie++)Oe.call(Fe,Ie);v=Fe.value.join("")}else v=""}return v},J}var q=Z();function ae(){var w=function(A,s){if(A.calendar)return A.calendar.setOptions(s,!0);var r={type:"calendar"};r.options={},r.date=null,r.setOptions=function(U,J){var v={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:D.monthsShort,monthsFull:D.months,weekdays:D.weekdays,textDone:f.translate("Done"),textReset:f.translate("Reset"),textUpdate:f.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var S in v)U&&U.hasOwnProperty(S)?r.options[S]=U[S]:(typeof r.options[S]>"u"||J===!0)&&(r.options[S]=v[S]);if(r.options.resetButton==!1?L.style.display="none":L.style.display="",r.options.readonly?A.setAttribute("readonly","readonly"):A.removeAttribute("readonly"),r.options.placeholder?A.setAttribute("placeholder",r.options.placeholder):A.removeAttribute("placeholder"),o.isNumeric(r.options.value)&&r.options.value>0&&(r.options.value=w.numToDate(r.options.value),r.options.dataType="numeric"),L.innerHTML=r.options.textReset,V.innerHTML=r.options.textDone,$e.innerHTML=r.options.textUpdate,r.options.format&&A.setAttribute("data-mask",r.options.format.toLowerCase()),!r.options.value&&r.options.today)var X=w.now();else var X=r.options.value;return X&&(r.options.value=null,r.setValue(X)),r},r.open=function(U){if(!F.classList.contains("jcalendar-focus")&&!F.classList.contains("jcalendar-inline")){if(w.current=r,P(r,!0),r.getDays(),r.options.type=="year-month-picker"&&r.getMonths(),r.options.time&&(Q.value=r.date[3],pe.value=r.date[4]),F.classList.add("jcalendar-focus"),o.getWindowWidth()<800||r.options.fullscreen)F.classList.add("jcalendar-fullsize"),O.slideBottom(ne,1);else{F.classList.remove("jcalendar-fullsize");var J=A.getBoundingClientRect(),v=ne.getBoundingClientRect();if(r.options.position)G.style.position="fixed",window.innerHeight<J.bottom+v.height?G.style.top=J.top-(v.height+2)+"px":G.style.top=J.top+J.height+2+"px",G.style.left=J.left+"px";else{if(window.innerHeight<J.bottom+v.height){var S=-1*(J.height+v.height+2);S+J.top<0&&(S=-1*(J.top+J.height)),G.style.top=S+"px"}else G.style.top="2px";if(window.innerWidth<J.left+v.width){var S=window.innerWidth-(J.left+v.width+20);G.style.left=S+"px"}else G.style.left="0px"}}typeof r.options.onopen=="function"&&r.options.onopen(A)}},r.close=function(U,J){if(r.options.autoSelect!==!0&&typeof J>"u"&&(J=!1),F.classList.contains("jcalendar-focus")){if(J!==!1){var v=F.querySelector(".jcalendar-selected");if(typeof J=="string")var S=J;else if(!v||v.classList.contains("jcalendar-disabled"))var S=r.options.value;else var S=r.getValue();r.setValue(S)}else{let X=r.options.value||"";r.options.value=null,r.setValue(X)}!U&&typeof r.options.onclose=="function"&&r.options.onclose(A),F.classList.remove("jcalendar-focus"),P(r,!1),w.current=null}return r.options.value},r.prev=function(){r.options.mode=="years"?(r.date[0]=r.date[0]-12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},r.next=function(){r.options.mode=="years"?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},r.setToday=function(){var U=new Date().toISOString().substr(0,10);return r.setValue(U),U},r.setValue=function(U){U||(U=""+U);var J=U,v=r.options.value;if(v!=J){if(J){r.setLabel(J,r.options);var X=J.split(" ");X[1]||(X[1]="00:00:00");var S=X[1].split(":"),X=X[0].split("-"),ue=parseInt(X[0]),K=parseInt(X[1]),le=parseInt(X[2]),je=parseInt(S[0]),Te=parseInt(S[1]);r.date=[ue,K,le,je,Te,0];var U=r.setLabel(J,r.options),ve=w.now(new Date(ue,K-1,le),!0);if(r.options.validRange){if(!r.options.validRange[0]||ve>=r.options.validRange[0])var Ie=!0;else var Ie=!1;if(!r.options.validRange[1]||ve<=r.options.validRange[1])var Fe=!0;else var Fe=!1;Ie&&Fe?(A.classList.remove("jcalendar_warning"),A.title=""):(A.classList.add("jcalendar_warning"),A.title=f.translate("Date outside the valid range"))}else A.classList.remove("jcalendar_warning"),A.title=""}else{r.date=null;var U="";A.classList.remove("jcalendar_warning"),A.title=""}r.options.value=J,typeof r.options.onchange=="function"&&r.options.onchange(A,J,v),A.value!=U&&(A.value=U,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))}r.date&&(r.getDays(),r.options.type=="year-month-picker"&&r.getMonths())},r.getValue=function(){return r.date?r.options.time?o.two(r.date[0])+"-"+o.two(r.date[1])+"-"+o.two(r.date[2])+" "+o.two(r.date[3])+":"+o.two(r.date[4])+":"+o.two(0):o.two(r.date[0])+"-"+o.two(r.date[1])+"-"+o.two(r.date[2])+" "+o.two(0)+":"+o.two(0)+":"+o.two(0):""},r.update=function(U,J){if(!U.classList.contains("jcalendar-disabled")){var v=F.querySelector(".jcalendar-selected");v&&v.classList.remove("jcalendar-selected"),U.classList.add("jcalendar-selected"),U.classList.contains("jcalendar-set-month")?(r.date[1]=J,r.date[2]=1):r.date[2]=U.innerText,r.options.time?(r.date[3]=Q.value,r.date[4]=pe.value):r.close(null,!0)}ee()},r.reset=function(){r.setValue(""),r.date=null,r.close(!1,!1)},r.getDays=function(){r.options.mode="days";var je=new Date,U=r.date&&o.isNumeric(r.date[0])?r.date[0]:parseInt(je.getFullYear()),J=r.date&&o.isNumeric(r.date[1])?r.date[1]:parseInt(je.getMonth())+1,v=r.date&&o.isNumeric(r.date[2])?r.date[2]:parseInt(je.getDate()),S=r.date&&o.isNumeric(r.date[3])?r.date[3]:parseInt(je.getHours()),X=r.date&&o.isNumeric(r.date[4])?r.date[4]:parseInt(je.getMinutes());r.date=[U,J,v,S,X,0],ge.innerHTML=U,ce.innerHTML=r.options.months[J-1];var ue=je.getMonth()==J-1&&je.getFullYear()==U,K=je.getDate(),je=new Date(U,J,0,0,0),le=je.getDate(),je=new Date(U,J-1,0,0,0),Te=je.getDay()+1,tt=r.options.startingDay||0;Te=Te-tt,Ee.innerHTML="";var ve=document.createElement("tr");ve.setAttribute("align","center"),Ee.appendChild(ve);for(var Ie=0;Ie<7;Ie++){var Fe=document.createElement("td");Fe.classList.add("jcalendar-weekday"),Fe.innerHTML=r.options.weekdays[tt].substr(0,1),ve.appendChild(Fe),tt++,tt>6&&(tt=0)}for(var tt=0,re=0,ye=0;ye<6;ye++){var ve=document.createElement("tr");ve.setAttribute("align","center"),ve.style.height="34px";for(var Ie=0;Ie<7;Ie++){var Fe=document.createElement("td");if(Fe.classList.add("jcalendar-set-day"),tt>=Te&&tt<Te+le){re++,Fe.innerHTML=re,re==v&&Fe.classList.add("jcalendar-selected"),ue&&K==re&&(Fe.style.fontWeight="bold");var xe=w.now(new Date(U,J-1,re),!0);if(r.options.validRange){if(!r.options.validRange[0]||xe>=r.options.validRange[0])var Oe=!0;else var Oe=!1;if(!r.options.validRange[1]||xe<=r.options.validRange[1])var Ge=!0;else var Ge=!1;Oe&&Ge||Fe.classList.add("jcalendar-disabled")}}ve.appendChild(Fe),tt++}Ee.appendChild(ve)}r.options.time?Se.style.display="":Se.style.display="none",ee()},r.getMonths=function(){r.options.mode="months";var U=r.options.months;r.options.value;var J=new Date,v=parseInt(J.getFullYear()),S=parseInt(J.getMonth())+1,X=r.date&&o.isNumeric(r.date[0])?r.date[0]:v,ue=r.date&&o.isNumeric(r.date[1])?r.date[1]:S;ge.innerHTML=r.date[0],ce.innerHTML=U[ue-1];var K=document.createElement("table");K.setAttribute("width","100%");for(var le=null,je=0;je<12;je++){if(!(je%4)){var le=document.createElement("tr");le.setAttribute("align","center"),K.appendChild(le)}var Te=document.createElement("td");if(Te.classList.add("jcalendar-set-month"),Te.setAttribute("data-value",je+1),Te.innerText=U[je],r.options.validRange){var ve=X+"-"+o.two(je+1);if(!r.options.validRange[0]||ve>=r.options.validRange[0].substr(0,7))var Ie=!0;else var Ie=!1;if(!r.options.validRange[1]||ve<=r.options.validRange[1].substr(0,7))var Fe=!0;else var Fe=!1;Ie&&Fe||Te.classList.add("jcalendar-disabled")}je+1==ue&&Te.classList.add("jcalendar-selected"),v==X&&je+1==S&&(Te.style.fontWeight="bold"),le.appendChild(Te)}Ee.innerHTML='<tr><td colspan="7"></td></tr>',Ee.children[0].children[0].appendChild(K),ee()},r.getYears=function(){r.options.mode="years";for(var U=new Date,J=U.getFullYear(),v=r.date&&o.isNumeric(r.date[0])?r.date[0]:parseInt(U.getFullYear()),S=[],X=0;X<25;X++)S[X]=parseInt(r.date[0])+(X-12);var ue=document.createElement("table");ue.setAttribute("width","100%");for(var X=0;X<25;X++){if(!(X%5)){var K=document.createElement("tr");K.setAttribute("align","center"),ue.appendChild(K)}var le=document.createElement("td");le.classList.add("jcalendar-set-year"),le.innerText=S[X],v==S[X]&&le.classList.add("jcalendar-selected"),J==S[X]&&(le.style.fontWeight="bold"),K.appendChild(le)}Ee.innerHTML='<tr><td colspan="7"></td></tr>',Ee.firstChild.firstChild.appendChild(ue),ee()},r.setLabel=function(U,J){return w.getDateString(U,J)},r.fromFormatted=function(U,J){return w.extractDateFromString(U,J)};var B=function(U){var J=o.findElement(U.target,"jcalendar-container");if(J){var v=U.target.className;if(v=="jcalendar-prev")r.prev();else if(v=="jcalendar-next")r.next();else if(v=="jcalendar-month")r.getMonths();else if(v=="jcalendar-year")r.getYears();else if(v=="jcalendar-set-year")r.date[0]=U.target.innerText,r.options.type=="year-month-picker"?r.getMonths():r.getDays();else if(U.target.classList.contains("jcalendar-set-month")){var S=parseInt(U.target.getAttribute("data-value"));r.options.type=="year-month-picker"?r.update(U.target,S):(r.date[1]=S,r.getDays())}else v=="jcalendar-confirm"||v=="jcalendar-update"||v=="jcalendar-close"?r.close(null,!0):v=="jcalendar-backdrop"?r.close(!1,!1):v=="jcalendar-reset"?r.reset():U.target.classList.contains("jcalendar-set-day")&&U.target.innerText&&r.update(U.target)}else r.close(!1,!1)},te=function(U){if(U.target.value&&U.target.value.length>3){var J=w.extractDateFromString(U.target.value,r.options.format);J&&r.setValue(J)}},ee=function(){var U=F.querySelector(".jcalendar-selected");U&&U.classList.contains("jcalendar-disabled")?($e.setAttribute("disabled","disabled"),Q.setAttribute("disabled","disabled"),pe.setAttribute("disabled","disabled")):($e.removeAttribute("disabled"),Q.removeAttribute("disabled"),pe.removeAttribute("disabled")),typeof r.options.onupdate=="function"&&r.options.onupdate(A,r.getValue())},F=null,L=null,V=null,G=null,ne=null,ge=null,ce=null,fe=null,Ee=null,De=null,Se=null,Ue=null,$e=null,Q=null,pe=null,we=function(){A.tagName=="INPUT"&&A.value&&(s.value=A.value),L=document.createElement("div"),L.className="jcalendar-reset",V=document.createElement("div"),V.className="jcalendar-confirm",De=document.createElement("div"),De.className="jcalendar-controls",De.style.borderBottom="1px solid #ddd",De.appendChild(L),De.appendChild(V),G=document.createElement("div"),G.className="jcalendar-container",ne=document.createElement("div"),ne.className="jcalendar-content",G.appendChild(ne),A.tagName=="DIV"?(F=A,F.classList.add("jcalendar-inline")):(ne.appendChild(De),F=document.createElement("div"),F.className="jcalendar"),F.classList.add("jcalendar-container"),F.appendChild(G);var U=document.createElement("div");U.className="jcalendar-table",ne.appendChild(U);var J=document.createElement("td");J.setAttribute("colspan","2"),J.className="jcalendar-prev",ge=document.createElement("span"),ge.className="jcalendar-year",ce=document.createElement("span"),ce.className="jcalendar-month";var v=document.createElement("td");v.className="jcalendar-header",v.setAttribute("colspan","3"),v.appendChild(ce),v.appendChild(ge);var S=document.createElement("td");S.setAttribute("colspan","2"),S.className="jcalendar-next";var X=document.createElement("thead"),ue=document.createElement("tr");ue.appendChild(J),ue.appendChild(v),ue.appendChild(S),X.appendChild(ue),fe=document.createElement("table"),Ee=document.createElement("tbody"),fe.setAttribute("cellpadding","0"),fe.setAttribute("cellspacing","0"),fe.appendChild(X),fe.appendChild(Ee),U.appendChild(fe),Q=document.createElement("select"),Q.className="jcalendar-select",Q.onchange=function(){r.date[3]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(A,r.getValue())};for(var K=0;K<24;K++){var le=document.createElement("option");le.value=K,le.innerHTML=o.two(K),Q.appendChild(le)}pe=document.createElement("select"),pe.className="jcalendar-select",pe.onchange=function(){r.date[4]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(A,r.getValue())};for(var K=0;K<60;K++){var le=document.createElement("option");le.value=K,le.innerHTML=o.two(K),pe.appendChild(le)}var je=document.createElement("div");je.className="jcalendar-controls",Se=document.createElement("div"),Se.className="jcalendar-time",Se.style.maxWidth="140px",Se.appendChild(Q),Se.appendChild(pe),$e=document.createElement("button"),$e.setAttribute("type","button"),$e.className="jcalendar-update",Ue=document.createElement("div"),Ue.style.flexGrow="10",Ue.appendChild($e),je.appendChild(Se),A.tagName=="INPUT"&&je.appendChild(Ue),ne.appendChild(je);var Te=document.createElement("div");Te.className="jcalendar-backdrop",F.appendChild(Te),A.addEventListener("keyup",te),F.addEventListener("swipeleft",function(ve){O.slideLeft(fe,0,function(){r.next(),O.slideRight(fe,1)}),ve.preventDefault(),ve.stopPropagation()}),F.addEventListener("swiperight",function(ve){O.slideRight(fe,0,function(){r.prev(),O.slideLeft(fe,1)}),ve.preventDefault(),ve.stopPropagation()}),"ontouchend"in document.documentElement?(F.addEventListener("touchend",B),A.addEventListener("touchend",r.open)):(F.addEventListener("mouseup",B),A.addEventListener("mouseup",r.open)),w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),r.setOptions(s),A.tagName=="INPUT"?(A.parentNode.insertBefore(F,A.nextSibling),A.setAttribute("autocomplete","off"),A.classList.add("jcalendar-input"),A.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(Q.value=r.date[3],pe.value=r.date[4])),r.options.opened==!0&&r.open(),r.options.controls==!1&&G.classList.add("jcalendar-hide-controls"),A.change=r.setValue,A.val=function(ve){if(ve===void 0)return r.getValue();r.setValue(ve)},A.calendar=F.calendar=r};return we(),r};return w.keydown=function(A){var s=null;(s=w.current)&&(A.which==13?s.close(!1,!0):A.which==27&&s.close(!1,!1))},w.prettify=function(A,s){if(!s)var s={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};A.indexOf("GMT")===-1&&A.indexOf("Z")===-1&&(A+=" GMT");var r=new Date,B=new Date(A),te=parseInt((r-B)/1e3/60);if(String.prototype.format=function(F){return this.replace("{0}",F)},te==0)var ee=s.justNow;else if(te<90)var ee=s.xMinutesAgo.format(te);else if(te<1440)var ee=s.xHoursAgo.format(Math.round(te/60));else if(te<20160)var ee=s.xDaysAgo.format(Math.round(te/1440));else if(te<43200)var ee=s.xWeeksAgo.format(Math.round(te/10080));else if(te<1036800)var ee=s.xMonthsAgo.format(Math.round(te/43200));else var ee=s.xYearsAgo.format(Math.round(te/525600));return ee},w.prettifyAll=function(){for(var A=document.querySelectorAll(".prettydate"),s=0;s<A.length;s++)A[s].getAttribute("data-date")?A[s].innerHTML=w.prettify(A[s].getAttribute("data-date")):A[s].innerHTML&&(A[s].setAttribute("title",A[s].innerHTML),A[s].setAttribute("data-date",A[s].innerHTML),A[s].innerHTML=w.prettify(A[s].innerHTML))},w.now=D.now,w.toArray=D.toArray,w.dateToNum=D.dateToNum,w.numToDate=D.numToDate,w.weekdays=D.weekdays,w.months=D.months,w.weekdaysShort=D.weekdaysShort,w.monthsShort=D.monthsShort,w.extractDateFromString=q.extractDateFromString,w.getDateString=q.getDateString,w}var he=ae();function se(){var w={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},A=function(s){return w[s]?w[s]:w.material};return A.get=function(s){return w[s]?w[s]:w},A.set=function(s,r){w[s]=r},A}var be=se();function Le(w,A){var s={};s.options={};var r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var B in r)A&&A.hasOwnProperty(B)?s.options[B]=A[B]:s.options[B]=r[B];w.classList.add("jtabs");var te=null,ee=null,F=null;const L=function(ce){s.options.animation&&setTimeout(function(){let fe=s.headers.children[ce].getBoundingClientRect();s.options.palette==="modern"?(F.style.width=fe.width-4+"px",F.style.left=s.headers.children[ce].offsetLeft+2+"px"):(F.style.width=fe.width+"px",F.style.left=s.headers.children[ce].offsetLeft+"px"),s.options.position==="bottom"?F.style.top="0px":F.style.bottom="0px"},50)};var V=function(ce){typeof s.headers.scrollTo=="function"?s.headers.scrollTo({left:ce,behavior:"smooth"}):s.headers.scrollLeft=ce,ce<=1?te.classList.add("disabled"):te.classList.remove("disabled"),ce>=s.headers.scrollWidth-s.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),s.headers.scrollWidth<=s.headers.offsetWidth?(te.style.display="none",ee.style.display="none"):(te.style.display="",ee.style.display="")};if(s.setBorder=L,s.open=function(ce){if(Array.from(s.content.children),!!s.content.children[ce]){for(var fe=null,Ee=0;Ee<s.headers.children.length;Ee++)s.headers.children[Ee].classList.contains("jtabs-selected")&&(fe=Ee),s.headers.children[Ee].classList.remove("jtabs-selected"),s.headers.children[Ee].removeAttribute("aria-selected"),s.content.children[Ee]&&s.content.children[Ee].classList.remove("jtabs-selected");if(s.headers.children[ce].classList.add("jtabs-selected"),s.headers.children[ce].setAttribute("aria-selected","true"),s.content.children[ce]&&s.content.children[ce].classList.add("jtabs-selected"),fe!=ce&&typeof s.options.onchange=="function"&&s.content.children[ce]&&s.options.onchange(w,s,ce,s.headers.children[ce],s.content.children[ce]),s.options.hideHeaders==!0&&s.headers.children.length<3&&s.options.allowCreate==!1)s.headers.parentNode.style.display="none";else{s.headers.parentNode.style.display="";var De=s.headers.children[ce].offsetLeft,Se=De+s.headers.children[ce].offsetWidth,Ue=s.headers.scrollLeft,$e=Ue+s.headers.offsetWidth;Ue<=De&&$e>=Se||V(De-1),L(ce)}}},s.selectIndex=function(ce){var fe=Array.prototype.indexOf.call(s.headers.children,ce);return fe>=0&&s.open(fe),fe},s.rename=function(ce,fe){fe||(fe=prompt("New title",s.headers.children[ce].innerText)),s.headers.children[ce].innerText=fe,L(s.getActive())},s.create=function(ce,fe){if(typeof s.options.onbeforecreate=="function"){var Ee=s.options.onbeforecreate(w,ce);if(Ee===!1)return!1;ce=Ee}var De=s.appendElement(ce);return typeof s.options.oncreate=="function"&&s.options.oncreate(w,De),L(s.getActive()),De},s.remove=function(ce){return s.deleteElement(ce)},s.nextNumber=function(){for(var ce=0,fe=0;fe<s.headers.children.length;fe++){var Ee=s.headers.children[fe].innerText.match(/[0-9].*/);Ee>ce&&(ce=parseInt(Ee))}return ce?ce++:ce=1,ce},s.deleteElement=function(ce){let fe=s.getActive();if(s.headers.children[ce])s.headers.removeChild(s.headers.children[ce]),s.content.removeChild(s.content.children[ce]);else return!1;if(fe===ce)s.open(0);else{let Ee=s.getActive()||0;L(Ee)}typeof s.options.ondelete=="function"&&s.options.ondelete(w,ce)},s.appendElement=function(ce,fe,Ee,De){if(!ce)var ce=prompt("Title?","");if(ce){let $e=o.guid(),Q=o.guid();var Se=document.createElement("div");Se.setAttribute("id",Q),Se.setAttribute("role","tabpanel"),Se.setAttribute("aria-labelledby",$e);var Ue=document.createElement("div");if(Ue.setAttribute("id",$e),Ue.setAttribute("role","tab"),Ue.setAttribute("aria-controls",Q),Ue.innerHTML=ce,Ue.content=Se,typeof De>"u")s.content.appendChild(Se),s.headers.insertBefore(Ue,s.headers.lastChild);else{let pe=s.content.children[De];pe?s.content.insertBefore(Se,pe):s.content.appendChild(Se),pe=s.headers.children[De]||s.headers.lastChild,s.headers.insertBefore(Ue,pe)}return s.options.allowChangePosition&&Ue.setAttribute("draggable","true"),Ee!==!1&&s.selectIndex(Ue),typeof fe=="function"&&fe(Se,Ue),Se}},s.getActive=function(){for(var ce=0;ce<s.headers.children.length;ce++)if(s.headers.children[ce].classList.contains("jtabs-selected"))return ce;return!1},s.updateContent=function(ce,fe){if(typeof fe!="string")var Ee=fe;else{var Ee=document.createElement("div");Ee.innerHTML=fe}s.content.children[ce].classList.contains("jtabs-selected")&&fe.classList.add("jtabs-selected"),s.content.replaceChild(fe,s.content.children[ce]),L()},s.updatePosition=function(ce,fe,Ee,De){if(ce>fe?s.content.insertBefore(s.content.children[ce],s.content.children[fe]):s.content.insertBefore(s.content.children[ce],s.content.children[fe].nextSibling),De!==!1)s.open(fe);else{const Se=s.getActive();fe<Se&&s.setBorder(Se)}!Ee&&typeof s.options.onchangeposition=="function"&&s.options.onchangeposition(s.headers,ce,fe)},s.move=function(ce,fe,Ee,De){ce>fe?s.headers.insertBefore(s.headers.children[ce],s.headers.children[fe]):s.headers.insertBefore(s.headers.children[ce],s.headers.children[fe].nextSibling),s.updatePosition(ce,fe,Ee,De)},s.setBorder=L,s.init=function(){w.innerHTML="",s.headers=document.createElement("div"),s.content=document.createElement("div"),s.headers.classList.add("jtabs-headers"),s.headers.setAttribute("role","tablist"),s.content.classList.add("jtabs-content"),s.content.setAttribute("role","region"),s.content.setAttribute("aria-label","Tab Panels"),s.options.palette?w.classList.add("jtabs-modern"):w.classList.remove("jtabs-modern"),s.options.padding&&(s.content.style.padding=parseInt(s.options.padding)+"px");var ce=document.createElement("div");ce.className="jtabs-headers-container",ce.appendChild(s.headers),s.options.maxWidth&&(ce.style.maxWidth=parseInt(s.options.maxWidth)+"px");var fe=document.createElement("div");if(fe.className="jtabs-controls",fe.setAttribute("draggable","false"),ce.appendChild(fe),s.options.position=="bottom"?(w.appendChild(s.content),w.appendChild(ce)):(w.appendChild(ce),w.appendChild(s.content)),s.options.allowCreate==!0){var Ee=document.createElement("div");Ee.className="jtabs-add",Ee.onclick=function(){s.create()},fe.appendChild(Ee)}te=document.createElement("div"),te.className="jtabs-prev",te.onclick=function(){V(s.headers.scrollLeft-s.headers.offsetWidth)},fe.appendChild(te),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){V(s.headers.scrollLeft+s.headers.offsetWidth)},fe.appendChild(ee);for(var De=0;De<s.options.data.length;De++){if(s.options.data[De].titleElement)var Se=s.options.data[De].titleElement;else var Se=document.createElement("div");if(s.options.data[De].icon){var Ue=document.createElement("div"),$e=document.createElement("i");$e.classList.add("material-icons"),$e.innerHTML=s.options.data[De].icon,Ue.appendChild($e),Se.appendChild(Ue)}if(s.options.data[De].title){var Q=document.createTextNode(s.options.data[De].title);Se.appendChild(Q)}if(s.options.data[De].width&&(Se.style.width=s.options.data[De].width),s.options.data[De].contentElement)var pe=s.options.data[De].contentElement;else{var pe=document.createElement("div");pe.innerHTML=s.options.data[De].content}s.headers.appendChild(Se),s.content.appendChild(pe)}F=document.createElement("div"),F.className="jtabs-border",s.headers.appendChild(F),s.options.animation&&w.classList.add("jtabs-animation"),s.headers.addEventListener("click",function(we){if(we.target.parentNode.classList.contains("jtabs-headers"))var U=we.target;else if(we.target.tagName=="I")var U=we.target.parentNode.parentNode;else var U=we.target.parentNode;var J=s.selectIndex(U);typeof s.options.onclick=="function"&&s.options.onclick(w,s,J,s.headers.children[J],s.content.children[J])}),s.headers.addEventListener("contextmenu",function(we){s.selectIndex(we.target)}),s.headers.children.length&&s.open(0),V(0),s.options.allowChangePosition==!0&&p(s.headers,{direction:1,ondrop:function(we,U,J){s.updatePosition(U,J)}}),typeof s.options.onload=="function"&&s.options.onload(w,s)},w.children[0]&&w.children[0].children.length)for(var G=0;G<w.children[0].children.length;G++){var ne=s.options.data&&s.options.data[G]?s.options.data[G]:{};w.children[1]&&w.children[1].children[G]?(ne.titleElement=w.children[0].children[G],ne.contentElement=w.children[1].children[G]):ne.contentElement=w.children[0].children[G],s.options.data[G]=ne}var ge=!1;if(s.options.data)for(var G=0;G<s.options.data.length;G++)s.options.data[G].url&&(I({url:s.options.data[G].url,type:"GET",dataType:"text/html",index:G,success:function(fe){s.options.data[this.index].content=fe},complete:function(){s.init()}}),ge=!0);return ge||s.init(),w.tabs=s,s}function me(w,A){if(w.color)return w.color.setOptions(A,!0);var s={type:"color"};s.options={};var r=null,B=null,te=null,ee=null,F=null,L=null,V=null;s.setOptions=function(v,S){var X={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};v||(v={}),v&&!v.palette&&(v.palette=be());for(var ue in X)v&&v.hasOwnProperty(ue)?s.options[ue]=v[ue]:(typeof s.options[ue]>"u"||S===!0)&&(s.options[ue]=X[ue]);return ee&&(ee.innerHTML=s.options.resetLabel),F&&(F.innerHTML=s.options.doneLabel),s.options.palette&&V&&V.updateContent(0,fe()),typeof s.options.value=="string"&&(w.value=s.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value)),s.options.placeholder?w.setAttribute("placeholder",s.options.placeholder):w.getAttribute("placeholder")&&w.removeAttribute("placeholder"),s},s.select=function(v){var S=r.querySelector(".jcolor-selected");S&&S.classList.remove("jcolor-selected"),s.values[v]&&s.values[v].classList.add("jcolor-selected"),s.options.value=v},s.open=function(){if(!r.classList.contains("jcolor-focus")){P(s,!0),r.classList.add("jcolor-focus"),s.options.value&&s.select(s.options.value),te.style.marginTop="",te.style.marginLeft="";var v=te.getBoundingClientRect(),S=o.getWindowWidth(),X=o.getWindowHeight();if(S<800||s.options.fullscreen==!0?(te.classList.add("jcolor-fullscreen"),O.slideBottom(te,1),B.style.display="block"):(te.classList.contains("jcolor-fullscreen")&&(te.classList.remove("jcolor-fullscreen"),B.style.display=""),s.options.position?te.style.position="fixed":te.style.position="",v.left+v.width>S&&(te.style.marginLeft=-1*(v.left+v.width-(S-20))+"px"),v.top+v.height>X&&(te.style.marginTop=-1*(v.top+v.height-(X-20))+"px")),typeof s.options.onopen=="function"&&s.options.onopen(w,s),V.setBorder(V.getActive()),s.options.value){var ue=ce(s.options.value);pe.forEach(function(K,le){K.value=ue[le],K.dispatchEvent(new Event("input"))})}}},s.close=function(v){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),B.style.display="",!v&&typeof s.options.onclose=="function"&&s.options.onclose(w,s),P(s,!1)),s.options.value},s.setValue=function(v){v||(v=""),v!=s.options.value&&(s.options.value=v,Q=v,s.select(v),typeof s.options.onchange=="function"&&s.options.onchange(w,v,s),w.value!=s.options.value&&(w.value=s.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value),typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),s.options.closeOnChange==!0&&s.close())},s.getValue=function(){return s.options.value};var G=function(v){var S=v.toString(16);return S.length===1?"0"+S:S},ne=function(v,S,X){return"#"+G(v)+G(S)+G(X)},ge=function(v){return parseInt("0x"+v)},ce=function(v){return[ge(v.substr(1,2)),ge(v.substr(3,2)),ge(v.substr(5,2))]},fe=function(){var v=document.createElement("div");v.className="jcolor-grid",s.values=[];var S=document.createElement("table");S.setAttribute("cellpadding","7"),S.setAttribute("cellspacing","0");for(var X=0;X<s.options.palette.length;X++){for(var ue=document.createElement("tr"),K=0;K<s.options.palette[X].length;K++){var le=document.createElement("td"),je=s.options.palette[X][K];je.length<7&&je.substr(0,1)!=="#"&&(je="#"+je),le.style.backgroundColor=je,le.setAttribute("data-value",je),le.innerHTML="",ue.appendChild(le),s.options.value==je&&le.classList.add("jcolor-selected"),s.values[je]=le}S.appendChild(ue)}return v.appendChild(S),v},Ee=document.createElement("canvas");Ee.width=200,Ee.height=160;var De=Ee.getContext("2d"),Se=function(){var v=L.firstChild.getBoundingClientRect();Ee.width=v.width-14,Ue()},Ue=function(){var v=De.createLinearGradient(0,0,Ee.width,0);v.addColorStop(0,"rgb(255,0,0)"),v.addColorStop(.15,"rgb(255,0,255)"),v.addColorStop(.33,"rgb(0,0,255)"),v.addColorStop(.49,"rgb(0,255,255)"),v.addColorStop(.67,"rgb(0,255,0)"),v.addColorStop(.84,"rgb(255,255,0)"),v.addColorStop(1,"rgb(255,0,0)"),De.fillStyle=v,De.fillRect(0,0,Ee.width,Ee.height),v=De.createLinearGradient(0,0,0,Ee.height),v.addColorStop(0,"rgba(255,255,255,1)"),v.addColorStop(.5,"rgba(255,255,255,0)"),v.addColorStop(.5,"rgba(0,0,0,0)"),v.addColorStop(1,"rgba(0,0,0,1)"),De.fillStyle=v,De.fillRect(0,0,Ee.width,Ee.height)},$e=function(){var v=document.createElement("div");v.className="jcolor-hsl";var S=document.createElement("div");S.className="jcolor-point";var X=document.createElement("div");X.appendChild(Ee),X.appendChild(S),v.appendChild(X);var ue=function(K,le,je){if(K===1){var Te=v.getBoundingClientRect(),ve=le-Te.left,Ie=je-Te.top;ve<0&&(ve=0),Ie<0&&(Ie=0),ve>Te.width&&(ve=Te.width),Ie>Te.height&&(Ie=Te.height),S.style.left=ve+"px",S.style.top=Ie+"px";var Fe=De.getImageData(ve,Ie,1,1).data;Q=ne(Fe[0],Fe[1],Fe[2])}};return v.addEventListener("mousedown",function(K){ue(K.buttons,K.clientX,K.clientY)}),v.addEventListener("mousemove",function(K){ue(K.buttons,K.clientX,K.clientY)}),v.addEventListener("touchmove",function(K){ue(1,K.changedTouches[0].clientX,K.changedTouches[0].clientY)}),v},Q="",pe=[],we=function(){if(Q!=="")for(var v=0;v<pe.length;v++){var S=ce(Q);S[v]=0;var X="linear-gradient(90deg, rgb(";X+=S.join(", "),X+="), rgb(",S[v]=255,X+=S.join(", "),X+="))",pe[v].style.backgroundImage=X}},U=function(){var v=document.createElement("div");v.className="jcolor-sliders";var S=document.createElement("div"),X=function(je){var Te=document.createElement("div");Te.className="jcolor-sliders-input-container";var ve=document.createElement("label");ve.innerText=je;var Ie=document.createElement("div");Ie.className="jcolor-sliders-input-subcontainer";var Fe=document.createElement("input");Fe.type="range",Fe.min=0,Fe.max=255,Fe.value=0,Fe.setAttribute("aria-label","Color value"),Fe.setAttribute("aria-valuemin","0"),Fe.setAttribute("aria-valuemax","255"),Fe.setAttribute("aria-valuenow","0"),Te.appendChild(ve),Ie.appendChild(Fe);var tt=document.createElement("div");return tt.innerText=Fe.value,Fe.addEventListener("input",function(){tt.innerText=Fe.value}),Ie.appendChild(tt),Te.appendChild(Ie),S.appendChild(Te),Fe};pe=[X("Red"),X("Green"),X("Blue")],v.appendChild(S);var ue=document.createElement("div");ue.className="jcolor-sliders-final-color";var K=document.createElement("div");K.style.visibility="hidden",K.innerText="a",ue.appendChild(K);var le=function(){var je=ne(parseInt(pe[0].value),parseInt(pe[1].value),parseInt(pe[2].value));K.innerText=je,K.style.color=je,K.style.removeProperty("visibility"),Q=je};return pe.forEach(function(je){je.addEventListener("input",function(){le(),we()})}),v.appendChild(ue),v},J=function(){s.setOptions(A),w.tagName=="INPUT"&&(w.classList.add("jcolor-input"),w.readOnly=!0),r=document.createElement("div"),r.className="jcolor",B=document.createElement("div"),B.className="jcolor-backdrop",r.appendChild(B),te=document.createElement("div"),te.className="jcolor-content";var v=document.createElement("div");v.className="jcolor-controls",te.appendChild(v),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=s.options.resetLabel,v.appendChild(ee),F=document.createElement("div"),F.className="jcolor-close",F.innerHTML=s.options.doneLabel,v.appendChild(F),L=document.createElement("div"),te.appendChild(L),V=Le(L,{animation:!0,data:[{title:"Grid",contentElement:fe()},{title:"Spectrum",contentElement:$e()},{title:"Sliders",contentElement:U()}],onchange:function(S,X,ue){if(ue===1)Se();else{var K=Q!==""?Q:s.getValue();if(ue===2&&K){var le=ce(K);pe.forEach(function(je,Te){je.value=le[Te],je.dispatchEvent(new Event("input"))})}}},palette:"modern"}),r.appendChild(te),w.tagName=="INPUT"?w.parentNode.insertBefore(r,w.nextSibling):w.appendChild(r),r.addEventListener("click",function(S){if(S.target.tagName=="TD"){var X=S.target.getAttribute("data-value");X&&s.setValue(X)}else S.target.classList.contains("jcolor-reset")?(s.setValue(""),s.close()):S.target.classList.contains("jcolor-close")?(V.getActive()>0&&s.setValue(Q),s.close()):S.target.classList.contains("jcolor-backdrop")?s.close():s.open()}),w.addEventListener("mouseup",function(S){s.open()}),window.addEventListener("resize",function(){r.classList.contains("jcolor-focus")&&V.getActive()==1&&Se()}),s.options.opened==!0&&s.open(),w.change=s.setValue,w.val=function(S){if(S===void 0)return s.getValue();s.setValue(S)},w.color=s,r.color=s};return s.toHex=function(v){var S=function(X){return("0"+parseInt(X).toString(16)).slice(-2)};if(v)return/^#[0-9A-F]{6}$/i.test(v)?v:(v=v.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),v&&v.length?"#"+S(v[1])+S(v[2])+S(v[3]):"")},J(),s}function ie(){var w=function(A,s){var r={type:"contextmenu"};r.options={};var B={items:null,onclick:null};for(var te in B)s&&s.hasOwnProperty(te)?r.options[te]=s[te]:r.options[te]=B[te];A.classList.add("jcontextmenu"),r.open=function(L,V){if(V&&(r.options.items=V,r.create(V)),w.current&&w.current.close(),P(r,!0),A.classList.add("jcontextmenu-focus"),w.current=r,r.options.items&&r.options.items.length>0||A.children.length){if(L.target)if(L.changedTouches&&L.changedTouches[0])G=L.changedTouches[0].clientX,ne=L.changedTouches[0].clientY;else var G=L.clientX,ne=L.clientY;else var G=L.x,ne=L.y;var ge=A.getBoundingClientRect();if(window.innerHeight<ne+ge.height){var ce=ne-ge.height;ce<0&&(ce=0),A.style.top=ce+"px"}else A.style.top=ne+"px";window.innerWidth<G+ge.width?G-ge.width>0?A.style.left=G-ge.width+"px":A.style.left="10px":A.style.left=G+"px"}},r.isOpened=function(){return!!A.classList.contains("jcontextmenu-focus")},r.close=function(){A.classList.contains("jcontextmenu-focus")&&A.classList.remove("jcontextmenu-focus"),P(r,!1)},r.create=function(L){A.innerHTML="";var V=ee();A.appendChild(V);for(var G=0;G<L.length;G++){var ne=F(L[G]);A.appendChild(ne)}};function ee(){var L=document.createElement("div");L.classList.add("header"),L.addEventListener("click",function(ne){ne.preventDefault(),ne.stopPropagation()});var V=document.createElement("a");V.classList.add("title"),V.innerHTML=f.translate("Menu"),L.appendChild(V);var G=document.createElement("a");return G.classList.add("close"),G.innerHTML=f.translate("close"),G.addEventListener("click",function(ne){r.close()}),L.appendChild(G),L}function F(L){if(L.type&&(L.type=="line"||L.type=="divisor"))var V=document.createElement("hr");else{var V=document.createElement("div"),G=document.createElement("a");if(G.innerHTML=L.title,L.tooltip&&V.setAttribute("title",L.tooltip),L.icon&&V.setAttribute("data-icon",L.icon),L.id&&(V.id=L.id),L.disabled?V.className="jcontextmenu-disabled":L.onclick&&(V.method=L.onclick,V.addEventListener("mousedown",function(Ue){Ue.preventDefault()}),V.addEventListener("mouseup",function(Ue){this.method(this,Ue)})),V.appendChild(G),L.submenu){var ne=document.createElement("span");ne.innerHTML="&#9658;",V.appendChild(ne),V.classList.add("jcontexthassubmenu");var ge=document.createElement("div");ge.classList.add("jcontextmenu"),ge.setAttribute("tabindex","900");for(var ce=L.submenu,fe=0;fe<ce.length;fe++){var Ee=F(ce[fe]);ge.appendChild(Ee)}V.appendChild(ge)}else if(L.shortcut){var De=document.createElement("span");De.innerHTML=L.shortcut,V.appendChild(De)}}return V}return typeof r.options.onclick=="function"&&A.addEventListener("click",function(L){r.options.onclick(r,L)}),r.options.items&&r.create(r.options.items),window.addEventListener("mousewheel",function(){r.close()}),A.contextmenu=r,r};return w}var Re=ie();function _e(){var w=function(A,s){if(A.dropdown)return A.dropdown.setOptions(s,!0);var r={type:"dropdown"};r.options={};var B=function(U,J){U&&U.length&&(r.options.sortResults!==!1&&(typeof r.options.sortResults=="function"?U.sort(r.options.sortResults):U.sort(te)),r.setData(U)),typeof r.options.onload=="function"&&r.options.onload(A,r,U,J),J&&F(J),J==null&&(r.options.value=""),A.value=r.options.value,r.options.opened==!0&&r.open()},te=function(U,J){var v,S;return typeof U=="string"?v=U:U.text?v=U.text:U.name&&(v=U.name),typeof J=="string"?S=J:J.text?S=J.text:J.name&&(S=J.name),typeof v=="string"||typeof S=="string"?(typeof v!="string"&&(v=""+v),typeof S!="string"&&(S=""+S),v.localeCompare(S)):v-S},ee=function(){r.value={};for(var U=0;U<r.items.length;U++)r.items[U].selected==!0&&(r.items[U].element&&r.items[U].element.classList.remove("jdropdown-selected"),r.items[U].selected=null);r.options.value="",A.value=""},F=function(U){if(ee(),U!==null)if(!U)typeof r.value[""]<"u"&&(r.value[""]="");else{Array.isArray(U)||(U=(""+U).split(";"));for(var J=0;J<U.length;J++)r.value[U[J]]=""}for(var J=0;J<r.items.length;J++)typeof r.value[L(J)]<"u"&&(r.items[J].element&&r.items[J].element.classList.add("jdropdown-selected"),r.items[J].selected=!0,r.value[L(J)]=V(J));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},L=function(U,J){if(r.options.format)var v="id";else var v="value";return r.items[U]?r.items[U].data[v]:""},V=function(U,J){if(r.options.format)var v="name";else var v="text";return r.items[U]?r.items[U].data[v]:""},G=function(){return Object.keys(r.value)},ne=function(){for(var U=[],J=Object.keys(r.value),v=0;v<J.length;v++)U.push(r.value[J[v]]);return U};r.setOptions=function(U,J){U||(U={});var v={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var S in v)U&&U.hasOwnProperty(S)?r.options[S]=U[S]:(typeof r.options[S]>"u"||J===!0)&&(r.options[S]=v[S]);return(r.options.remoteSearch==!0||r.options.type==="searchbar")&&(r.options.autocomplete=!0),r.options.newOptions==!0?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),r.options.autocomplete==!0?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),A.classList.remove("jdropdown-searchbar"),A.classList.remove("jdropdown-picker"),A.classList.remove("jdropdown-list"),r.options.type=="searchbar"?A.classList.add("jdropdown-searchbar"):r.options.type=="list"?A.classList.add("jdropdown-list"):r.options.type=="picker"?A.classList.add("jdropdown-picker"):o.getWindowWidth()<800?r.options.autocomplete?(A.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(A.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(A.style.width=r.options.width,A.style.minWidth=r.options.width):(A.style.removeProperty("width"),A.style.removeProperty("min-width")),A.classList.add("jdropdown-default"),r.options.type="default"),r.options.type=="searchbar"?ge.appendChild(Ee):ce.insertBefore(Ee,ce.firstChild),r.options.url&&!U.data?I({url:r.options.url,method:"GET",dataType:"json",success:function(X){X&&B(X,r.options.value)}}):B(r.options.data,r.options.value),r};var ge=null,ce=null,fe=null,Ee=null,De=null,Se=null,Ue=null,$e=function(){if(s||(s={}),A.tagName=="SELECT"){var U=w.extractFromDom(A,s);A=U.el,s=U.options}!s.placeholder&&A.getAttribute("placeholder")&&(s.placeholder=A.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,A.classList.add("jdropdown"),ge=document.createElement("div"),ge.className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header jss_object",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){typeof r.options.onfocus=="function"&&r.options.onfocus(A)},r.header.onblur=function(){typeof r.options.onblur=="function"&&r.options.onblur(A)},r.header.onkeyup=function(J){r.options.autocomplete==!0&&!Ue?(r.search!=r.header.value.trim()&&(Ue=setTimeout(function(){r.find(r.header.value.trim()),Ue=null},400)),A.classList.contains("jdropdown-focus")||r.open()):r.options.autocomplete||r.next(J.key)},w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),ce=document.createElement("div"),ce.className="jdropdown-container",fe=document.createElement("div"),fe.className="jdropdown-content",Ee=document.createElement("div"),Ee.className="jdropdown-close",Ee.textContent="Done",De=document.createElement("div"),De.className="jdropdown-reset",De.textContent="x",De.onclick=function(){r.reset(),r.close()},Se=document.createElement("div"),Se.className="jdropdown-backdrop",ge.appendChild(r.header),ce.appendChild(fe),A.appendChild(ge),A.appendChild(ce),A.appendChild(Se),r.setOptions(s),"ontouchsend"in document.documentElement?A.addEventListener("touchsend",w.mouseup):A.addEventListener("mouseup",w.mouseup),r.options.lazyLoading==!0&&C(fe,{loadUp:r.loadUp,loadDown:r.loadDown}),fe.onwheel=function(J){J.stopPropagation()},A.change=r.setValue,A.val=function(J){if(J===void 0)return r.getValue(!!r.options.multiple);r.setValue(J)},A.dropdown=r};r.getUrl=function(){return r.options.url},r.setUrl=function(U,J){r.options.url=U,I({url:r.options.url,method:"GET",dataType:"json",success:function(v){r.setData(v),typeof J=="function"&&J(r)}})},r.setId=function(U,J){if(r.options.format)var v="id";else var v="value";typeof U=="object"?U[v]=J:r.items[U].data[v]=J};const Q=function(U,J){if(!U){let X=r.options.autocomplete==!0?r.header.value:"";if(U=prompt(f.translate("Add A New Option"),X),!U)return!1}if(J||(J=o.guid()),r.options.format)var v={id:J,name:U};else var v={value:J,text:U};if(typeof r.options.onbeforeinsert=="function"){let X=r.options.onbeforeinsert(r,v);if(X===!1)return!1;X&&(v=X)}r.options.data.push(v);var S=r.createItem(v);return fe.appendChild(S.element),typeof r.options.oninsert=="function"&&r.options.oninsert(r,v,S),fe.style.display=="none"&&(fe.style.display=""),r.results&&r.results.push(S),v};r.add=function(U,J){return typeof r.options.prompt=="function"?r.options.prompt.call(r,Q):Q(U,J)},r.createItem=function(U,J,v){r.options.format?(!U.id&&U.value!==void 0&&(U.id=U.value),!U.name&&U.text!==void 0&&(U.name=U.text)):(!U.value&&U.id!==void 0&&(U.value=U.id),!U.text&&U.name!==void 0&&(U.text=U.name));var S={};if(S.element=document.createElement("div"),S.element.className="jdropdown-item",S.element.indexValue=r.items.length,S.data=U,J&&(S.group=J),U.id&&S.element.setAttribute("id",U.id),U.disabled==!0&&S.element.setAttribute("data-disabled",!0),U.tooltip&&S.element.setAttribute("title",U.tooltip),U.image){var X=document.createElement("img");X.className="jdropdown-image",X.src=U.image,U.title||X.classList.add("jdropdown-image-small"),S.element.appendChild(X)}else if(U.icon){var ue=document.createElement("span");ue.className="jdropdown-icon material-icons",ue.innerText=U.icon,U.title||ue.classList.add("jdropdown-icon-small"),U.color&&(ue.style.color=U.color),S.element.appendChild(ue)}else if(U.color){var K=document.createElement("div");K.className="jdropdown-color",K.style.backgroundColor=U.color,S.element.appendChild(K)}if(r.options.format)var le=U.name;else var le=U.text;var je=document.createElement("div");if(je.className="jdropdown-description",je.textContent=le||"&nbsp;",U.title){var Te=document.createElement("div");Te.className="jdropdown-title",Te.innerText=U.title,je.appendChild(Te)}if(r.options.format)var ve=U.id;else var ve=U.value;return r.value[ve]&&(S.element.classList.add("jdropdown-selected"),S.selected=!0),r.items.push(S),S.element.appendChild(je),S},r.appendData=function(U){if(U.length){for(var J=[],v=[],S=0;S<U.length;S++)U[S].group?(v[U[S].group]||(v[U[S].group]=[]),v[U[S].group].push(S)):J.push(S);var X=0,ue=Object.keys(v);if(ue.length>0)for(var S=0;S<ue.length;S++){var K=document.createElement("div");K.className="jdropdown-group";var le=document.createElement("div");le.className="jdropdown-group-name",le.textContent=ue[S];var je=document.createElement("i");je.className="jdropdown-group-arrow jdropdown-group-arrow-down",le.appendChild(je);var Te=document.createElement("div");Te.className="jdropdown-group-items";for(var ve=0;ve<v[ue[S]].length;ve++){var Ie=r.createItem(U[v[ue[S]][ve]],K,ue[S]);(r.options.lazyLoading==!1||X<200)&&(Te.appendChild(Ie.element),X++)}K.appendChild(le),K.appendChild(Te),r.groups.push(K),Te.children.length>0&&fe.appendChild(K)}if(J.length)for(var S=0;S<J.length;S++){var Ie=r.createItem(U[J[S]]);(r.options.lazyLoading==!1||X<200)&&(fe.appendChild(Ie.element),X++)}}},r.setData=function(U){if(ee(),fe.textContent="",r.header.value="",r.items=[],U&&U.length){for(var J=0;J<U.length;J++)typeof U[J]!="object"&&(r.options.format?U[J]={id:U[J],name:U[J]}:U[J]={value:U[J],text:U[J]});r.appendData(U),r.options.data=U}else r.options.data=[];r.close()},r.getData=function(){return r.options.data},r.getPosition=function(U){for(var J=0;J<r.items.length;J++)if(L(J)==U)return J;return!1},r.getText=function(U){var J=ne();return U?J:J.join("; ")},r.getValue=function(U){var J=G();return U?J:J.join(";")};var pe=function(U){A.value!=r.options.value&&(A.value=r.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value})),typeof r.options.onchange=="function"&&r.options.onchange(A,r,U,r.options.value)};r.setValue=function(U){var J=r.getValue();Array.isArray(U)&&(U=U.join(";")),J!==U&&(F(U),pe(J))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(v,J){var v=parseInt(v);if(r.items&&r.items[v]&&(J===!0||r.items[v].data.disabled!==!0))if(r.setCursor(v,!1),!r.options.multiple)r.items[v].selected?r.options.allowEmpty!==!1&&r.setValue(null):r.setValue(L(v)),r.close();else{var S=r.options.value;r.items[v].selected?(r.items[v].element.classList.remove("jdropdown-selected"),r.items[v].selected=!1,delete r.value[L(v)]):(r.items[v].element.classList.add("jdropdown-selected"),r.items[v].selected=!0,r.value[L(v)]=V(v)),r.options.value=Object.keys(r.value).join(";"),r.options.autocomplete==!1&&(r.header.value=ne().join("; ")),pe(S)}},r.selectItem=function(U){r.selectIndex(U.indexValue)};var we=function(U,J){for(var v=0;v<J.length;v++)if(r.options.format){if(J[v].id==U)return!0}else if(J[v].value==U)return!0;return!1};return r.find=function(U){if(r.search==U.trim())return!1;if(r.search=U,r.setCursor(),r.groups.length)for(var J=0;J<r.groups.length;J++)r.groups[J].lastChild.textContent="";if(fe.textContent="",r.options.remoteSearch==!0){r.results=null;var v=r.options.url;let Te={url:v,method:"GET",data:{q:U},dataType:"json",success:function(ve){r.items=[];var Ie=Object.keys(r.value);if(Ie.length)for(var Fe=0;Fe<Ie.length;Fe++)we(Ie[Fe],ve)||(r.options.format?ve.unshift({id:Ie[Fe],name:r.value[Ie[Fe]]}):ve.unshift({value:Ie[Fe],text:r.value[Ie[Fe]]}));r.appendData(ve),ve.length?fe.style.display="":fe.style.display="none",typeof r.options.onsearch=="function"&&r.options.onsearch(r,ve)}};if(typeof r.options.onbeforesearch=="function"){let ve=r.options.onbeforesearch(r,Te);if(ve===!1)return;typeof ve=="object"&&(Te=ve)}I(Te)}else{U=new RegExp(U,"gi");for(var S=[],J=0;J<r.items.length;J++){var X=V(J),ue=r.items[J].data.title||"",K=r.items[J].data.group||"",le=r.items[J].data.synonym||"";le&&(le=le.join(" ")),(U==null||r.items[J].selected==!0||X.toString().match(U)||ue.match(U)||K.match(U)||le.match(U))&&S.push(r.items[J])}if(!S.length)fe.style.display="none",r.results=null;else{fe.style.display="",r.results=S;var je=S.length||0;r.options.lazyLoading==!0&&je>200&&(je=200);for(var J=0;J<je;J++)r.results[J].group?(r.results[J].group.parentNode||fe.appendChild(r.results[J].group),r.results[J].group.lastChild.appendChild(r.results[J].element)):fe.appendChild(r.results[J].element)}}r.options.autofocus==!0&&r.first()},r.open=function(){if(!A.classList.contains("jdropdown-focus")){w.current=r,P(r,!0),A.classList.add("jdropdown-focus"),o.getWindowWidth()<800&&(r.options.type==null||r.options.type=="picker")&&O.slideBottom(ce,1),r.options.autocomplete==!0&&(r.header.value=r.search,r.header.focus());var U=G();if(U[0]){var J=r.getPosition(U[0]);J!==!1&&r.setCursor(J)}if(!r.options.type||r.options.type=="default"){var v=A.getBoundingClientRect(),S=ce.getBoundingClientRect();r.options.position?(ce.style.position="fixed",window.innerHeight<v.bottom+S.height?(ce.style.top="",ce.style.bottom=window.innerHeight-v.top+1+"px"):(ce.style.top=v.bottom+"px",ce.style.bottom=""),ce.style.left=v.left+"px"):window.innerHeight<v.bottom+S.height?(ce.style.top="",ce.style.bottom=v.height+1+"px"):(ce.style.top="",ce.style.bottom=""),ce.style.minWidth=v.width+"px",r.options.maxWidth&&(ce.style.maxWidth=r.options.maxWidth),!r.items.length&&r.options.autocomplete==!0?fe.style.display="none":fe.style.display=""}}typeof r.options.onopen=="function"&&r.options.onopen(A)},r.close=function(U){return A.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),!U&&typeof r.options.onclose=="function"&&r.options.onclose(A),r.header.blur&&r.header.blur(),A.classList.remove("jdropdown-focus"),P(r,!1),w.current=null),r.getValue()},r.setCursor=function(U,J){if(r.currentIndex!=null&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),U==null)r.currentIndex=null;else if(U=parseInt(U),r.items[U].element.parentNode&&(r.items[U].element.classList.add("jdropdown-cursor"),r.currentIndex=U,J!==!1&&r.items[r.currentIndex].element)){fe.scrollTop;var v=r.items[r.currentIndex].element;fe.scrollTop=v.offsetTop-v.scrollTop+v.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){r.options.lazyLoading===!0&&r.loadFirst();var U=fe.querySelectorAll(".jdropdown-item");if(U.length){var J=U[0].indexValue;r.setCursor(J)}},r.last=function(){r.options.lazyLoading===!0&&r.loadLast();var U=fe.querySelectorAll(".jdropdown-item");if(U.length){var J=U[U.length-1].indexValue;r.setCursor(J)}},r.next=function(U){var J=null;if(U){if(U.length==1){var v=r.currentIndex||-1;U=U.toLowerCase();var S=null,X=null,ue=fe.querySelectorAll(".jdropdown-item");if(ue.length){for(var K=0;K<ue.length;K++)if(ue[K].indexValue>v&&(S=r.items[ue[K].indexValue])&&(X=S.element.innerText[0])&&(X=X.toLowerCase(),U==X)){J=ue[K].indexValue;break}r.setCursor(J)}}}else if(r.currentIndex==null||r.currentIndex==null)r.first();else{var le=r.items[r.currentIndex].element,je=le.nextElementSibling;je?(je.classList.contains("jdropdown-group")&&(je=je.lastChild.firstChild),J=je.indexValue):le.parentNode.classList.contains("jdropdown-group-items")&&((je=le.parentNode.parentNode.nextElementSibling)&&(je.classList.contains("jdropdown-group")?je=je.lastChild.firstChild:je.classList.contains("jdropdown-item")?J=je.indexValue:je=null),je&&(J=je.indexValue)),J!==null&&r.setCursor(J)}},r.prev=function(){var U=null;if(r.currentIndex===null)r.first();else{var J=r.items[r.currentIndex].element,v=J.previousElementSibling;v?(v.classList.contains("jdropdown-group")&&(v=v.lastChild.lastChild),U=v.indexValue):J.parentNode.classList.contains("jdropdown-group-items")&&((v=J.parentNode.parentNode.previousElementSibling)&&(v.classList.contains("jdropdown-group")?v=v.lastChild.lastChild:v.classList.contains("jdropdown-item")?U=v.indexValue:v=null),v&&(U=v.indexValue))}U!==null&&r.setCursor(U)},r.loadFirst=function(){if(r.results)var U=r.results;else var U=r.items;var J=U.length||0;r.options.lazyLoading==!0&&J>200&&(J=200),fe.textContent="";for(var v=0;v<J;v++)U[v].group?(U[v].group.parentNode||fe.appendChild(U[v].group),U[v].group.lastChild.appendChild(U[v].element)):fe.appendChild(U[v].element);fe.scrollTop=0},r.loadLast=function(){if(r.results)var U=r.results;else var U=r.items;var J=U.length;if(J>200){J=J-200,fe.textContent="";for(var v=J;v<U.length;v++)U[v].group?(U[v].group.parentNode||fe.appendChild(U[v].group),U[v].group.lastChild.appendChild(U[v].element)):fe.appendChild(U[v].element);fe.scrollTop=fe.scrollHeight}},r.loadUp=function(){var U=!1;if(r.results)var J=r.results;else var J=r.items;var v=fe.querySelectorAll(".jdropdown-item"),S=v[0].indexValue;S=r.items[S];var X=J.indexOf(S)-1;if(X>0){for(var ue=0;X>0&&J[X]&&ue<200;)J[X].group?(J[X].group.parentNode||fe.insertBefore(J[X].group,fe.firstChild),J[X].group.lastChild.insertBefore(J[X].element,J[X].group.lastChild.firstChild)):fe.insertBefore(J[X].element,fe.firstChild),X--,ue++;U=!0}return U},r.loadDown=function(){var U=!1;if(r.results)var J=r.results;else var J=r.items;var v=fe.querySelectorAll(".jdropdown-item"),S=v[v.length-1].indexValue;S=r.items[S];var X=J.indexOf(S)+1;if(X<J.length){for(var ue=0;X<J.length&&J[X]&&ue<200;)J[X].group?(J[X].group.parentNode||fe.appendChild(J[X].group),J[X].group.lastChild.appendChild(J[X].element)):fe.appendChild(J[X].element),X++,ue++;U=!0}return U},$e(),r};return w.keydown=function(A){var s=null;if(s=w.current){if(A.which==13||A.which==9)s.header.value&&s.currentIndex==null&&s.options.newOptions?s.add():(s.currentIndex==null&&s.options.autocomplete==!0&&s.header.value!=""&&s.find(s.header.value),s.selectIndex(s.currentIndex));else if(A.which==38)s.currentIndex==null?s.first():s.currentIndex>0&&s.prev(),A.preventDefault();else if(A.which==40)s.currentIndex==null?s.first():s.currentIndex+1<s.items.length&&s.next(),A.preventDefault();else if(A.which==36)s.first(),A.target.classList.contains("jdropdown-header")||A.preventDefault();else if(A.which==35)s.last(),A.target.classList.contains("jdropdown-header")||A.preventDefault();else if(A.which==27)s.close();else if(A.which==33){if(s.currentIndex==null)s.first();else if(s.currentIndex>0)for(var r=0;r<7;r++)s.prev();A.preventDefault()}else if(A.which==34){if(s.currentIndex==null)s.first();else if(s.currentIndex+1<s.items.length)for(var r=0;r<7;r++)s.next();A.preventDefault()}}},w.mouseup=function(A){var s=o.findElement(A.target,"jdropdown");if(s){var r=s.dropdown;if(A.target.classList.contains("jdropdown-header"))if(s.classList.contains("jdropdown-focus")&&s.classList.contains("jdropdown-default")){var B=s.getBoundingClientRect();if(A.changedTouches&&A.changedTouches[0]){var te=A.changedTouches[0].clientX;A.changedTouches[0].clientY}else{var te=A.clientX;A.clientY}B.width-(te-B.left)<30?A.target.classList.contains("jdropdown-add")?r.add():r.close():r.options.autocomplete==!1&&r.close()}else r.open();else if(A.target.classList.contains("jdropdown-group-name")){var ee=A.target.nextSibling.children;if(A.target.nextSibling.style.display!="none")for(var F=0;F<ee.length;F++)ee[F].style.display!="none"&&r.selectItem(ee[F])}else A.target.classList.contains("jdropdown-group-arrow")?A.target.classList.contains("jdropdown-group-arrow-down")?(A.target.classList.remove("jdropdown-group-arrow-down"),A.target.classList.add("jdropdown-group-arrow-up"),A.target.parentNode.nextSibling.style.display="none"):(A.target.classList.remove("jdropdown-group-arrow-up"),A.target.classList.add("jdropdown-group-arrow-down"),A.target.parentNode.nextSibling.style.display=""):A.target.classList.contains("jdropdown-item")?r.selectItem(A.target):A.target.classList.contains("jdropdown-image")||A.target.classList.contains("jdropdown-description")?r.selectItem(A.target.parentNode):A.target.classList.contains("jdropdown-title")?r.selectItem(A.target.parentNode.parentNode):(A.target.classList.contains("jdropdown-close")||A.target.classList.contains("jdropdown-backdrop"))&&r.close()}},w.extractFromDom=function(A,s){var r=A;if(s||(s={}),A.getAttribute("multiple")&&(!s||s.multiple==null)&&(s.multiple=!0),A.getAttribute("placeholder")&&(!s||s.placeholder==null)&&(s.placeholder=A.getAttribute("placeholder")),A.getAttribute("data-autocomplete")&&(!s||s.autocomplete==null)&&(s.autocomplete=!0),(!s||s.width==null)&&(s.width=A.offsetWidth),A.value&&(!s||s.value==null)&&(s.value=A.value),!s||s.data==null){s.data=[];for(var B=0;B<A.children.length;B++)if(A.children[B].tagName=="OPTGROUP")for(var te=0;te<A.children[B].children.length;te++)s.data.push({value:A.children[B].children[te].value,text:A.children[B].children[te].textContent,group:A.children[B].getAttribute("label")});else s.data.push({value:A.children[B].value,text:A.children[B].textContent})}(!s||s.onchange==null)&&(s.onchange=function(F,L,V,G){s.multiple==!0?obj.items[L].classList.contains("jdropdown-selected")?r.options[L].setAttribute("selected","selected"):r.options[L].removeAttribute("selected"):r.value=G});var ee=document.createElement("div");return A.parentNode.insertBefore(ee,A),A.style.display="none",A=ee,{el:A,options:s}},w}var Be=_e();function He(w,A){if(w.picker)return w.picker.setOptions(A,!0);var s={type:"picker"};s.options={};var r=null,B=null,te=function(L){return L instanceof Element||L instanceof HTMLDocument},ee=function(){B.innerHTML="";for(var L=Object.keys(s.options.data),V=0;V<L.length;V++){var G=document.createElement("div");G.classList.add("jpicker-item"),G.setAttribute("role","option"),G.k=L[V],G.v=s.options.data[L[V]];var ne=s.getLabel(L[V],G);te(ne)?G.appendChild(ne):G.innerHTML=ne,B.appendChild(G)}};s.setOptions=function(L,V){var G={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};L&&L.options&&(L.data=L.options);for(var ne in G)L&&L.hasOwnProperty(ne)?s.options[ne]=L[ne]:(typeof s.options[ne]>"u"||V===!0)&&(s.options[ne]=G[ne]);return s.options.header===!1?r.style.display="none":r.style.display="",s.options.width?r.style.width=parseInt(s.options.width)+"px":r.style.width="",s.options.height?(B.style.maxHeight=s.options.height+"px",B.style.overflow="scroll"):B.style.overflow="",s.options.columns>0&&(s.options.grid?(B.classList.add("jpicker-grid"),B.style.gridTemplateColumns="repeat("+s.options.grid+", 1fr)"):(B.classList.add("jpicker-columns"),B.style.width=s.options.width?s.options.width:36*s.options.columns+"px")),isNaN(parseInt(s.options.value))&&(s.options.value=0),ee(),s.setValue(s.options.value),s},s.getValue=function(){return s.options.value},s.setValue=function(L,V){if(s.setLabel(L),s.options.value=String(L),w.value!=s.options.value&&(w.value=s.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),B.children[L]&&B.children[L].getAttribute("type")!=="generic"&&s.close(),V&&typeof s.options.onchange=="function"){var G=s.options.data[L];s.options.onchange(w,s,G,G,L,V)}},s.getLabel=function(L,V){var G=s.options.data[L]||null;return typeof s.options.render=="function"&&(G=s.options.render(G,V)),G},s.setLabel=function(L){var V;s.options.content?V='<i class="material-icons">'+s.options.content+"</i>":V=s.getLabel(L,null),te(V)?(r.innerHTML="",r.appendChild(V)):r.innerHTML=V},s.open=function(){if(!w.classList.contains("jpicker-focus")){P(s,!0),w.classList.add("jpicker-focus"),w.focus();var L=0,V=0;B.style.marginLeft="";var G=r.getBoundingClientRect(),ne=B.getBoundingClientRect();window.innerHeight<G.bottom+ne.height||s.options.bottom?L=-1*(ne.height+4):L=G.height+4,s.options.right===!0&&(V=-1*ne.width+G.width),ne.left+V<0&&(V=V+ne.left+10),ne.left+ne.width>window.innerWidth&&(V=-1*(10+ne.left+ne.width-window.innerWidth)),B.style.marginTop=parseInt(L)+"px",B.style.marginLeft=parseInt(V)+"px",typeof s.options.onopen=="function"&&s.options.onopen(w,s)}},s.close=function(){w.classList.contains("jpicker-focus")&&(w.classList.remove("jpicker-focus"),P(s,!1),typeof s.options.onclose=="function"&&s.options.onclose(w,s))};var F=function(){let L=o.guid();w.classList.add("jpicker"),w.setAttribute("role","combobox"),w.setAttribute("aria-haspopup","listbox"),w.setAttribute("aria-expanded","false"),w.setAttribute("aria-controls",L),w.setAttribute("tabindex","0"),w.onmousedown=function(V){w.classList.contains("jpicker-focus")||s.open()},r=document.createElement("div"),r.classList.add("jpicker-header"),B=document.createElement("div"),B.setAttribute("id",L),B.setAttribute("role","listbox"),B.classList.add("jpicker-content"),B.onclick=function(V){var G=o.findElement(V.target,"jpicker-item");G&&G.parentNode===B&&s.setValue(G.k,V)},w.appendChild(r),w.appendChild(B),w.value=A.value||0,s.setOptions(A),typeof s.options.onload=="function"&&s.options.onload(w,s),w.change=s.setValue,w.val=function(V){if(V===void 0)return s.getValue();s.setValue(V)},w.picker=s};return F(),s}function lt(w,A){var s={type:"toolbar"};s.options={};var r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var B in r)A&&A.hasOwnProperty(B)?s.options[B]=A[B]:s.options[B]=r[B];!w&&A.app&&A.app.el&&(w=document.createElement("div"),A.app.el.appendChild(w));var te=document.createElement("div");te.classList.add("jtoolbar-item"),te.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),te.appendChild(ee),s.selectItem=function(L){for(var V=F.children,G=0;G<V.length;G++)L!=V[G]&&V[G].classList.remove("jtoolbar-selected");L.classList.add("jtoolbar-selected")},s.hide=function(){O.slideBottom(w,0,function(){w.style.display="none"})},s.show=function(){w.style.display="",O.slideBottom(w,1)},s.get=function(){return w},s.setBadge=function(L,V){F.children[L].children[1].firstChild.innerHTML=V},s.destroy=function(){toolbar.remove(),w.innerHTML=""},s.update=function(L,V){for(var G=0;G<F.children.length;G++){var ne=F.children[G];typeof ne.updateState=="function"&&ne.updateState(w,s,ne,L,V)}for(var G=0;G<ee.children.length;G++){var ne=ee.children[G];typeof ne.updateState=="function"&&ne.updateState(w,s,ne,L,V)}},s.create=function(L){F.innerHTML="";for(var V=0;V<L.length;V++){var G=document.createElement("div");if(G.classList.add("jtoolbar-item"),L[V].width&&(G.style.width=parseInt(L[V].width)+"px"),L[V].k&&(G.k=L[V].k),L[V].tooltip&&(G.setAttribute("title",L[V].tooltip),G.setAttribute("aria-label",L[V].tooltip)),L[V].id&&G.setAttribute("id",L[V].id),L[V].updateState&&(G.updateState=L[V].updateState),L[V].active&&G.classList.add("jtoolbar-active"),L[V].disabled&&G.classList.add("jtoolbar-disabled"),L[V].type=="select"||L[V].type=="dropdown")He(G,L[V]);else if(L[V].type=="divisor")G.classList.add("jtoolbar-divisor");else if(L[V].type=="label")G.classList.add("jtoolbar-label"),G.innerHTML=L[V].content;else{var ne=document.createElement("i");if(typeof L[V].class>"u")ne.classList.add("material-icons");else for(var ge=L[V].class.split(" "),ce=0;ce<ge.length;ce++)ne.classList.add(ge[ce]);if(ne.innerHTML=L[V].content?L[V].content:"",G.setAttribute("role","button"),G.appendChild(ne),s.options.badge==!0){var fe=document.createElement("div");fe.classList.add("jbadge");var Ee=document.createElement("div");Ee.innerHTML=L[V].badge?L[V].badge:"",fe.appendChild(Ee),G.appendChild(fe)}if(L[V].title)if(s.options.title==!0){var De=document.createElement("span");De.innerHTML=L[V].title,G.appendChild(De)}else G.setAttribute("title",L[V].title);s.options.app&&L[V].route&&(G.route=L[V].route,G.onclick=function(){s.options.app.pages(this.route)},s.options.app.pages(L[V].route,{toolbarItem:G,closed:!0})),typeof L[V].render=="function"&&L[V].render(G,L[V])}L[V].onclick&&(G.onclick=L[V].onclick.bind(L[V],w,s,G)),F.appendChild(G)}setTimeout(function(){s.refresh()},0)},s.open=function(){te.classList.add("jtoolbar-arrow-selected"),w.getBoundingClientRect();var L=ee.getBoundingClientRect();L.bottom>window.innerHeight||s.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",te.children[0].focus(),P(s,!0)},s.close=function(){te.classList.remove("jtoolbar-arrow-selected"),P(s,!1)},s.refresh=function(){if(s.options.responsive==!0){var L=w.parentNode.getBoundingClientRect();s.options.maxWidth||(s.options.maxWidth=L.width);var V=parseInt(s.options.maxWidth);for(te.parentNode&&te.parentNode.removeChild(te);ee.firstChild;)F.appendChild(ee.firstChild);if(V<F.offsetWidth)for(V-=50;F.lastChild&&V<F.offsetWidth;)ee.insertBefore(F.lastChild,ee.firstChild);ee.children.length>0&&F.appendChild(te)}},s.setReadonly=function(L){L=L?"add":"remove",w.classList[L]("jtoolbar-disabled")},w.onclick=function(L){var V=o.findElement(L.target,"jtoolbar-item");V&&s.selectItem(V),L.target.classList.contains("jtoolbar-arrow")&&s.open()},window.addEventListener("resize",function(){s.refresh()}),w.classList.add("jtoolbar"),w.innerHTML="",s.options.container==!0&&w.classList.add("jtoolbar-container");var F=document.createElement("div");return w.appendChild(F),s.options.app&&w.classList.add("jtoolbar-mobile"),s.create(s.options.items),w.toolbar=s,s}function Y(){var w=function(A,s){var r={type:"editor"};r.options={};var B={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var te in B)s&&s.hasOwnProperty(te)?r.options[te]=s[te]:r.options[te]=B[te];var ee=null,F=null,L=[];r.el=A,typeof r.options.onclick=="function"&&(A.onclick=function(re){r.options.onclick(A,r,re)}),A.classList.add("jeditor-container");var V=document.createElement("div");V.className="jsnippet",V.setAttribute("contenteditable",!1);var G=document.createElement("div");if(G.className="jeditor-toolbar",r.editor=document.createElement("div"),r.editor.setAttribute("contenteditable",!0),r.editor.setAttribute("spellcheck",!1),r.editor.classList.add("jeditor"),r.options.placeholder&&r.editor.setAttribute("data-placeholder",r.options.placeholder),(r.options.maxHeight||r.options.height)&&(r.editor.style.overflowY="auto",r.options.maxHeight&&(r.editor.style.maxHeight=r.options.maxHeight),r.options.height&&(r.editor.style.height=r.options.height)),r.options.url)I({url:r.options.url,dataType:"html",success:function(re){r.editor.innerHTML=re,w.setCursor(r.editor,r.options.focus=="initial")}});else if(r.options.value)r.editor.innerHTML=r.options.value;else for(var ne=0;ne<A.children.length;ne++)r.editor.appendChild(A.children[ne]);A.innerHTML="";var ge=function(re){typeof r.options.onchange=="function"&&r.options.onchange(A,r,re),r.options.value=r.getData(),A.value!=r.options.value&&(A.value=r.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))},ce=function(re){var ye=document.createElement("div");ye.innerHTML=re;var xe=ye.querySelectorAll("img");if(xe.length)for(var Oe=0;Oe<xe.length;Oe++)r.addImage(xe[Oe].src)},fe=function(){var re=null;if(re=V.children[0]){re.classList.contains("jslider-grid")||re.classList.add("jslider-grid");var ye=re.children.length;re.setAttribute("data-number",ye>4?4:ye),ye>4?re.setAttribute("data-total",ye-4):re.removeAttribute("data-total")}},Ee=function(re){V.innerHTML||r.appendSnippet({}),V.children[0].appendChild(re),fe()};r.appendSnippet=function(re){V.innerHTML="";for(var ye=["image","title","description","host","url"],xe=0;xe<ye.length;xe++){var Oe=document.createElement("div");if(Oe.className="jsnippet-"+ye[xe],Oe.setAttribute("data-k",ye[xe]),V.appendChild(Oe),re[ye[xe]])if(ye[xe]=="image"){Array.isArray(re.image)||(re.image=[re.image]);for(var Ge=0;Ge<re.image.length;Ge++){var Ke=document.createElement("img");Ke.src=re.image[Ge],Oe.appendChild(Ke)}}else Oe.innerHTML=re[ye[xe]]}r.editor.appendChild(document.createElement("br")),r.editor.appendChild(V)},r.setData=function(re){typeof re=="object"?r.editor.innerHTML=re.content:r.editor.innerHTML=re,r.options.focus&&w.setCursor(r.editor,!0),L=[]},r.getFiles=function(){for(var re=r.editor.querySelectorAll(".jfile"),ye=[],xe=0;xe<re.length;xe++)L[re[xe].src]&&ye.push(L[re[xe].src]);return ye},r.getText=function(){return r.editor.innerText},r.getData=function(re){if(re){var ye={content:""};if(V.innerHTML){ye.snippet={};for(var xe=0;xe<V.children.length;xe++){var Oe=V.children[xe].getAttribute("data-k");if(Oe)if(Oe=="image"){ye.snippet.image||(ye.snippet.image=[]);for(var Ge=0;Ge<V.children[xe].children.length;Ge++)ye.snippet.image.push(V.children[xe].children[Ge].getAttribute("src"))}else ye.snippet[Oe]=V.children[xe].innerHTML}}var Ke=Object.keys(L);if(Ke.length){ye.files=[];for(var xe=0;xe<Ke.length;xe++)ye.files.push(L[Ke[xe]])}var ot=document.createElement("div");ot.innerHTML=r.editor.innerHTML;var ft=ot.querySelector(".jsnippet");ft&&ft.remove();var nt=ot.innerHTML;nt=nt.replace(/<br>/g,`
`),nt=nt.replace(/<\/div>/g,`</div>
`),nt=nt.replace(/<(?:.|\n)*?>/gm,""),ye.content=nt.trim(),Ie("getData",ye)}else var ye=r.editor.innerHTML;return ye},r.reset=function(){r.editor.innerHTML="",V.innerHTML="",L=[]},r.addPdf=function(re){if(re.result.substr(0,4)!="data")console.error("Invalid source");else{var ye=document.createElement("canvas");ye.width=60,ye.height=60;var xe=new Image,Oe=ye.getContext("2d");Oe.drawImage(xe,0,0,ye.width,ye.height),ye.toBlob(function(Ge){var Ke=document.createElement("img");Ke.src=window.URL.createObjectURL(Ge),Ke.title=re.name,Ke.className="jfile pdf",L[Ke.src]={file:Ke.src,extension:"pdf",content:re.result},document.execCommand("insertHtml",!1,Ke.outerHTML)})}},r.addImage=function(re,ye){if(r.options.acceptImages)if(re||(re=""),re.substr(0,4)!="data"&&!r.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(re.substr(0,4)=="data"){var xe=re.split(";");xe=xe[0].split("/"),xe=xe[1]}else{var xe=re.substr(re.lastIndexOf(".")+1);re=r.options.remoteParser+re}var Oe=new Image;Oe.onload=function(){var Ke=document.createElement("canvas");Ke.width=Oe.width,Ke.height=Oe.height;var ot=Ke.getContext("2d");ot.drawImage(Oe,0,0,Ke.width,Ke.height),Ke.toBlob(function(ft){var nt=document.createElement("img");nt.src=window.URL.createObjectURL(ft),nt.classList.add("jfile"),nt.setAttribute("tabindex","900"),nt.setAttribute("width",Oe.width),nt.setAttribute("height",Oe.height),L[nt.src]={file:nt.src,extension:xe,content:Ke.toDataURL()},r.options.dropAsSnippet||ye?(Ee(nt),L[nt.src].snippet=!0):document.execCommand("insertHtml",!1,nt.outerHTML),ge()})},Oe.src=re}},r.addFile=function(re){for(var ye=[],xe=0;xe<re.length;xe++)if(re[xe].size>r.options.maxFileSize)alert("The file is too big");else{var Oe=re[xe].type.split("/");Oe[0]=="image"?Oe=1:Oe[1]=="pdf"?Oe=2:Oe=0,Oe?(ye[xe]=new FileReader,ye[xe].index=xe,ye[xe].type=Oe,ye[xe].name=re[xe].name,ye[xe].date=re[xe].lastModified,ye[xe].size=re[xe].size,ye[xe].addEventListener("load",function(Ge){Ge.target.type==2?r.options.acceptFiles==!0&&r.addPdf(Ge.target):r.addImage(Ge.target.result)},!1),ye[xe].readAsDataURL(re[xe])):alert("The extension is not allowed")}},r.destroy=function(){r.editor.removeEventListener("mouseup",je),r.editor.removeEventListener("mousedown",Te),r.editor.removeEventListener("mousemove",ve),r.editor.removeEventListener("keyup",K),r.editor.removeEventListener("keydown",le),r.editor.removeEventListener("dragstart",U),r.editor.removeEventListener("dragenter",J),r.editor.removeEventListener("dragover",v),r.editor.removeEventListener("drop",S),r.editor.removeEventListener("paste",we),r.editor.removeEventListener("blur",X),r.editor.removeEventListener("focus",ue),A.editor=null,A.classList.remove("jeditor-container"),G.remove(),V.remove(),r.editor.remove()},r.upload=function(){o.click(r.file)};const De=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Se=["width","height","align","border","src","tabindex"],Ue=["color","font-weight","font-size","background","background-color","margin"],$e=function(re){if(re.tagName&&De.indexOf(re.tagName.toLowerCase())===-1&&re.innerText&&(re.innerHTML=re.innerText),re.attributes&&re.attributes.length){let ye=null,xe=re.getAttribute("style");if(xe){ye=[];let Ge=xe.split(";");for(let Ke=0;Ke<Ge.length;Ke++){let ot=Ge[Ke].trim().split(":");if(Ue.indexOf(ot[0].trim())>=0){let ft=ot.shift();ot=ot.join(":"),ye.push(ft+":"+ot)}}}re.tagName.toUpperCase()==="IMG"&&(!r.options.acceptImages||!re.src?re.parentNode.removeChild(re):(re.setAttribute("tabindex","900"),r.addImage(re.src)));let Oe=[];for(let Ge=0;Ge<re.attributes.length;Ge++)Oe.push(re.attributes[Ge].name);Oe.length&&Oe.forEach(function(Ge){Se.indexOf(Ge)===-1?re.removeAttribute(Ge):re.attributes&&re.attributes[ne]&&re.attributes[ne].value.indexOf("<")!==-1&&re.attributes[ne].value.replace("<","&#60;")}),re.style="",ye&&ye.length&&re.setAttribute("style",ye.join(";"))}if(re.children.length)for(let ye=re.children.length;ye>0;ye--)$e(re.children[ye-1])};var Q=function(re){var ye=window.getSelection(),xe=document.createRange();xe.selectNode(re),ye.addRange(xe)},pe=function(re){re&&(re=re.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ye=new DOMParser,xe=ye.parseFromString(re,"text/html");$e(xe);var Oe=document.createElement("div");return Oe.innerHTML=xe.firstChild.innerHTML,Oe},we=function(re){if(r.options.filterPaste==!0){if(re.clipboardData||re.originalEvent.clipboardData)var ye=(re.originalEvent||re).clipboardData.getData("text/html"),xe=(re.originalEvent||re).clipboardData.getData("text/plain"),Oe=(re.originalEvent||re).clipboardData.files;else if(window.clipboardData)var ye=window.clipboardData.getData("Html"),xe=window.clipboardData.getData("Text"),Oe=window.clipboardData.files;if(Oe.length)r.addFile(Oe);else if(!ye)ye=xe.split(`\r
`),re.target.innerText?(ye=ye.map(function(Ke){return"<div>"+Ke+"</div>"}),document.execCommand("insertText",!1,ye.join(""))):ye.map(function(Ke){var ot=document.createElement("div");ot.innerText=Ke,r.editor.appendChild(ot)});else{var Ge=pe(ye);document.execCommand("insertHtml",!1,Ge.innerHTML)}re.preventDefault()}},U=function(re){F&&F.e&&re.preventDefault()},J=function(re){F||r.options.dropZone==!1||(A.classList.add("jeditor-dragging"),re.preventDefault())},v=function(re){F||r.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){A.classList.remove("jeditor-dragging")},100),re.preventDefault())},S=function(re){if(!(F||r.options.dropZone==!1)){var ye=null;document.caretRangeFromPoint?ye=document.caretRangeFromPoint(re.clientX,re.clientY):re.rangeParent&&(ye=document.createRange(),ye.setStart(re.rangeParent,re.rangeOffset));var xe=window.getSelection();xe.removeAllRanges(),xe.addRange(ye),xe.anchorNode.parentNode.focus();var Oe=(re.originalEvent||re).dataTransfer.getData("text/html"),Ge=(re.originalEvent||re).dataTransfer.getData("text/plain"),Ke=(re.originalEvent||re).dataTransfer.files;Ke.length?r.addFile(Ke):Ge&&ce(Oe),A.classList.remove("jeditor-dragging"),re.preventDefault()}},X=function(re){Ie("onevent",re),ge(re),typeof r.options.onblur=="function"&&r.options.onblur(A,r,re)},ue=function(re){typeof r.options.onfocus=="function"&&r.options.onfocus(A,r,re)},K=function(re){r.editor.innerHTML||(r.editor.innerHTML="<div><br></div>"),typeof r.options.onkeyup=="function"&&r.options.onkeyup(A,r,re)},le=function(re){if(Ie("onevent",re),re.key=="Delete"&&re.target.tagName=="IMG"){var ye=re.target.parentNode;Q(re.target),ye.classList.contains("jsnippet-image")&&fe()}typeof r.options.onkeydown=="function"&&r.options.onkeydown(A,r,re)},je=function(re){if(F&&F.e&&(F.e.classList.remove("resizing"),F.e.changed==!0)){var ye=F.e.cloneNode();ye.width=parseInt(F.e.style.width)||F.e.getAttribute("width"),ye.height=parseInt(F.e.style.height)||F.e.getAttribute("height"),F.e.style.width="",F.e.style.height="",Q(F.e),document.execCommand("insertHtml",!1,ye.outerHTML)}F=!1},Te=function(re){var ye=function(Ke){var ot=Ke.getBoundingClientRect();ot.width-(re.clientX-ot.left)<40&&re.clientY-ot.top<40&&(Ke.innerHTML="",Ke.remove())};if(re.target.tagName=="IMG")if(re.target.style.cursor){var xe=re.target.getBoundingClientRect();F={e:re.target,x:re.clientX,y:re.clientY,w:xe.width,h:xe.height,d:re.target.style.cursor},re.target.getAttribute("width")||re.target.setAttribute("width",xe.width),re.target.getAttribute("height")||re.target.setAttribute("height",xe.height);var Oe=window.getSelection();if(Oe.rangeCount)for(var Ge=0;Ge<Oe.rangeCount;Ge++)Oe.removeRange(Oe.getRangeAt(Ge));re.target.classList.add("resizing")}else F=!0;else re.target.classList.contains("jsnippet")?ye(re.target):re.target.parentNode.classList.contains("jsnippet")&&ye(re.target.parentNode),F=!0},ve=function(re){if(re.target.tagName=="IMG"&&!re.target.parentNode.classList.contains("jsnippet-image")&&r.options.allowImageResize==!0&&re.target.getAttribute("tabindex")){var ye=re.target.getBoundingClientRect();re.clientY-ye.top<5?ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="ne-resize":re.clientX-ye.left<5?re.target.style.cursor="nw-resize":re.target.style.cursor="n-resize":ye.height-(re.clientY-ye.top)<5?ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="se-resize":re.clientX-ye.left<5?re.target.style.cursor="sw-resize":re.target.style.cursor="s-resize":ye.width-(re.clientX-ye.left)<5?re.target.style.cursor="e-resize":re.clientX-ye.left<5?re.target.style.cursor="w-resize":re.target.style.cursor=""}if(re.which==1&&F&&F.d){if(F.d=="e-resize"||F.d=="ne-resize"||F.d=="se-resize")if(F.e.style.width=F.w+(re.clientX-F.x),re.shiftKey){var xe=(re.clientX-F.x)*(F.h/F.w);F.e.style.height=F.h+xe}else var xe=null;xe||(F.d=="s-resize"||F.d=="se-resize"||F.d=="sw-resize")&&(re.shiftKey||(F.e.style.height=F.h+(re.clientY-F.y))),F.e.changed=!0}},Ie=function(re,ye){if(r.options.extensions){var xe=Object.keys(r.options.extensions);if(xe.length)for(var Oe=0;Oe<xe.length;Oe++)r.options.extensions[xe[Oe]]&&typeof r.options.extensions[xe[Oe]][re]=="function"&&r.options.extensions[xe[Oe]][re].call(r,ye)}},Fe=function(){if(r.options.extensions){var re=Object.keys(r.options.extensions);if(re.length)for(var ye=0;ye<re.length;ye++)r.options.extensions[re[ye]]&&typeof r.options.extensions[re[ye]]=="function"&&(r.options.extensions[re[ye]]=r.options.extensions[re[ye]](A,r))}};if(document.addEventListener("mouseup",je),document.addEventListener("mousemove",ve),r.editor.addEventListener("mousedown",Te),r.editor.addEventListener("keyup",K),r.editor.addEventListener("keydown",le),r.editor.addEventListener("dragstart",U),r.editor.addEventListener("dragenter",J),r.editor.addEventListener("dragover",v),r.editor.addEventListener("drop",S),r.editor.addEventListener("paste",we),r.editor.addEventListener("focus",ue),r.editor.addEventListener("blur",X),A.appendChild(r.editor),r.options.snippet&&r.appendSnippet(r.options.snippet),r.options.toolbar){if(Array.isArray(r.options.toolbar))var tt={container:!0,responsive:!0,items:r.options.toolbar};else if(r.options.toolbar===!0)var tt={container:!0,responsive:!0,items:[]};else var tt=r.options.toolbar;tt.items&&tt.items.length||(tt.items=w.getDefaultToolbar(r)),r.options.toolbarOnTop?(A.classList.add("toolbar-on-top"),A.insertBefore(G,A.firstChild)):(r.editor.style.padding="15px",A.appendChild(G)),lt(G,tt),G.addEventListener("click",function(){r.editor.focus()})}return r.file=document.createElement("input"),r.file.style.display="none",r.file.type="file",r.file.setAttribute("accept","image/*"),r.file.onchange=function(){r.addFile(this.files)},A.appendChild(r.file),r.options.focus&&w.setCursor(r.editor,r.options.focus=="initial"),A.change=r.setData,A.val=function(re){if(re===void 0){var ye=A.getAttribute("data-html")!=="true";return r.getData(ye)}else r.setData(re)},Fe(),A.editor=r,typeof r.options.onload=="function"&&r.options.onload(A,r,r.editor),r};return w.setCursor=function(A,s){A.focus(),document.execCommand("selectAll");var r=window.getSelection(),B=r.getRangeAt(0);if(s==!0)var te=B.startContainer,ee=0;else var te=B.endContainer,ee=te.length;B.setStart(te,ee),B.setEnd(te,ee),r.removeAllRanges(),r.addRange(B)},w.getDefaultToolbar=function(A){var s=function(B,te,ee){ee.color||(me(ee,{onchange:function(F,L){ee.k==="color"?document.execCommand("foreColor",!1,L):document.execCommand("backColor",!1,L)}}),ee.color.open())},r=[];return r.push({content:"undo",onclick:function(){document.execCommand("undo")}}),r.push({content:"redo",onclick:function(){document.execCommand("redo")}}),r.push({type:"divisor"}),A.options.toolbarOnTop&&(r.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(B){return'<span style="font-family:'+B+'">'+B+"</span>"},onchange:function(B,te,ee,F,L){document.execCommand("fontName",!1,F)}}),r.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(B){return'<span style="font-size:'+B+'">'+B+"</span>"},onchange:function(B,te,ee,F,L){document.execCommand("fontSize",!1,parseInt(L)+1)}}),r.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(B){return'<i class="material-icons">'+B+"</i>"},onchange:function(B,te,ee,F,L){var V=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(V[L])}}),r.push({type:"divisor"}),r.push({content:"format_color_text",k:"color",onclick:s}),r.push({content:"format_color_fill",k:"background-color",onclick:s})),r.push({content:"format_bold",onclick:function(B,te,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_italic",onclick:function(B,te,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_underline",onclick:function(B,te,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({type:"divisor"}),r.push({content:"format_list_bulleted",onclick:function(B,te,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_list_numbered",onclick:function(B,te,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_increase",onclick:function(B,te,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),A.options.toolbarOnTop&&(r.push({type:"divisor"}),r.push({content:"photo",onclick:function(){A.upload()}}),r.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(B,te){te&&(te.onmouseover=this.onmouseover,B=B.split("x"),te.setAttribute("data-x",B[0]),te.setAttribute("data-y",B[1]));var ee=document.createElement("div");return te.style.margin="1px",te.style.border="1px solid #ddd",ee},onmouseover:function(B){for(var te=parseInt(B.target.getAttribute("data-x")),ee=parseInt(B.target.getAttribute("data-y")),F=0;F<B.target.parentNode.children.length;F++){var L=B.target.parentNode.children[F],V=parseInt(L.getAttribute("data-x")),G=parseInt(L.getAttribute("data-y"));V<=te&&G<=ee?(L.style.backgroundColor="#cae1fc",L.style.borderColor="#2977ff"):(L.style.backgroundColor="",L.style.borderColor="#ddd")}},onchange:function(B,te,ee){ee=ee.split("x");for(var F=document.createElement("table"),L=document.createElement("tbody"),V=0;V<=ee[1];V++){for(var G=document.createElement("tr"),ne=0;ne<=ee[0];ne++){var ge=document.createElement("td");ge.innerHTML="",G.appendChild(ge)}L.appendChild(G)}F.appendChild(L),F.setAttribute("width","100%"),F.setAttribute("cellpadding","6"),F.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,F.outerHTML)}})),r},w}var Me=Y();function qe(){var w=function(A,s){var r={};r.options={};var B={type:"big",title:"Untitled",width:510,height:472};for(var te in B)s&&s.hasOwnProperty(te)?r.options[te]=s[te]:r.options[te]=B[te];var ee=function(){for(var V=document.createElement("div");A.children[0];)V.appendChild(A.children[0]);for(r.content=document.createElement("div"),r.content.className="jfloating_content",r.content.innerHTML=A.innerHTML;V.children[0];)r.content.appendChild(V.children[0]);r.container=document.createElement("div"),r.container.className="jfloating",r.container.appendChild(r.content),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),r.options.width&&(r.container.style.width=parseInt(r.options.width)+"px"),r.options.height&&(r.container.style.height=parseInt(r.options.height)+"px"),A.innerHTML="",A.appendChild(r.container)},F=function(){r.container&&r.container.addEventListener("click",function(V){var G=V.target.getBoundingClientRect();if(V.target.classList.contains("jfloating")){if(V.changedTouches&&V.changedTouches[0])var ne=V.changedTouches[0].clientX,ge=V.changedTouches[0].clientY;else var ne=V.clientX,ge=V.clientY;G.width-(ne-G.left)<50&&ge-G.top<50?setTimeout(function(){r.close()},100):r.setState()}})},L=function(){r.container.classList.add("jfloating-"+r.options.type)};return r.state={isMinized:!1},r.setState=function(){r.state.isMinized?r.container.classList.remove("jfloating-minimized"):r.container.classList.add("jfloating-minimized"),r.state.isMinized=!r.state.isMinized},r.close=function(){Components.elements.splice(w.elements.indexOf(r.container),1),r.updatePosition(),A.remove()},r.updatePosition=function(){for(var V=0;V<w.elements.length;V++){var G=w.elements[V],ne=w.elements[V-1];G.style.right=V*(ne?ne.offsetWidth:G.offsetWidth)*1.01+"px"}},r.init=function(){ee(),F(),L(),w.elements.push(r.container),r.updatePosition(),A.floating=r},r.init(),r};return w.elements=[],w}var pt=qe();function Ze(){const w=function(F){return!isNaN(F)&&F!==null&&(typeof F!="string"||F.trim()!=="")},A={between:function(F,L){return F>=L[0]&&F<=L[1]},"not between":function(F,L){return F<L[0]||F>L[1]},"<":function(F,L){return F<L[0]},"<=":function(F,L){return F<=L[0]},">":function(F,L){return F>L[0]},">=":function(F,L){return F>=L[0]},"=":function(F,L){return F==L[0]},"!=":function(F,L){return F!=L[0]}},s={"valid date":function(){return!0},"=":function(F,L){return F===L[0]},"!=":function(F,L){return F!==L[0]},"<":function(F,L){return F<L[0]},"<=":function(F,L){return F<=L[0]},">":function(F,L){return F>L[0]},">=":function(F,L){return F>=L[0]},between:function(F,L){return F>=L[0]&&F<=L[1]},"not between":function(F,L){return F<L[0]||F>L[1]}},r={contains:function(F,L){return F.includes(L[0])},"not contains":function(F,L){return!F.includes(L[0])},"begins with":function(F,L){return F.startsWith(L[0])},"ends with":function(F,L){return F.endsWith(L[0])},"=":function(F,L){return F===L[0]},"!=":function(F,L){return F!==L[0]},"valid email":function(F){var L=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return L.test(F)},"valid url":function(F){var L=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return L.test(F)}},B=function(F,L){return typeof B[L.type]=="function"?L.allowBlank&&(typeof F>"u"||F===""||F===null)?!0:B[L.type].call(this,F,L):null};B.url=function(F){var L=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!L.test(F)},B.email=function(F){var L=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(F&&L.test(F))},B.required=function(F){return!!(F&&F.trim())},B.empty=function(F){return typeof F>"u"||F===null||typeof F=="string"&&!F.toString().trim()},B["not exist"]=B.empty,B.notEmpty=function(F){return!B.empty(F)},B.exist=B.notEmpty,B.number=function(F,L){if(!w(F))return!1;if(!L||!L.criteria)return!0;if(!A[L.criteria])return!1;let V=L.value.map(function(G){return parseFloat(G)});return A[L.criteria](F,V)},B.login=function(F){let L=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(F&&L.test(F))},B.list=function(F,L){let V=typeof F;if(V!=="string"&&V!=="number")return!1;let G;return typeof L.value[0]=="string"?L.source?G=L.source:G=L.value[0].split(","):G=L.value[0],Array.isArray(G)?G.findIndex(function(ge){return ge==F})>-1:!1};const te=function(){let F=new Date;return F.setHours(0,0,0,0),F},ee={"one year ago":function(){let F=te();return F.setFullYear(F.getFullYear()-1),F},"one month ago":function(){let F=te();return F.setMonth(F.getMonth()-1),F},"one week ago":function(){let F=te();return F.setDate(F.getDate()-7),F},yesterday:function(){let F=te();return F.setDate(F.getDate()-1),F},today:te,tomorrow:function(){let F=te();return F.setDate(F.getDate()+1),F}};return B.date=function(F,L){if(w(F)&&F>0&&F<1e6&&(F=D.numToDate(F)),new Date(F)=="Invalid Date")return!1;if(!L||!L.criteria)return!0;if(!s[L.criteria])return!1;let V=L.value.map(function(G){return typeof G=="string"&&ee[G]?ee[G]().getTime():new Date(G).getTime()});return s[L.criteria](new Date(F).getTime(),V)},B.text=function(F,L){if(typeof F>"u"||F===null)F="";else if(typeof F!="string")return!1;return!L||!L.criteria?!0:r[L.criteria]?r[L.criteria](F,L.value):!1},B.textLength=function(F,L){let V;return typeof F=="string"?V=F.length:typeof F<"u"&&F!==null&&typeof F.toString=="function"?V=F.toString().length:V=0,B.number(V,L)},B.time=function(F,L){if(!w(F))return!1;if(!L||!L.criteria)return!0;if(!A[L.criteria])return!1;let V=L.value.map(function(G){return parseInt(parseFloat(G)*10**17)/10**17});return A[L.criteria](parseInt(parseFloat(F)*10**17)/10**17,V)},B}var Ae=Ze();function Ne(){var w=function(A,s){var r={};r.options={};var B={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(L,V){alert(V)}};for(var te in B)s&&s.hasOwnProperty(te)?r.options[te]=s[te]:r.options[te]=B[te];r.options.validations||(r.options.validations={}),r.options.submitButton||(r.options.submitButton=A.querySelector("input[type=submit]")),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=Ae.email),r.options.validations.length||(r.options.validations.length=Ae.length),r.options.validations.required||(r.options.validations.required=Ae.required),r.setUrl=function(L){r.options.url=L},r.load=function(){I({url:r.options.url,method:"GET",dataType:"json",queue:!0,success:function(L){if(typeof r.options.onbeforeload=="function"){var V=r.options.onbeforeload(A,L);V&&(L=V)}w.setElements(A,L),typeof r.options.onload=="function"&&r.options.onload(A,L)}})},r.save=function(){var L=r.validate();if(L)r.options.onerror(A,L);else{var V=w.getElements(A,!0);if(typeof r.options.onbeforesave=="function"){var V=r.options.onbeforesave(A,V);if(V===!1)return}I({url:r.options.url,method:"POST",dataType:"json",data:V,success:function(G){typeof r.options.onsave=="function"&&r.options.onsave(A,V,G)}})}},r.remove=function(){if(typeof r.options.onbeforeremove=="function"){var L=r.options.onbeforeremove(A,r);if(L===!1)return!1}I({url:r.options.url,method:"DELETE",dataType:"json",success:function(V){typeof r.options.onremove=="function"&&r.options.onremove(A,r,V),r.reset()}})};var ee=function(L){L.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var V=L.getAttribute("data-error")||"There is an error in the form";return L.setAttribute("title",V),V},F=function(L){var V=!1;L.classList.remove("error"),L.removeAttribute("title");for(var G=A.querySelectorAll("input, select, textarea, div[name]"),ne=0;ne<G.length;ne++)G[ne].getAttribute("data-validation")&&G[ne].classList.contains("error")&&(V=!0);r.options.submitButton&&(V?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))};return r.validateElement=function(L){var V=!1,G=w.getValue(L),ne=L.getAttribute("data-validation");return typeof r.options.validations[ne]=="function"&&!r.options.validations[ne](G,L)?V=ee(L):L.classList.contains("error")&&F(L),V},r.reset=function(){for(var L=A.querySelectorAll("input, select, textarea, div[name]"),V=0;V<L.length;V++)L[V].getAttribute("name")&&(L[V].type=="checkbox"||L[V].type=="radio"?L[V].checked=!1:typeof L[V].val=="function"?L[V].val(""):L[V].value="")},r.validate=function(){for(var L=[],V=A.querySelectorAll("input, select, textarea, div[name]"),G=0;G<V.length;G++)if(V[G].getAttribute("data-validation")){var ne=r.validateElement(V[G]);ne&&L.push(ne)}return L.length>0?L.join("<br>"):!1},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(w.getElements(A))},r.getHash=function(L){var V=0,G,ne;if(L.length===0)return V;for(G=0;G<L.length;G++)ne=L.charCodeAt(G),V=(V<<5)-V+ne,V|=0;return V},r.isChanged=function(){var L=r.setHash();return r.options.currentHash!=L},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(L){r.options.ignore=!!L},setTimeout(function(){r.options.currentHash=r.setHash()},1e3),A.addEventListener("keyup",function(L){L.target.getAttribute("data-validation")&&r.validateElement(L.target)}),w.hasEvents||(window.addEventListener("beforeunload",function(L){if(r.isChanged()&&r.options.ignore==!1){var V=r.options.message?r.options.message:"o/";return V?(typeof L>"u"&&(L=window.event),L&&(L.returnValue=V),V):void 0}}),w.hasEvents=!0),A.form=r,r};return w.getValue=function(A){var s=null;if(A.type=="checkbox")A.checked==!0&&(s=A.value||!0);else if(A.type=="radio")A.checked==!0&&(s=A.value);else if(A.type=="file")s=A.files;else if(A.tagName=="select"&&A.multiple==!0){s=[];for(var r=A.querySelectorAll("options[selected]"),B=0;B<r.length;B++)s.push(r[B].value)}else typeof A.val=="function"?s=A.val():s=A.value||"";return s},w.getElements=function(A,s){for(var r={},B=null,te=A.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<te.length;ee++)(B=te[ee].getAttribute("name"))&&(r[B]=w.getValue(te[ee])||"");return s==!0?r:JSON.stringify(r)},w.setElements=function(A,s){for(var r=null,B=null,te=A.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<te.length;ee++){var F=te[ee].getAttribute("type");if(r=te[ee].getAttribute("name")){if(r=r.replace(new RegExp(/\[(.*?)\]/ig),".$1"),B=null,r.match(/\./)){var L=m.call(s,r)||"";typeof L<"u"&&(B=L)}else typeof s[r]<"u"&&(B=s[r]);B!==null&&(F=="checkbox"||F=="radio"?te[ee].checked=!!B:F=="file"||(typeof te[ee].val=="function"?te[ee].val(B):te[ee].value=B))}}},w}var Ve=Ne();function ze(){var w=function(){var s=null,r=function(F){if(F.which==27)for(var L=document.querySelectorAll(".jmodal"),V=0;V<L.length;V++)L[V].parentNode.modal.close()},B=function(F){let L=F.composedPath();var V=o.findElement(L[0],"jmodal");if(V){var G=V.getBoundingClientRect();if(F.changedTouches&&F.changedTouches[0])var ne=F.changedTouches[0].clientX,ge=F.changedTouches[0].clientY;else var ne=F.clientX,ge=F.clientY;G.width-(ne-G.left)<50&&ge-G.top<50&&V.parentNode.modal.close()}s&&(s.element.style.cursor="auto",s=null)},te=function(F){let L=F.composedPath();var V=o.findElement(L[0],"jmodal");if(V){var G=V.getBoundingClientRect();if(F.changedTouches&&F.changedTouches[0])var ne=F.changedTouches[0].clientX,ge=F.changedTouches[0].clientY;else var ne=F.clientX,ge=F.clientY;G.width-(ne-G.left)<50&&ge-G.top<50||ge-G.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),s={left:G.left,top:G.top,x:F.clientX,y:F.clientY,width:G.width,height:G.height,element:V})}},ee=function(F){if(s){if(F=F||window.event,F.buttons)var L=F.buttons;else if(F.button)var L=F.button;else var L=F.which;L?(s.element.style.top=s.top+(F.clientY-s.y)+s.height/2+"px",s.element.style.left=s.left+(F.clientX-s.x)+s.width/2+"px",s.element.style.cursor="move"):s.element.style.cursor="auto"}};document.addEventListener("keydown",r),document.addEventListener("mouseup",B),document.addEventListener("mousedown",te),document.addEventListener("mousemove",ee)},A=function(s,r){var B={};B.options={};var te={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in te)r&&r.hasOwnProperty(ee)?B.options[ee]=r[ee]:B.options[ee]=te[ee];!B.options.title&&s.getAttribute("title")&&(B.options.title=s.getAttribute("title"));for(var F=document.createElement("div");s.children[0];)F.appendChild(s.children[0]);for(B.title=document.createElement("div"),B.title.className="jmodal_title",B.options.icon&&B.title.setAttribute("data-icon",B.options.icon),B.content=document.createElement("div"),B.content.className="jmodal_content",B.content.innerHTML=s.innerHTML;F.children[0];)B.content.appendChild(F.children[0]);if(B.container=document.createElement("div"),B.container.className="jmodal",B.container.appendChild(B.title),B.container.appendChild(B.content),B.options.padding&&(B.content.style.padding=B.options.padding),B.options.width&&(B.container.style.width=B.options.width),B.options.height&&(B.container.style.height=B.options.height),B.options.title){var L=document.createElement("h4");L.innerText=B.options.title,B.title.appendChild(L)}if(s.innerHTML="",s.style.display="none",s.appendChild(B.container),B.options.backdrop){var V=document.createElement("div");V.className="jmodal_backdrop",V.onclick=function(){B.close()},s.appendChild(V)}return B.open=function(){s.style.display="block";var G=B.container.getBoundingClientRect();o.getWindowWidth()<G.width?(B.container.style.top="",B.container.style.left="",B.container.classList.add("jmodal_fullscreen"),O.slideBottom(B.container,1)):B.options.backdrop&&(V.style.display="block"),typeof B.options.onopen=="function"&&B.options.onopen(s,B)},B.resetPosition=function(){B.container.style.top="",B.container.style.left=""},B.isOpen=function(){return s.style.display!="none"},B.close=function(){B.isOpen()&&(s.style.display="none",B.options.backdrop&&(V.style.display=""),B.container.classList.remove("jmodal_fullscreen"),typeof B.options.onclose=="function"&&B.options.onclose(s,B))},B.options.url?I({url:B.options.url,method:"GET",dataType:"text/html",success:function(G){B.content.innerHTML=G,B.options.closed||B.open(),typeof B.options.onload=="function"&&B.options.onload(B)}}):(B.options.closed||B.open(),typeof B.options.onload=="function"&&B.options.onload(B)),s.modal=B,w(),w=function(){},B};return A}var Je=ze();function et(){var w=function(A){var s={};s.options={};var r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var B in r)A&&A.hasOwnProperty(B)?s.options[B]=A[B]:s.options[B]=r[B];var te=document.createElement("div");te.className="jnotification",s.options.error&&te.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",te.appendChild(ee);var F=document.createElement("div");F.className="jnotification-header",ee.appendChild(F);var L=document.createElement("div");if(L.className="jnotification-image",F.appendChild(L),s.options.icon){var V=document.createElement("img");V.src=s.options.icon,L.appendChild(V)}var G=document.createElement("div");if(G.className="jnotification-name",G.innerHTML=s.options.name,F.appendChild(G),s.options.closeable==!0){var ne=document.createElement("div");ne.className="jnotification-close",ne.onclick=function(){s.hide()},F.appendChild(ne)}var ge=document.createElement("div");ge.className="jnotification-date",F.appendChild(ge);var ce=document.createElement("div");if(ce.className="jnotification-content",ee.appendChild(ce),s.options.title){var fe=document.createElement("div");fe.className="jnotification-title",fe.innerHTML=s.options.title,ce.appendChild(fe)}var Ee=document.createElement("div");if(Ee.className="jnotification-message",Ee.innerHTML=s.options.message,ce.appendChild(Ee),s.show=function(){document.body.appendChild(te),o.getWindowWidth()>800?O.fadeIn(te):O.slideTop(te,1)},s.hide=function(){o.getWindowWidth()>800?O.fadeOut(te,function(){te.parentNode&&(te.parentNode.removeChild(te),De&&clearTimeout(De))}):O.slideTop(te,0,function(){te.parentNode&&(te.parentNode.removeChild(te),De&&clearTimeout(De))})},s.show(),s.options.autoHide==!0)var De=setTimeout(function(){s.hide()},s.options.timeout);return o.getWindowWidth()<800&&te.addEventListener("swipeup",function(Se){s.hide(),Se.preventDefault(),Se.stopPropagation()}),s};return w.isVisible=function(){var A=document.querySelector(".jnotification");return!!(A&&A.parentNode)},w}var it=et();function dt(w,A){var s={};s.options={};var r={value:0,onchange:null,width:null};for(var B in r)A&&A.hasOwnProperty(B)?s.options[B]=A[B]:s.options[B]=r[B];w.classList.add("jprogressbar"),w.setAttribute("tabindex",1),w.setAttribute("data-value",s.options.value);var te=document.createElement("div");te.style.width=s.options.value+"%",te.style.color="#fff",w.appendChild(te),s.options.width&&(w.style.width=s.options.width),s.setValue=function(F){F=parseInt(F),s.options.value=F,te.style.width=F+"%",w.setAttribute("data-value",F+"%"),F<6?w.style.color="#000":w.style.color="#fff",s.options.value=F,typeof s.options.onchange=="function"&&s.options.onchange(w,F),w.value!=s.options.value&&(w.value=s.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},s.getValue=function(){return s.options.value};var ee=function(F){if(F.which){var L=w.getBoundingClientRect();if(F.changedTouches&&F.changedTouches[0]){var V=F.changedTouches[0].clientX;F.changedTouches[0].clientY}else{var V=F.clientX;F.clientY}s.setValue(Math.round((V-L.left)/L.width*100))}};return"touchstart"in document.documentElement?(w.addEventListener("touchstart",ee),w.addEventListener("touchend",ee)):(w.addEventListener("mousedown",ee),w.addEventListener("mousemove",ee)),w.change=s.setValue,w.val=function(F){if(F===void 0)return s.getValue();s.setValue(F)},w.progressbar=s,s}function mt(w,A){if(w.rating)return w.rating.setOptions(A,!0);var s={};s.options={},s.setOptions=function(B,te){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var F in ee)B&&B.hasOwnProperty(F)?s.options[F]=B[F]:(typeof s.options[F]>"u"||te===!0)&&(s.options[F]=ee[F]);w.innerHTML="";for(var L=0;L<s.options.number;L++){var V=document.createElement("div");V.setAttribute("data-index",L+1),V.setAttribute("title",s.options.tooltip[L]),w.appendChild(V)}if(s.options.value)for(var L=0;L<s.options.number;L++)L<s.options.value&&w.children[L].classList.add("jrating-selected");return s},s.setValue=function(B){for(var te=0;te<s.options.number;te++)te<B?w.children[te].classList.add("jrating-selected"):(w.children[te].classList.remove("jrating-over"),w.children[te].classList.remove("jrating-selected"));s.options.value=B,typeof s.options.onchange=="function"&&s.options.onchange(w,B),w.value!=s.options.value&&(w.value=s.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},s.getValue=function(){return s.options.value};var r=function(){s.setOptions(A),w.classList.add("jrating"),w.addEventListener("click",function(B){var te=B.target.getAttribute("data-index");te!=null&&(te==s.options.value?s.setValue(0):s.setValue(te))}),w.addEventListener("mouseover",function(B){for(var te=B.target.getAttribute("data-index"),ee=0;ee<s.options.number;ee++)ee<te?w.children[ee].classList.add("jrating-over"):w.children[ee].classList.remove("jrating-over")}),w.addEventListener("mouseout",function(B){for(var te=0;te<s.options.number;te++)w.children[te].classList.remove("jrating-over")}),w.change=s.setValue,w.val=function(B){if(B===void 0)return s.getValue();s.setValue(B)},w.rating=s};return r(),s}function gt(w,A){if(w.search)return w.search;var s=null,r=function(V){if(V.target.classList.contains("jsearch_item"))var G=V.target;else var G=V.target.parentNode;F.selectIndex(G),V.preventDefault()},B=function(V){if(typeof F.options.onsearch=="function"){var G=F.options.onsearch(F,V);G&&(V=G)}if(L.innerHTML="",!V.length)w.style.display="";else{w.style.display="block";for(var ne=V.length<11?V.length:10,ge=0;ge<ne;ge++){if(typeof V[ge]=="string")var ce=V[ge],fe=V[ge];else{var ce=V[ge].text;!ce&&V[ge].name&&(ce=V[ge].name);var fe=V[ge].value;!fe&&V[ge].id&&(fe=V[ge].id)}var Ee=document.createElement("div");Ee.setAttribute("data-value",fe),Ee.setAttribute("data-text",ce),Ee.className="jsearch_item",V[ge].id&&Ee.setAttribute("id",V[ge].id),F.options.forceSelect&&ge==0&&Ee.classList.add("selected");var De=document.createElement("img");V[ge].image?De.src=V[ge].image:De.style.display="none",Ee.appendChild(De);var Se=document.createElement("div");Se.innerHTML=ce,Ee.appendChild(Se),L.appendChild(Ee)}}},te=function(V){if(V!=F.terms)if(F.terms=V,F.options.forceSelect?s=0:s=null,Array.isArray(F.options.data)){var G=function(ge){if(typeof ge=="string"){if((""+ge).toLowerCase().search(V.toLowerCase())>=0)return!0}else for(var ce in ge){var fe=ge[ce];if((""+fe).toLowerCase().search(V.toLowerCase())>=0)return!0}return!1},ne=F.options.data.filter(function(ge){return G(ge)});B(ne)}else I({url:F.options.data+V,method:"GET",dataType:"json",success:function(ge){B(ge)}})},ee=null,F=function(V){ee&&clearTimeout(ee),ee=setTimeout(function(){te(V)},500)};A.forceSelect===null&&(A.forceSelect=!0),F.options={data:A.data||null,input:A.input||null,searchByNode:A.searchByNode||null,onselect:A.onselect||null,forceSelect:A.forceSelect,onsearch:A.onsearch||null,onbeforesearch:A.onbeforesearch||null},F.selectIndex=function(V){var G=V.getAttribute("id"),ne=V.getAttribute("data-text"),ge=V.getAttribute("data-value"),ce=V.children[0].src||"";typeof F.options.onselect=="function"&&F.options.onselect(F,ne,ge,G,ce),F.close()},F.open=function(){w.style.display="block"},F.close=function(){ee&&clearTimeout(ee),F.terms="",L.innerHTML="",w.style.display=""},F.isOpened=function(){return!!w.style.display},F.keydown=function(V){F.isOpened()&&(V.key=="Enter"?s!==null&&L.children[s]?(F.selectIndex(L.children[s]),V.preventDefault()):F.close():V.key==="ArrowUp"?(s!==null&&L.children[0]&&(L.children[s].classList.remove("selected"),!F.options.forceSelect&&s===0?s=null:(s=Math.max(0,s-1),L.children[s].classList.add("selected"))),V.preventDefault()):V.key==="ArrowDown"&&(s==null?s=-1:L.children[s].classList.remove("selected"),s<9&&L.children[s+1]&&s++,L.children[s].classList.add("selected"),V.preventDefault()))},F.keyup=function(V){if(!F.options.searchByNode&&F.options.input)if(F.options.input.tagName==="DIV")var G=F.options.input.innerText;else var G=F.options.input.value;else{var ne=o.getNode();if(ne)var G=ne.innerText}if(typeof F.options.onbeforesearch=="function"){var ge=F.options.onbeforesearch(F,G);if(ge)G=ge;else if(ge===!1)return}F(G)},F.blur=function(V){F.close()},F.options.input&&(F.options.input.addEventListener("keyup",F.keyup),F.options.input.addEventListener("keydown",F.keydown),F.options.input.addEventListener("blur",F.blur));var L=document.createElement("div");return L.classList.add("jsearch_container"),L.onmousedown=r,w.appendChild(L),w.classList.add("jsearch"),w.search=F,F}function St(w,A){var s={};if(s.options={},s.currentImage=null,A&&(s.options=A),w.setAttribute("tabindex","900"),s.options.items=[],!w.classList.contains("jslider")){if(w.classList.add("jslider"),w.classList.add("unselectable"),s.options.height&&(w.style.minHeight=parseInt(s.options.height)+"px"),s.options.width&&(w.style.width=parseInt(s.options.width)+"px"),s.options.grid){w.classList.add("jslider-grid");var r=w.children.length;r>4&&w.setAttribute("data-total",r-4),w.setAttribute("data-number",r>4?4:r)}var B=document.createElement("div");if(B.classList.add("jslider-counter"),w.children.length>0)for(var te=0;te<w.children.length;te++){s.options.items.push(w.children[te]);var ee=document.createElement("div");ee.onclick=function(){var ne=Array.prototype.slice.call(B.children).indexOf(this);s.show(s.currentImage=s.options.items[ne])},B.appendChild(ee)}var F=document.createElement("div");F.className="jslider-caption";var L=document.createElement("div"),V=document.createElement("div");V.className="jslider-close",V.innerHTML="",V.onclick=function(){s.close()},L.appendChild(F),L.appendChild(V)}s.updateCounter=function(ne){for(var ge=0;ge<B.children.length;ge++)if(B.children[ge].classList.contains("jslider-counter-focus")){B.children[ge].classList.remove("jslider-counter-focus");break}B.children[ne].classList.add("jslider-counter-focus")},s.show=function(ne){if(!ne)var ne=w.children[0];w.classList.add("jslider-focus"),w.classList.remove("jslider-grid"),w.appendChild(L),w.appendChild(B);var ge=s.options.items.indexOf(ne);s.updateCounter(ge);for(var ce=0;ce<w.children.length;ce++)w.children[ce].style.display="";ne.style.display="block",ne.previousElementSibling?w.classList.add("jslider-left"):w.classList.remove("jslider-left"),ne.nextElementSibling&&ne.nextElementSibling.tagName=="IMG"?w.classList.add("jslider-right"):w.classList.remove("jslider-right"),s.currentImage=ne,s.currentImage.offsetHeight>s.currentImage.offsetWidth&&s.currentImage.classList.add("jslider-vertical"),L.children[0].innerText=s.currentImage.getAttribute("title")},s.open=function(){s.show(),typeof s.options.onopen=="function"&&s.options.onopen(w)},s.close=function(){w.classList.remove("jslider-focus"),w.classList.remove("jslider-left"),w.classList.remove("jslider-right"),s.options.grid&&w.classList.add("jslider-grid");for(var ne=0;ne<w.children.length;ne++)w.children[ne].style.display="";B.remove(),L.remove(),s.currentImage=null,typeof s.options.onclose=="function"&&s.options.onclose(w)},s.reset=function(){w.innerHTML=""},s.next=function(){var ne=s.currentImage.nextElementSibling;ne&&ne.tagName==="IMG"&&s.show(s.currentImage.nextElementSibling)},s.prev=function(){s.currentImage.previousElementSibling&&s.show(s.currentImage.previousElementSibling)};var G=function(ne){if(ne.target.tagName=="IMG")s.show(ne.target);else if(!ne.target.classList.contains("jslider-close")&&!(ne.target.parentNode.classList.contains("jslider-counter")||ne.target.classList.contains("jslider-counter"))){var ge=ne.offsetX||ne.changedTouches[0].clientX;ne.target.clientWidth-ge<40?s.next():ge<40&&s.prev()}};return"ontouchend"in document.documentElement?w.addEventListener("touchend",G):w.addEventListener("mouseup",G),w.addEventListener("swipeleft",function(ne){s.next(),ne.preventDefault(),ne.stopPropagation()}),w.addEventListener("swiperight",function(ne){s.prev(),ne.preventDefault(),ne.stopPropagation()}),w.addEventListener("keydown",function(ne){ne.which==27&&s.close()}),w.slider=s,s}function Ft(w,A){if(w.tags)return w.tags.setOptions(A,!0);var s={type:"tags"};s.options={};var r=function(){return!!(s.options.limit&&w.children.length>=s.options.limit)},B=null,te=null;s.setOptions=function(Q,pe){var we={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var U in we)Q&&Q.hasOwnProperty(U)?s.options[U]=Q[U]:(typeof s.options[U]>"u"||pe===!0)&&(s.options[U]=we[U]);return s.options.placeholder?w.setAttribute("data-placeholder",s.options.placeholder):w.removeAttribute("data-placeholder"),w.placeholder=s.options.placeholder,s.setValue(s.options.value),V(),s.options.search?te||(te=document.createElement("div"),w.parentNode.insertBefore(te,w.nextSibling),B=gt(te,{data:s.options.search,onselect:function(J,v,S){s.selectIndex(v,S)}})):te&&(B=null,te.remove(),te=null),s},s.add=function(Q,pe){if(typeof s.options.onbeforechange=="function"){var we=s.options.onbeforechange(w,s,s.options.value,Q);if(we===!1)return!1;we!=null&&(Q=we)}if(B&&B.close(),r())typeof s.options.onlimit=="function"?s.options.onlimit(s,s.options.limit):alert(f.translate("You reach the limit number of entries")+" "+s.options.limit);else{var U=o.getNode();if(U&&U.parentNode&&U.parentNode.classList.contains("jtags")&&U.nextSibling&&!(U.nextSibling.innerText&&U.nextSibling.innerText.trim()))J=U.nextSibling;else{if(w.lastChild&&(w.lastChild.innerText.trim()||w.removeChild(w.lastChild)),!Q||typeof Q=="string")var J=F(Q,Q,U);else for(var v=0;v<=Q.length;v++)if(!r()){if(!Q[v]||typeof Q[v]=="string")var S=Q[v]||"",X=null;else var S=Q[v].text,X=Q[v].value;var J=F(S,X)}L()}pe&&ee(J)}},s.setLimit=function(Q){for(s.options.limit=Q,w.children.length-Q;w.children.length>Q;)w.removeChild(w.lastChild)},s.remove=function(Q){Q.parentNode.removeChild(Q),w.children.length?L():s.add("",!0),typeof s.options.onremoveitem=="function"&&s.options.onremoveitem(w,s,Q)},s.getData=function(){for(var Q=[],pe=0;pe<w.children.length;pe++){var we=w.children[pe].innerText.replace(`
`,""),U=w.children[pe].getAttribute("data-value");U||(U=we),(we||U)&&Q.push({text:we,value:U})}return Q},s.getValue=function(Q){var pe=null;if(Q!=null)pe=w.children[Q].getAttribute("data-value"),pe||(pe=w.children[Q].innerText.replace(`
`,""));else{for(var we=[],U=0;U<w.children.length;U++)pe=w.children[U].innerText.replace(`
`,""),pe&&we.push(s.getValue(U));pe=we.join(",")}return pe},s.setValue=function(Q){if(!Q)s.reset();else if(w.value!=Q)if(Array.isArray(Q))s.add(Q);else{var pe=(""+Q).trim(),we=ne(pe);w.innerHTML="",s.add(we)}},s.reset=function(){w.classList.add("jtags-empty"),w.innerHTML="<div></div>",L()},s.isValid=function(){for(var Q=0,pe=0;pe<w.children.length;pe++)w.children[pe].classList.contains("jtags_error")&&Q++;return Q==0},s.selectIndex=function(Q,pe){var we=o.getNode();we&&(we.innerText=Q,pe&&we.setAttribute("data-value",pe),we.classList.remove("jtags_error"),r()||s.add("",!0))},s.search=function(Q){Q.innerText},s.destroy=function(){w.removeEventListener("mouseup",De),w.removeEventListener("keydown",ce),w.removeEventListener("keyup",fe),w.removeEventListener("paste",Ee),w.removeEventListener("focus",Se),w.removeEventListener("blur",Ue),w.parentNode.removeChild(w)};var ee=function(Q){if(w.children.length){var pe=document.createRange(),we=window.getSelection();if(!Q)var Q=w.childNodes[w.childNodes.length-1];pe.setStart(Q,Q.length),pe.collapse(!0),we.removeAllRanges(),we.addRange(pe),w.scrollLeft=w.scrollWidth}},F=function(Q,pe,we){var U=document.createElement("div");return U.textContent=Q||"",pe&&U.setAttribute("data-value",pe),we&&we.parentNode.classList.contains("jtags")?w.insertBefore(U,we.nextSibling):w.appendChild(U),U},L=function(){var Q=s.getValue();Q!=s.options.value&&(s.options.value=Q,typeof s.options.onchange=="function"&&s.options.onchange(w,s,s.options.value),w.value!=s.options.value&&(w.value=s.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))),V()},V=function(){for(var Q=0;Q<w.children.length;Q++)w.children[Q].tagName==="DIV"&&(s.getValue(Q)?(w.children[Q].classList.add("jtags_label"),typeof s.options.validation=="function"&&s.getValue(Q)?s.options.validation(w.children[Q],w.children[Q].innerText,w.children[Q].getAttribute("data-value"))?w.children[Q].classList.remove("jtags_error"):w.children[Q].classList.add("jtags_error"):w.children[Q].classList.remove("jtags_error")):w.children[Q].classList.remove("jtags_label"));G()},G=function(){w.innerText.trim()?w.classList.remove("jtags-empty"):(!w.children.length||w.children[0].tagName==="BR")&&(w.innerHTML="",ee(F()))},ne=function(Q){var pe=[],we="";if(Q=Q.trim(),Q){for(var U=0;U<Q.length;U++)Q[U]==","||Q[U]==";"||Q[U]==`
`?we&&(pe.push(we.trim()),we=""):we+=Q[U];we&&pe.push(we)}return pe},ge=0,ce=function(Q){if(ge=window.getSelection().anchorOffset,G(),Q.key==="Tab"||Q.key===";"||Q.key===","){var pe=window.getSelection().anchorOffset;pe>1&&(r()?typeof s.options.onlimit=="function"&&s.options.onlimit(s,s.options.limit):s.add("",!0)),Q.preventDefault()}else if(Q.key=="Enter"){if(!B||!B.isOpened()){var pe=window.getSelection().anchorOffset;pe>1&&(r()||s.add("",!0)),Q.preventDefault()}}else Q.key=="Backspace"&&w.children.length==1&&window.getSelection().anchorOffset<1&&Q.preventDefault();B&&B.keydown(Q),G()},fe=function(Q){if(Q.which==39){var pe=window.getSelection().anchorOffset;pe>1&&pe==ge&&s.add("",!0)}else Q.which==13||Q.which==38||Q.which==40?Q.preventDefault():B&&B.keyup(Q);V()},Ee=function(Q){if(Q.clipboardData||Q.originalEvent.clipboardData)var pe=(Q.originalEvent||Q).clipboardData.getData("text/plain");else if(window.clipboardData)var pe=window.clipboardData.getData("Text");var we=ne(pe);if(typeof s.options.onbeforepaste=="function"){var U=s.options.onbeforepaste(w,s,we);if(U===!1)return Q.preventDefault(),!1;U&&(we=U)}we.length>1?(s.add(we,!0),Q.preventDefault()):we[0]&&(document.execCommand("insertText",!1,we[0]),Q.preventDefault())},De=function(Q){if(Q.target.parentNode&&Q.target.parentNode.classList.contains("jtags")&&(Q.target.classList.contains("jtags_label")||Q.target.classList.contains("jtags_error"))){var pe=Q.target.getBoundingClientRect();pe.width-(Q.clientX-pe.left)<16&&s.remove(Q.target)}Q.target==w&&ee()},Se=function(){w.classList.contains("jtags-focus")||((!w.children.length||s.getValue(w.children.length-1))&&(r()||F("")),typeof s.options.onfocus=="function"&&s.options.onfocus(w,s,s.getValue()),w.classList.add("jtags-focus"))},Ue=function(){if(w.classList.contains("jtags-focus")){B&&B.close();for(var Q=0;Q<w.children.length-1;Q++)s.getValue(Q)||w.removeChild(w.children[Q]);L(),w.classList.remove("jtags-focus"),typeof s.options.onblur=="function"&&s.options.onblur(w,s,s.getValue())}},$e=function(){"touchend"in document.documentElement?w.addEventListener("touchend",De):w.addEventListener("mouseup",De),w.addEventListener("keydown",ce),w.addEventListener("keyup",fe),w.addEventListener("paste",Ee),w.addEventListener("focus",Se),w.addEventListener("blur",Ue),w.setAttribute("contenteditable",!0),w.classList.add("jtags"),s.setOptions(A),typeof s.options.onload=="function"&&s.options.onload(w,s),w.change=s.setValue,w.val=function(Q){if(Q===void 0)return s.getValue();s.setValue(Q)},w.tags=s};return $e(),s}function Et(w,A){var s={};s.options={};var r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var B in r)A&&A.hasOwnProperty(B)?s.options[B]=A[B]:s.options[B]=r[B];s.options.multiple==!0&&w.setAttribute("data-multiple",!0),w.content=[],w.classList.add("jupload"),s.options.input==!0&&w.classList.add("input"),s.add=function(L){if(s.options.multiple==!1&&(w.content=[],w.innerText=""),s.options.type=="image"){var V=document.createElement("img");V.setAttribute("src",L.file),V.setAttribute("tabindex",-1),w.getAttribute("name")||(V.className="jfile",V.content=L),w.appendChild(V)}else{if(L.name)var G=L.name;else var G=L.file;var ne=document.createElement("div");ne.innerText=G||s.options.type,ne.classList.add("jupload-item"),ne.setAttribute("tabindex",-1),w.appendChild(ne)}L.content&&(L.file=o.guid()),w.content.push(L),typeof s.options.onchange=="function"&&s.options.onchange(w,L)},s.addFromFile=function(L){var V=L.type.split("/");if(V[0]==s.options.type){var G=new FileReader;G.addEventListener("load",function(ne){var ge={file:ne.srcElement.result,extension:L.name.substr(L.name.lastIndexOf(".")+1),name:L.name,size:L.size,lastmodified:L.lastModified,content:ne.srcElement.result};s.add(ge)}),G.readAsDataURL(L)}else alert(f.translate("This extension is not allowed"))},s.addFromUrl=function(L){if(L.substr(0,4)!="data"&&!s.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(L.substr(0,4)=="data"){var V=L.split(";");V=V[0].split("/");var G=V[0].replace("data:","");if(G==s.options.type){var ne={file:L,name:"",extension:V[1],content:L};s.add(ne)}else alert(s.options.text.extensionNotAllowed)}else{var V=L.substr(L.lastIndexOf(".")+1);L=s.options.remoteParser+L,I({url:L,type:"GET",dataType:"blob",success:function(ce){}})}};var te=s.options.type+"/"+s.options.extension,ee=document.createElement("input");ee.type="file",ee.setAttribute("accept",te),ee.onchange=function(){for(var L=0;L<this.files.length;L++)s.addFromFile(this.files[L])},s.options.multiple==!0&&ee.setAttribute("multiple",!0);var F=null;return w.addEventListener("click",function(L){F=null,!w.children.length||L.target===w?o.click(ee):L.target.parentNode==w&&(F=L.target)}),w.addEventListener("dblclick",function(L){o.click(ee)}),w.addEventListener("dragenter",function(L){w.style.border="1px dashed #000"}),w.addEventListener("dragleave",function(L){w.style.border="1px solid #eee"}),w.addEventListener("dragstop",function(L){w.style.border="1px solid #eee"}),w.addEventListener("dragover",function(L){L.preventDefault()}),w.addEventListener("keydown",function(L){if(F&&L.which==46){var V=Array.prototype.indexOf.call(w.children,F);V>=0&&(w.content.splice(V,1),F.remove(),F=null)}}),w.addEventListener("drop",function(L){L.preventDefault(),L.stopPropagation();var V=(L.originalEvent||L).dataTransfer.getData("text/html"),G=(L.originalEvent||L).dataTransfer.files;if(G.length)for(var ne=0;ne<L.dataTransfer.files.length;ne++)s.addFromFile(L.dataTransfer.files[ne]);else if(V){s.options.multiple==!1&&(w.innerText="");var ge=document.createElement("div");ge.innerHTML=V;var ce=ge.querySelectorAll("img");if(ce.length)for(var ne=0;ne<ce.length;ne++)s.addFromUrl(ce[ne].src)}return w.style.border="1px solid #eee",!1}),w.val=function(L){if(L===void 0)return w.content&&w.content.length?w.content:null;if(w.innerText="",w.content=[],L)if(Array.isArray(L))for(var V=0;V<L.length;V++)typeof L[V]=="string"?s.add({file:L[V]}):s.add(L[V]);else typeof L=="string"&&s.add({file:L})},w.upload=w.image=s,s}var Ot=R(195),Tt=R.n(Ot),bt={...f,...o,version:"5.12.0",setExtensions:function(w){if(typeof w=="object")for(var A=Object.keys(w),s=0;s<A.length;s++)bt[A[s]]=w[A[s]]},tracking:P,path:m,sorting:p,lazyLoading:C,ajax:I,animation:O,calendar:he,color:me,contextmenu:Re,dropdown:Be,editor:Me,floating:pt,form:Ve,mask:q,modal:Je,notification:it,palette:be,picker:He,progressbar:dt,rating:mt,search:gt,slider:St,tabs:Le,tags:Ft,toolbar:lt,upload:Et,validations:Ae};bt.image=Et,bt.image.create=function(w){var A=document.createElement("img");return A.setAttribute("src",w.file),A.className="jfile",A.setAttribute("tabindex",-1),A.content=w,A},bt.tracker=Ve,bt.loading=O.loading,bt.sha512=Tt(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const w=function(Q,pe){return Q[pe.type]&&Q[pe.type]==pe||Q.component&&Q.component==pe?!0:Q.parentNode?w(Q.parentNode,pe):!1},A=function(Q){let pe=window.jSuitesStateControl;if(pe&&pe.length>0)for(let we=0;we<pe.length;we++)pe[we]&&!w(Q,pe[we])&&pe[we].close()};let s=15,r=!1,B={x:null,y:null},te=document.createElement("div");te.classList.add("jtooltip");const ee=function(Q){return Q&&(Q.shadowRoot||Q.tagName&&Q.tagName.includes("-"))},F=function(Q){let pe,we,U=Q.path||Q.composedPath&&Q.composedPath();return U?(we=U[0],we&&ee(we)&&!we.shadowRoot&&Q.toElement&&(we=Q.toElement)):(Q.target&&ee(Q.target)?pe=Q.target.shadowRoot:pe=document,we=pe.elementFromPoint(x,y)),we},L=function(Q){if(Q.changedTouches&&Q.changedTouches[0])var pe=Q.changedTouches[0].clientX,we=Q.changedTouches[0].clientY;else var pe=Q.clientX,we=Q.clientY;let U=F(Q),J=U&&U.tagName==="DIV"&&U.getAttribute("contentEditable"),v=bt.findElement(U,"jpanel");if(v&&!v.classList.contains("readonly")&&!J){let S=v.getBoundingClientRect(),X=0;v.style.rotate&&(X=parseFloat(v.style.rotate));let ue="move";U.getAttribute("data-action")?ue=U.getAttribute("data-action"):v.style.cursor?ue="resize":v.style.cursor="move",r={action:ue,a:X,e:v,x:pe,y:we,l:S.left,t:S.top,b:S.bottom,r:S.right,w:S.width,h:S.height,d:v.style.cursor,actioned:!1},v.style.width||(v.style.width=S.width+"px"),v.style.height||(v.style.height=S.height+"px")}else r=!1;A(U),fe(Q)},V=function(Q,pe,we,U,J,v){const S=we-Q,X=U-pe,ue=J-Q,K=v-pe;let le=Math.atan2(X,S),Te=Math.atan2(K,ue)-le;return Te=Te*(180/Math.PI),Te<0&&(Te+=360),Te},G=function(Q){r&&r.e&&(typeof r.e.refresh=="function"&&B.actioned&&r.e.refresh(),r.e.style.cursor=""),B={x:null,y:null},r=!1},ne=function(Q){if(r){let v=Q.clientX||Q.pageX,S=Q.clientY||Q.pageY;if(B.x==null&&B.y==null&&(B.x=v,B.y=S),r.action==="move"){var pe=v-B.x,we=S-B.y,U=r.e.offsetTop+we,J=r.e.offsetLeft+pe;r.e.style.top=U+"px",r.e.style.left=J+"px",typeof r.e.refresh=="function"&&(B.actioned=!0,r.e.refresh("position",U,J))}else if(r.action==="rotate"){let X=r.l+r.w/2,ue=r.t+r.h/2,K=V(X,ue,r.x,r.y,v,S);K=K+r.a%360,K=Math.round(K/2)*2,r.e.style.rotate=`${K}deg`,typeof r.e.refresh=="function"&&(B.actioned=!0,r.e.refresh("rotate",K))}else if(r.action==="resize"){let X=null,ue=null,K=null,le=null;r.d=="e-resize"||r.d=="ne-resize"||r.d=="se-resize"?(K=r.e.offsetWidth+(v-B.x),Q.shiftKey&&(le=r.e.offsetHeight+(v-B.x)*(r.e.offsetHeight/r.e.offsetWidth))):(r.d==="w-resize"||r.d=="nw-resize"||r.d=="sw-resize")&&(ue=r.e.offsetLeft+(v-B.x),K=r.e.offsetLeft+r.e.offsetWidth-ue,Q.shiftKey&&(le=r.e.offsetHeight-(v-B.x)*(r.e.offsetHeight/r.e.offsetWidth))),r.d=="s-resize"||r.d=="se-resize"||r.d=="sw-resize"?le||(le=r.e.offsetHeight+(S-B.y)):(r.d==="n-resize"||r.d=="ne-resize"||r.d=="nw-resize")&&(X=r.e.offsetTop+(S-B.y),le=r.e.offsetTop+r.e.offsetHeight-X),X&&(r.e.style.top=X+"px"),ue&&(r.e.style.left=ue+"px"),K&&(r.e.style.width=K+"px"),le&&(r.e.style.height=le+"px"),typeof r.e.refresh=="function"&&(B.actioned=!0,r.e.refresh("dimensions",K,le))}B.x=v,B.y=S}else{let v=F(Q),S=bt.findElement(v,"jpanel");if(S){if(S.classList.contains("jpanel-controls")){let ue=v.getAttribute("data-position");ue?S.style.cursor=ue:S.style.cursor=""}else if(S.getAttribute("tabindex")){let ue=S.getBoundingClientRect();Q.clientY-ue.top<s?ue.width-(Q.clientX-ue.left)<s?S.style.cursor="ne-resize":Q.clientX-ue.left<s?S.style.cursor="nw-resize":S.style.cursor="n-resize":ue.height-(Q.clientY-ue.top)<s?ue.width-(Q.clientX-ue.left)<s?S.style.cursor="se-resize":Q.clientX-ue.left<s?S.style.cursor="sw-resize":S.style.cursor="s-resize":ue.width-(Q.clientX-ue.left)<s?S.style.cursor="e-resize":Q.clientX-ue.left<s?S.style.cursor="w-resize":S.style.cursor=""}}}};let ge=["n","ne","e","se","s","sw","w","nw","rotate"];ge.forEach(function(Q,pe){ge[pe]=document.createElement("div"),ge[pe].classList.add("jpanel-action"),Q==="rotate"?ge[pe].setAttribute("data-action","rotate"):(ge[pe].setAttribute("data-action","resize"),ge[pe].setAttribute("data-position",Q+"-resize"))});let ce;const fe=function(Q){let pe=F(Q),we=bt.findElement(pe,"jpanel");we&&!we.classList.contains("readonly")&&we.classList.contains("jpanel-controls")?(we.append(...ge),we.classList.contains("jpanel-rotate")||ge[ge.length-1].remove(),ce=we):Ee()},Ee=function(Q){ce&&(ge.forEach(function(pe){pe.remove()}),ce=null)},De=function(Q){var we=F(Q).getAttribute("data-tooltip");if(we){if(te.innerText=we,Q.changedTouches&&Q.changedTouches[0])var U=Q.changedTouches[0].clientX,J=Q.changedTouches[0].clientY;else var U=Q.clientX,J=Q.clientY;te.style.top=J+"px",te.style.left=U+"px",document.body.appendChild(te)}else te.innerText&&(te.innerText="",document.body.removeChild(te))},Se=function(Q){var pe=document.activeElement;if(pe&&typeof pe.contextmenu=="function")pe.contextmenu(Q),Q.preventDefault(),Q.stopImmediatePropagation();else if(pe=bt.findElement(Q.target,function(U){return U.tagName&&U.getAttribute("aria-contextmenu-id")}),pe){var we=document.querySelector("#"+pe);we?(we.contextmenu.open(Q),Q.preventDefault(),Q.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+pe)}},Ue=function(Q){let pe=document.activeElement;pe&&Q.key==="Delete"&&typeof pe.delete=="function"&&(pe.delete(),Q.preventDefault(),Q.stopImmediatePropagation());let we=window.jSuitesStateControl;we&&we.length>0&&(pe=we[we.length-1],pe&&Q.key==="Escape"&&typeof pe.isOpened=="function"&&typeof pe.close=="function"&&pe.isOpened()&&(pe.close(),Q.preventDefault(),Q.stopImmediatePropagation()))},$e=function(Q){(Q.target.getAttribute("data-mask")||Q.target.mask)&&bt.mask(Q)};document.addEventListener("focusin",fe),document.addEventListener("mouseup",G),document.addEventListener("mousedown",L),document.addEventListener("mousemove",ne),document.addEventListener("mouseover",De),document.addEventListener("keydown",Ue),document.addEventListener("contextmenu",Se),document.addEventListener("input",$e)}();var Rt=bt})(),c=W.default}(),c})}(jsuites$1)),jsuites$1.exports}var dist=dist$1.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();(function(n,l){module.exports=l()})(dist,function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(n){var l;n.exports=(function(){var c={765:function(W,j){var u;u=function(f){f.version="1.0.2";var k=Math;function P(me,ie){for(var Re=0,_e=0;Re<me.length;++Re)_e=ie*_e+me[Re];return _e}function b(me,ie,Re,_e,Be){if(ie===0)return Re;if(ie===1)return _e;for(var He=2/me,lt=_e,Y=1;Y<ie;++Y)lt=_e*Y*He+Be*Re,Re=_e,_e=lt;return lt}function o(me,ie,Re,_e,Be){return function(He,lt){if(_e){if(He===0)return _e==1?-1/0:1/0;if(He<0)return NaN}return lt===0?me(He):lt===1?ie(He):lt<0?NaN:b(He,lt|=0,me(He),ie(He),Be)}}var g,m,p,C,T,I,_,O,M,D,Z,q,ae,he=function(){var me=.636619772,ie=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Re=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),_e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Be=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function He(Ze){var Ae=0,Ne=0,Ve=0,ze=Ze*Ze;if(Ze<8)Ae=(Ne=P(ie,ze))/(Ve=P(Re,ze));else{var Je=Ze-.785398164;Ne=P(_e,ze=64/ze),Ve=P(Be,ze),Ae=k.sqrt(me/Ze)*(k.cos(Je)*Ne-k.sin(Je)*Ve*8/Ze)}return Ae}var lt=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),Y=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Me=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),qe=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function pt(Ze){var Ae=0,Ne=0,Ve=0,ze=Ze*Ze,Je=k.abs(Ze)-2.356194491;return Math.abs(Ze)<8?Ae=(Ne=Ze*P(lt,ze))/(Ve=P(Y,ze)):(Ne=P(Me,ze=64/ze),Ve=P(qe,ze),Ae=k.sqrt(me/k.abs(Ze))*(k.cos(Je)*Ne-k.sin(Je)*Ve*8/k.abs(Ze)),Ze<0&&(Ae=-Ae)),Ae}return function Ze(Ae,Ne){if(Ne=Math.round(Ne),!isFinite(Ae))return isNaN(Ae)?Ae:0;if(Ne<0)return(Ne%2?-1:1)*Ze(Ae,-Ne);if(Ae<0)return(Ne%2?-1:1)*Ze(-Ae,Ne);if(Ne===0)return He(Ae);if(Ne===1)return pt(Ae);if(Ae===0)return 0;var Ve=0;if(Ae>Ne)Ve=b(Ae,Ne,He(Ae),pt(Ae),-1);else{for(var ze=!1,Je=0,et=0,it=1,dt=0,mt=2/Ae,gt=2*k.floor((Ne+k.floor(k.sqrt(40*Ne)))/2);gt>0;gt--)dt=gt*mt*it-Je,Je=it,it=dt,k.abs(it)>1e10&&(it*=1e-10,Je*=1e-10,Ve*=1e-10,et*=1e-10),ze&&(et+=it),ze=!ze,gt==Ne&&(Ve=Je);Ve/=et=2*et-it}return Ve}}(),se=(g=.636619772,m=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),p=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),T=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),I=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),_=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),O=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),M=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),o(function(me){var ie=0,Re=0,_e=0,Be=me*me,He=me-.785398164;return me<8?ie=(Re=P(m,Be))/(_e=P(p,Be))+g*he(me,0)*k.log(me):(Re=P(C,Be=64/Be),_e=P(T,Be),ie=k.sqrt(g/me)*(k.sin(He)*Re+k.cos(He)*_e*8/me)),ie},function(me){var ie=0,Re=0,_e=0,Be=me*me,He=me-2.356194491;return me<8?ie=(Re=me*P(I,Be))/(_e=P(_,Be))+g*(he(me,1)*k.log(me)-1/me):(Re=P(O,Be=64/Be),_e=P(M,Be),ie=k.sqrt(g/me)*(k.sin(He)*Re+k.cos(He)*_e*8/me)),ie},0,1,-1)),be=(D=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Z=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),q=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),ae=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function me(ie,Re){if((Re=Math.round(Re))===0)return function(qe){return qe<=3.75?P(D,qe*qe/14.0625):k.exp(k.abs(qe))/k.sqrt(k.abs(qe))*P(Z,3.75/k.abs(qe))}(ie);if(Re===1)return function(qe){return qe<3.75?qe*P(q,qe*qe/14.0625):(qe<0?-1:1)*k.exp(k.abs(qe))/k.sqrt(k.abs(qe))*P(ae,3.75/k.abs(qe))}(ie);if(Re<0)return NaN;if(k.abs(ie)===0)return 0;if(ie==1/0)return 1/0;var _e,Be=0,He=2/k.abs(ie),lt=0,Y=1,Me=0;for(_e=2*k.round((Re+k.round(k.sqrt(40*Re)))/2);_e>0;_e--)Me=_e*He*Y+lt,lt=Y,Y=Me,k.abs(Y)>1e10&&(Y*=1e-10,lt*=1e-10,Be*=1e-10),_e==Re&&(Be=lt);return Be*=me(ie,0)/Y,ie<0&&Re%2?-Be:Be}),Le=function(){var me=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ie=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Re=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),_e=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o(function(Be){return Be<=2?-k.log(Be/2)*be(Be,0)+P(me,Be*Be/4):k.exp(-Be)/k.sqrt(Be)*P(ie,2/Be)},function(Be){return Be<=2?k.log(Be/2)*be(Be,1)+1/Be*P(Re,Be*Be/4):k.exp(-Be)/k.sqrt(Be)*P(_e,2/Be)},0,2,1)}();f.besselj=he,f.bessely=se,f.besseli=be,f.besselk=Le},u(typeof DO_NOT_EXPORT_BESSEL>"u"?j:{})},162:function(W){var j;W.exports=(j=function(u,f){var k=Array.prototype.concat,P=Array.prototype.slice,b=Object.prototype.toString;function o(M,D){var Z=M>D?M:D;return u.pow(10,17-~~(u.log(Z>0?Z:-Z)*u.LOG10E))}var g=Array.isArray||function(M){return b.call(M)==="[object Array]"};function m(M){return b.call(M)==="[object Function]"}function p(M){return typeof M=="number"&&M-M==0}function C(){return new C._init(arguments)}function T(){return 0}function I(){return 1}function _(M,D){return M===D?1:0}C.fn=C.prototype,C._init=function(M){if(g(M[0]))if(g(M[0][0])){m(M[1])&&(M[0]=C.map(M[0],M[1]));for(var D=0;D<M[0].length;D++)this[D]=M[0][D];this.length=M[0].length}else this[0]=m(M[1])?C.map(M[0],M[1]):M[0],this.length=1;else if(p(M[0]))this[0]=C.seq.apply(null,M),this.length=1;else{if(M[0]instanceof C)return C(M[0].toArray());this[0]=[],this.length=1}return this},C._init.prototype=C.prototype,C._init.constructor=C,C.utils={calcRdx:o,isArray:g,isFunction:m,isNumber:p,toVector:function(M){return k.apply([],M)}},C._random_fn=u.random,C.setRandom=function(M){if(typeof M!="function")throw new TypeError("fn is not a function");C._random_fn=M},C.extend=function(M){var D,Z;if(arguments.length===1){for(Z in M)C[Z]=M[Z];return this}for(D=1;D<arguments.length;D++)for(Z in arguments[D])M[Z]=arguments[D][Z];return M},C.rows=function(M){return M.length||1},C.cols=function(M){return M[0].length||1},C.dimensions=function(M){return{rows:C.rows(M),cols:C.cols(M)}},C.row=function(M,D){return g(D)?D.map(function(Z){return C.row(M,Z)}):M[D]},C.rowa=function(M,D){return C.row(M,D)},C.col=function(M,D){if(g(D)){var Z=C.arange(M.length).map(function(){return new Array(D.length)});return D.forEach(function(he,se){C.arange(M.length).forEach(function(be){Z[be][se]=M[be][he]})}),Z}for(var q=new Array(M.length),ae=0;ae<M.length;ae++)q[ae]=[M[ae][D]];return q},C.cola=function(M,D){return C.col(M,D).map(function(Z){return Z[0]})},C.diag=function(M){for(var D=C.rows(M),Z=new Array(D),q=0;q<D;q++)Z[q]=[M[q][q]];return Z},C.antidiag=function(M){for(var D=C.rows(M)-1,Z=new Array(D),q=0;D>=0;D--,q++)Z[q]=[M[q][D]];return Z},C.transpose=function(M){var D,Z,q,ae,he,se=[];for(g(M[0])||(M=[M]),Z=M.length,q=M[0].length,he=0;he<q;he++){for(D=new Array(Z),ae=0;ae<Z;ae++)D[ae]=M[ae][he];se.push(D)}return se.length===1?se[0]:se},C.map=function(M,D,Z){var q,ae,he,se,be;for(g(M[0])||(M=[M]),ae=M.length,he=M[0].length,se=Z?M:new Array(ae),q=0;q<ae;q++)for(se[q]||(se[q]=new Array(he)),be=0;be<he;be++)se[q][be]=D(M[q][be],q,be);return se.length===1?se[0]:se},C.cumreduce=function(M,D,Z){var q,ae,he,se,be;for(g(M[0])||(M=[M]),ae=M.length,he=M[0].length,se=Z?M:new Array(ae),q=0;q<ae;q++)for(se[q]||(se[q]=new Array(he)),he>0&&(se[q][0]=M[q][0]),be=1;be<he;be++)se[q][be]=D(se[q][be-1],M[q][be]);return se.length===1?se[0]:se},C.alter=function(M,D){return C.map(M,D,!0)},C.create=function(M,D,Z){var q,ae,he=new Array(M);for(m(D)&&(Z=D,D=M),q=0;q<M;q++)for(he[q]=new Array(D),ae=0;ae<D;ae++)he[q][ae]=Z(q,ae);return he},C.zeros=function(M,D){return p(D)||(D=M),C.create(M,D,T)},C.ones=function(M,D){return p(D)||(D=M),C.create(M,D,I)},C.rand=function(M,D){return p(D)||(D=M),C.create(M,D,C._random_fn)},C.identity=function(M,D){return p(D)||(D=M),C.create(M,D,_)},C.symmetric=function(M){var D,Z,q=M.length;if(M.length!==M[0].length)return!1;for(D=0;D<q;D++)for(Z=0;Z<q;Z++)if(M[Z][D]!==M[D][Z])return!1;return!0},C.clear=function(M){return C.alter(M,T)},C.seq=function(M,D,Z,q){m(q)||(q=!1);var ae,he=[],se=o(M,D),be=(D*se-M*se)/((Z-1)*se),Le=M;for(ae=0;Le<=D&&ae<Z;Le=(M*se+be*se*++ae)/se)he.push(q?q(Le,ae):Le);return he},C.arange=function(M,D,Z){var q,ae=[];if(Z=Z||1,D===f&&(D=M,M=0),M===D||Z===0)return[];if(M<D&&Z<0)return[];if(M>D&&Z>0)return[];if(Z>0)for(q=M;q<D;q+=Z)ae.push(q);else for(q=M;q>D;q+=Z)ae.push(q);return ae},C.slice=function(){function M(D,Z,q,ae){var he,se=[],be=D.length;if(Z===f&&q===f&&ae===f)return C.copy(D);if(ae=ae||1,(Z=(Z=Z||0)>=0?Z:be+Z)===(q=(q=q||D.length)>=0?q:be+q)||ae===0)return[];if(Z<q&&ae<0)return[];if(Z>q&&ae>0)return[];if(ae>0)for(he=Z;he<q;he+=ae)se.push(D[he]);else for(he=Z;he>q;he+=ae)se.push(D[he]);return se}return function(D,Z){var q,ae;return p((Z=Z||{}).row)?p(Z.col)?D[Z.row][Z.col]:M(C.rowa(D,Z.row),(q=Z.col||{}).start,q.end,q.step):p(Z.col)?M(C.cola(D,Z.col),(ae=Z.row||{}).start,ae.end,ae.step):(ae=Z.row||{},q=Z.col||{},M(D,ae.start,ae.end,ae.step).map(function(he){return M(he,q.start,q.end,q.step)}))}}(),C.sliceAssign=function(M,D,Z){var q,ae;if(p(D.row)){if(p(D.col))return M[D.row][D.col]=Z;D.col=D.col||{},D.col.start=D.col.start||0,D.col.end=D.col.end||M[0].length,D.col.step=D.col.step||1,q=C.arange(D.col.start,u.min(M.length,D.col.end),D.col.step);var he=D.row;return q.forEach(function(be,Le){M[he][be]=Z[Le]}),M}if(p(D.col)){D.row=D.row||{},D.row.start=D.row.start||0,D.row.end=D.row.end||M.length,D.row.step=D.row.step||1,ae=C.arange(D.row.start,u.min(M[0].length,D.row.end),D.row.step);var se=D.col;return ae.forEach(function(be,Le){M[be][se]=Z[Le]}),M}return Z[0].length===f&&(Z=[Z]),D.row.start=D.row.start||0,D.row.end=D.row.end||M.length,D.row.step=D.row.step||1,D.col.start=D.col.start||0,D.col.end=D.col.end||M[0].length,D.col.step=D.col.step||1,ae=C.arange(D.row.start,u.min(M.length,D.row.end),D.row.step),q=C.arange(D.col.start,u.min(M[0].length,D.col.end),D.col.step),ae.forEach(function(be,Le){q.forEach(function(me,ie){M[be][me]=Z[Le][ie]})}),M},C.diagonal=function(M){var D=C.zeros(M.length,M.length);return M.forEach(function(Z,q){D[q][q]=Z}),D},C.copy=function(M){return M.map(function(D){return p(D)?D:D.map(function(Z){return Z})})};var O=C.prototype;return O.length=0,O.push=Array.prototype.push,O.sort=Array.prototype.sort,O.splice=Array.prototype.splice,O.slice=Array.prototype.slice,O.toArray=function(){return this.length>1?P.call(this):P.call(this)[0]},O.map=function(M,D){return C(C.map(this,M,D))},O.cumreduce=function(M,D){return C(C.cumreduce(this,M,D))},O.alter=function(M){return C.alter(this,M),this},function(M){for(var D=0;D<M.length;D++)(function(Z){O[Z]=function(q){var ae,he=this;return q?(setTimeout(function(){q.call(he,O[Z].call(he))}),this):(ae=C[Z](this),g(ae)?C(ae):ae)}})(M[D])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(M){for(var D=0;D<M.length;D++)(function(Z){O[Z]=function(q,ae){var he=this;return ae?(setTimeout(function(){ae.call(he,O[Z].call(he,q))}),this):C(C[Z](this,q))}})(M[D])}("row col".split(" ")),function(M){for(var D=0;D<M.length;D++)(function(Z){O[Z]=function(){return C(C[Z].apply(null,arguments))}})(M[D])}("create zeros ones rand identity".split(" ")),C}(Math),function(u,f){var k=u.utils.isFunction;function P(g,m){return g-m}function b(g,m,p){return f.max(m,f.min(g,p))}u.sum=function(g){for(var m=0,p=g.length;--p>=0;)m+=g[p];return m},u.sumsqrd=function(g){for(var m=0,p=g.length;--p>=0;)m+=g[p]*g[p];return m},u.sumsqerr=function(g){for(var m,p=u.mean(g),C=0,T=g.length;--T>=0;)C+=(m=g[T]-p)*m;return C},u.sumrow=function(g){for(var m=0,p=g.length;--p>=0;)m+=g[p];return m},u.product=function(g){for(var m=1,p=g.length;--p>=0;)m*=g[p];return m},u.min=function(g){for(var m=g[0],p=0;++p<g.length;)g[p]<m&&(m=g[p]);return m},u.max=function(g){for(var m=g[0],p=0;++p<g.length;)g[p]>m&&(m=g[p]);return m},u.unique=function(g){for(var m={},p=[],C=0;C<g.length;C++)m[g[C]]||(m[g[C]]=!0,p.push(g[C]));return p},u.mean=function(g){return u.sum(g)/g.length},u.meansqerr=function(g){return u.sumsqerr(g)/g.length},u.geomean=function(g){var m=g.map(f.log),p=u.mean(m);return f.exp(p)},u.median=function(g){var m=g.length,p=g.slice().sort(P);return 1&m?p[m/2|0]:(p[m/2-1]+p[m/2])/2},u.cumsum=function(g){return u.cumreduce(g,function(m,p){return m+p})},u.cumprod=function(g){return u.cumreduce(g,function(m,p){return m*p})},u.diff=function(g){var m,p=[],C=g.length;for(m=1;m<C;m++)p.push(g[m]-g[m-1]);return p},u.rank=function(g){var m,p=[],C={};for(m=0;m<g.length;m++)C[O=g[m]]?C[O]++:(C[O]=1,p.push(O));var T=p.sort(P),I={},_=1;for(m=0;m<T.length;m++){var O,M=C[O=T[m]],D=(_+(_+M-1))/2;I[O]=D,_+=M}return g.map(function(Z){return I[Z]})},u.mode=function(g){var m,p=g.length,C=g.slice().sort(P),T=1,I=0,_=0,O=[];for(m=0;m<p;m++)C[m]===C[m+1]?T++:(T>I?(O=[C[m]],I=T,_=0):T===I&&(O.push(C[m]),_++),T=1);return _===0?O[0]:O},u.range=function(g){return u.max(g)-u.min(g)},u.variance=function(g,m){return u.sumsqerr(g)/(g.length-(m?1:0))},u.pooledvariance=function(g){return g.reduce(function(m,p){return m+u.sumsqerr(p)},0)/(g.reduce(function(m,p){return m+p.length},0)-g.length)},u.deviation=function(g){for(var m=u.mean(g),p=g.length,C=new Array(p),T=0;T<p;T++)C[T]=g[T]-m;return C},u.stdev=function(g,m){return f.sqrt(u.variance(g,m))},u.pooledstdev=function(g){return f.sqrt(u.pooledvariance(g))},u.meandev=function(g){for(var m=u.mean(g),p=[],C=g.length-1;C>=0;C--)p.push(f.abs(g[C]-m));return u.mean(p)},u.meddev=function(g){for(var m=u.median(g),p=[],C=g.length-1;C>=0;C--)p.push(f.abs(g[C]-m));return u.median(p)},u.coeffvar=function(g){return u.stdev(g)/u.mean(g)},u.quartiles=function(g){var m=g.length,p=g.slice().sort(P);return[p[f.round(m/4)-1],p[f.round(m/2)-1],p[f.round(3*m/4)-1]]},u.quantiles=function(g,m,p,C){var T,I,_,O,M,D=g.slice().sort(P),Z=[m.length],q=g.length;for(p===void 0&&(p=.375),C===void 0&&(C=.375),T=0;T<m.length;T++)_=q*(I=m[T])+(p+I*(1-p-C)),O=f.floor(b(_,1,q-1)),M=b(_-O,0,1),Z[T]=(1-M)*D[O-1]+M*D[O];return Z},u.percentile=function(g,m,p){var C=g.slice().sort(P),T=m*(C.length+(p?1:-1))+(p?0:1),I=parseInt(T),_=T-I;return I+1<C.length?C[I-1]+_*(C[I]-C[I-1]):C[I-1]},u.percentileOfScore=function(g,m,p){var C,T,I=0,_=g.length,O=!1;for(p==="strict"&&(O=!0),T=0;T<_;T++)C=g[T],(O&&C<m||!O&&C<=m)&&I++;return I/_},u.histogram=function(g,m){m=m||4;var p,C=u.min(g),T=(u.max(g)-C)/m,I=g.length,_=[];for(p=0;p<m;p++)_[p]=0;for(p=0;p<I;p++)_[f.min(f.floor((g[p]-C)/T),m-1)]+=1;return _},u.covariance=function(g,m){var p,C=u.mean(g),T=u.mean(m),I=g.length,_=new Array(I);for(p=0;p<I;p++)_[p]=(g[p]-C)*(m[p]-T);return u.sum(_)/(I-1)},u.corrcoeff=function(g,m){return u.covariance(g,m)/u.stdev(g,1)/u.stdev(m,1)},u.spearmancoeff=function(g,m){return g=u.rank(g),m=u.rank(m),u.corrcoeff(g,m)},u.stanMoment=function(g,m){for(var p=u.mean(g),C=u.stdev(g),T=g.length,I=0,_=0;_<T;_++)I+=f.pow((g[_]-p)/C,m);return I/g.length},u.skewness=function(g){return u.stanMoment(g,3)},u.kurtosis=function(g){return u.stanMoment(g,4)-3};var o=u.prototype;(function(g){for(var m=0;m<g.length;m++)(function(p){o[p]=function(C,T){var I=[],_=0,O=this;if(k(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(O,o[p].call(O,C))}),this;if(this.length>1){for(O=C===!0?this:this.transpose();_<O.length;_++)I[_]=u[p](O[_]);return I}return u[p](this[0],C)}})(g[m])})("cumsum cumprod".split(" ")),function(g){for(var m=0;m<g.length;m++)(function(p){o[p]=function(C,T){var I=[],_=0,O=this;if(k(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(O,o[p].call(O,C))}),this;if(this.length>1){for(p!=="sumrow"&&(O=C===!0?this:this.transpose());_<O.length;_++)I[_]=u[p](O[_]);return C===!0?u[p](u.utils.toVector(I)):I}return u[p](this[0],C)}})(g[m])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(g){for(var m=0;m<g.length;m++)(function(p){o[p]=function(){var C,T=[],I=0,_=this,O=Array.prototype.slice.call(arguments);if(k(O[O.length-1])){C=O[O.length-1];var M=O.slice(0,O.length-1);return setTimeout(function(){C.call(_,o[p].apply(_,M))}),this}C=void 0;var D=function(Z){return u[p].apply(_,[Z].concat(O))};if(this.length>1){for(_=_.transpose();I<_.length;I++)T[I]=D(_[I]);return T}return D(this[0])}})(g[m])}("quantiles percentileOfScore".split(" "))}(j,Math),function(u,f){u.gammaln=function(k){var P,b,o,g=0,m=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],p=1.000000000190015;for(o=(b=P=k)+5.5,o-=(P+.5)*f.log(o);g<6;g++)p+=m[g]/++b;return f.log(2.5066282746310007*p/P)-o},u.loggam=function(k){var P,b,o,g,m,p,C,T=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(P=k,C=0,k==1||k==2)return 0;for(k<=7&&(P=k+(C=f.floor(7-k))),b=1/(P*P),o=2*f.PI,m=T[9],p=8;p>=0;p--)m*=b,m+=T[p];if(g=m/P+.5*f.log(o)+(P-.5)*f.log(P)-P,k<=7)for(p=1;p<=C;p++)g-=f.log(P-1),P-=1;return g},u.gammafn=function(k){var P,b,o,g,m=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],p=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],C=!1,T=0,I=0,_=0,O=k;if(k>171.6243769536076)return 1/0;if(O<=0){if(!(g=O%1+36e-17))return 1/0;C=(1&O?-1:1)*f.PI/f.sin(f.PI*g),O=1-O}for(o=O,b=O<1?O++:(O-=T=(0|O)-1)-1,P=0;P<8;++P)_=(_+m[P])*b,I=I*b+p[P];if(g=_/I+1,o<O)g/=o;else if(o>O)for(P=0;P<T;++P)g*=O,O++;return C&&(g=C/g),g},u.gammap=function(k,P){return u.lowRegGamma(k,P)*u.gammafn(k)},u.lowRegGamma=function(k,P){var b,o=u.gammaln(k),g=k,m=1/k,p=m,C=P+1-k,T=1/1e-30,I=1/C,_=I,O=1,M=-~(8.5*f.log(k>=1?k:1/k)+.4*k+17);if(P<0||k<=0)return NaN;if(P<k+1){for(;O<=M;O++)m+=p*=P/++g;return m*f.exp(-P+k*f.log(P)-o)}for(;O<=M;O++)_*=(I=1/(I=(b=-O*(O-k))*I+(C+=2)))*(T=C+b/T);return 1-_*f.exp(-P+k*f.log(P)-o)},u.factorialln=function(k){return k<0?NaN:u.gammaln(k+1)},u.factorial=function(k){return k<0?NaN:u.gammafn(k+1)},u.combination=function(k,P){return k>170||P>170?f.exp(u.combinationln(k,P)):u.factorial(k)/u.factorial(P)/u.factorial(k-P)},u.combinationln=function(k,P){return u.factorialln(k)-u.factorialln(P)-u.factorialln(k-P)},u.permutation=function(k,P){return u.factorial(k)/u.factorial(k-P)},u.betafn=function(k,P){if(!(k<=0||P<=0))return k+P>170?f.exp(u.betaln(k,P)):u.gammafn(k)*u.gammafn(P)/u.gammafn(k+P)},u.betaln=function(k,P){return u.gammaln(k)+u.gammaln(P)-u.gammaln(k+P)},u.betacf=function(k,P,b){var o,g,m,p,C=1e-30,T=1,I=P+b,_=P+1,O=P-1,M=1,D=1-I*k/_;for(f.abs(D)<C&&(D=C),p=D=1/D;T<=100&&(D=1+(g=T*(b-T)*k/((O+(o=2*T))*(P+o)))*D,f.abs(D)<C&&(D=C),M=1+g/M,f.abs(M)<C&&(M=C),p*=(D=1/D)*M,D=1+(g=-(P+T)*(I+T)*k/((P+o)*(_+o)))*D,f.abs(D)<C&&(D=C),M=1+g/M,f.abs(M)<C&&(M=C),p*=m=(D=1/D)*M,!(f.abs(m-1)<3e-7));T++);return p},u.gammapinv=function(k,P){var b,o,g,m,p,C,T=0,I=P-1,_=u.gammaln(P);if(k>=1)return f.max(100,P+100*f.sqrt(P));if(k<=0)return 0;for(P>1?(p=f.log(I),C=f.exp(I*(p-1)-_),m=k<.5?k:1-k,b=(2.30753+.27061*(o=f.sqrt(-2*f.log(m))))/(1+o*(.99229+.04481*o))-o,k<.5&&(b=-b),b=f.max(.001,P*f.pow(1-1/(9*P)-b/(3*f.sqrt(P)),3))):b=k<(o=1-P*(.253+.12*P))?f.pow(k/o,1/P):1-f.log(1-(k-o)/(1-o));T<12;T++){if(b<=0)return 0;if((b-=o=(g=(u.lowRegGamma(P,b)-k)/(o=P>1?C*f.exp(-(b-I)+I*(f.log(b)-p)):f.exp(-b+I*f.log(b)-_)))/(1-.5*f.min(1,g*((P-1)/b-1))))<=0&&(b=.5*(b+o)),f.abs(o)<1e-8*b)break}return b},u.erf=function(k){var P,b,o,g,m=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],p=m.length-1,C=!1,T=0,I=0;for(k<0&&(k=-k,C=!0),b=4*(P=2/(2+k))-2;p>0;p--)o=T,T=b*T-I+m[p],I=o;return g=P*f.exp(-k*k+.5*(m[0]+b*T)-I),C?g-1:1-g},u.erfc=function(k){return 1-u.erf(k)},u.erfcinv=function(k){var P,b,o,g,m=0;if(k>=2)return-100;if(k<=0)return 100;for(g=k<1?k:2-k,P=-.70711*((2.30753+.27061*(o=f.sqrt(-2*f.log(g/2))))/(1+o*(.99229+.04481*o))-o);m<2;m++)P+=(b=u.erfc(P)-g)/(1.1283791670955126*f.exp(-P*P)-P*b);return k<1?P:-P},u.ibetainv=function(k,P,b){var o,g,m,p,C,T,I,_,O,M,D=P-1,Z=b-1,q=0;if(k<=0)return 0;if(k>=1)return 1;for(P>=1&&b>=1?(m=k<.5?k:1-k,T=(2.30753+.27061*(p=f.sqrt(-2*f.log(m))))/(1+p*(.99229+.04481*p))-p,k<.5&&(T=-T),I=(T*T-3)/6,_=2/(1/(2*P-1)+1/(2*b-1)),O=T*f.sqrt(I+_)/_-(1/(2*b-1)-1/(2*P-1))*(I+.8333333333333334-2/(3*_)),T=P/(P+b*f.exp(2*O))):(o=f.log(P/(P+b)),g=f.log(b/(P+b)),T=k<(p=f.exp(P*o)/P)/(O=p+(C=f.exp(b*g)/b))?f.pow(P*O*k,1/P):1-f.pow(b*O*(1-k),1/b)),M=-u.gammaln(P)-u.gammaln(b)+u.gammaln(P+b);q<10;q++){if(T===0||T===1)return T;if((T-=p=(C=(u.ibeta(T,P,b)-k)/(p=f.exp(D*f.log(T)+Z*f.log(1-T)+M)))/(1-.5*f.min(1,C*(D/T-Z/(1-T)))))<=0&&(T=.5*(T+p)),T>=1&&(T=.5*(T+p+1)),f.abs(p)<1e-8*T&&q>0)break}return T},u.ibeta=function(k,P,b){var o=k===0||k===1?0:f.exp(u.gammaln(P+b)-u.gammaln(P)-u.gammaln(b)+P*f.log(k)+b*f.log(1-k));return!(k<0||k>1)&&(k<(P+1)/(P+b+2)?o*u.betacf(k,P,b)/P:1-o*u.betacf(1-k,b,P)/b)},u.randn=function(k,P){var b,o,g,m,p;if(P||(P=k),k)return u.create(k,P,function(){return u.randn()});do b=u._random_fn(),o=1.7156*(u._random_fn()-.5),p=(g=b-.449871)*g+(m=f.abs(o)+.386595)*(.196*m-.25472*g);while(p>.27597&&(p>.27846||o*o>-4*f.log(b)*b*b));return o/b},u.randg=function(k,P,b){var o,g,m,p,C,T,I=k;if(b||(b=P),k||(k=1),P)return(T=u.zeros(P,b)).alter(function(){return u.randg(k)}),T;k<1&&(k+=1),o=k-.3333333333333333,g=1/f.sqrt(9*o);do{do p=1+g*(C=u.randn());while(p<=0);p*=p*p,m=u._random_fn()}while(m>1-.331*f.pow(C,4)&&f.log(m)>.5*C*C+o*(1-p+f.log(p)));if(k==I)return o*p;do m=u._random_fn();while(m===0);return f.pow(m,1/I)*o*p},function(k){for(var P=0;P<k.length;P++)(function(b){u.fn[b]=function(){return u(u.map(this,function(o){return u[b](o)}))}})(k[P])}("gammaln gammafn factorial factorialln".split(" ")),function(k){for(var P=0;P<k.length;P++)(function(b){u.fn[b]=function(){return u(u[b].apply(null,arguments))}})(k[P])}("randn".split(" "))}(j,Math),function(u,f){function k(b,o,g,m){for(var p,C=0,T=1,I=1,_=1,O=0,M=0;f.abs((I-M)/I)>m;)M=I,T=_+(p=-(o+O)*(o+g+O)*b/(o+2*O)/(o+2*O+1))*T,I=(C=I+p*C)+(p=(O+=1)*(g-O)*b/(o+2*O-1)/(o+2*O))*I,C/=_=T+p*_,T/=_,I/=_,_=1;return I/o}function P(b,o,g){var m=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],p=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],C=.5*b;if(C>=8)return 1;var T,I=2*u.normal.cdf(C,0,1,1,0)-1;I=I>=f.exp(-50/g)?f.pow(I,g):0;for(var _=C,O=(8-C)/(T=b>3?2:3),M=_+O,D=0,Z=g-1,q=1;q<=T;q++){for(var ae=0,he=.5*(M+_),se=.5*(M-_),be=1;be<=12;be++){var Le,me=he+se*(6<be?m[(Le=12-be+1)-1]:-m[(Le=be)-1]),ie=me*me;if(ie>60)break;var Re=2*u.normal.cdf(me,0,1,1,0)*.5-2*u.normal.cdf(me,b,1,1,0)*.5;Re>=f.exp(-30/Z)&&(ae+=Re=p[Le-1]*f.exp(-.5*ie)*f.pow(Re,Z))}D+=ae*=2*se*g/f.sqrt(2*f.PI),_=M,M+=O}return(I+=D)<=f.exp(-30/o)?0:(I=f.pow(I,o))>=1?1:I}(function(b){for(var o=0;o<b.length;o++)(function(g){u[g]=function m(p,C,T){return this instanceof m?(this._a=p,this._b=C,this._c=T,this):new m(p,C,T)},u.fn[g]=function(m,p,C){var T=u[g](m,p,C);return T.data=this,T},u[g].prototype.sample=function(m){var p=this._a,C=this._b,T=this._c;return m?u.alter(m,function(){return u[g].sample(p,C,T)}):u[g].sample(p,C,T)},function(m){for(var p=0;p<m.length;p++)(function(C){u[g].prototype[C]=function(T){var I=this._a,_=this._b,O=this._c;return T||T===0||(T=this.data),typeof T!="number"?u.fn.map.call(T,function(M){return u[g][C](M,I,_,O)}):u[g][C](T,I,_,O)}})(m[p])}("pdf cdf inv".split(" ")),function(m){for(var p=0;p<m.length;p++)(function(C){u[g].prototype[C]=function(){return u[g][C](this._a,this._b,this._c)}})(m[p])}("mean median mode variance".split(" "))})(b[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),u.extend(u.beta,{pdf:function(b,o,g){return b>1||b<0?0:o==1&&g==1?1:o<512&&g<512?f.pow(b,o-1)*f.pow(1-b,g-1)/u.betafn(o,g):f.exp((o-1)*f.log(b)+(g-1)*f.log(1-b)-u.betaln(o,g))},cdf:function(b,o,g){return b>1||b<0?1*(b>1):u.ibeta(b,o,g)},inv:function(b,o,g){return u.ibetainv(b,o,g)},mean:function(b,o){return b/(b+o)},median:function(b,o){return u.ibetainv(.5,b,o)},mode:function(b,o){return(b-1)/(b+o-2)},sample:function(b,o){var g=u.randg(b);return g/(g+u.randg(o))},variance:function(b,o){return b*o/(f.pow(b+o,2)*(b+o+1))}}),u.extend(u.centralF,{pdf:function(b,o,g){var m;return b<0?0:o<=2?b===0&&o<2?1/0:b===0&&o===2?1:1/u.betafn(o/2,g/2)*f.pow(o/g,o/2)*f.pow(b,o/2-1)*f.pow(1+o/g*b,-(o+g)/2):(m=o*b/(g+b*o),o*(g/(g+b*o))/2*u.binomial.pdf((o-2)/2,(o+g-2)/2,m))},cdf:function(b,o,g){return b<0?0:u.ibeta(o*b/(o*b+g),o/2,g/2)},inv:function(b,o,g){return g/(o*(1/u.ibetainv(b,o/2,g/2)-1))},mean:function(b,o){return o>2?o/(o-2):void 0},mode:function(b,o){return b>2?o*(b-2)/(b*(o+2)):void 0},sample:function(b,o){return 2*u.randg(b/2)/b/(2*u.randg(o/2)/o)},variance:function(b,o){if(!(o<=4))return 2*o*o*(b+o-2)/(b*(o-2)*(o-2)*(o-4))}}),u.extend(u.cauchy,{pdf:function(b,o,g){return g<0?0:g/(f.pow(b-o,2)+f.pow(g,2))/f.PI},cdf:function(b,o,g){return f.atan((b-o)/g)/f.PI+.5},inv:function(b,o,g){return o+g*f.tan(f.PI*(b-.5))},median:function(b){return b},mode:function(b){return b},sample:function(b,o){return u.randn()*f.sqrt(1/(2*u.randg(.5)))*o+b}}),u.extend(u.chisquare,{pdf:function(b,o){return b<0?0:b===0&&o===2?.5:f.exp((o/2-1)*f.log(b)-b/2-o/2*f.log(2)-u.gammaln(o/2))},cdf:function(b,o){return b<0?0:u.lowRegGamma(o/2,b/2)},inv:function(b,o){return 2*u.gammapinv(b,.5*o)},mean:function(b){return b},median:function(b){return b*f.pow(1-2/(9*b),3)},mode:function(b){return b-2>0?b-2:0},sample:function(b){return 2*u.randg(b/2)},variance:function(b){return 2*b}}),u.extend(u.exponential,{pdf:function(b,o){return b<0?0:o*f.exp(-o*b)},cdf:function(b,o){return b<0?0:1-f.exp(-o*b)},inv:function(b,o){return-f.log(1-b)/o},mean:function(b){return 1/b},median:function(b){return 1/b*f.log(2)},mode:function(){return 0},sample:function(b){return-1/b*f.log(u._random_fn())},variance:function(b){return f.pow(b,-2)}}),u.extend(u.gamma,{pdf:function(b,o,g){return b<0?0:b===0&&o===1?1/g:f.exp((o-1)*f.log(b)-b/g-u.gammaln(o)-o*f.log(g))},cdf:function(b,o,g){return b<0?0:u.lowRegGamma(o,b/g)},inv:function(b,o,g){return u.gammapinv(b,o)*g},mean:function(b,o){return b*o},mode:function(b,o){if(b>1)return(b-1)*o},sample:function(b,o){return u.randg(b)*o},variance:function(b,o){return b*o*o}}),u.extend(u.invgamma,{pdf:function(b,o,g){return b<=0?0:f.exp(-(o+1)*f.log(b)-g/b-u.gammaln(o)+o*f.log(g))},cdf:function(b,o,g){return b<=0?0:1-u.lowRegGamma(o,g/b)},inv:function(b,o,g){return g/u.gammapinv(1-b,o)},mean:function(b,o){return b>1?o/(b-1):void 0},mode:function(b,o){return o/(b+1)},sample:function(b,o){return o/u.randg(b)},variance:function(b,o){if(!(b<=2))return o*o/((b-1)*(b-1)*(b-2))}}),u.extend(u.kumaraswamy,{pdf:function(b,o,g){return b===0&&o===1?g:b===1&&g===1?o:f.exp(f.log(o)+f.log(g)+(o-1)*f.log(b)+(g-1)*f.log(1-f.pow(b,o)))},cdf:function(b,o,g){return b<0?0:b>1?1:1-f.pow(1-f.pow(b,o),g)},inv:function(b,o,g){return f.pow(1-f.pow(1-b,1/g),1/o)},mean:function(b,o){return o*u.gammafn(1+1/b)*u.gammafn(o)/u.gammafn(1+1/b+o)},median:function(b,o){return f.pow(1-f.pow(2,-1/o),1/b)},mode:function(b,o){if(b>=1&&o>=1&&b!==1&&o!==1)return f.pow((b-1)/(b*o-1),1/b)},variance:function(){throw new Error("variance not yet implemented")}}),u.extend(u.lognormal,{pdf:function(b,o,g){return b<=0?0:f.exp(-f.log(b)-.5*f.log(2*f.PI)-f.log(g)-f.pow(f.log(b)-o,2)/(2*g*g))},cdf:function(b,o,g){return b<0?0:.5+.5*u.erf((f.log(b)-o)/f.sqrt(2*g*g))},inv:function(b,o,g){return f.exp(-1.4142135623730951*g*u.erfcinv(2*b)+o)},mean:function(b,o){return f.exp(b+o*o/2)},median:function(b){return f.exp(b)},mode:function(b,o){return f.exp(b-o*o)},sample:function(b,o){return f.exp(u.randn()*o+b)},variance:function(b,o){return(f.exp(o*o)-1)*f.exp(2*b+o*o)}}),u.extend(u.noncentralt,{pdf:function(b,o,g){return f.abs(g)<1e-14?u.studentt.pdf(b,o):f.abs(b)<1e-14?f.exp(u.gammaln((o+1)/2)-g*g/2-.5*f.log(f.PI*o)-u.gammaln(o/2)):o/b*(u.noncentralt.cdf(b*f.sqrt(1+2/o),o+2,g)-u.noncentralt.cdf(b,o,g))},cdf:function(b,o,g){var m=1e-14;if(f.abs(g)<m)return u.studentt.cdf(b,o);var p=!1;b<0&&(p=!0,g=-g);for(var C=u.normal.cdf(-g,0,1),T=m+1,I=T,_=b*b/(b*b+o),O=0,M=f.exp(-g*g/2),D=f.exp(-g*g/2-.5*f.log(2)-u.gammaln(1.5))*g;O<200||I>m||T>m;)I=T,O>0&&(M*=g*g/(2*O),D*=g*g/(2*(O+.5))),C+=.5*(T=M*u.beta.cdf(_,O+.5,o/2)+D*u.beta.cdf(_,O+1,o/2)),O++;return p?1-C:C}}),u.extend(u.normal,{pdf:function(b,o,g){return f.exp(-.5*f.log(2*f.PI)-f.log(g)-f.pow(b-o,2)/(2*g*g))},cdf:function(b,o,g){return .5*(1+u.erf((b-o)/f.sqrt(2*g*g)))},inv:function(b,o,g){return-1.4142135623730951*g*u.erfcinv(2*b)+o},mean:function(b){return b},median:function(b){return b},mode:function(b){return b},sample:function(b,o){return u.randn()*o+b},variance:function(b,o){return o*o}}),u.extend(u.pareto,{pdf:function(b,o,g){return b<o?0:g*f.pow(o,g)/f.pow(b,g+1)},cdf:function(b,o,g){return b<o?0:1-f.pow(o/b,g)},inv:function(b,o,g){return o/f.pow(1-b,1/g)},mean:function(b,o){if(!(o<=1))return o*f.pow(b,o)/(o-1)},median:function(b,o){return b*(o*f.SQRT2)},mode:function(b){return b},variance:function(b,o){if(!(o<=2))return b*b*o/(f.pow(o-1,2)*(o-2))}}),u.extend(u.studentt,{pdf:function(b,o){return o=o>1e100?1e100:o,1/(f.sqrt(o)*u.betafn(.5,o/2))*f.pow(1+b*b/o,-(o+1)/2)},cdf:function(b,o){var g=o/2;return u.ibeta((b+f.sqrt(b*b+o))/(2*f.sqrt(b*b+o)),g,g)},inv:function(b,o){var g=u.ibetainv(2*f.min(b,1-b),.5*o,.5);return g=f.sqrt(o*(1-g)/g),b>.5?g:-g},mean:function(b){return b>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(b){return u.randn()*f.sqrt(b/(2*u.randg(b/2)))},variance:function(b){return b>2?b/(b-2):b>1?1/0:void 0}}),u.extend(u.weibull,{pdf:function(b,o,g){return b<0||o<0||g<0?0:g/o*f.pow(b/o,g-1)*f.exp(-f.pow(b/o,g))},cdf:function(b,o,g){return b<0?0:1-f.exp(-f.pow(b/o,g))},inv:function(b,o,g){return o*f.pow(-f.log(1-b),1/g)},mean:function(b,o){return b*u.gammafn(1+1/o)},median:function(b,o){return b*f.pow(f.log(2),1/o)},mode:function(b,o){return o<=1?0:b*f.pow((o-1)/o,1/o)},sample:function(b,o){return b*f.pow(-f.log(u._random_fn()),1/o)},variance:function(b,o){return b*b*u.gammafn(1+2/o)-f.pow(u.weibull.mean(b,o),2)}}),u.extend(u.uniform,{pdf:function(b,o,g){return b<o||b>g?0:1/(g-o)},cdf:function(b,o,g){return b<o?0:b<g?(b-o)/(g-o):1},inv:function(b,o,g){return o+b*(g-o)},mean:function(b,o){return .5*(b+o)},median:function(b,o){return u.mean(b,o)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(b,o){return b/2+o/2+(o/2-b/2)*(2*u._random_fn()-1)},variance:function(b,o){return f.pow(o-b,2)/12}}),u.extend(u.binomial,{pdf:function(b,o,g){return g===0||g===1?o*g===b?1:0:u.combination(o,b)*f.pow(g,b)*f.pow(1-g,o-b)},cdf:function(b,o,g){var m,p=1e-10;if(b<0)return 0;if(b>=o)return 1;if(g<0||g>1||o<=0)return NaN;var C=g,T=(b=f.floor(b))+1,I=o-b,_=T+I,O=f.exp(u.gammaln(_)-u.gammaln(I)-u.gammaln(T)+T*f.log(C)+I*f.log(1-C));return m=C<(T+1)/(_+2)?O*k(C,T,I,p):1-O*k(1-C,I,T,p),f.round(1/p*(1-m))/(1/p)}}),u.extend(u.negbin,{pdf:function(b,o,g){return b===b>>>0&&(b<0?0:u.combination(b+o-1,o-1)*f.pow(1-g,b)*f.pow(g,o))},cdf:function(b,o,g){var m=0,p=0;if(b<0)return 0;for(;p<=b;p++)m+=u.negbin.pdf(p,o,g);return m}}),u.extend(u.hypgeom,{pdf:function(b,o,g,m){if(b!=b|0)return!1;if(b<0||b<g-(o-m)||b>m||b>g)return 0;if(2*g>o)return 2*m>o?u.hypgeom.pdf(o-g-m+b,o,o-g,o-m):u.hypgeom.pdf(m-b,o,o-g,m);if(2*m>o)return u.hypgeom.pdf(g-b,o,g,o-m);if(g<m)return u.hypgeom.pdf(b,o,m,g);for(var p=1,C=0,T=0;T<b;T++){for(;p>1&&C<m;)p*=1-g/(o-C),C++;p*=(m-T)*(g-T)/((T+1)*(o-g-m+T+1))}for(;C<m;C++)p*=1-g/(o-C);return f.min(1,f.max(0,p))},cdf:function(b,o,g,m){if(b<0||b<g-(o-m))return 0;if(b>=m||b>=g)return 1;if(2*g>o)return 2*m>o?u.hypgeom.cdf(o-g-m+b,o,o-g,o-m):1-u.hypgeom.cdf(m-b-1,o,o-g,m);if(2*m>o)return 1-u.hypgeom.cdf(g-b-1,o,g,o-m);if(g<m)return u.hypgeom.cdf(b,o,m,g);for(var p=1,C=1,T=0,I=0;I<b;I++){for(;p>1&&T<m;){var _=1-g/(o-T);C*=_,p*=_,T++}p+=C*=(m-I)*(g-I)/((I+1)*(o-g-m+I+1))}for(;T<m;T++)p*=1-g/(o-T);return f.min(1,f.max(0,p))}}),u.extend(u.poisson,{pdf:function(b,o){return o<0||b%1!=0||b<0?0:f.pow(o,b)*f.exp(-o)/u.factorial(b)},cdf:function(b,o){var g=[],m=0;if(b<0)return 0;for(;m<=b;m++)g.push(u.poisson.pdf(m,o));return u.sum(g)},mean:function(b){return b},variance:function(b){return b},sampleSmall:function(b){var o=1,g=0,m=f.exp(-b);do g++,o*=u._random_fn();while(o>m);return g-1},sampleLarge:function(b){var o,g,m,p,C,T,I,_,O,M,D=b;for(p=f.sqrt(D),C=f.log(D),T=.02483*(I=.931+2.53*p)-.059,_=1.1239+1.1328/(I-3.4),O=.9277-3.6224/(I-2);;)if(g=f.random()-.5,m=f.random(),M=.5-f.abs(g),o=f.floor((2*T/M+I)*g+D+.43),M>=.07&&m<=O||!(o<0||M<.013&&m>M)&&f.log(m)+f.log(_)-f.log(T/(M*M)+I)<=o*C-D-u.loggam(o+1))return o},sample:function(b){return b<10?this.sampleSmall(b):this.sampleLarge(b)}}),u.extend(u.triangular,{pdf:function(b,o,g,m){return g<=o||m<o||m>g?NaN:b<o||b>g?0:b<m?2*(b-o)/((g-o)*(m-o)):b===m?2/(g-o):2*(g-b)/((g-o)*(g-m))},cdf:function(b,o,g,m){return g<=o||m<o||m>g?NaN:b<=o?0:b>=g?1:b<=m?f.pow(b-o,2)/((g-o)*(m-o)):1-f.pow(g-b,2)/((g-o)*(g-m))},inv:function(b,o,g,m){return g<=o||m<o||m>g?NaN:b<=(m-o)/(g-o)?o+(g-o)*f.sqrt(b*((m-o)/(g-o))):o+(g-o)*(1-f.sqrt((1-b)*(1-(m-o)/(g-o))))},mean:function(b,o,g){return(b+o+g)/3},median:function(b,o,g){return g<=(b+o)/2?o-f.sqrt((o-b)*(o-g))/f.sqrt(2):g>(b+o)/2?b+f.sqrt((o-b)*(g-b))/f.sqrt(2):void 0},mode:function(b,o,g){return g},sample:function(b,o,g){var m=u._random_fn();return m<(g-b)/(o-b)?b+f.sqrt(m*(o-b)*(g-b)):o-f.sqrt((1-m)*(o-b)*(o-g))},variance:function(b,o,g){return(b*b+o*o+g*g-b*o-b*g-o*g)/18}}),u.extend(u.arcsine,{pdf:function(b,o,g){return g<=o?NaN:b<=o||b>=g?0:2/f.PI*f.pow(f.pow(g-o,2)-f.pow(2*b-o-g,2),-.5)},cdf:function(b,o,g){return b<o?0:b<g?2/f.PI*f.asin(f.sqrt((b-o)/(g-o))):1},inv:function(b,o,g){return o+(.5-.5*f.cos(f.PI*b))*(g-o)},mean:function(b,o){return o<=b?NaN:(b+o)/2},median:function(b,o){return o<=b?NaN:(b+o)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(b,o){return(b+o)/2+(o-b)/2*f.sin(2*f.PI*u.uniform.sample(0,1))},variance:function(b,o){return o<=b?NaN:f.pow(o-b,2)/8}}),u.extend(u.laplace,{pdf:function(b,o,g){return g<=0?0:f.exp(-f.abs(b-o)/g)/(2*g)},cdf:function(b,o,g){return g<=0?0:b<o?.5*f.exp((b-o)/g):1-.5*f.exp(-(b-o)/g)},mean:function(b){return b},median:function(b){return b},mode:function(b){return b},variance:function(b,o){return 2*o*o},sample:function(b,o){var g,m=u._random_fn()-.5;return b-o*((g=m)/f.abs(g))*f.log(1-2*f.abs(m))}}),u.extend(u.tukey,{cdf:function(b,o,g){var m=o,p=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(b<=0)return 0;if(g<2||m<2)return NaN;if(!Number.isFinite(b))return 1;if(g>25e3)return P(b,1,m);var T,I=.5*g,_=I*f.log(g)-g*f.log(2)-u.gammaln(I),O=I-1,M=.25*g;T=g<=100?1:g<=800?.5:g<=5e3?.25:.125,_+=f.log(T);for(var D=0,Z=1;Z<=50;Z++){for(var q=0,ae=(2*Z-1)*T,he=1;he<=16;he++){var se,be;8<he?(se=he-8-1,be=_+O*f.log(ae+p[se]*T)-(p[se]*T+ae)*M):(se=he-1,be=_+O*f.log(ae-p[se]*T)+(p[se]*T-ae)*M),be>=-30&&(q+=P(8<he?b*f.sqrt(.5*(p[se]*T+ae)):b*f.sqrt(.5*(-p[se]*T+ae)),1,m)*C[se]*f.exp(be))}if(Z*T>=1&&q<=1e-14)break;D+=q}if(q>1e-14)throw new Error("tukey.cdf failed to converge");return D>1&&(D=1),D},inv:function(b,o,g){if(g<2||o<2)return NaN;if(b<0||b>1)return NaN;if(b===0)return 0;if(b===1)return 1/0;var m,p=function(O,M,D){var Z=.5-.5*O,q=f.sqrt(f.log(1/(Z*Z))),ae=q+((((-453642210148e-16*q-.204231210125)*q-.342242088547)*q-1)*q+.322232421088)/((((.0038560700634*q+.10353775285)*q+.531103462366)*q+.588581570495)*q+.099348462606);D<120&&(ae+=(ae*ae*ae+ae)/D/4);var he=.8832-.2368*ae;return D<120&&(he+=-1.214/D+1.208*ae/D),ae*(he*f.log(M-1)+1.4142)}(b,o,g),C=u.tukey.cdf(p,o,g)-b;m=C>0?f.max(0,p-1):p+1;for(var T,I=u.tukey.cdf(m,o,g)-b,_=1;_<50;_++)if(T=m-I*(m-p)/(I-C),C=I,p=m,T<0&&(T=0,I=-b),I=u.tukey.cdf(T,o,g)-b,m=T,f.abs(m-p)<1e-4)return T;throw new Error("tukey.inv failed to converge")}})}(j,Math),function(u,f){var k,P,b=Array.prototype.push,o=u.utils.isArray;function g(m){return o(m)||m instanceof u}u.extend({add:function(m,p){return g(p)?(g(p[0])||(p=[p]),u.map(m,function(C,T,I){return C+p[T][I]})):u.map(m,function(C){return C+p})},subtract:function(m,p){return g(p)?(g(p[0])||(p=[p]),u.map(m,function(C,T,I){return C-p[T][I]||0})):u.map(m,function(C){return C-p})},divide:function(m,p){return g(p)?(g(p[0])||(p=[p]),u.multiply(m,u.inv(p))):u.map(m,function(C){return C/p})},multiply:function(m,p){var C,T,I,_,O,M,D,Z;if(m.length===void 0&&p.length===void 0)return m*p;if(O=m.length,M=m[0].length,D=u.zeros(O,I=g(p)?p[0].length:M),Z=0,g(p)){for(;Z<I;Z++)for(C=0;C<O;C++){for(_=0,T=0;T<M;T++)_+=m[C][T]*p[T][Z];D[C][Z]=_}return O===1&&Z===1?D[0][0]:D}return u.map(m,function(q){return q*p})},outer:function(m,p){return u.multiply(m.map(function(C){return[C]}),[p])},dot:function(m,p){g(m[0])||(m=[m]),g(p[0])||(p=[p]);for(var C,T,I=m[0].length===1&&m.length!==1?u.transpose(m):m,_=p[0].length===1&&p.length!==1?u.transpose(p):p,O=[],M=0,D=I.length,Z=I[0].length;M<D;M++){for(O[M]=[],C=0,T=0;T<Z;T++)C+=I[M][T]*_[M][T];O[M]=C}return O.length===1?O[0]:O},pow:function(m,p){return u.map(m,function(C){return f.pow(C,p)})},exp:function(m){return u.map(m,function(p){return f.exp(p)})},log:function(m){return u.map(m,function(p){return f.log(p)})},abs:function(m){return u.map(m,function(p){return f.abs(p)})},norm:function(m,p){var C=0,T=0;for(isNaN(p)&&(p=2),g(m[0])&&(m=m[0]);T<m.length;T++)C+=f.pow(f.abs(m[T]),p);return f.pow(C,1/p)},angle:function(m,p){return f.acos(u.dot(m,p)/(u.norm(m)*u.norm(p)))},aug:function(m,p){var C,T=[];for(C=0;C<m.length;C++)T.push(m[C].slice());for(C=0;C<T.length;C++)b.apply(T[C],p[C]);return T},inv:function(m){for(var p,C=m.length,T=m[0].length,I=u.identity(C,T),_=u.gauss_jordan(m,I),O=[],M=0;M<C;M++)for(O[M]=[],p=T;p<_[0].length;p++)O[M][p-T]=_[M][p];return O},det:function m(p){if(p.length===2)return p[0][0]*p[1][1]-p[0][1]*p[1][0];for(var C=0,T=0;T<p.length;T++){for(var I=[],_=1;_<p.length;_++){I[_-1]=[];for(var O=0;O<p.length;O++)O<T?I[_-1][O]=p[_][O]:O>T&&(I[_-1][O-1]=p[_][O])}var M=T%2?-1:1;C+=m(I)*p[0][T]*M}return C},gauss_elimination:function(m,p){var C,T,I,_,O=0,M=0,D=m.length,Z=m[0].length,q=1,ae=0,he=[];for(C=(m=u.aug(m,p))[0].length,O=0;O<D;O++){for(T=m[O][O],M=O,_=O+1;_<Z;_++)T<f.abs(m[_][O])&&(T=m[_][O],M=_);if(M!=O)for(_=0;_<C;_++)I=m[O][_],m[O][_]=m[M][_],m[M][_]=I;for(M=O+1;M<D;M++)for(q=m[M][O]/m[O][O],_=O;_<C;_++)m[M][_]=m[M][_]-q*m[O][_]}for(O=D-1;O>=0;O--){for(ae=0,M=O+1;M<=D-1;M++)ae+=he[M]*m[O][M];he[O]=(m[O][C-1]-ae)/m[O][O]}return he},gauss_jordan:function(m,p){var C,T,I,_=u.aug(m,p),O=_.length,M=_[0].length,D=0;for(T=0;T<O;T++){var Z=T;for(I=T+1;I<O;I++)f.abs(_[I][T])>f.abs(_[Z][T])&&(Z=I);var q=_[T];for(_[T]=_[Z],_[Z]=q,I=T+1;I<O;I++)for(D=_[I][T]/_[T][T],C=T;C<M;C++)_[I][C]-=_[T][C]*D}for(T=O-1;T>=0;T--){for(D=_[T][T],I=0;I<T;I++)for(C=M-1;C>T-1;C--)_[I][C]-=_[T][C]*_[I][T]/D;for(_[T][T]/=D,C=O;C<M;C++)_[T][C]/=D}return _},triaUpSolve:function(m,p){var C,T=m[0].length,I=u.zeros(1,T)[0],_=!1;return p[0].length!=null&&(p=p.map(function(O){return O[0]}),_=!0),u.arange(T-1,-1,-1).forEach(function(O){C=u.arange(O+1,T).map(function(M){return I[M]*m[O][M]}),I[O]=(p[O]-u.sum(C))/m[O][O]}),_?I.map(function(O){return[O]}):I},triaLowSolve:function(m,p){var C,T=m[0].length,I=u.zeros(1,T)[0],_=!1;return p[0].length!=null&&(p=p.map(function(O){return O[0]}),_=!0),u.arange(T).forEach(function(O){C=u.arange(O).map(function(M){return m[O][M]*I[M]}),I[O]=(p[O]-u.sum(C))/m[O][O]}),_?I.map(function(O){return[O]}):I},lu:function(m){var p,C=m.length,T=u.identity(C),I=u.zeros(m.length,m[0].length);return u.arange(C).forEach(function(_){I[0][_]=m[0][_]}),u.arange(1,C).forEach(function(_){u.arange(_).forEach(function(O){p=u.arange(O).map(function(M){return T[_][M]*I[M][O]}),T[_][O]=(m[_][O]-u.sum(p))/I[O][O]}),u.arange(_,C).forEach(function(O){p=u.arange(_).map(function(M){return T[_][M]*I[M][O]}),I[_][O]=m[p.length][O]-u.sum(p)})}),[T,I]},cholesky:function(m){var p,C=m.length,T=u.zeros(m.length,m[0].length);return u.arange(C).forEach(function(I){p=u.arange(I).map(function(_){return f.pow(T[I][_],2)}),T[I][I]=f.sqrt(m[I][I]-u.sum(p)),u.arange(I+1,C).forEach(function(_){p=u.arange(I).map(function(O){return T[I][O]*T[_][O]}),T[_][I]=(m[I][_]-u.sum(p))/T[I][I]})}),T},gauss_jacobi:function(m,p,C,T){for(var I,_,O,M,D=0,Z=0,q=m.length,ae=[],he=[],se=[];D<q;D++)for(ae[D]=[],he[D]=[],se[D]=[],Z=0;Z<q;Z++)D>Z?(ae[D][Z]=m[D][Z],he[D][Z]=se[D][Z]=0):D<Z?(he[D][Z]=m[D][Z],ae[D][Z]=se[D][Z]=0):(se[D][Z]=m[D][Z],ae[D][Z]=he[D][Z]=0);for(O=u.multiply(u.multiply(u.inv(se),u.add(ae,he)),-1),_=u.multiply(u.inv(se),p),I=C,M=u.add(u.multiply(O,C),_),D=2;f.abs(u.norm(u.subtract(M,I)))>T;)I=M,M=u.add(u.multiply(O,I),_),D++;return M},gauss_seidel:function(m,p,C,T){for(var I,_,O,M,D,Z=0,q=m.length,ae=[],he=[],se=[];Z<q;Z++)for(ae[Z]=[],he[Z]=[],se[Z]=[],I=0;I<q;I++)Z>I?(ae[Z][I]=m[Z][I],he[Z][I]=se[Z][I]=0):Z<I?(he[Z][I]=m[Z][I],ae[Z][I]=se[Z][I]=0):(se[Z][I]=m[Z][I],ae[Z][I]=he[Z][I]=0);for(M=u.multiply(u.multiply(u.inv(u.add(se,ae)),he),-1),O=u.multiply(u.inv(u.add(se,ae)),p),_=C,D=u.add(u.multiply(M,C),O),Z=2;f.abs(u.norm(u.subtract(D,_)))>T;)_=D,D=u.add(u.multiply(M,_),O),Z+=1;return D},SOR:function(m,p,C,T,I){for(var _,O,M,D,Z,q=0,ae=m.length,he=[],se=[],be=[];q<ae;q++)for(he[q]=[],se[q]=[],be[q]=[],_=0;_<ae;_++)q>_?(he[q][_]=m[q][_],se[q][_]=be[q][_]=0):q<_?(se[q][_]=m[q][_],he[q][_]=be[q][_]=0):(be[q][_]=m[q][_],he[q][_]=se[q][_]=0);for(D=u.multiply(u.inv(u.add(be,u.multiply(he,I))),u.subtract(u.multiply(be,1-I),u.multiply(se,I))),M=u.multiply(u.multiply(u.inv(u.add(be,u.multiply(he,I))),p),I),O=C,Z=u.add(u.multiply(D,C),M),q=2;f.abs(u.norm(u.subtract(Z,O)))>T;)O=Z,Z=u.add(u.multiply(D,O),M),q++;return Z},householder:function(m){for(var p,C,T,I,_=m.length,O=m[0].length,M=0,D=[],Z=[];M<_-1;M++){for(p=0,I=M+1;I<O;I++)p+=m[I][M]*m[I][M];for(p=(m[M+1][M]>0?-1:1)*f.sqrt(p),C=f.sqrt((p*p-m[M+1][M]*p)/2),(D=u.zeros(_,1))[M+1][0]=(m[M+1][M]-p)/(2*C),T=M+2;T<_;T++)D[T][0]=m[T][M]/(2*C);Z=u.subtract(u.identity(_,O),u.multiply(u.multiply(D,u.transpose(D)),2)),m=u.multiply(Z,u.multiply(m,Z))}return m},QR:(k=u.sum,P=u.arange,function(m){var p,C,T,I=m.length,_=m[0].length,O=u.zeros(_,_);for(m=u.copy(m),C=0;C<_;C++){for(O[C][C]=f.sqrt(k(P(I).map(function(M){return m[M][C]*m[M][C]}))),p=0;p<I;p++)m[p][C]=m[p][C]/O[C][C];for(T=C+1;T<_;T++)for(O[C][T]=k(P(I).map(function(M){return m[M][C]*m[M][T]})),p=0;p<I;p++)m[p][T]=m[p][T]-m[p][C]*O[C][T]}return[m,O]}),lstsq:function(m,p){var C=!1;p[0].length===void 0&&(p=p.map(function(ae){return[ae]}),C=!0);var T=u.QR(m),I=T[0],_=T[1],O=m[0].length,M=u.slice(I,{col:{end:O}}),D=function(ae){var he=(ae=u.copy(ae)).length,se=u.identity(he);return u.arange(he-1,-1,-1).forEach(function(be){u.sliceAssign(se,{row:be},u.divide(u.slice(se,{row:be}),ae[be][be])),u.sliceAssign(ae,{row:be},u.divide(u.slice(ae,{row:be}),ae[be][be])),u.arange(be).forEach(function(Le){var me=u.multiply(ae[Le][be],-1),ie=u.slice(ae,{row:Le}),Re=u.multiply(u.slice(ae,{row:be}),me);u.sliceAssign(ae,{row:Le},u.add(ie,Re));var _e=u.slice(se,{row:Le}),Be=u.multiply(u.slice(se,{row:be}),me);u.sliceAssign(se,{row:Le},u.add(_e,Be))})}),se}(u.slice(_,{row:{end:O}})),Z=u.transpose(M);Z[0].length===void 0&&(Z=[Z]);var q=u.multiply(u.multiply(D,Z),p);return q.length===void 0&&(q=[[q]]),C?q.map(function(ae){return ae[0]}):q},jacobi:function(m){for(var p,C,T,I,_,O,M,D=1,Z=m.length,q=u.identity(Z,Z),ae=[];D===1;){for(_=m[0][1],T=0,I=1,p=0;p<Z;p++)for(C=0;C<Z;C++)p!=C&&_<f.abs(m[p][C])&&(_=f.abs(m[p][C]),T=p,I=C);for(O=m[T][T]===m[I][I]?m[T][I]>0?f.PI/4:-f.PI/4:f.atan(2*m[T][I]/(m[T][T]-m[I][I]))/2,(M=u.identity(Z,Z))[T][T]=f.cos(O),M[T][I]=-f.sin(O),M[I][T]=f.sin(O),M[I][I]=f.cos(O),q=u.multiply(q,M),m=u.multiply(u.multiply(u.inv(M),m),M),D=0,p=1;p<Z;p++)for(C=1;C<Z;C++)p!=C&&f.abs(m[p][C])>.001&&(D=1)}for(p=0;p<Z;p++)ae.push(m[p][p]);return[q,ae]},rungekutta:function(m,p,C,T,I,_){var O,M,D;if(_===2)for(;T<=C;)I+=((O=p*m(T,I))+(M=p*m(T+p,I+O)))/2,T+=p;if(_===4)for(;T<=C;)I+=((O=p*m(T,I))+2*(M=p*m(T+p/2,I+O/2))+2*(D=p*m(T+p/2,I+M/2))+p*m(T+p,I+D))/6,T+=p;return I},romberg:function(m,p,C,T){for(var I,_,O,M,D,Z=0,q=(C-p)/2,ae=[],he=[],se=[];Z<T/2;){for(D=m(p),O=p,M=0;O<=C;O+=q,M++)ae[M]=O;for(I=ae.length,O=1;O<I-1;O++)D+=(O%2!=0?4:2)*m(ae[O]);D=q/3*(D+m(C)),se[Z]=D,q/=2,Z++}for(_=se.length,I=1;_!==1;){for(O=0;O<_-1;O++)he[O]=(f.pow(4,I)*se[O+1]-se[O])/(f.pow(4,I)-1);_=he.length,se=he,he=[],I++}return se},richardson:function(m,p,C,T){function I(be,Le){for(var me,ie=0,Re=be.length;ie<Re;ie++)be[ie]===Le&&(me=ie);return me}for(var _,O,M,D,Z,q=f.abs(C-m[I(m,C)+1]),ae=0,he=[],se=[];T>=q;)_=I(m,C+T),O=I(m,C),he[ae]=(p[_]-2*p[O]+p[2*O-_])/(T*T),T/=2,ae++;for(D=he.length,M=1;D!=1;){for(Z=0;Z<D-1;Z++)se[Z]=(f.pow(4,M)*he[Z+1]-he[Z])/(f.pow(4,M)-1);D=se.length,he=se,se=[],M++}return he},simpson:function(m,p,C,T){for(var I,_=(C-p)/T,O=m(p),M=[],D=p,Z=0,q=1;D<=C;D+=_,Z++)M[Z]=D;for(I=M.length;q<I-1;q++)O+=(q%2!=0?4:2)*m(M[q]);return _/3*(O+m(C))},hermite:function(m,p,C,T){for(var I,_=m.length,O=0,M=0,D=[],Z=[],q=[],ae=[];M<_;M++){for(D[M]=1,I=0;I<_;I++)M!=I&&(D[M]*=(T-m[I])/(m[M]-m[I]));for(Z[M]=0,I=0;I<_;I++)M!=I&&(Z[M]+=1/(m[M]-m[I]));q[M]=(1-2*(T-m[M])*Z[M])*(D[M]*D[M]),ae[M]=(T-m[M])*(D[M]*D[M]),O+=q[M]*p[M]+ae[M]*C[M]}return O},lagrange:function(m,p,C){for(var T,I,_=0,O=0,M=m.length;O<M;O++){for(I=p[O],T=0;T<M;T++)O!=T&&(I*=(C-m[T])/(m[O]-m[T]));_+=I}return _},cubic_spline:function(m,p,C){for(var T,I,_=m.length,O=0,M=[],D=[],Z=[],q=[],ae=[],he=[];O<_-1;O++)q[O]=m[O+1]-m[O];for(Z[0]=0,O=1;O<_-1;O++)Z[O]=3/q[O]*(p[O+1]-p[O])-3/q[O-1]*(p[O]-p[O-1]);for(O=1;O<_-1;O++)M[O]=[],D[O]=[],M[O][O-1]=q[O-1],M[O][O]=2*(q[O-1]+q[O]),M[O][O+1]=q[O],D[O][0]=Z[O];for(I=u.multiply(u.inv(M),D),T=0;T<_-1;T++)ae[T]=(p[T+1]-p[T])/q[T]-q[T]*(I[T+1][0]+2*I[T][0])/3,he[T]=(I[T+1][0]-I[T][0])/(3*q[T]);for(T=0;T<_&&!(m[T]>C);T++);return p[T-=1]+(C-m[T])*ae[T]+u.sq(C-m[T])*I[T]+(C-m[T])*u.sq(C-m[T])*he[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(m){var p,C,T,I,_,O=m.length,M=m[0].length,D=0,Z=[],q=[],ae=[],he=[],se=[],be=[],Le=[];for(D=0;D<O;D++)Z[D]=u.sum(m[D])/M;for(D=0;D<M;D++)for(se[D]=[],p=0;p<O;p++)se[D][p]=m[p][D]-Z[p];for(se=u.transpose(se),D=0;D<O;D++)for(be[D]=[],p=0;p<O;p++)be[D][p]=u.dot([se[D]],[se[p]])/(M-1);for(_=(T=u.jacobi(be))[0],q=T[1],Le=u.transpose(_),D=0;D<q.length;D++)for(p=D;p<q.length;p++)q[D]<q[p]&&(C=q[D],q[D]=q[p],q[p]=C,ae=Le[D],Le[D]=Le[p],Le[p]=ae);for(I=u.transpose(se),D=0;D<O;D++)for(he[D]=[],p=0;p<I.length;p++)he[D][p]=u.dot([Le[D]],[I[p]]);return[m,q,Le,he]}}),function(m){for(var p=0;p<m.length;p++)(function(C){u.fn[C]=function(T,I){var _=this;return I?(setTimeout(function(){I.call(_,u.fn[C].call(_,T))},15),this):typeof u[C](this,T)=="number"?u[C](this,T):u(u[C](this,T))}})(m[p])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(j,Math),function(u,f){var k=[].slice,P=u.utils.isNumber,b=u.utils.isArray;function o(g,m,p,C){if(g>1||p>1||g<=0||p<=0)throw new Error("Proportions should be greater than 0 and less than 1");var T=(g*m+p*C)/(m+C);return(g-p)/f.sqrt(T*(1-T)*(1/m+1/C))}u.extend({zscore:function(){var g=k.call(arguments);return P(g[1])?(g[0]-g[1])/g[2]:(g[0]-u.mean(g[1]))/u.stdev(g[1],g[2])},ztest:function(){var g,m=k.call(arguments);return b(m[1])?(g=u.zscore(m[0],m[1],m[3]),m[2]===1?u.normal.cdf(-f.abs(g),0,1):2*u.normal.cdf(-f.abs(g),0,1)):m.length>2?(g=u.zscore(m[0],m[1],m[2]),m[3]===1?u.normal.cdf(-f.abs(g),0,1):2*u.normal.cdf(-f.abs(g),0,1)):(g=m[0],m[1]===1?u.normal.cdf(-f.abs(g),0,1):2*u.normal.cdf(-f.abs(g),0,1))}}),u.extend(u.fn,{zscore:function(g,m){return(g-this.mean())/this.stdev(m)},ztest:function(g,m,p){var C=f.abs(this.zscore(g,p));return m===1?u.normal.cdf(-C,0,1):2*u.normal.cdf(-C,0,1)}}),u.extend({tscore:function(){var g=k.call(arguments);return g.length===4?(g[0]-g[1])/(g[2]/f.sqrt(g[3])):(g[0]-u.mean(g[1]))/(u.stdev(g[1],!0)/f.sqrt(g[1].length))},ttest:function(){var g,m=k.call(arguments);return m.length===5?(g=f.abs(u.tscore(m[0],m[1],m[2],m[3])),m[4]===1?u.studentt.cdf(-g,m[3]-1):2*u.studentt.cdf(-g,m[3]-1)):P(m[1])?(g=f.abs(m[0]),m[2]==1?u.studentt.cdf(-g,m[1]-1):2*u.studentt.cdf(-g,m[1]-1)):(g=f.abs(u.tscore(m[0],m[1])),m[2]==1?u.studentt.cdf(-g,m[1].length-1):2*u.studentt.cdf(-g,m[1].length-1))}}),u.extend(u.fn,{tscore:function(g){return(g-this.mean())/(this.stdev(!0)/f.sqrt(this.cols()))},ttest:function(g,m){return m===1?1-u.studentt.cdf(f.abs(this.tscore(g)),this.cols()-1):2*u.studentt.cdf(-f.abs(this.tscore(g)),this.cols()-1)}}),u.extend({anovafscore:function(){var g,m,p,C,T,I,_,O,M=k.call(arguments);if(M.length===1){for(T=new Array(M[0].length),_=0;_<M[0].length;_++)T[_]=M[0][_];M=T}for(m=new Array,_=0;_<M.length;_++)m=m.concat(M[_]);for(p=u.mean(m),g=0,_=0;_<M.length;_++)g+=M[_].length*f.pow(u.mean(M[_])-p,2);for(g/=M.length-1,I=0,_=0;_<M.length;_++)for(C=u.mean(M[_]),O=0;O<M[_].length;O++)I+=f.pow(M[_][O]-C,2);return g/(I/(m.length-M.length))},anovaftest:function(){var g,m,p,C,T=k.call(arguments);if(P(T[0]))return 1-u.centralF.cdf(T[0],T[1],T[2]);var I=u.anovafscore(T);for(g=T.length-1,p=0,C=0;C<T.length;C++)p+=T[C].length;return m=p-g-1,1-u.centralF.cdf(I,g,m)},ftest:function(g,m,p){return 1-u.centralF.cdf(g,m,p)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){var g,m=0;for(g=0;g<this.length;g++)m+=this[g].length;return u.ftest(this.anovafscore(),this.length-1,m-this.length)}}),u.extend({qscore:function(){var g,m,p,C,T,I=k.call(arguments);return P(I[0])?(g=I[0],m=I[1],p=I[2],C=I[3],T=I[4]):(g=u.mean(I[0]),m=u.mean(I[1]),p=I[0].length,C=I[1].length,T=I[2]),f.abs(g-m)/(T*f.sqrt((1/p+1/C)/2))},qtest:function(){var g,m=k.call(arguments);m.length===3?(g=m[0],m=m.slice(1)):m.length===7?(g=u.qscore(m[0],m[1],m[2],m[3],m[4]),m=m.slice(5)):(g=u.qscore(m[0],m[1],m[2]),m=m.slice(3));var p=m[0],C=m[1];return 1-u.tukey.cdf(g,C,p-C)},tukeyhsd:function(g){for(var m=u.pooledstdev(g),p=g.map(function(M){return u.mean(M)}),C=g.reduce(function(M,D){return M+D.length},0),T=[],I=0;I<g.length;++I)for(var _=I+1;_<g.length;++_){var O=u.qtest(p[I],p[_],g[I].length,g[_].length,m,C,g.length);T.push([[I,_],O])}return T}}),u.extend({normalci:function(){var g,m=k.call(arguments),p=new Array(2);return g=m.length===4?f.abs(u.normal.inv(m[1]/2,0,1)*m[2]/f.sqrt(m[3])):f.abs(u.normal.inv(m[1]/2,0,1)*u.stdev(m[2])/f.sqrt(m[2].length)),p[0]=m[0]-g,p[1]=m[0]+g,p},tci:function(){var g,m=k.call(arguments),p=new Array(2);return g=m.length===4?f.abs(u.studentt.inv(m[1]/2,m[3]-1)*m[2]/f.sqrt(m[3])):f.abs(u.studentt.inv(m[1]/2,m[2].length-1)*u.stdev(m[2],!0)/f.sqrt(m[2].length)),p[0]=m[0]-g,p[1]=m[0]+g,p},significant:function(g,m){return g<m}}),u.extend(u.fn,{normalci:function(g,m){return u.normalci(g,m,this.toArray())},tci:function(g,m){return u.tci(g,m,this.toArray())}}),u.extend(u.fn,{oneSidedDifferenceOfProportions:function(g,m,p,C){var T=o(g,m,p,C);return u.ztest(T,1)},twoSidedDifferenceOfProportions:function(g,m,p,C){var T=o(g,m,p,C);return u.ztest(T,2)}})}(j,Math),j.models=function(){function u(f,k){var P=f.length,b=k[0].length-1,o=P-b-1,g=j.lstsq(k,f),m=j.multiply(k,g.map(function(O){return[O]})).map(function(O){return O[0]}),p=j.subtract(f,m),C=j.mean(f),T=j.sum(m.map(function(O){return Math.pow(O-C,2)})),I=j.sum(f.map(function(O,M){return Math.pow(O-m[M],2)})),_=T+I;return{exog:k,endog:f,nobs:P,df_model:b,df_resid:o,coef:g,predict:m,resid:p,ybar:C,SST:_,SSE:T,SSR:I,R2:T/_}}return{ols:function(f,k){var P=u(f,k),b=function(m){var p,C,T=(p=m.exog,C=p[0].length,j.arange(C).map(function(q){var ae=j.arange(C).filter(function(he){return he!==q});return u(j.col(p,q).map(function(he){return he[0]}),j.col(p,ae))})),I=Math.sqrt(m.SSR/m.df_resid),_=T.map(function(q){var ae=q.SST,he=q.R2;return I/Math.sqrt(ae*(1-he))}),O=m.coef.map(function(q,ae){return(q-0)/_[ae]}),M=O.map(function(q){var ae=j.studentt.cdf(q,m.df_resid);return 2*(ae>.5?1-ae:ae)}),D=j.studentt.inv(.975,m.df_resid),Z=m.coef.map(function(q,ae){var he=D*_[ae];return[q-he,q+he]});return{se:_,t:O,p:M,sigmaHat:I,interval95:Z}}(P),o=function(m){var p,C,T,I=m.R2/m.df_model/((1-m.R2)/m.df_resid);return{F_statistic:I,pvalue:1-(p=I,C=m.df_model,T=m.df_resid,j.beta.cdf(p/(T/C+p),C/2,T/2))}}(P),g=1-(1-P.R2)*((P.nobs-1)/P.df_resid);return P.t=b,P.f=o,P.adjust_R2=g,P}}}(),j.extend({buildxmatrix:function(){for(var u=new Array(arguments.length),f=0;f<arguments.length;f++)u[f]=[1].concat(arguments[f]);return j(u)},builddxmatrix:function(){for(var u=new Array(arguments[0].length),f=0;f<arguments[0].length;f++)u[f]=[1].concat(arguments[0][f]);return j(u)},buildjxmatrix:function(u){for(var f=new Array(u.length),k=0;k<u.length;k++)f[k]=u[k];return j.builddxmatrix(f)},buildymatrix:function(u){return j(u).transpose()},buildjymatrix:function(u){return u.transpose()},matrixmult:function(u,f){var k,P,b,o,g;if(u.cols()==f.rows()){if(f.rows()>1){for(o=[],k=0;k<u.rows();k++)for(o[k]=[],P=0;P<f.cols();P++){for(g=0,b=0;b<u.cols();b++)g+=u.toArray()[k][b]*f.toArray()[b][P];o[k][P]=g}return j(o)}for(o=[],k=0;k<u.rows();k++)for(o[k]=[],P=0;P<f.cols();P++){for(g=0,b=0;b<u.cols();b++)g+=u.toArray()[k][b]*f.toArray()[P];o[k][P]=g}return j(o)}},regress:function(u,f){var k=j.xtranspxinv(u),P=u.transpose(),b=j.matrixmult(j(k),P);return j.matrixmult(b,f)},regresst:function(u,f,k){var P=j.regress(u,f),b={anova:{}},o=j.jMatYBar(u,P);b.yBar=o;var g=f.mean();b.anova.residuals=j.residuals(f,o),b.anova.ssr=j.ssr(o,g),b.anova.msr=b.anova.ssr/(u[0].length-1),b.anova.sse=j.sse(f,o),b.anova.mse=b.anova.sse/(f.length-(u[0].length-1)-1),b.anova.sst=j.sst(f,g),b.anova.mst=b.anova.sst/(f.length-1),b.anova.r2=1-b.anova.sse/b.anova.sst,b.anova.r2<0&&(b.anova.r2=0),b.anova.fratio=b.anova.msr/b.anova.mse,b.anova.pvalue=j.anovaftest(b.anova.fratio,u[0].length-1,f.length-(u[0].length-1)-1),b.anova.rmse=Math.sqrt(b.anova.mse),b.anova.r2adj=1-b.anova.mse/b.anova.mst,b.anova.r2adj<0&&(b.anova.r2adj=0),b.stats=new Array(u[0].length);for(var m,p,C,T=j.xtranspxinv(u),I=0;I<P.length;I++)m=Math.sqrt(b.anova.mse*Math.abs(T[I][I])),p=Math.abs(P[I]/m),C=j.ttest(p,f.length-u[0].length-1,k),b.stats[I]=[P[I],m,p,C];return b.regress=P,b},xtranspx:function(u){return j.matrixmult(u.transpose(),u)},xtranspxinv:function(u){var f=j.matrixmult(u.transpose(),u);return j.inv(f)},jMatYBar:function(u,f){var k=j.matrixmult(u,f);return new j(k)},residuals:function(u,f){return j.matrixsubtract(u,f)},ssr:function(u,f){for(var k=0,P=0;P<u.length;P++)k+=Math.pow(u[P]-f,2);return k},sse:function(u,f){for(var k=0,P=0;P<u.length;P++)k+=Math.pow(u[P]-f[P],2);return k},sst:function(u,f){for(var k=0,P=0;P<u.length;P++)k+=Math.pow(u[P]-f,2);return k},matrixsubtract:function(u,f){for(var k=new Array(u.length),P=0;P<u.length;P++){k[P]=new Array(u[P].length);for(var b=0;b<u[P].length;b++)k[P][b]=u[P][b]-f[P][b]}return j(k)}}),j.jStat=j,j)},960:function(W,j,u){const f=u(592);W.exports=function(k){function P(I,_){const O=_.split(".");let M=I;for(const D of O){if(M==null)return;M=M[D]}return M}for(let I=0;I<Object.keys(f).length;I++){let _,O=Object.keys(f)[I],M=[];if(typeof f[O]=="object"){M=Object.keys(f[O]),_=Object.values(f[O]);for(let D=0;D<_.length;D++)if(typeof _[D]=="object"){let Z=M[D];f[O][Z]&&(M=[...M,...Object.keys(f[O][Z]).map(q=>Z+"."+q)],M.splice(M.indexOf(Z),1))}}if(M.length<1)k[O]=f[O];else for(let D=0;D<M.length;D++)typeof P(f[O],M[D])=="function"&&(k[O]=P(f[O],M[D]))}let b=function(I){return typeof I=="number"&&(I=parseInt(I)),I},o=null,g=null,m=null;k.TABLE=function(){return m},k.COLUMN=k.COL=function(){return m.tracking&&m.tracking.push(T.getColumnNameFromCoords(b(o),b(g))),b(o)+1},k.ROW=function(){return m.tracking&&m.tracking.push(T.getColumnNameFromCoords(b(o),b(g))),b(g)+1},k.CELL=function(){return T.getColumnNameFromCoords(o,g)},k.VALUE=function(I,_,O){return m.getValueFromCoords(b(I)-1,b(_)-1,O)},k.THISROWCELL=function(I){return m.getValueFromCoords(b(I)-1,b(g))};const p=function(I,_){for(let O=0;O<I.length;O++){let M=T.getTokensFromRange(I[O]);_=_.replace(I[O],"["+M.join(",")+"]")}return _},C=function(I){return typeof I=="string"&&(I=I.trim()),!isNaN(I)&&I!==null&&I!==""},T=function(I,_,O,M,D){m=D,o=O,g=M;let Z="",q={};if(_)if(_.size){let se,be=null;_.forEach(function(Le,me){se=me.replace(/!/g,"."),se.indexOf(".")!==-1&&(se=se.split("."),q[se[0]]=!0)}),se=Object.keys(q);for(let Le=0;Le<se.length;Le++)Z+="var "+se[Le]+" = {};";_.forEach(function(Le,me){se=me.replace(/!/g,"."),Le===null||C(Le)||(be=Le.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),be&&be.length&&(Le=updateRanges(be,Le))),se.indexOf(".")>0?Z+=se+" = "+_.get(me)+`;
`:Z+="var "+se+" = "+Le+`;
`})}else{let se=Object.keys(_);if(se.length){let be,Le={};for(let me=0;me<se.length;me++)if(be=se[me].replace(/\!/g,"."),be.indexOf(".")>0){let ie=ie.split(".");Le[ie[0]]={}}be=Object.keys(Le);for(let me=0;me<be.length;me++)Z+="var "+be[me]+" = {};";for(let me=0;me<se.length;me++){if(be=se[me].replace(/!/g,"."),_[se[me]]!==null&&!C(_[se[me]])){let ie=_[se[me]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ie&&ie.length&&(_[se[me]]=p(ie,_[se[me]]))}be.indexOf(".")>0?Z+=be+" = "+_[se[me]]+`;
`:Z+="var "+be+" = "+_[se[me]]+`;
`}}}let ae=(I=function(se,be){let Le="",me=0,ie=["=","!",">","<"];for(let Re=0;Re<se.length;Re++)se[Re]==='"'&&(me=me===0?1:0),me===1?Le+=se[Re]:(Le+=se[Re].toUpperCase(),Re>0&&se[Re]==="="&&ie.indexOf(se[Re-1])===-1&&ie.indexOf(se[Re+1])===-1&&(Le+="="));return Le=Le.replace(/\^/g,"**"),Le=Le.replace(/<>/g,"!="),Le=Le.replace(/&/g,"+"),Le=Le.replace(/\$/g,""),Le}(I=(I=I.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ae&&ae.length&&(I=p(ae,I));let he=new Function(Z+"; return "+I)();return he===null&&(he=0),he};return T.getColumnNameFromCoords=function(I,_){return M="",(O=parseInt(I))>701?(M+=String.fromCharCode(64+parseInt(O/676)),M+=String.fromCharCode(64+parseInt(O%676/26))):O>25&&(M+=String.fromCharCode(64+parseInt(O/26))),M+String.fromCharCode(65+O%26)+(parseInt(_)+1);var O,M},T.getCoordsFromColumnName=function(I){var _=/^[a-zA-Z]+/.exec(I);if(_){for(var O=0,M=0;M<_[0].length;M++)O+=parseInt(_[0].charCodeAt(M)-64)*Math.pow(26,_[0].length-1-M);--O<0&&(O=0);var D=parseInt(/[0-9]+$/.exec(I))||null;return D>0&&D--,[O,D]}},T.getRangeFromTokens=function(I){I=I.filter(function(D){return D!="#REF!"});for(var _="",O="",M=0;M<I.length;M++)I[M].indexOf(".")>=0?_=".":I[M].indexOf("!")>=0&&(_="!"),_&&(O=I[M].split(_),I[M]=O[1],O=O[0]+_);return I.sort(function(D,Z){var q=Helpers.getCoordsFromColumnName(D),ae=Helpers.getCoordsFromColumnName(Z);return q[1]>ae[1]?1:q[1]<ae[1]?-1:q[0]>ae[0]?1:q[0]<ae[0]?-1:0}),I.length?O+(I[0]+":")+I[I.length-1]:"#REF!"},T.getTokensFromRange=function(I){if(I.indexOf(".")>0){var _=I.split(".");I=_[1],_=_[0]+"."}else I.indexOf("!")>0?(_=I.split("!"),I=_[1],_=_[0]+"!"):_="";I=I.split(":");var O=T.getCoordsFromColumnName(I[0]),M=T.getCoordsFromColumnName(I[1]);if(O[0]<=M[0])var D=O[0],Z=M[0];else D=M[0],Z=O[0];if(O[1]===null&&M[1]==null)for(var q=null,ae=null,he=Object.keys(vars),se=0;se<he.length;se++){var be=T.getCoordsFromColumnName(he[se]);be[0]===O[0]&&(q===null||be[1]<q)&&(q=be[1]),be[0]===M[0]&&(ae===null||be[1]>ae)&&(ae=be[1])}else O[1]<=M[1]?(q=O[1],ae=M[1]):(q=M[1],ae=O[1]);for(var Le=[],me=q;me<=ae;me++){var ie=[];for(se=D;se<=Z;se++)ie.push(_+T.getColumnNameFromCoords(se,me));Le.push(ie)}return Le},T.setFormula=function(I){let _=Object.keys(I);for(let O=0;O<_.length;O++)typeof I[_[O]]=="function"&&(k[_[O]]=I[_[O]])},T.basic=!0,T}(typeof window>"u"?u.g:window)},592:function(W,j,u){var f=u(162),k=u(765);const P=new Error("#NULL!"),b=new Error("#DIV/0!"),o=new Error("#VALUE!"),g=new Error("#REF!"),m=new Error("#NAME?"),p=new Error("#NUM!"),C=new Error("#N/A"),T=new Error("#ERROR!"),I=new Error("#GETTING_DATA");var _=Object.freeze({__proto__:null,data:I,div0:b,error:T,na:C,name:m,nil:P,num:p,ref:g,value:o});function O(e){const t=[];return M(e,a=>{t.push(a)}),t}function M(e,t){let a=-1;const h=e.length;for(;++a<h&&t(e[a],a,e)!==!1;);return e}function D(e){let t,a=e.length;for(;a--;)if(t=e[a],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const h=Y(t);e[a]=h instanceof Error?0:h}}else e[a]=0;else e[a]=1;return e}function Z(e,t){if(!e)return o;e.every(N=>Array.isArray(N))&&e.length!==0||(e=[[...e]]),e.map((N,H)=>{N.map((z,oe)=>{z||(e[H][oe]=0)})});const a=e.reduce((N,H,z)=>H.length>e[N].length?z:N,0),h=e[a].length;return e.map(N=>[...N,...Array(h-N.length).fill(0)])}function q(){let e;if(arguments.length===1){const a=arguments[0];e=(t=a)!=null&&typeof t.length=="number"&&typeof t!="string"?O.apply(null,arguments):[a]}else e=Array.from(arguments);for(var t;!he(e);)e=ae(e);return e}function ae(e){return e&&e.reduce?e.reduce((t,a)=>{const h=Array.isArray(t),N=Array.isArray(a);return h&&N?t.concat(a):h?(t.push(a),t):N?[t].concat(a):[t,a]}):[e]}function he(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function se(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function be(e){return e?e[0].map((t,a)=>e.map(h=>h[a])):o}function Le(e,t){let a=null;return M(e,(h,N)=>{if(h[0]===t)return a=N,!1}),a??o}function me(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ie(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function Re(e){return Math.round(e*1e14)/1e14}function _e(){return q.apply(null,arguments).filter(e=>typeof e=="number")}function Be(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||o}function He(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?p:function(a){a<60&&(a+=1);const h=Math.floor(a-25569),N=new Date(86400*h*1e3),H=a-Math.floor(a)+1e-7;let z=Math.floor(86400*H);const oe=z%60;z-=oe;const de=Math.floor(z/3600),Ce=Math.floor(z/60)%60;let ke=N.getUTCDate(),Ye=N.getUTCMonth();return a>=60&&a<61&&(ke=29,Ye=1),new Date(N.getUTCFullYear(),Ye,ke,de,Ce,oe)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?o:e}function lt(e){let t,a=e.length;for(;a--;){if(t=He(e[a]),t===o)return t;e[a]=t}return e}function Y(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?o:parseFloat(e))}function Me(e){let t,a;if(!e||(t=e.length)===0)return o;for(;t--;){if(e[t]instanceof Error)return e[t];if(a=Y(e[t]),a instanceof Error)return a;e[t]=a}return e}function qe(e){return e instanceof Error?e:e==null?"":e.toString()}function pt(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function Ze(e){return e!=null}const Ae="=",Ne=[">",">=","<","<=","=","<>"],Ve="operator",ze="literal",Je=[Ve,ze],et=Ve,it=ze;function dt(e,t){if(Je.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function mt(e){return function(t){let a="";const h=[];for(let N=0;N<t.length;N++){const H=t[N];N===0&&Ne.indexOf(H)>=0?h.push(dt(H,et)):a+=H}return a.length>0&&h.push(dt(function(N){return typeof N!="string"||/^\d+(\.\d+)?$/.test(N)&&(N=N.indexOf(".")===-1?parseInt(N,10):parseFloat(N)),N}(a),it)),h.length>0&&h[0].type!==et&&h.unshift(dt(Ae,et)),h}(function(t){const a=t.length,h=[];let N=0,H="",z="";for(;N<a;){const oe=t.charAt(N);switch(oe){case">":case"<":case"=":z+=oe,H.length>0&&(h.push(H),H="");break;default:z.length>0&&(h.push(z),z=""),H+=oe}N++}return H.length>0&&h.push(H),z.length>0&&h.push(z),h}(e))}const gt=function(e){const t=[];let a;for(let h=0;h<e.length;h++){const N=e[h];switch(N.type){case et:a=N.value;break;case it:t.push(N.value)}}return function(h,N){let H=!1;switch(N){case">":H=h[0]>h[1];break;case">=":H=h[0]>=h[1];break;case"<":H=h[0]<h[1];break;case"<=":H=h[0]<=h[1];break;case"=":H=h[0]==h[1];break;case"<>":H=h[0]!=h[1]}return H}(t,a)},St={};function Ft(e){return[o,g,b,p,m,P].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Et(e){return Ft(e)||e===C}function Ot(e){return e===!0||e===!1}function Tt(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function bt(e){return typeof e=="string"}function kt(){const e=[];for(let t=0;t<arguments.length;++t){let a=!1;const h=arguments[t];for(let N=0;N<e.length&&(a=e[N]===h,!a);++N);a||e.push(h)}return e}function Rt(e,t,a,h){if(!t||!a)return C;h=!(h===0||h===!1);let N=C;const H=typeof e=="number";let z=!1;for(let oe=0;oe<t.length;oe++){const de=t[oe];if(de[0]===e){N=a<de.length+1?de[a-1]:g;break}!z&&(H&&h&&de[0]<=e||h&&typeof de[0]=="string"&&de[0].localeCompare(e)<0)&&(N=a<de.length+1?de[a-1]:g),H&&de[0]>e&&(z=!0)}return N}function w(){const e=q(arguments).filter(Ze);if(e.length===0)return b;const t=me.apply(void 0,e);if(t)return t;const a=_e(e),h=a.length;let N,H=0,z=0;for(let oe=0;oe<h;oe++)H+=a[oe],z+=1;return N=H/z,isNaN(N)&&(N=p),N}function A(){const e=q(arguments).filter(Ze);if(e.length===0)return b;const t=me.apply(void 0,e);if(t)return t;const a=e,h=a.length;let N,H=0,z=0;for(let oe=0;oe<h;oe++){const de=a[oe];typeof de=="number"&&(H+=de),de===!0&&H++,de!==null&&z++}return N=H/z,isNaN(N)&&(N=p),N}St.TYPE=e=>{switch(e){case P:return 1;case b:return 2;case o:return 3;case g:return 4;case m:return 5;case p:return 6;case C:return 7;case I:return 8}return C};const s={DIST:function(e,t,a,h,N,H){return arguments.length<4?o:(N=N===void 0?0:N,H=H===void 0?1:H,ie(e=Y(e),t=Y(t),a=Y(a),N=Y(N),H=Y(H))?o:(e=(e-N)/(H-N),h?f.beta.cdf(e,t,a):f.beta.pdf(e,t,a)))},INV:(e,t,a,h,N)=>(h=h===void 0?0:h,N=N===void 0?1:N,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N))?o:f.beta.inv(e,t,a)*(N-h)+h)},r={DIST:(e,t,a,h)=>ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h))?o:h?f.binomial.cdf(e,t,a):f.binomial.pdf(e,t,a)};r.DIST.RANGE=(e,t,a,h)=>{if(h=h===void 0?a:h,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h)))return o;let N=0;for(let H=a;H<=h;H++)N+=Ge(e,H)*Math.pow(t,H)*Math.pow(1-t,e-H);return N},r.INV=(e,t,a)=>{if(ie(e=Y(e),t=Y(t),a=Y(a)))return o;let h=0;for(;h<=e;){if(f.binomial.cdf(h,e,t)>=a)return h;h++}};const B={DIST:(e,t,a)=>ie(e=Y(e),t=Y(t))?o:a?f.chisquare.cdf(e,t):f.chisquare.pdf(e,t)};B.DIST.RT=(e,t)=>!e|!t?C:e<1||t>Math.pow(10,10)?p:typeof e!="number"||typeof t!="number"?o:1-f.chisquare.cdf(e,t),B.INV=(e,t)=>ie(e=Y(e),t=Y(t))?o:f.chisquare.inv(e,t),B.INV.RT=(e,t)=>!e|!t?C:e<0||e>1||t<1||t>Math.pow(10,10)?p:typeof e!="number"||typeof t!="number"?o:f.chisquare.inv(1-e,t),B.TEST=function(e,t){if(arguments.length!==2)return C;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return o;const a=e.length;let h,N,H;for(N=0;N<a;N++)e[N]instanceof Array||(h=e[N],e[N]=[],e[N].push(h)),t[N]instanceof Array||(h=t[N],t[N]=[],t[N].push(h));const z=e[0].length,oe=z===1?a-1:(a-1)*(z-1);let de=0;const Ce=Math.PI;for(N=0;N<a;N++)for(H=0;H<z;H++)de+=Math.pow(e[N][H]-t[N][H],2)/t[N][H];return Math.round(1e6*function(ke,Ye){let Pe=Math.exp(-.5*ke);Ye%2==1&&(Pe*=Math.sqrt(2*ke/Ce));let We=Ye;for(;We>=2;)Pe=Pe*ke/We,We-=2;let Qe=Pe,rt=Ye;for(;Qe>1e-10*Pe;)rt+=2,Qe=Qe*ke/rt,Pe+=Qe;return 1-Pe}(de,oe))/1e6};const te={};function ee(){return _e(q(arguments)).length}function F(){const e=q(arguments);return e.length-L(e)}function L(){const e=q(arguments);let t,a=0;for(let h=0;h<e.length;h++)t=e[h],t!=null&&t!==""||a++;return a}te.NORM=(e,t,a)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:f.normalci(1,e,t,a)[1]-1,te.T=(e,t,a)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:f.tci(1,e,t,a)[1]-1;const V={P:(e,t)=>{if(ie(e=Me(q(e)),t=Me(q(t))))return o;const a=f.mean(e),h=f.mean(t);let N=0;const H=e.length;for(let z=0;z<H;z++)N+=(e[z]-a)*(t[z]-h);return N/H},S:(e,t)=>ie(e=Me(q(e)),t=Me(q(t)))?o:f.covariance(e,t)},G={DIST:(e,t,a)=>ie(e=Y(e),t=Y(t))?o:a?f.exponential.cdf(e,t):f.exponential.pdf(e,t)},ne={};function ge(e,t,a){if(ie(e=Y(e),t=Me(q(t)),a=Me(q(a))))return o;const h=f.mean(a),N=f.mean(t),H=a.length;let z=0,oe=0;for(let Ce=0;Ce<H;Ce++)z+=(a[Ce]-h)*(t[Ce]-N),oe+=Math.pow(a[Ce]-h,2);const de=z/oe;return N-de*h+de*e}function ce(e){return(e=Y(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?p:f.gammafn(e)}function fe(e){return(e=Y(e))instanceof Error?e:f.gammaln(e)}ne.DIST=(e,t,a,h)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:h?f.centralF.cdf(e,t,a):f.centralF.pdf(e,t,a),ne.DIST.RT=function(e,t,a){return arguments.length!==3?C:e<0||t<1||a<1?p:typeof e!="number"||typeof t!="number"||typeof a!="number"?o:1-f.centralF.cdf(e,t,a)},ne.INV=(e,t,a)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:e<=0||e>1?p:f.centralF.inv(e,t,a),ne.INV.RT=function(e,t,a){return arguments.length!==3?C:e<0||e>1||t<1||t>Math.pow(10,10)||a<1||a>Math.pow(10,10)?p:typeof e!="number"||typeof t!="number"||typeof a!="number"?o:f.centralF.inv(1-e,t,a)},ne.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return C;if(e.length<2||t.length<2)return b;const a=(H,z)=>{let oe=0;for(let de=0;de<H.length;de++)oe+=Math.pow(H[de]-z,2);return oe},h=At(e)/e.length,N=At(t)/t.length;return a(e,h)/(e.length-1)/(a(t,N)/(t.length-1))},ce.DIST=function(e,t,a,h){return arguments.length!==4?C:e<0||t<=0||a<=0||typeof e!="number"||typeof t!="number"||typeof a!="number"?o:h?f.gamma.cdf(e,t,a,!0):f.gamma.pdf(e,t,a,!1)},ce.INV=function(e,t,a){return arguments.length!==3?C:e<0||e>1||t<=0||a<=0?p:typeof e!="number"||typeof t!="number"||typeof a!="number"?o:f.gamma.inv(e,t,a)},fe.PRECISE=function(e){return arguments.length!==1?C:e<=0?p:typeof e!="number"?o:f.gammaln(e)};const Ee={};function De(e,t){return ie(e=Me(q(e)),t=Y(t))?e:t<0||e.length<t?o:e.sort((a,h)=>h-a)[t-1]}function Se(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return o;const a=f.mean(e),h=f.mean(t),N=t.length;let H=0,z=0;for(let de=0;de<N;de++)H+=(t[de]-h)*(e[de]-a),z+=Math.pow(t[de]-h,2);const oe=H/z;return[oe,a-oe*h]}Ee.DIST=(e,t,a,h,N)=>{if(ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h)))return o;function H(z,oe,de,Ce){return Ge(de,z)*Ge(Ce-de,oe-z)/Ge(Ce,oe)}return N?function(z,oe,de,Ce){let ke=0;for(let Ye=0;Ye<=z;Ye++)ke+=H(Ye,oe,de,Ce);return ke}(e,t,a,h):H(e,t,a,h)};const Ue={};function $e(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;const a=_e(e);return a.length===0?0:Math.max.apply(Math,a)}function Q(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;const a=D(e);let h=f.median(a);return isNaN(h)&&(h=p),h}function pe(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;const a=_e(e);return a.length===0?0:Math.min.apply(Math,a)}Ue.DIST=(e,t,a,h)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:h?f.lognormal.cdf(e,t,a):f.lognormal.pdf(e,t,a),Ue.INV=(e,t,a)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:f.lognormal.inv(e,t,a);const we={MULT:function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=e.length,a={};let h,N=[],H=0;for(let z=0;z<t;z++)h=e[z],a[h]=a[h]?a[h]+1:1,a[h]>H&&(H=a[h],N=[]),a[h]===H&&(N[N.length]=h);return N},SNGL:function(){const e=Me(q(arguments));return e instanceof Error?e:we.MULT(e).sort((t,a)=>t-a)[0]}},U={DIST:(e,t,a,h)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:h?f.negbin.cdf(e,t,a):f.negbin.pdf(e,t,a)},J={};function v(e,t){if(ie(t=Me(q(t)),e=Me(q(e))))return o;const a=f.mean(e),h=f.mean(t),N=e.length;let H=0,z=0,oe=0;for(let de=0;de<N;de++)H+=(e[de]-a)*(t[de]-h),z+=Math.pow(e[de]-a,2),oe+=Math.pow(t[de]-h,2);return H/Math.sqrt(z*oe)}J.DIST=(e,t,a,h)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:a<=0?p:h?f.normal.cdf(e,t,a):f.normal.pdf(e,t,a),J.INV=(e,t,a)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:f.normal.inv(e,t,a),J.S={},J.S.DIST=(e,t)=>(e=Y(e))instanceof Error?o:t?f.normal.cdf(e,0,1):f.normal.pdf(e,0,1),J.S.INV=e=>(e=Y(e))instanceof Error?o:f.normal.inv(e,0,1);const S={EXC:(e,t)=>{if(ie(e=Me(q(e)),t=Y(t)))return o;const a=(e=e.sort((H,z)=>H-z)).length;if(t<1/(a+1)||t>1-1/(a+1))return p;const h=t*(a+1)-1,N=Math.floor(h);return Re(h===N?e[h]:e[N]+(h-N)*(e[N+1]-e[N]))},INC:(e,t)=>{if(ie(e=Me(q(e)),t=Y(t)))return o;const a=t*((e=e.sort((N,H)=>N-H)).length-1),h=Math.floor(a);return Re(a===h?e[a]:e[h]+(a-h)*(e[h+1]-e[h]))}},X={EXC:(e,t,a)=>{if(a=a===void 0?3:a,ie(e=Me(q(e)),t=Y(t),a=Y(a)))return o;e=e.sort((ke,Ye)=>ke-Ye);const h=kt.apply(null,e),N=e.length,H=h.length,z=Math.pow(10,a);let oe=0,de=!1,Ce=0;for(;!de&&Ce<H;)t===h[Ce]?(oe=(e.indexOf(h[Ce])+1)/(N+1),de=!0):t>=h[Ce]&&(t<h[Ce+1]||Ce===H-1)&&(oe=(e.indexOf(h[Ce])+1+(t-h[Ce])/(h[Ce+1]-h[Ce]))/(N+1),de=!0),Ce++;return Math.floor(oe*z)/z},INC:(e,t,a)=>{if(a=a===void 0?3:a,ie(e=Me(q(e)),t=Y(t),a=Y(a)))return o;e=e.sort((ke,Ye)=>ke-Ye);const h=kt.apply(null,e),N=e.length,H=h.length,z=Math.pow(10,a);let oe=0,de=!1,Ce=0;for(;!de&&Ce<H;)t===h[Ce]?(oe=e.indexOf(h[Ce])/(N-1),de=!0):t>=h[Ce]&&(t<h[Ce+1]||Ce===H-1)&&(oe=(e.indexOf(h[Ce])+(t-h[Ce])/(h[Ce+1]-h[Ce]))/(N-1),de=!0),Ce++;return Math.floor(oe*z)/z}},ue={DIST:(e,t,a)=>ie(e=Y(e),t=Y(t))?o:a?f.poisson.cdf(e,t):f.poisson.pdf(e,t)},K={EXC:(e,t)=>{if(ie(e=Me(q(e)),t=Y(t)))return o;switch(t){case 1:return S.EXC(e,.25);case 2:return S.EXC(e,.5);case 3:return S.EXC(e,.75);default:return p}},INC:(e,t)=>{if(ie(e=Me(q(e)),t=Y(t)))return o;switch(t){case 1:return S.INC(e,.25);case 2:return S.INC(e,.5);case 3:return S.INC(e,.75);default:return p}}},le={};function je(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=f.mean(e),a=e.length;let h=0;for(let N=0;N<a;N++)h+=Math.pow(e[N]-t,3);return a*h/((a-1)*(a-2)*Math.pow(f.stdev(e,!0),3))}function Te(e,t){return ie(e=Me(q(e)),t=Y(t))?e:e.sort((a,h)=>a-h)[t-1]}le.AVG=(e,t,a)=>{if(ie(e=Y(e),t=Me(q(t))))return o;const h=(a=a||!1)?(z,oe)=>z-oe:(z,oe)=>oe-z,N=(t=(t=q(t)).sort(h)).length;let H=0;for(let z=0;z<N;z++)t[z]===e&&H++;return H>1?(2*t.indexOf(e)+H+1)/2:t.indexOf(e)+1},le.EQ=(e,t,a)=>{if(ie(e=Y(e),t=Me(q(t))))return o;const h=(a=a||!1)?(N,H)=>N-H:(N,H)=>H-N;return(t=t.sort(h)).indexOf(e)+1},je.P=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=f.mean(e),a=e.length;let h=0,N=0;for(let H=0;H<a;H++)N+=Math.pow(e[H]-t,3),h+=Math.pow(e[H]-t,2);return N/=a,h/=a,N/Math.pow(h,1.5)};const ve={P:function(){const e=Fe.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=p),t},S:function(){const e=Fe.S.apply(this,arguments);return Math.sqrt(e)}},Ie={DIST:(e,t,a)=>a!==1&&a!==2?p:a===1?Ie.DIST.RT(e,t):Ie.DIST["2T"](e,t)};Ie.DIST["2T"]=function(e,t){return arguments.length!==2?C:e<0||t<1?p:typeof e!="number"||typeof t!="number"?o:2*(1-f.studentt.cdf(e,t))},Ie.DIST.RT=function(e,t){return arguments.length!==2?C:e<0||t<1?p:typeof e!="number"||typeof t!="number"?o:1-f.studentt.cdf(e,t)},Ie.INV=(e,t)=>ie(e=Y(e),t=Y(t))?o:f.studentt.inv(e,t),Ie.INV["2T"]=(e,t)=>(e=Y(e),t=Y(t),e<=0||e>1||t<1?p:ie(e,t)?o:Math.abs(f.studentt.inv(e/2,t))),Ie.TEST=(e,t)=>{if(ie(e=Me(q(e)),t=Me(q(t))))return o;const a=f.mean(e),h=f.mean(t);let N,H=0,z=0;for(N=0;N<e.length;N++)H+=Math.pow(e[N]-a,2);for(N=0;N<t.length;N++)z+=Math.pow(t[N]-h,2);H/=e.length-1,z/=t.length-1;const oe=Math.abs(a-h)/Math.sqrt(H/e.length+z/t.length);return Ie.DIST["2T"](oe,e.length+t.length-2)};const Fe={};function tt(){const e=q(arguments),t=e.length;let a=0,h=0;const N=A(e);for(let H=0;H<t;H++){const z=e[H];a+=Math.pow(typeof z=="number"?z-N:z===!0?1-N:0-N,2),z!==null&&h++}return a/(h-1)}function re(){const e=q(arguments),t=e.length;let a=0,h=0;const N=A(e);let H;for(let z=0;z<t;z++){const oe=e[z];a+=Math.pow(typeof oe=="number"?oe-N:oe===!0?1-N:0-N,2),oe!==null&&h++}return H=a/h,isNaN(H)&&(H=p),H}Fe.P=function(){const e=_e(q(arguments)),t=e.length;let a=0;const h=w(e);let N;for(let H=0;H<t;H++)a+=Math.pow(e[H]-h,2);return N=a/t,isNaN(N)&&(N=p),N},Fe.S=function(){const e=_e(q(arguments)),t=e.length;let a=0;const h=w(e);for(let N=0;N<t;N++)a+=Math.pow(e[N]-h,2);return a/(t-1)};const ye={DIST:(e,t,a,h)=>ie(e=Y(e),t=Y(t),a=Y(a))?o:h?1-Math.exp(-Math.pow(e/a,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/a,t))*t/Math.pow(a,t)},xe={};function Oe(e,t,a){const h=me(e=Y(e),t=Y(t),a=Y(a));if(h)return h;if(t===0)return 0;t=Math.abs(t);const N=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.ceil(e/t)*t,N):a===0?-xt(Math.floor(Math.abs(e)/t)*t,N):-xt(Math.ceil(Math.abs(e)/t)*t,N)}function Ge(e,t){return me(e=Y(e),t=Y(t))||(e<t?p:ot(e)/(ot(t)*ot(e-t)))}xe.TEST=(e,t,a)=>{if(ie(e=Me(q(e)),t=Y(t)))return o;a=a||ve.S(e);const h=e.length;return 1-J.S.DIST((w(e)-t)/(a/Math.sqrt(h)),!0)},Oe.MATH=Oe,Oe.PRECISE=Oe;const Ke=[];function ot(e){if((e=Y(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(Ke[t]>0||(Ke[t]=ot(t-1)*t),Ke[t])}function ft(e,t){const a=me(e=Y(e),t=Y(t));if(a)return a;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return p;t=Math.abs(t);const h=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,h):-xt(Math.ceil(Math.abs(e)/t),h)}ft.MATH=(e,t,a)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const h=me(e=Y(e),t=Y(t),a=Y(a));if(h)return h;if(t===0)return 0;t=t?Math.abs(t):1;const N=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,N):a===0||a===void 0?-xt(Math.ceil(Math.abs(e)/t)*t,N):-xt(Math.floor(Math.abs(e)/t)*t,N)},ft.PRECISE=ft.MATH;const nt={CEILING:Oe};function ut(e,t){const a=me(e=Y(e),t=Y(t));if(a)return a;if(e===0&&t===0)return p;const h=Math.pow(e,t);return isNaN(h)?p:h}function Xe(){const e=q(arguments).filter(h=>h!=null);if(e.length===0)return 0;const t=Me(e);if(t instanceof Error)return t;let a=1;for(let h=0;h<t.length;h++)a*=t[h];return a}function xt(e,t){return me(e=Y(e),t=Y(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function At(){let e=0;return M(O(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const a=parseFloat(t);!isNaN(a)&&(e+=a)}else if(Array.isArray(t)){const a=At.apply(null,t);a instanceof Error?e=a:e+=a}}),e}var dn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?C:me(e=Y(e),t=Y(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?C:me(e=Y(e),t=Y(t))||(t===0?b:e/t)},EQ:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(pt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),me(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?C:(pt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),me(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?C:(pt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),me(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?C:(pt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),me(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?C:me(e=Y(e),t=Y(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?C:me(e=Y(e),t=Y(t))||e*t},NE:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?C:ut(e,t)}});const fn=new Date(Date.UTC(1900,0,1)),pn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],hn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Ht=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function It(e,t,a){a=a.toUpperCase(),e=He(e),t=He(t);const h=e.getFullYear(),N=e.getMonth(),H=e.getDate(),z=t.getFullYear(),oe=t.getMonth(),de=t.getDate();let Ce;switch(a){case"Y":Ce=Math.floor(zt(e,t));break;case"D":Ce=Lt(t,e);break;case"M":Ce=oe-N+12*(z-h),de<H&&Ce--;break;case"MD":H<=de?Ce=de-H:(oe===0?(e.setFullYear(z-1),e.setMonth(12)):(e.setFullYear(z),e.setMonth(oe-1)),Ce=Lt(t,e));break;case"YM":Ce=oe-N+12*(z-h),de<H&&Ce--,Ce%=12;break;case"YD":oe>N||oe===N&&de<H?e.setFullYear(z):e.setFullYear(z-1),Ce=Lt(t,e)}return Ce}function Bt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function Lt(e,t){return e=He(e),t=He(t),e instanceof Error?e:t instanceof Error?t:nn(Bt(e))-nn(Bt(t))}function wt(e,t,a){if(a=Be(a||"false"),e=He(e),t=He(t),e instanceof Error)return e;if(t instanceof Error)return t;if(a instanceof Error)return a;const h=e.getMonth();let N,H,z=t.getMonth();if(a)N=e.getDate()===31?30:e.getDate(),H=t.getDate()===31?30:t.getDate();else{const oe=new Date(e.getFullYear(),h+1,0).getDate(),de=new Date(t.getFullYear(),z+1,0).getDate();N=e.getDate()===oe?30:e.getDate(),t.getDate()===de?N<30?(z++,H=1):H=30:H=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(z-h)+(H-N)}function tn(e){if((e=He(e))instanceof Error)return e;(e=Bt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Pt(e,t,a){return Pt.INTL(e,t,1,a)}function _t(e,t,a){return _t.INTL(e,t,1,a)}function Ut(e){return new Date(e,1,29).getMonth()===1}function Vt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function zt(e,t,a){if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;a=a||0;let h=e.getDate();const N=e.getMonth()+1,H=e.getFullYear();let z=t.getDate();const oe=t.getMonth()+1,de=t.getFullYear();switch(a){case 0:return h===31&&z===31?(h=30,z=30):h===31?h=30:h===30&&z===31&&(z=30),(z+30*oe+360*de-(h+30*N+360*H))/360;case 1:{const Ce=(We,Qe)=>{const rt=We.getFullYear(),jt=new Date(rt,2,1);if(Ut(rt)&&We<jt&&Qe>=jt)return!0;const ct=Qe.getFullYear(),Ct=new Date(ct,2,1);return Ut(ct)&&Qe>=Ct&&We<Ct};let ke=365;if(H===de||H+1===de&&(N>oe||N===oe&&h>=z))return(H===de&&Ut(H)||Ce(e,t)||oe===1&&z===29)&&(ke=366),Vt(e,t)/ke;const Ye=de-H+1,Pe=(new Date(de+1,0,1)-new Date(H,0,1))/1e3/60/60/24/Ye;return Vt(e,t)/Pe}case 2:return Vt(e,t)/360;case 3:return Vt(e,t)/365;case 4:return(z+30*oe+360*de-(h+30*N+360*H))/360}}function nn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-fn)/864e5)+t}function rn(e){return(e=Y(e))===0?o:e instanceof Error?e:String.fromCharCode(e)}function on(e){if(ie(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=o),t}function an(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;let a=0;for(;(a=e.indexOf(!0))>-1;)e[a]="TRUE";let h=0;for(;(h=e.indexOf(!1))>-1;)e[h]="FALSE";return e.join("")}Pt.INTL=(e,t,a,h)=>{if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;let N=!1;const H=[],z=[1,2,3,4,5,6,0],oe=new RegExp("^[0|1]{7}$");if(a===void 0)a=Ht[1];else if(typeof a=="string"&&oe.test(a)){N=!0,a=a.split("");for(let Ye=0;Ye<a.length;Ye++)a[Ye]==="1"&&H.push(z[Ye])}else a=Ht[a];if(!(a instanceof Array))return o;h===void 0?h=[]:h instanceof Array||(h=[h]);for(let Ye=0;Ye<h.length;Ye++){const Pe=He(h[Ye]);if(Pe instanceof Error)return Pe;h[Ye]=Pe}const de=Math.round((t-e)/864e5)+1;let Ce=de;const ke=e;for(let Ye=0;Ye<de;Ye++){const Pe=new Date().getTimezoneOffset()>0?ke.getUTCDay():ke.getDay();let We=N?H.includes(Pe):Pe===a[0]||Pe===a[1];for(let Qe=0;Qe<h.length;Qe++){const rt=h[Qe];if(rt.getDate()===ke.getDate()&&rt.getMonth()===ke.getMonth()&&rt.getFullYear()===ke.getFullYear()){We=!0;break}}We&&Ce--,ke.setDate(ke.getDate()+1)}return Ce},_t.INTL=(e,t,a,h)=>{if((e=He(e))instanceof Error)return e;if((t=Y(t))instanceof Error)return t;if(t<0)return p;if(!((a=a===void 0?Ht[1]:Ht[a])instanceof Array))return o;h===void 0?h=[]:h instanceof Array||(h=[h]);for(let H=0;H<h.length;H++){const z=He(h[H]);if(z instanceof Error)return z;h[H]=z}let N=0;for(;N<t;){e.setDate(e.getDate()+1);const H=e.getDay();if(H!==a[0]&&H!==a[1]){for(let z=0;z<h.length;z++){const oe=h[z];if(oe.getDate()===e.getDate()&&oe.getMonth()===e.getMonth()&&oe.getFullYear()===e.getFullYear()){N--;break}}N++}}return e};const gn=an;function sn(e,t=2,a=!1){if(e=Y(e),isNaN(e)||(t=Y(t),isNaN(t)))return o;if(t<0){const h=Math.pow(10,-t);e=Math.round(e/h)*h}else e=e.toFixed(t);if(a)e=e.toString().replace(/,/g,"");else{const h=e.toString().split(".");h[0]=h[0].replace(/\B(?=(\d{3})+$)/g,","),e=h.join(".")}return e}function vt(e,t){return me(e,t)||(e=qe(e),(t=Y(t))instanceof Error?t:new Array(t+1).join(e))}const bn=rn,mn=on;function Wt(e){return/^[01]{1,10}$/.test(e)}function ht(e,t,a){if(ie(e=Y(e),t=Y(t)))return e;if((a=a===void 0?"i":a)!=="i"&&a!=="j")return o;if(e===0&&t===0)return 0;if(e===0)return t===1?a:t.toString()+a;if(t===0)return e.toString();{const h=t>0?"+":"";return e.toString()+h+(t===1?a:t.toString()+a)}}function Xt(e,t){return t=t===void 0?0:t,ie(e=Y(e),t=Y(t))?o:f.erf(e)}function Gt(e){return isNaN(e)?o:f.erfc(e)}function $t(e){const t=st(e),a=at(e);return ie(t,a)?o:Math.sqrt(Math.pow(t,2)+Math.pow(a,2))}function at(e){if(e===void 0||e===!0||e===!1)return o;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),a=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),a===0&&(a=e.indexOf("-",1));const h=e.substring(e.length-1,e.length),N=h==="i"||h==="j";return t>=0||a>=0?N?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?p:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,a))||isNaN(e.substring(a+1,e.length-1))?p:-Number(e.substring(a+1,e.length-1)):p:N?isNaN(e.substring(0,e.length-1))?p:e.substring(0,e.length-1):isNaN(e)?p:0}function Kt(e){const t=st(e),a=at(e);return ie(t,a)?o:t===0&&a===0?b:t===0&&a>0?Math.PI/2:t===0&&a<0?-Math.PI/2:a===0&&t>0?0:a===0&&t<0?-Math.PI:t>0?Math.atan(a/t):t<0&&a>=0?Math.atan(a/t)+Math.PI:Math.atan(a/t)-Math.PI}function qt(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);return h=h==="i"||h==="j"?h:"i",ht(Math.cos(t)*(Math.exp(a)+Math.exp(-a))/2,-Math.sin(t)*(Math.exp(a)-Math.exp(-a))/2,h)}function ln(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);return h=h==="i"||h==="j"?h:"i",ht(Math.cos(a)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(a)*(Math.exp(t)-Math.exp(-t))/2,h)}function Mt(e,t){const a=st(e),h=at(e),N=st(t),H=at(t);if(ie(a,h,N,H))return o;const z=e.substring(e.length-1),oe=t.substring(t.length-1);let de="i";if((z==="j"||oe==="j")&&(de="j"),N===0&&H===0)return p;const Ce=N*N+H*H;return ht((a*N+h*H)/Ce,(h*N-a*H)/Ce,de)}function st(e){if(e===void 0||e===!0||e===!1)return o;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),a=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),a===0&&(a=e.indexOf("-",1));const h=e.substring(e.length-1,e.length),N=h==="i"||h==="j";return t>=0||a>=0?N?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?p:Number(e.substring(0,t)):isNaN(e.substring(0,a))||isNaN(e.substring(a+1,e.length-1))?p:Number(e.substring(0,a)):p:N?isNaN(e.substring(0,e.length-1))?p:0:isNaN(e)?p:e}function Yt(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);return h=h==="i"||h==="j"?h:"i",ht(Math.sin(t)*(Math.exp(a)+Math.exp(-a))/2,Math.cos(t)*(Math.exp(a)-Math.exp(-a))/2,h)}function un(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);return h=h==="i"||h==="j"?h:"i",ht(Math.cos(a)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(a)*(Math.exp(t)+Math.exp(-t))/2,h)}Xt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Gt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const jn=s.DIST,vn=s.INV,yn=r.DIST,xn=Oe.MATH,wn=Oe.PRECISE,Cn=B.DIST,En=B.DIST.RT,An=B.INV,Ln=B.INV.RT,Mn=B.TEST,Nn=V.P,Tn=V.P,In=V.S,Dn=r.INV,Sn=Gt.PRECISE,Fn=Xt.PRECISE,On=G.DIST,kn=ne.DIST,Rn=ne.DIST.RT,Hn=ne.INV,Bn=ne.INV.RT,Pn=ft.MATH,_n=ft.PRECISE,Vn=ne.TEST,qn=ce.DIST,Yn=ce.INV,Un=fe.PRECISE,zn=Ee.DIST,Wn=Ue.INV,Xn=Ue.DIST,Gn=Ue.INV,$n=we.MULT,Kn=we.SNGL,Jn=U.DIST,Zn=Pt.INTL,Qn=J.DIST,er=J.INV,tr=J.S.DIST,nr=J.S.INV,rr=S.EXC,or=S.INC,ir=X.EXC,ar=X.INC,sr=ue.DIST,lr=K.EXC,ur=K.INC,cr=le.AVG,dr=le.EQ,fr=je.P,pr=ve.P,hr=ve.S,gr=Ie.DIST,br=Ie.DIST.RT,mr=Ie.INV,jr=Ie.TEST,vr=Fe.P,yr=Fe.S,xr=ye.DIST,wr=_t.INTL,Cr=xe.TEST;function Jt(e){const t=[];return M(e,a=>{a&&t.push(a)}),t}function yt(e,t){const a={};for(let H=1;H<e[0].length;++H)a[H]=!0;let h=t[0].length;for(let H=1;H<t.length;++H)t[H].length>h&&(h=t[H].length);for(let H=1;H<e.length;++H)for(let z=1;z<e[H].length;++z){let oe=!1,de=!1;for(let Ce=0;Ce<t.length;++Ce){const ke=t[Ce];if(ke.length<h)continue;const Ye=ke[0];if(e[H][0]===Ye){de=!0;for(let Pe=1;Pe<ke.length;++Pe)if(!oe)if(ke[Pe]===void 0||ke[Pe]==="*")oe=!0;else{const We=mt(ke[Pe]+""),Qe=[dt(e[H][z],it)].concat(We);oe=gt(Qe)}}}de&&(a[z]=a[z]&&oe)}const N=[];for(let H=0;H<e[0].length;++H)a[H]&&N.push(H-1);return N}function Zt(e){return e&&e.getTime&&!isNaN(e.getTime())}function Qt(e){return e instanceof Date?e:new Date(e)}function Nt(e,t,a,h,N){if(h=h||0,N=N||0,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N)))return o;let H;if(e===0)H=h+a*t;else{const z=Math.pow(1+e,t);H=N===1?h*z+a*(1+e)*(z-1)/e:h*z+a*(z-1)/e}return-H}function cn(e,t,a,h,N,H){if(N=N||0,H=H||0,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N),H=Y(H)))return o;const z=Dt(e,a,h,N,H);return(t===1?H===1?0:-h:H===1?Nt(e,t-2,z,h,1)-z:Nt(e,t-1,z,h,0))*e}function en(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=e[0];let a=0;for(let h=1;h<e.length;h++)a+=e[h]/Math.pow(1+t,h);return a}function Dt(e,t,a,h,N){if(h=h||0,N=N||0,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N)))return o;let H;if(e===0)H=(a+h)/t;else{const z=Math.pow(1+e,t);H=N===1?(h*e/(z-1)+a*e/(1-1/z))/(1+e):h*e/(z-1)+a*e/(1-1/z)}return-H}const Er={errors:_,symbols:dn};j.ABS=function(e){return(e=Y(e))instanceof Error?e:Math.abs(e)},j.ACCRINT=function(e,t,a,h,N,H,z){return e=Qt(e),t=Qt(t),a=Qt(a),Zt(e)&&Zt(t)&&Zt(a)?h<=0||N<=0||[1,2,4].indexOf(H)===-1||[0,1,2,3,4].indexOf(z)===-1||a<=e?p:(N=N||0)*h*zt(e,a,z=z||0):o},j.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},j.ACOS=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=p),t},j.ACOSH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=p),t},j.ACOT=function(e){return(e=Y(e))instanceof Error?e:Math.atan(1/e)},j.ACOTH=function(e){if((e=Y(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=p),t},j.AGGREGATE=function(e,t,a,h){if(ie(e=Y(e),Y(e)))return o;switch(e){case 1:return w(a);case 2:return ee(a);case 3:return F(a);case 4:return $e(a);case 5:return pe(a);case 6:return Xe(a);case 7:return ve.S(a);case 8:return ve.P(a);case 9:return At(a);case 10:return Fe.S(a);case 11:return Fe.P(a);case 12:return Q(a);case 13:return we.SNGL(a);case 14:return De(a,h);case 15:return Te(a,h);case 16:return S.INC(a,h);case 17:return K.INC(a,h);case 18:return S.EXC(a,h);case 19:return K.EXC(a,h)}},j.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},j.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},j.AND=function(){const e=q(arguments);let t=o;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===o&&(t=!0),e[a]||(t=!1))}return t},j.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return o;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,a=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),t},j.ASC=function(){throw new Error("ASC is not implemented")},j.ASIN=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=p),t},j.ASINH=function(e){return(e=Y(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},j.ATAN=function(e){return(e=Y(e))instanceof Error?e:Math.atan(e)},j.ATAN2=function(e,t){return me(e=Y(e),t=Y(t))||Math.atan2(e,t)},j.ATANH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=p),t},j.AVEDEV=function(){const e=q(arguments).filter(Ze);if(e.length===0)return p;const t=Me(e);return t instanceof Error?t:f.sum(f(t).subtract(f.mean(t)).abs()[0])/t.length},j.AVERAGE=w,j.AVERAGEA=A,j.AVERAGEIF=function(e,t,a){if(arguments.length<=1)return C;if(a=Me(q(a=a||e).filter(Ze)),e=q(e),a instanceof Error)return a;let h=0,N=0;const H=t===void 0||t==="*",z=H?null:mt(t+"");for(let oe=0;oe<e.length;oe++){const de=e[oe];if(H)N+=a[oe],h++;else{const Ce=[dt(de,it)].concat(z);gt(Ce)&&(N+=a[oe],h++)}}return N/h},j.AVERAGEIFS=function(){const e=O(arguments),t=(e.length-1)/2,a=q(e[0]);let h=0,N=0;for(let z=0;z<a.length;z++){let oe=!1;for(let de=0;de<t;de++){const Ce=e[2*de+1][z],ke=e[2*de+2];let Ye=!1;if(ke===void 0||ke==="*")Ye=!0;else{const Pe=mt(ke+""),We=[dt(Ce,it)].concat(Pe);Ye=gt(We)}if(!Ye){oe=!1;break}oe=!0}oe&&(N+=a[z],h++)}const H=N/h;return isNaN(H)?0:H},j.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},j.BASE=function(e,t,a){const h=me(e=Y(e),t=Y(t),a=Y(a));if(h)return h;if(t===0)return p;const N=e.toString(t);return new Array(Math.max(a+1-N.length,0)).join("0")+N},j.BESSELI=function(e,t){return ie(e=Y(e),t=Y(t))?o:k.besseli(e,t)},j.BESSELJ=function(e,t){return ie(e=Y(e),t=Y(t))?o:k.besselj(e,t)},j.BESSELK=function(e,t){return ie(e=Y(e),t=Y(t))?o:k.besselk(e,t)},j.BESSELY=function(e,t){return ie(e=Y(e),t=Y(t))?o:k.bessely(e,t)},j.BETA=s,j.BETADIST=jn,j.BETAINV=vn,j.BIN2DEC=function(e){if(!Wt(e))return p;const t=parseInt(e,2),a=e.toString();return a.length===10&&a.substring(0,1)==="1"?parseInt(a.substring(1),2)-512:t},j.BIN2HEX=function(e,t){if(!Wt(e))return p;const a=e.toString();if(a.length===10&&a.substring(0,1)==="1")return(0xfffffffe00+parseInt(a.substring(1),2)).toString(16);const h=parseInt(e,2).toString(16);return t===void 0?h:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=h.length?vt("0",t-h.length)+h:p},j.BIN2OCT=function(e,t){if(!Wt(e))return p;const a=e.toString();if(a.length===10&&a.substring(0,1)==="1")return(1073741312+parseInt(a.substring(1),2)).toString(8);const h=parseInt(e,2).toString(8);return t===void 0?h:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=h.length?vt("0",t-h.length)+h:p},j.BINOM=r,j.BINOMDIST=yn,j.BITAND=function(e,t){return ie(e=Y(e),t=Y(t))?o:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?p:e&t},j.BITLSHIFT=function(e,t){return ie(e=Y(e),t=Y(t))?o:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?p:t>=0?e<<t:e>>-t},j.BITOR=function(e,t){return ie(e=Y(e),t=Y(t))?o:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?p:e|t},j.BITRSHIFT=function(e,t){return ie(e=Y(e),t=Y(t))?o:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?p:t>=0?e>>t:e<<-t},j.BITXOR=function(e,t){return ie(e=Y(e),t=Y(t))?o:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?p:e^t},j.CEILING=Oe,j.CEILINGMATH=xn,j.CEILINGPRECISE=wn,j.CELL=function(){throw new Error("CELL is not implemented")},j.CHAR=rn,j.CHIDIST=Cn,j.CHIDISTRT=En,j.CHIINV=An,j.CHIINVRT=Ln,j.CHISQ=B,j.CHITEST=Mn,j.CHOOSE=function(){if(arguments.length<2)return C;const e=arguments[0];return e<1||e>254||arguments.length<e+1?o:arguments[e]},j.CLEAN=function(e){return ie(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},j.CODE=on,j.COLUMN=function(e,t){return arguments.length!==2?C:t<0?p:e instanceof Array&&typeof t=="number"?e.length!==0?f.col(e,t):void 0:o},j.COLUMNS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:f.cols(e):o},j.COMBIN=Ge,j.COMBINA=function(e,t){return me(e=Y(e),t=Y(t))||(e<t?p:e===0&&t===0?1:Ge(e+t-1,e-1))},j.COMPLEX=ht,j.CONCAT=gn,j.CONCATENATE=an,j.CONFIDENCE=te,j.CONVERT=function(e,t,a){if((e=Y(e))instanceof Error)return e;const h=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],N={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},H={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let z,oe=null,de=null,Ce=t,ke=a,Ye=1,Pe=1;for(let We=0;We<h.length;We++)z=h[We][2]===null?[]:h[We][2],(h[We][1]===Ce||z.indexOf(Ce)>=0)&&(oe=h[We]),(h[We][1]===ke||z.indexOf(ke)>=0)&&(de=h[We]);if(oe===null){const We=N[t.substring(0,2)];let Qe=H[t.substring(0,1)];t.substring(0,2)==="da"&&(Qe=["dekao",10,"da"]),We?(Ye=We[2],Ce=t.substring(2)):Qe&&(Ye=Qe[1],Ce=t.substring(Qe[2].length));for(let rt=0;rt<h.length;rt++)z=h[rt][2]===null?[]:h[rt][2],(h[rt][1]===Ce||z.indexOf(Ce)>=0)&&(oe=h[rt])}if(de===null){const We=N[a.substring(0,2)];let Qe=H[a.substring(0,1)];a.substring(0,2)==="da"&&(Qe=["dekao",10,"da"]),We?(Pe=We[2],ke=a.substring(2)):Qe&&(Pe=Qe[1],ke=a.substring(Qe[2].length));for(let rt=0;rt<h.length;rt++)z=h[rt][2]===null?[]:h[rt][2],(h[rt][1]===ke||z.indexOf(ke)>=0)&&(de=h[rt])}return oe===null||de===null||oe[3]!==de[3]?C:e*oe[6]*Ye/(de[6]*Pe)},j.CORREL=function(e,t){return ie(e=Me(q(e)),t=Me(q(t)))?o:f.corrcoeff(e,t)},j.COS=function(e){return(e=Y(e))instanceof Error?e:Math.cos(e)},j.COSH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},j.COT=function(e){return(e=Y(e))instanceof Error?e:e===0?b:1/Math.tan(e)},j.COTH=function(e){if((e=Y(e))instanceof Error)return e;if(e===0)return b;const t=Math.exp(2*e);return(t+1)/(t-1)},j.COUNT=ee,j.COUNTA=F,j.COUNTBLANK=L,j.COUNTIF=function(e,t){if(e=q(e),t===void 0||t==="*")return e.length;let a=0;const h=mt(t+"");for(let N=0;N<e.length;N++){const H=[dt(e[N],it)].concat(h);gt(H)&&a++}return a},j.COUNTIFS=function(){const e=O(arguments),t=new Array(q(e[0]).length);for(let h=0;h<t.length;h++)t[h]=!0;for(let h=0;h<e.length;h+=2){const N=q(e[h]),H=e[h+1];if(H!==void 0&&H!=="*"){const z=mt(H+"");for(let oe=0;oe<N.length;oe++){const de=[dt(N[oe],it)].concat(z);t[oe]=t[oe]&&gt(de)}}}let a=0;for(let h=0;h<t.length;h++)t[h]&&a++;return a},j.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},j.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},j.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},j.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},j.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},j.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},j.COVAR=Nn,j.COVARIANCE=V,j.COVARIANCEP=Tn,j.COVARIANCES=In,j.CRITBINOM=Dn,j.CSC=function(e){return(e=Y(e))instanceof Error?e:e===0?b:1/Math.sin(e)},j.CSCH=function(e){return(e=Y(e))instanceof Error?e:e===0?b:2/(Math.exp(e)-Math.exp(-e))},j.CUMIPMT=function(e,t,a,h,N,H){if(ie(e=Y(e),t=Y(t),a=Y(a)))return o;if(e<=0||t<=0||a<=0||h<1||N<1||h>N||H!==0&&H!==1)return p;const z=Dt(e,t,a,0,H);let oe=0;h===1&&(H===0&&(oe=-a),h++);for(let de=h;de<=N;de++)oe+=H===1?Nt(e,de-2,z,a,1)-z:Nt(e,de-1,z,a,0);return oe*=e,oe},j.CUMPRINC=function(e,t,a,h,N,H){if(ie(e=Y(e),t=Y(t),a=Y(a)))return o;if(e<=0||t<=0||a<=0||h<1||N<1||h>N||H!==0&&H!==1)return p;const z=Dt(e,t,a,0,H);let oe=0;h===1&&(oe=H===0?z+a*e:z,h++);for(let de=h;de<=N;de++)oe+=H>0?z-(Nt(e,de-2,z,a,1)-z)*e:z-Nt(e,de-1,z,a,0)*e;return oe},j.DATE=function(e,t,a){let h;return ie(e=Y(e),t=Y(t),a=Y(a))?h=o:(h=new Date(e,t-1,a),h.getFullYear()<0&&(h=p)),h},j.DATEDIF=It,j.DATEVALUE=function(e){if(typeof e!="string")return o;const t=Date.parse(e);return isNaN(t)?o:new Date(e)},j.DAVERAGE=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);let H=0;return M(h,z=>{H+=N[z]}),h.length===0?b:H/h.length},j.DAY=function(e){const t=He(e);return t instanceof Error?t:t.getDate()},j.DAYS=Lt,j.DAYS360=wt,j.DB=function(e,t,a,h,N){if(N=N===void 0?12:N,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N)))return o;if(e<0||t<0||a<0||h<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(N)===-1||h>a)return p;if(t>=e)return 0;const H=(1-Math.pow(t/e,1/a)).toFixed(3),z=e*H*N/12;let oe=z,de=0;const Ce=h===a?a-1:h;for(let ke=2;ke<=Ce;ke++)de=(e-oe)*H,oe+=de;return h===1?z:h===a?(e-oe)*H:de},j.DBCS=function(){throw new Error("DBCS is not implemented")},j.DCOUNT=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);const H=[];return M(h,z=>{H.push(N[z])}),ee(H)},j.DCOUNTA=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);const H=[];return M(h,z=>{H.push(N[z])}),F(H)},j.DDB=function(e,t,a,h,N){if(N=N===void 0?2:N,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N)))return o;if(e<0||t<0||a<0||h<0||N<=0||h>a)return p;if(t>=e)return 0;let H=0,z=0;for(let oe=1;oe<=h;oe++)z=Math.min(N/a*(e-H),e-t-H),H+=z;return z},j.DEC2BIN=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return p;if(e<0)return"1"+vt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const a=parseInt(e,10).toString(2);return t===void 0?a:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=a.length?vt("0",t-a.length)+a:p},j.DEC2HEX=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return p;if(e<0)return(1099511627776+e).toString(16);const a=parseInt(e,10).toString(16);return t===void 0?a:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=a.length?vt("0",t-a.length)+a:p},j.DEC2OCT=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return p;if(e<0)return(1073741824+e).toString(8);const a=parseInt(e,10).toString(8);return t===void 0?a:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=a.length?vt("0",t-a.length)+a:p},j.DECIMAL=function(e,t){return arguments.length<1?o:me(e=Y(e),t=Y(t))||(t===0?p:parseInt(e,t))},j.DEGREES=function(e){return(e=Y(e))instanceof Error?e:180*e/Math.PI},j.DELTA=function(e,t){return t=t===void 0?0:t,ie(e=Y(e),t=Y(t))?o:e===t?1:0},j.DEVSQ=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=f.mean(e);let a=0;for(let h=0;h<e.length;h++)a+=Math.pow(e[h]-t,2);return a},j.DGET=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];return N=se(typeof t=="string"?e[Le(e,t)]:e[t]),h.length===0?o:h.length>1?p:N[h[0]]},j.DISC=function(e,t,a,h,N){if(ie(e=He(e),t=He(t),a=Y(a),h=Y(h),N=(N=Y(N))||0))return o;if(a<=0||h<=0)return p;if(e>=t)return o;let H,z;switch(N){case 0:H=360,z=wt(e,t,!1);break;case 1:case 3:H=365,z=It(e,t,"D");break;case 2:H=360,z=It(e,t,"D");break;case 4:H=360,z=wt(e,t,!0);break;default:return p}return(h-a)/h*H/z},j.DMAX=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);let H=N[h[0]];return M(h,z=>{H<N[z]&&(H=N[z])}),H},j.DMIN=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);let H=N[h[0]];return M(h,z=>{H>N[z]&&(H=N[z])}),H},j.DOLLAR=function(e,t=2){if(e=Y(e),isNaN(e))return o;const a={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},h=(e=xt(e,t)).toLocaleString("en-US",a);return e<0?"$("+h.slice(2)+")":h},j.DOLLARDE=function(e,t){if(ie(e=Y(e),t=Y(t)))return o;if(t<0)return p;if(t>=0&&t<1)return b;t=parseInt(t,10);let a=parseInt(e,10);a+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const h=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return a=Math.round(a*h)/h,a},j.DOLLARFR=function(e,t){if(ie(e=Y(e),t=Y(t)))return o;if(t<0)return p;if(t>=0&&t<1)return b;t=parseInt(t,10);let a=parseInt(e,10);return a+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,a},j.DPRODUCT=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const oe=Le(e,t);N=se(e[oe])}else N=se(e[t]);let H=[];M(h,oe=>{H.push(N[oe])}),H=Jt(H);let z=1;return M(H,oe=>{z*=oe}),z},j.DSTDEV=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);let H=[];return M(h,z=>{H.push(N[z])}),H=Jt(H),ve.S(H)},j.DSTDEVP=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);let H=[];return M(h,z=>{H.push(N[z])}),H=Jt(H),ve.P(H)},j.DSUM=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);const H=[];return M(h,z=>{H.push(N[z])}),At(H)},j.DURATION=function(){throw new Error("DURATION is not implemented")},j.DVAR=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);const H=[];return M(h,z=>{H.push(N[z])}),Fe.S(H)},j.DVARP=function(e,t,a){if(isNaN(t)&&typeof t!="string")return o;const h=yt(e,a);let N=[];if(typeof t=="string"){const z=Le(e,t);N=se(e[z])}else N=se(e[t]);const H=[];return M(h,z=>{H.push(N[z])}),Fe.P(H)},j.EDATE=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?o:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},j.EFFECT=function(e,t){return ie(e=Y(e),t=Y(t))?o:e<=0||t<1?p:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},j.EOMONTH=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?o:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},j.ERF=Xt,j.ERFC=Gt,j.ERFCPRECISE=Sn,j.ERFPRECISE=Fn,j.ERROR=St,j.EVEN=function(e){return(e=Y(e))instanceof Error?e:Oe(e,-2,-1)},j.EXACT=function(e,t){return arguments.length!==2?C:me(e,t)||(e=qe(e))===qe(t)},j.EXP=function(e){return arguments.length<1?C:arguments.length>1?T:(e=Y(e))instanceof Error?e:e=Math.exp(e)},j.EXPON=G,j.EXPONDIST=On,j.F=ne,j.FACT=ot,j.FACTDOUBLE=function e(t){if((t=Y(t))instanceof Error)return t;const a=Math.floor(t);return a<=0?1:a*e(a-2)},j.FALSE=function(){return!1},j.FDIST=kn,j.FDISTRT=Rn,j.FIND=function(e,t,a){if(arguments.length<2)return C;e=qe(e),a=a===void 0?0:a;const h=(t=qe(t)).indexOf(e,a-1);return h===-1?o:h+1},j.FINV=Hn,j.FINVRT=Bn,j.FISHER=function(e){return(e=Y(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},j.FISHERINV=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},j.FIXED=sn,j.FLOOR=ft,j.FLOORMATH=Pn,j.FLOORPRECISE=_n,j.FORECAST=ge,j.FREQUENCY=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return o;const a=e.length,h=t.length,N=[];for(let H=0;H<=h;H++){N[H]=0;for(let z=0;z<a;z++)H===0?e[z]<=t[0]&&(N[0]+=1):H<h?e[z]>t[H-1]&&e[z]<=t[H]&&(N[H]+=1):H===h&&e[z]>t[h-1]&&(N[h]+=1)}return N},j.FTEST=Vn,j.FV=Nt,j.FVSCHEDULE=function(e,t){if(ie(e=Y(e),t=Me(q(t))))return o;const a=t.length;let h=e;for(let N=0;N<a;N++)h*=1+t[N];return h},j.GAMMA=ce,j.GAMMADIST=qn,j.GAMMAINV=Yn,j.GAMMALN=fe,j.GAMMALNPRECISE=Un,j.GAUSS=function(e){return(e=Y(e))instanceof Error?e:f.normal.cdf(e,0,1)-.5},j.GCD=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=e.length,a=e[0];let h=a<0?-a:a;for(let N=1;N<t;N++){const H=e[N];let z=H<0?-H:H;for(;h&&z;)h>z?h%=z:z%=h;h+=z}return h},j.GEOMEAN=function(){const e=Me(q(arguments));return e instanceof Error?e:f.geomean(e)},j.GESTEP=function(e,t){return ie(t=t||0,e=Y(e))?e:e>=t?1:0},j.GROWTH=function(e,t,a,h){if((e=Me(e))instanceof Error)return e;let N;if(t===void 0)for(t=[],N=1;N<=e.length;N++)t.push(N);if(a===void 0)for(a=[],N=1;N<=e.length;N++)a.push(N);if(ie(t=Me(t),a=Me(a)))return o;h===void 0&&(h=!0);const H=e.length;let z,oe,de=0,Ce=0,ke=0,Ye=0;for(N=0;N<H;N++){const We=t[N],Qe=Math.log(e[N]);de+=We,Ce+=Qe,ke+=We*Qe,Ye+=We*We}de/=H,Ce/=H,ke/=H,Ye/=H,h?(z=(ke-de*Ce)/(Ye-de*de),oe=Ce-z*de):(z=ke/Ye,oe=0);const Pe=[];for(N=0;N<a.length;N++)Pe.push(Math.exp(oe+z*a[N]));return Pe},j.HARMEAN=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=e.length;let a=0;for(let h=0;h<t;h++)a+=1/e[h];return t/a},j.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return p;const a=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),h=a?parseInt(e,16)-1099511627776:parseInt(e,16);if(h<-512||h>511)return p;if(a)return"1"+vt("0",9-(512+h).toString(2).length)+(512+h).toString(2);const N=h.toString(2);return t===void 0?N:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=N.length?vt("0",t-N.length)+N:p},j.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return p;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},j.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return p;const a=parseInt(e,16);if(a>536870911&&a<0xffe0000000)return p;if(a>=0xffe0000000)return(a-0xffc0000000).toString(8);const h=a.toString(8);return t===void 0?h:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=h.length?vt("0",t-h.length)+h:p},j.HLOOKUP=function(e,t,a,h){return Rt(e,be(t),a,h)},j.HOUR=function(e){return(e=He(e))instanceof Error?e:e.getHours()},j.HYPGEOM=Ee,j.HYPGEOMDIST=zn,j.IF=function(e,t,a){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(a=arguments.length===3&&a)==null&&(a=0),e?t:a)},j.IFERROR=function(e,t){return Et(e)?t:e},j.IFNA=function(e,t){return e===C?t:e},j.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return C},j.IMABS=$t,j.IMAGINARY=at,j.IMARGUMENT=Kt,j.IMCONJUGATE=function(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);return h=h==="i"||h==="j"?h:"i",a!==0?ht(t,-a,h):e},j.IMCOS=qt,j.IMCOSH=ln,j.IMCOT=function(e){return ie(st(e),at(e))?o:Mt(qt(e),Yt(e))},j.IMCSC=function(e){return e===!0||e===!1?o:ie(st(e),at(e))?p:Mt("1",Yt(e))},j.IMCSCH=function(e){return e===!0||e===!1?o:ie(st(e),at(e))?p:Mt("1",un(e))},j.IMDIV=Mt,j.IMEXP=function(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);h=h==="i"||h==="j"?h:"i";const N=Math.exp(t);return ht(N*Math.cos(a),N*Math.sin(a),h)},j.IMLN=function(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);return h=h==="i"||h==="j"?h:"i",ht(Math.log(Math.sqrt(t*t+a*a)),Math.atan(a/t),h)},j.IMLOG10=function(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);return h=h==="i"||h==="j"?h:"i",ht(Math.log(Math.sqrt(t*t+a*a))/Math.log(10),Math.atan(a/t)/Math.log(10),h)},j.IMLOG2=function(e){const t=st(e),a=at(e);if(ie(t,a))return o;let h=e.substring(e.length-1);return h=h==="i"||h==="j"?h:"i",ht(Math.log(Math.sqrt(t*t+a*a))/Math.log(2),Math.atan(a/t)/Math.log(2),h)},j.IMPOWER=function(e,t){if(ie(t=Y(t),st(e),at(e)))return o;let a=e.substring(e.length-1);a=a==="i"||a==="j"?a:"i";const h=Math.pow($t(e),t),N=Kt(e);return ht(h*Math.cos(t*N),h*Math.sin(t*N),a)},j.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return o;for(let t=1;t<arguments.length;t++){const a=st(e),h=at(e),N=st(arguments[t]),H=at(arguments[t]);if(ie(a,h,N,H))return o;e=ht(a*N-h*H,a*H+h*N)}return e},j.IMREAL=st,j.IMSEC=function(e){return e===!0||e===!1||ie(st(e),at(e))?o:Mt("1",qt(e))},j.IMSECH=function(e){return ie(st(e),at(e))?o:Mt("1",ln(e))},j.IMSIN=Yt,j.IMSINH=un,j.IMSQRT=function(e){if(ie(st(e),at(e)))return o;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const a=Math.sqrt($t(e)),h=Kt(e);return ht(a*Math.cos(h/2),a*Math.sin(h/2),t)},j.IMSUB=function(e,t){const a=st(e),h=at(e),N=st(t),H=at(t);if(ie(a,h,N,H))return o;const z=e.substring(e.length-1),oe=t.substring(t.length-1);let de="i";return(z==="j"||oe==="j")&&(de="j"),ht(a-N,h-H,de)},j.IMSUM=function(){if(!arguments.length)return o;const e=q(arguments);let t=e[0];for(let a=1;a<e.length;a++){const h=st(t),N=at(t),H=st(e[a]),z=at(e[a]);if(ie(h,N,H,z))return o;t=ht(h+H,N+z)}return t},j.IMTAN=function(e){return e===!0||e===!1||ie(st(e),at(e))?o:Mt(Yt(e),qt(e))},j.INDEX=function(e,t,a){const h=me(e,t,a);if(h)return h;if(!Array.isArray(e))return o;const N=e.length>0&&!Array.isArray(e[0]);return N&&!a?(a=t,t=1):(a=a||1,t=t||1),a<0||t<0?o:N&&t===1&&a<=e.length?e[a-1]:t<=e.length&&a<=e[t-1].length?e[t-1][a-1]:g},j.INFO=function(){throw new Error("INFO is not implemented")},j.INT=function(e){return(e=Y(e))instanceof Error?e:Math.floor(e)},j.INTERCEPT=function(e,t){return ie(e=Me(e),t=Me(t))?o:e.length!==t.length?C:ge(0,e,t)},j.INTRATE=function(){throw new Error("INTRATE is not implemented")},j.IPMT=cn,j.IRR=function(e,t){if(t=t||0,ie(e=Me(q(e)),t=Y(t)))return o;const a=(Pe,We,Qe)=>{const rt=Qe+1;let jt=Pe[0];for(let ct=1;ct<Pe.length;ct++)jt+=Pe[ct]/Math.pow(rt,(We[ct]-We[0])/365);return jt},h=(Pe,We,Qe)=>{const rt=Qe+1;let jt=0;for(let ct=1;ct<Pe.length;ct++){const Ct=(We[ct]-We[0])/365;jt-=Ct*Pe[ct]/Math.pow(rt,Ct+1)}return jt},N=[];let H=!1,z=!1;for(let Pe=0;Pe<e.length;Pe++)N[Pe]=Pe===0?0:N[Pe-1]+365,e[Pe]>0&&(H=!0),e[Pe]<0&&(z=!0);if(!H||!z)return p;let oe,de,Ce,ke=t=t===void 0?.1:t,Ye=!0;do Ce=a(e,N,ke),oe=ke-Ce/h(e,N,ke),de=Math.abs(oe-ke),ke=oe,Ye=de>1e-10&&Math.abs(Ce)>1e-10;while(Ye);return ke},j.ISBLANK=function(e){return e===null},j.ISERR=Ft,j.ISERROR=Et,j.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},j.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},j.ISLOGICAL=Ot,j.ISNA=function(e){return e===C},j.ISNONTEXT=function(e){return typeof e!="string"},j.ISNUMBER=Tt,j.ISO=nt,j.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},j.ISOWEEKNUM=tn,j.ISPMT=function(e,t,a,h){return ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h))?o:h*e*(t/a-1)},j.ISREF=function(){throw new Error("ISREF is not implemented")},j.ISTEXT=bt,j.KURT=function(){const e=Me(q(arguments));if(e instanceof Error)return e;const t=f.mean(e),a=e.length;let h=0;for(let N=0;N<a;N++)h+=Math.pow(e[N]-t,4);return h/=Math.pow(f.stdev(e,!0),4),a*(a+1)/((a-1)*(a-2)*(a-3))*h-3*(a-1)*(a-1)/((a-2)*(a-3))},j.LARGE=De,j.LCM=function(){const e=Me(q(arguments));if(e instanceof Error)return e;for(var t,a,h,N,H=1;(h=e.pop())!==void 0;){if(h===0)return 0;for(;h>1;){if(h%2){for(t=3,a=Math.floor(Math.sqrt(h));t<=a&&h%t;t+=2);N=t<=a?t:h}else N=2;for(h/=N,H*=N,t=e.length;t;e[--t]%N==0&&(e[t]/=N)==1&&e.splice(t,1));}}return H},j.LEFT=function(e,t){return me(e,t)||(e=qe(e),(t=Y(t=t===void 0?1:t))instanceof Error||typeof e!="string"?o:e.substring(0,t))},j.LEN=function(e){return arguments.length===0?T:e instanceof Error?e:Array.isArray(e)?o:qe(e).length},j.LINEST=Se,j.LN=function(e){return(e=Y(e))instanceof Error?e:e===0?p:Math.log(e)},j.LOG=function(e,t){return me(e=Y(e),t=Y(t))||(e===0||t===0?p:Math.log(e)/Math.log(t))},j.LOG10=function(e){return(e=Y(e))instanceof Error?e:e===0?p:Math.log(e)/Math.log(10)},j.LOGEST=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t)))||e.length!==t.length)return o;for(let h=0;h<e.length;h++)e[h]=Math.log(e[h]);const a=Se(e,t);return a[0]=Math.round(1e6*Math.exp(a[0]))/1e6,a[1]=Math.round(1e6*Math.exp(a[1]))/1e6,a},j.LOGINV=Wn,j.LOGNORM=Ue,j.LOGNORMDIST=Xn,j.LOGNORMINV=Gn,j.LOOKUP=function(e,t,a){t=q(t),a=a?q(a):t;const h=typeof e=="number";let N=C;for(let H=0;H<t.length;H++){if(t[H]===e)return a[H];if(h&&t[H]<=e||typeof t[H]=="string"&&t[H].localeCompare(e)<0)N=a[H];else if(h&&t[H]>e)return N}return N},j.LOWER=function(e){return arguments.length!==1?o:ie(e=qe(e))?e:e.toLowerCase()},j.MATCH=function(e,t,a){if(!e||!t||(arguments.length===2&&(a=1),!((t=q(t))instanceof Array))||a!==-1&&a!==0&&a!==1)return C;let h,N;for(let H=0;H<t.length;H++)if(a===1){if(t[H]===e)return H+1;t[H]<e&&(N?t[H]>N&&(h=H+1,N=t[H]):(h=H+1,N=t[H]))}else if(a===0){if(typeof e=="string"&&typeof t[H]=="string"){const z=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+z+"$").test(t[H].toLowerCase()))return H+1}else if(t[H]===e)return H+1}else if(a===-1){if(t[H]===e)return H+1;t[H]>e&&(N?t[H]<N&&(h=H+1,N=t[H]):(h=H+1,N=t[H]))}return h||C},j.MAX=$e,j.MAXA=function(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;let a=D(e);return a=a.map(h=>h??0),a.length===0?0:Math.max.apply(Math,a)},j.MDURATION=function(){throw new Error("MDURATION is not implemented")},j.MEDIAN=Q,j.MID=function(e,t,a){if(t==null)return o;if(ie(t=Y(t),a=Y(a))||typeof e!="string")return a;const h=t-1,N=h+a;return e.substring(h,N)},j.MIN=pe,j.MINA=function(){const e=q(arguments),t=me.apply(void 0,e);if(t)return t;let a=D(e);return a=a.map(h=>h??0),a.length===0?0:Math.min.apply(Math,a)},j.MINUTE=function(e){return(e=He(e))instanceof Error?e:e.getMinutes()},j.MIRR=function(e,t,a){if(ie(e=Me(q(e)),t=Y(t),a=Y(a)))return o;const h=e.length,N=[],H=[];for(let de=0;de<h;de++)e[de]<0?N.push(e[de]):H.push(e[de]);const z=-en(a,H)*Math.pow(1+a,h-1),oe=en(t,N)*(1+t);return Math.pow(z/oe,1/(h-1))-1},j.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(a=>!a.length)||t.some(a=>!a.length)||ae(e).some(a=>typeof a!="number")||ae(t).some(a=>typeof a!="number")||e[0].length!==t.length?o:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((a,h)=>a.map((N,H)=>e[h].reduce((z,oe,de)=>z+oe*t[de][H],0)))},j.MOD=function(e,t){const a=me(e=Y(e),t=Y(t));if(a)return a;if(t===0)return b;let h=Math.abs(e%t);return h=e<0?t-h:h,t>0?h:-h},j.MODE=we,j.MODEMULT=$n,j.MODESNGL=Kn,j.MONTH=function(e){return(e=He(e))instanceof Error?e:e.getMonth()+1},j.MROUND=function(e,t){return me(e=Y(e),t=Y(t))||(e*t==0?0:e*t<0?p:Math.round(e/t)*t)},j.MULTINOMIAL=function(){const e=Me(q(arguments));if(e instanceof Error)return e;let t=0,a=1;for(let h=0;h<e.length;h++)t+=e[h],a*=ot(e[h]);return ot(t)/a},j.MUNIT=function(e){return arguments.length>1?C:!(e=parseInt(e))||e<=0?o:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,a)=>(t[a]=1,t))},j.N=function(e){return Tt(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Et(e)?e:0},j.NA=function(){return C},j.NEGBINOM=U,j.NEGBINOMDIST=Jn,j.NETWORKDAYS=Pt,j.NETWORKDAYSINTL=Zn,j.NOMINAL=function(e,t){return ie(e=Y(e),t=Y(t))?o:e<=0||t<1?p:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},j.NORM=J,j.NORMDIST=Qn,j.NORMINV=er,j.NORMSDIST=tr,j.NORMSINV=nr,j.NOT=function(e){return typeof e=="string"?o:e instanceof Error?e:!e},j.NOW=function(){return new Date},j.NPER=function(e,t,a,h,N){if(N=N===void 0?0:N,h=h===void 0?0:h,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N)))return o;if(e===0)return-(a+h)/t;{const H=t*(1+e*N)-h*e,z=a*e+t*(1+e*N);return Math.log(H/z)/Math.log(1+e)}},j.NPV=en,j.NUMBERVALUE=function(e,t,a){return typeof(e=Ze(e)?e:"")=="number"?e:typeof e!="string"?C:(t=t===void 0?".":t,a=a===void 0?",":a,Number(e.replace(t,".").replace(a,"")))},j.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return p;const a=!(e.length!==10||e.substring(0,1)!=="7"),h=a?parseInt(e,8)-1073741824:parseInt(e,8);if(h<-512||h>511)return p;if(a)return"1"+vt("0",9-(512+h).toString(2).length)+(512+h).toString(2);const N=h.toString(2);return t===void 0?N:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=N.length?vt("0",t-N.length)+N:p},j.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return p;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},j.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return p;const a=parseInt(e,8);if(a>=536870912)return"ff"+(a+3221225472).toString(16);const h=a.toString(16);return t===void 0?h:isNaN(t)?o:t<0?p:(t=Math.floor(t))>=h.length?vt("0",t-h.length)+h:p},j.ODD=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},j.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},j.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},j.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},j.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},j.OR=function(){const e=q(arguments);let t=o;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===o&&(t=!1),e[a]&&(t=!0))}return t},j.PDURATION=function(e,t,a){return ie(e=Y(e),t=Y(t),a=Y(a))?o:e<=0?p:(Math.log(a)-Math.log(t))/Math.log(1+e)},j.PEARSON=v,j.PERCENTILE=S,j.PERCENTILEEXC=rr,j.PERCENTILEINC=or,j.PERCENTRANK=X,j.PERCENTRANKEXC=ir,j.PERCENTRANKINC=ar,j.PERMUT=function(e,t){return ie(e=Y(e),t=Y(t))?o:ot(e)/ot(e-t)},j.PERMUTATIONA=function(e,t){return ie(e=Y(e),t=Y(t))?o:Math.pow(e,t)},j.PHI=function(e){return(e=Y(e))instanceof Error?o:Math.exp(-.5*e*e)/2.5066282746310002},j.PI=function(){return Math.PI},j.PMT=Dt,j.POISSON=ue,j.POISSONDIST=sr,j.POWER=ut,j.PPMT=function(e,t,a,h,N,H){return N=N||0,H=H||0,ie(e=Y(e),a=Y(a),h=Y(h),N=Y(N),H=Y(H))?o:Dt(e,a,h,N,H)-cn(e,t,a,h,N,H)},j.PRICE=function(){throw new Error("PRICE is not implemented")},j.PRICEDISC=function(e,t,a,h,N){if(ie(e=He(e),t=He(t),a=Y(a),h=Y(h),N=(N=Y(N))||0))return o;if(a<=0||h<=0)return p;if(e>=t)return o;let H,z;switch(N){case 0:H=360,z=wt(e,t,!1);break;case 1:case 3:H=365,z=It(e,t,"D");break;case 2:H=360,z=It(e,t,"D");break;case 4:H=360,z=wt(e,t,!0);break;default:return p}return h-a*h*z/H},j.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},j.PROB=function(e,t,a,h){if(a===void 0)return 0;if(h=h===void 0?a:h,ie(e=Me(q(e)),t=Me(q(t)),a=Y(a),h=Y(h)))return o;if(a===h)return e.indexOf(a)>=0?t[e.indexOf(a)]:0;const N=e.sort((oe,de)=>oe-de),H=N.length;let z=0;for(let oe=0;oe<H;oe++)N[oe]>=a&&N[oe]<=h&&(z+=t[e.indexOf(N[oe])]);return z},j.PRODUCT=Xe,j.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},j.PROPER=function(e){return ie(e)?e:isNaN(e)&&typeof e=="number"?o:(e=qe(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},j.PV=function(e,t,a,h,N){return h=h||0,N=N||0,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N))?o:e===0?-a*t-h:((1-Math.pow(1+e,t))/e*a*(1+e*N)-h)/Math.pow(1+e,t)},j.QUARTILE=K,j.QUARTILEEXC=lr,j.QUARTILEINC=ur,j.QUOTIENT=function(e,t){return me(e=Y(e),t=Y(t))||parseInt(e/t,10)},j.RADIANS=function(e){return(e=Y(e))instanceof Error?e:e*Math.PI/180},j.RAND=function(){return Math.random()},j.RANDBETWEEN=function(e,t){return me(e=Y(e),t=Y(t))||e+Math.ceil((t-e+1)*Math.random())-1},j.RANK=le,j.RANKAVG=cr,j.RANKEQ=dr,j.RATE=function(e,t,a,h,N,H){if(H=H===void 0?.01:H,h=h===void 0?0:h,N=N===void 0?0:N,ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h),N=Y(N),H=Y(H)))return o;const z=1e-10;let oe=H;N=N?1:0;for(let de=0;de<20;de++){if(oe<=-1)return p;let Ce,ke,Ye;if(Math.abs(oe)<z?Ce=a*(1+e*oe)+t*(1+oe*N)*e+h:(ke=Math.pow(1+oe,e),Ce=a*ke+t*(1/oe+N)*(ke-1)+h),Math.abs(Ce)<z)return oe;if(Math.abs(oe)<z)Ye=a*e+t*N*e;else{ke=Math.pow(1+oe,e);const Pe=e*Math.pow(1+oe,e-1);Ye=a*Pe+t*(1/oe+N)*Pe+t*(-1/(oe*oe))*(ke-1)}oe-=Ce/Ye}return oe},j.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},j.REPLACE=function(e,t,a,h){return ie(t=Y(t),a=Y(a))||typeof e!="string"||typeof h!="string"?o:e.substr(0,t-1)+h+e.substr(t-1+a)},j.REPT=vt,j.RIGHT=function(e,t){return me(e,t)||(e=qe(e),(t=Y(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},j.ROMAN=function(e){if((e=Y(e))instanceof Error)return e;const t=String(e).split(""),a=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let h="",N=3;for(;N--;)h=(a[+t.pop()+10*N]||"")+h;return new Array(+t.join("")+1).join("M")+h},j.ROUND=xt,j.ROUNDDOWN=function(e,t){return me(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},j.ROUNDUP=function(e,t){return me(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},j.ROW=function(e,t){return arguments.length!==2?C:t<0?p:e instanceof Array&&typeof t=="number"?e.length!==0?f.row(e,t):void 0:o},j.ROWS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:f.rows(e):o},j.RRI=function(e,t,a){return ie(e=Y(e),t=Y(t),a=Y(a))?o:e===0||t===0?p:Math.pow(a/t,1/e)-1},j.RSQ=function(e,t){return ie(e=Me(q(e)),t=Me(q(t)))?o:Math.pow(v(e,t),2)},j.SEARCH=function(e,t,a){let h;return typeof e!="string"||typeof t!="string"?o:(a=a===void 0?0:a,h=t.toLowerCase().indexOf(e.toLowerCase(),a-1)+1,h===0?o:h)},j.SEC=function(e){return(e=Y(e))instanceof Error?e:1/Math.cos(e)},j.SECH=function(e){return(e=Y(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},j.SECOND=function(e){return(e=He(e))instanceof Error?e:e.getSeconds()},j.SERIESSUM=function(e,t,a,h){if(ie(e=Y(e),t=Y(t),a=Y(a),h=Me(h)))return o;let N=h[0]*Math.pow(e,t);for(let H=1;H<h.length;H++)N+=h[H]*Math.pow(e,t+H*a);return N},j.SHEET=function(){throw new Error("SHEET is not implemented")},j.SHEETS=function(){throw new Error("SHEETS is not implemented")},j.SIGN=function(e){return(e=Y(e))instanceof Error?e:e<0?-1:e===0?0:1},j.SIN=function(e){return(e=Y(e))instanceof Error?e:Math.sin(e)},j.SINH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},j.SKEW=je,j.SKEWP=fr,j.SLN=function(e,t,a){return ie(e=Y(e),t=Y(t),a=Y(a))?o:a===0?p:(e-t)/a},j.SLOPE=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return o;const a=f.mean(t),h=f.mean(e),N=t.length;let H=0,z=0;for(let oe=0;oe<N;oe++)H+=(t[oe]-a)*(e[oe]-h),z+=Math.pow(t[oe]-a,2);return H/z},j.SMALL=Te,j.SORT=function(e,t=1,a=1,h=!1){if(!e||!Array.isArray(e))return C;if(e.length===0)return 0;if(!(t=Y(t))||t<1||(a=Y(a))!==1&&a!==-1)return o;if(typeof(h=Be(h))!="boolean")return m;const N=oe=>oe.sort((de,Ce)=>(de=qe(de[t-1]),Ce=qe(Ce[t-1]),a===1?de<Ce?-1*a:a:de>Ce?a:-1*a)),H=Z(e),z=h?be(H):H;return t>=1&&t<=z[0].length?h?be(N(z)):N(z):o},j.SQRT=function(e){return(e=Y(e))instanceof Error?e:e<0?p:Math.sqrt(e)},j.SQRTPI=function(e){return(e=Y(e))instanceof Error?e:Math.sqrt(e*Math.PI)},j.STANDARDIZE=function(e,t,a){return ie(e=Y(e),t=Y(t),a=Y(a))?o:(e-t)/a},j.STDEV=ve,j.STDEVA=function(){const e=tt.apply(this,arguments);return Math.sqrt(e)},j.STDEVP=pr,j.STDEVPA=function(){const e=re.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=p),t},j.STDEVS=hr,j.STEYX=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return o;const a=f.mean(t),h=f.mean(e),N=t.length;let H=0,z=0,oe=0;for(let de=0;de<N;de++)H+=Math.pow(e[de]-h,2),z+=(t[de]-a)*(e[de]-h),oe+=Math.pow(t[de]-a,2);return Math.sqrt((H-z*z/oe)/(N-2))},j.SUBSTITUTE=function(e,t,a,h){if(arguments.length<3)return C;if(e&&t){if(h===void 0)return e.split(t).join(a);{if(h=Math.floor(Number(h)),Number.isNaN(h)||h<=0)return o;let N=0,H=0;for(;N>-1&&e.indexOf(t,N)>-1;)if(N=e.indexOf(t,N+1),H++,N>-1&&H===h)return e.substring(0,N)+a+e.substring(N+t.length);return e}}return e},j.SUBTOTAL=function(e,t){if((e=Y(e))instanceof Error)return e;switch(e){case 1:case 101:return w(t);case 2:case 102:return ee(t);case 3:case 103:return F(t);case 4:case 104:return $e(t);case 5:case 105:return pe(t);case 6:case 106:return Xe(t);case 7:case 107:return ve.S(t);case 8:case 108:return ve.P(t);case 9:case 109:return At(t);case 10:case 110:return Fe.S(t);case 11:case 111:return Fe.P(t)}},j.SUM=At,j.SUMIF=function(e,t,a){if(e=q(e),a=a?q(a):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let h=0;const N=t==="*",H=N?null:mt(t+"");for(let z=0;z<e.length;z++){const oe=e[z],de=a[z];if(N)h+=oe;else{const Ce=[dt(oe,it)].concat(H);h+=gt(Ce)?de:0}}return h},j.SUMIFS=function(){const e=O(arguments),t=Me(q(e.shift()));if(t instanceof Error)return t;const a=e,h=a.length/2;for(let H=0;H<h;H++)a[2*H]=q(a[2*H]);let N=0;for(let H=0;H<t.length;H++){let z=!1;for(let oe=0;oe<h;oe++){const de=a[2*oe][H],Ce=a[2*oe+1];let ke=!1;if(Ce===void 0||Ce==="*")ke=!0;else{const Ye=mt(Ce+""),Pe=[dt(de,it)].concat(Ye);ke=gt(Pe)}if(!ke){z=!1;break}z=!0}z&&(N+=t[H])}return N},j.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return o;const e=arguments.length+1;let t,a,h,N,H=0;for(let z=0;z<arguments[0].length;z++)if(arguments[0][z]instanceof Array)for(let oe=0;oe<arguments[0][z].length;oe++){for(t=1,a=1;a<e;a++){const de=arguments[a-1][z][oe];if(de instanceof Error)return de;if(N=Y(de),N instanceof Error)return N;t*=N}H+=t}else{for(t=1,a=1;a<e;a++){const oe=arguments[a-1][z];if(oe instanceof Error)return oe;if(h=Y(oe),h instanceof Error)return h;t*=h}H+=t}return H},j.SUMSQ=function(){const e=Me(q(arguments));if(e instanceof Error)return e;let t=0;const a=e.length;for(let h=0;h<a;h++)t+=Tt(e[h])?e[h]*e[h]:0;return t},j.SUMX2MY2=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return o;let a=0;for(let h=0;h<e.length;h++)a+=e[h]*e[h]-t[h]*t[h];return a},j.SUMX2PY2=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return o;let a=0;e=Me(q(e)),t=Me(q(t));for(let h=0;h<e.length;h++)a+=e[h]*e[h]+t[h]*t[h];return a},j.SUMXMY2=function(e,t){if(ie(e=Me(q(e)),t=Me(q(t))))return o;let a=0;e=q(e),t=q(t);for(let h=0;h<e.length;h++)a+=Math.pow(e[h]-t[h],2);return a},j.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],a=arguments.length-1,h=Math.floor(a/2);let N=!1;const H=a%2!=0,z=a%2==0?null:arguments[arguments.length-1];if(h){for(let oe=0;oe<h;oe++)if(t===arguments[2*oe+1]){e=arguments[2*oe+2],N=!0;break}}N||(e=H?z:C)}else e=o;return e},j.SYD=function(e,t,a,h){return ie(e=Y(e),t=Y(t),a=Y(a),h=Y(h))?o:a===0||h<1||h>a?p:(e-t)*(a-(h=parseInt(h,10))+1)*2/(a*(a+1))},j.T=function(e){return e instanceof Error||typeof e=="string"?e:""},j.TAN=function(e){return(e=Y(e))instanceof Error?e:Math.tan(e)},j.TANH=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},j.TBILLEQ=function(e,t,a){return ie(e=He(e),t=He(t),a=Y(a))?o:a<=0||e>t||t-e>31536e6?p:365*a/(360-a*wt(e,t,!1))},j.TBILLPRICE=function(e,t,a){return ie(e=He(e),t=He(t),a=Y(a))?o:a<=0||e>t||t-e>31536e6?p:100*(1-a*wt(e,t,!1)/360)},j.TBILLYIELD=function(e,t,a){return ie(e=He(e),t=He(t),a=Y(a))?o:a<=0||e>t||t-e>31536e6?p:360*(100-a)/(a*wt(e,t,!1))},j.TDIST=gr,j.TDISTRT=br,j.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return C;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return o;const a=t.startsWith("$")?"$":"",h=t.endsWith("%");return h&&(e*=100),e=(e=sn(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+a+(e=e.replace("-","")):a+e,h&&(e+="%"),e},j.TEXTJOIN=function(e,t,...a){if(typeof t!="boolean"&&(t=Be(t)),arguments.length<3)return C;e=e??"";let h=q(a),N=t?h.filter(H=>H):h;if(Array.isArray(e)){e=q(e);let H=N.map(oe=>[oe]),z=0;for(let oe=0;oe<H.length-1;oe++)H[oe].push(e[z]),z++,z===e.length&&(z=0);return N=q(H),N.join("")}return N.join(e)},j.TIME=function(e,t,a){return ie(e=Y(e),t=Y(t),a=Y(a))?o:e<0||t<0||a<0?p:(3600*e+60*t+a)/86400},j.TIMEVALUE=function(e){return(e=He(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},j.TINV=mr,j.TODAY=function(){return Bt(new Date)},j.TRANSPOSE=function(e){return e?be(Z(e)):C},j.TREND=function(e,t,a){if(ie(e=Me(q(e)),t=Me(q(t)),a=Me(q(a))))return o;const h=Se(e,t),N=h[0],H=h[1],z=[];return a.forEach(oe=>{z.push(N*oe+H)}),z},j.TRIM=function(e){return(e=qe(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},j.TRIMMEAN=function(e,t){if(ie(e=Me(q(e)),t=Y(t)))return o;const a=ft(e.length*t,2)/2;return f.mean((N=(N=a)||1,(h=se(e.sort((H,z)=>H-z),a))&&typeof h.slice=="function"?h.slice(0,h.length-N):h));var h,N},j.TRUE=function(){return!0},j.TRUNC=function(e,t){return me(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},j.TTEST=jr,j.TYPE=function(e){return Tt(e)?1:bt(e)?2:Ot(e)?4:Et(e)?16:Array.isArray(e)?64:void 0},j.UNICHAR=bn,j.UNICODE=mn,j.UNIQUE=kt,j.UPPER=function(e){return(e=qe(e))instanceof Error?e:e.toUpperCase()},j.VALUE=function(e){const t=me(e);if(t)return t;if(typeof e=="number")return e;if(Ze(e)||(e=""),typeof e!="string")return o;const a=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let h=Number(e);return isNaN(h)?o:(h=h||0,a&&(h*=.01),h)},j.VAR=Fe,j.VARA=tt,j.VARP=vr,j.VARPA=re,j.VARS=yr,j.VDB=function(){throw new Error("VDB is not implemented")},j.VLOOKUP=Rt,j.WEEKDAY=function(e,t){if((e=He(e))instanceof Error)return e;t===void 0&&(t=1);const a=e.getDay();return hn[t][a]},j.WEEKNUM=function(e,t){if((e=He(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return tn(e);const a=pn[t];let h=new Date(e.getFullYear(),0,1);const N=h.getDay()<a?1:0;return h-=24*Math.abs(h.getDay()-a)*60*60*1e3,Math.floor((e-h)/864e5/7+1)+N},j.WEIBULL=ye,j.WEIBULLDIST=xr,j.WORKDAY=_t,j.WORKDAYINTL=wr,j.XIRR=function(e,t,a){if(ie(e=Me(q(e)),t=lt(q(t)),a=Y(a)))return o;const h=(Pe,We,Qe)=>{const rt=Qe+1;let jt=Pe[0];for(let ct=1;ct<Pe.length;ct++)jt+=Pe[ct]/Math.pow(rt,Lt(We[ct],We[0])/365);return jt},N=(Pe,We,Qe)=>{const rt=Qe+1;let jt=0;for(let ct=1;ct<Pe.length;ct++){const Ct=Lt(We[ct],We[0])/365;jt-=Ct*Pe[ct]/Math.pow(rt,Ct+1)}return jt};let H=!1,z=!1;for(let Pe=0;Pe<e.length;Pe++)e[Pe]>0&&(H=!0),e[Pe]<0&&(z=!0);if(!H||!z)return p;let oe,de,Ce,ke=a=a||.1,Ye=!0;do Ce=h(e,t,ke),oe=ke-Ce/N(e,t,ke),de=Math.abs(oe-ke),ke=oe,Ye=de>1e-10&&Math.abs(Ce)>1e-10;while(Ye);return ke},j.XNPV=function(e,t,a){if(ie(e=Y(e),t=Me(q(t)),a=lt(q(a))))return o;let h=0;for(let N=0;N<t.length;N++)h+=t[N]/Math.pow(1+e,Lt(a[N],a[0])/365);return h},j.XOR=function(){const e=q(arguments);let t=o;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===o&&(t=0),e[a]&&t++)}return t===o?t:!!(1&Math.floor(Math.abs(t)))},j.YEAR=function(e){return(e=He(e))instanceof Error?e:e.getFullYear()},j.YEARFRAC=zt,j.YIELD=function(){throw new Error("YIELD is not implemented")},j.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},j.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},j.Z=xe,j.ZTEST=Cr,j.utils=Er}},d={};function E(W){var j=d[W];if(j!==void 0)return j.exports;var u=d[W]={exports:{}};return c[W].call(u.exports,u,u.exports,E),u.exports}E.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var R=E(960);l=R}(),l)},44:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(463);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var l=(""+n)[0];return l=="="||l=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var l={};return n.mask?l.mask=n.mask:n.format?l.mask=n.format:(l.locale=n.locale,l.options=n.options),n.decimal&&(l.options||(l.options={}),l.options={decimal:n.decimal}),l}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var l=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(l=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var c=obj.options.persistance==1?obj.options.url:obj.options.persistance,d=obj.prepareJson(arguments[2]);obj.save(c,d)}return l},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var l=Object.keys(obj.options.data[0]);l.length>n&&(n=l.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var c=[],d=0;d<n;d++)obj.options.colHeaders[d]||(obj.options.colHeaders[d]=""),obj.options.colWidths[d]||(obj.options.colWidths[d]=obj.options.defaultColWidth),obj.options.colAlignments[d]||(obj.options.colAlignments[d]=obj.options.defaultColAlign),obj.options.columns[d]?obj.options.columns[d].type||(obj.options.columns[d].type="text"):obj.options.columns[d]={type:"text"},obj.options.columns[d].name||(obj.options.columns[d].name=l&&l[d]?l[d]:d),obj.options.columns[d].source||(obj.options.columns[d].source=[]),obj.options.columns[d].options||(obj.options.columns[d].options=[]),obj.options.columns[d].editor||(obj.options.columns[d].editor=null),obj.options.columns[d].allowEmpty||(obj.options.columns[d].allowEmpty=!1),obj.options.columns[d].title||(obj.options.columns[d].title=obj.options.colHeaders[d]?obj.options.colHeaders[d]:""),obj.options.columns[d].width||(obj.options.columns[d].width=obj.options.colWidths[d]?obj.options.colWidths[d]:obj.options.defaultColWidth),obj.options.columns[d].align||(obj.options.columns[d].align=obj.options.colAlignments[d]?obj.options.colAlignments[d]:"center"),obj.options.columns[d].type=="autocomplete"||obj.options.columns[d].type=="dropdown"?obj.options.columns[d].url&&c.push({url:obj.options.columns[d].url,index:d,method:"GET",dataType:"json",success:function(E){for(var R=0;R<E.length;R++)obj.options.columns[this.index].source.push(E[R])}}):obj.options.columns[d].type=="calendar"&&(obj.options.columns[d].options.format||(obj.options.columns[d].options.format="DD/MM/YYYY"));c.length?jSuites.ajax(c,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(m){obj.scrollControls(m)},obj.content.onwheel=function(m){obj.wheelControls(m)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),l=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(l),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var c=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var d=0;d<obj.options.paginationOptions.length;d++){var E=document.createElement("option");E.value=obj.options.paginationOptions[d],E.innerHTML=obj.options.paginationOptions[d],obj.paginationDropdown.appendChild(E)}obj.paginationDropdown.value=obj.options.pagination,c.appendChild(document.createTextNode(obj.options.text.show)),c.appendChild(obj.paginationDropdown),c.appendChild(document.createTextNode(obj.options.text.entries))}var R,W=document.createElement("div");if(W.classList.add("jexcel_filter"),W.appendChild(c),W.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(R=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(R),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var j=0;j<obj.options.nestedHeaders.length;j++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(R=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(R),d=0;d<obj.options.columns.length;d++)obj.createCellHeader(d),obj.headerContainer.appendChild(obj.headers[d]),obj.colgroupContainer.appendChild(obj.colgroup[d]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var u=document.createElement("td");for(obj.filter.appendChild(u),d=0;d<obj.options.columns.length;d++)(u=document.createElement("td")).innerHTML="&nbsp;",u.setAttribute("data-x",d),u.className="jexcel_column_filter",obj.options.columns[d].type=="hidden"&&(u.style.display="none"),obj.filter.appendChild(u);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var f=document.createElement("a");f.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var k=document.createElement("span");k.innerHTML="Jspreadsheet CE",f.appendChild(k),obj.ads.appendChild(f),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var P=document.createElement("div"),b=document.createElement("div");if(obj.pagination.appendChild(P),obj.pagination.appendChild(b),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(W),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var o=Object.keys(obj.options.classes);for(d=0;d<o.length;d++){var g=jexcel.getIdFromColumnName(o[d],!0);obj.records[g[1]][g[0]].classList.add(obj.options.classes[o[d]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var l=0;l<obj.options.data.length;l++){for(var c=[],d=0;d<obj.options.columns.length;d++)c[d]=obj.options.data[l][obj.options.columns[d].name];n.push(c)}obj.options.data=n}l=0,d=0;var E=obj.options.columns.length,R=obj.options.data.length,W=obj.options.minDimensions[0],j=obj.options.minDimensions[1],u=W>E?W:E,f=j>R?j:R;for(l=0;l<f;l++)for(d=0;d<u;d++)obj.options.data[l]==null&&(obj.options.data[l]=[]),obj.options.data[l][d]==null&&(obj.options.data[l][d]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var k=0,P=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,k=obj.options.pagination*obj.pageNumber,P=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<P&&(P=obj.options.data.length)):(k=0,P=obj.options.data.length);for(l=0;l<obj.options.data.length;l++){var b=obj.createRow(l,obj.options.data[l]);l>=k&&l<P&&obj.tbody.appendChild(b)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var o=Object.keys(obj.options.mergeCells);for(d=0;d<o.length;d++){var g=obj.options.mergeCells[o[d]];obj.setMerge(o[d],g[0],g[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,l){for(var c=[],d=0,E=0,R=l==1||obj.options.copyCompatibility==0,W=obj.options.columns.length,j=obj.options.data.length,u=0;u<j;u++){d=0;for(var f=0;f<W;f++)n&&!obj.records[u][f].classList.contains("highlight")||(c[E]||(c[E]=[]),c[E][d]=R?obj.options.data[u][f]:obj.records[u][f].innerHTML,d++);d>0&&E++}return c},obj.getJsonRow=function(n){for(var l=obj.options.data[n],c=obj.options.columns.length,d={},E=0;E<c;E++)obj.options.columns[E].name||(obj.options.columns[E].name=E),d[obj.options.columns[E].name]=l[E];return d},obj.getJson=function(n){for(var l=[],c=obj.options.columns.length,d=obj.options.data.length,E=0;E<d;E++){for(var R=null,W=0;W<c;W++)n&&!obj.records[E][W].classList.contains("highlight")||(R==null&&(R={}),obj.options.columns[W].name||(obj.options.columns[W].name=W),R[obj.options.columns[W].name]=obj.options.data[E][W]);R!=null&&l.push(R)}return l},obj.prepareJson=function(n){for(var l=[],c=0;c<n.length;c++){var d=n[c].x,E=n[c].y,R=obj.options.columns[d].name?obj.options.columns[d].name:d;l[E]||(l[E]={row:E,data:{}}),l[E].data[R]=n[c].newValue}return l.filter(function(W){return W!=null})},obj.save=function(n,l){var c=obj.dispatch("onbeforesave",el,obj,l);if(c)l=c;else if(c===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(l)},success:function(d){obj.dispatch("onsave",el,obj,l)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,l){for(var c=0;c<obj.headers.length;c++){var d=jexcel.getColumnNameFromId([c,n]);l[c]!=null&&obj.setValue(d,l[c])}},obj.getColumnData=function(n){for(var l=[],c=0;c<obj.options.data.length;c++)l.push(obj.options.data[c][n]);return l},obj.setColumnData=function(n,l){for(var c=0;c<obj.rows.length;c++){var d=jexcel.getColumnNameFromId([n,c]);l[c]!=null&&obj.setValue(d,l[c])}},obj.createRow=function(n,l){obj.records[n]||(obj.records[n]=[]),l||(l=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var c=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(c=obj.options.rows[n].title)),c||(c=parseInt(n+1));var d=document.createElement("td");d.innerHTML=c,d.setAttribute("data-y",n),d.className="jexcel_row",obj.rows[n].appendChild(d);for(var E=0;E<obj.options.columns.length;E++)obj.records[n][E]=obj.createCell(E,n,l[E]),obj.rows[n].appendChild(obj.records[n][E]);return obj.rows[n]},obj.parseValue=function(n,l,c,d){(""+c).substr(0,1)=="="&&obj.options.parseFormulas==1&&(c=obj.executeFormula(c,n,l));var E=obj.options.columns[n];if(E&&!isFormula(c)){var R=null;if(R=getMask(E)){c&&c==Number(c)&&(c=Number(c));var W=jSuites.mask.render(c,R,!0);if(d&&R.mask){var j=R.mask.split(";");j[1]&&(j[1].match(new RegExp("\\[Red\\]","gi"))&&(c<0?d.classList.add("red"):d.classList.remove("red")),j[1].match(new RegExp("\\(","gi"))&&c<0&&(W="("+W+")"))}W&&(c=W)}}return c};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,l,c){var d=document.createElement("td");if(d.setAttribute("data-x",n),d.setAttribute("data-y",l),(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1){var E=secureFormula(c);E!=c&&(c=E)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?d.innerHTML=c:d.textContent=c,typeof obj.options.columns[n].editor.createCell=="function"&&(d=obj.options.columns[n].editor.createCell(d));else if(obj.options.columns[n].type=="hidden")d.style.display="none",d.textContent=c;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var R=document.createElement("input");R.type=obj.options.columns[n].type,R.name="c"+n,R.checked=c==1||c==1||c=="true",R.onclick=function(){obj.setValue(d,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||R.setAttribute("disabled","disabled"),d.appendChild(R),obj.options.data[l][n]=R.checked}else if(obj.options.columns[n].type=="calendar"){var W=null;if(!validDate(c)){var j=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);j&&(W=j)}d.textContent=jSuites.calendar.getDateString(W||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")d.classList.add("jexcel_dropdown"),d.textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=c,d.appendChild(u)}else d.style.color=c,d.textContent=c;else if(obj.options.columns[n].type=="image"){if(c&&c.substr(0,10)=="data:image"){var f=document.createElement("img");f.src=c,d.appendChild(f)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?d.innerHTML=stripScript(obj.parseValue(n,l,c,d)):d.textContent=obj.parseValue(n,l,c,d);obj.options.columns[n].readOnly==1&&(d.className="readonly");var k=obj.options.columns[n].align?obj.options.columns[n].align:"center";return d.style.textAlign=k,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||d.innerHTML.length>200)&&(d.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(c||d.innerHTML?obj.records[l][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(d.style.overflow="hidden")),d},obj.createCellHeader=function(n){var l=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,c=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=c,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",l),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,l,c){obj.options.nestedHeaders[l][n].title&&(obj.options.nestedHeaders[l][n].title=c,obj.options.nestedHeaders[l].element.children[n+1].textContent=c)},obj.createNestedHeader=function(n){var l=document.createElement("tr");l.classList.add("jexcel_nested");var c=document.createElement("td");l.appendChild(c),n.element=l;for(var d=0,E=0;E<n.length;E++){n[E].colspan||(n[E].colspan=1),n[E].align||(n[E].align="center"),n[E].title||(n[E].title=""),n[E].id||(n[E].id="");for(var R=n[E].colspan,W=[],j=0;j<R;j++)obj.options.columns[d]&&obj.options.columns[d].type=="hidden"&&R++,W.push(d),d++;(c=document.createElement("td")).setAttribute("data-column",W.join(",")),c.setAttribute("colspan",n[E].colspan),c.setAttribute("align",n[E].align),c.setAttribute("id",n[E].id),c.textContent=n[E].title,l.appendChild(c)}return l},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var l=0;l<n.length;l++)if(n[l].type=="i")(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",n[l].k),R.setAttribute("data-v",n[l].v),R.setAttribute("id",n[l].id),n[l].tooltip&&R.setAttribute("title",n[l].tooltip),n[l].onclick&&(n[l].onclick,1)?R.onclick=function(W){var j=W;return function(){n[j].onclick(el,obj,this)}}(l):R.onclick=function(){var W=this.getAttribute("data-k"),j=this.getAttribute("data-v");obj.setStyle(obj.highlighted,W,j)},R.textContent=n[l].content,obj.toolbar.appendChild(R);else if(n[l].type=="select"){var c=!1;(R=document.createElement("select")).classList.add("jexcel_toolbar_item"),R.setAttribute("data-k",n[l].k),n[l].tooltip&&R.setAttribute("title",n[l].tooltip),n[l].onchange&&(n[l].onchange,1)?(R.onchange=n[l].onchange,c=!0):R.onchange=function(){var W=this.getAttribute("data-k");obj.setStyle(obj.highlighted,W,this.value)};for(var d=0;d<n[l].v.length;d++){var E=document.createElement("option");E.value=n[l].v[d],E.textContent=n[l].v[d],n[l].selectedValue&&E.value===n[l].selectedValue&&(E.selected=!0),R.appendChild(E)}c&&R.dispatchEvent(new Event("change")),obj.toolbar.appendChild(R)}else if(n[l].type=="color"){var R;(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",n[l].k),R.setAttribute("data-v",""),n[l].tooltip&&R.setAttribute("title",n[l].tooltip),obj.toolbar.appendChild(R),R.textContent=n[l].content,jSuites.color(R,{onchange:function(W,j){var u=W.getAttribute("data-k");obj.setStyle(obj.highlighted,u,j)}})}},obj.setMerge=function(n,l,c,d){var E=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var R=parseInt(obj.highlighted[0].getAttribute("data-x")),W=parseInt(obj.highlighted[0].getAttribute("data-y")),j=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),u=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([R,W]),l=j-R+1,c=u-W+1}var f=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[f[1]][f[0]].getAttribute("data-merged")&&(E=obj.options.text.cellAlreadyMerged);else if((!l||l<2)&&(!c||c<2))E=obj.options.text.invalidMergeProperties;else for(var k=f[1];k<f[1]+c;k++)for(var P=f[0];P<f[0]+l;P++)jexcel.getColumnNameFromId([P,k]),obj.records[k][P].getAttribute("data-merged")&&(E=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(E)alert(E);else{l>1?obj.records[f[1]][f[0]].setAttribute("colspan",l):l=1,c>1?obj.records[f[1]][f[0]].setAttribute("rowspan",c):c=1,obj.options.mergeCells[n]=[l,c,[]],obj.records[f[1]][f[0]].setAttribute("data-merged","true"),obj.records[f[1]][f[0]].style.overflow="hidden";for(var b=[],o=f[1];o<f[1]+c;o++)for(var g=f[0];g<f[0]+l;g++)f[0]==g&&f[1]==o||(b.push(obj.options.data[o][g]),obj.updateCell(g,o,"",!0),obj.options.mergeCells[n][2].push(obj.records[o][g]),obj.records[o][g].style.display="none",obj.records[o][g]=obj.records[f[1]][f[0]]);obj.updateSelection(obj.records[f[1]][f[0]]),d||(obj.setHistory({action:"setMerge",column:n,colspan:l,rowspan:c,data:b}),obj.dispatch("onmerge",el,n,l,c))}},obj.getMerge=function(n){var l={};if(n)l=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var c=Object.keys(obj.options.mergeCells),d=0;d<c.length;d++)l[c[d]]=[obj.options.mergeCells[c[d]][0],obj.options.mergeCells[c[d]][1]]}return l},obj.removeMerge=function(n,l,c){if(obj.options.mergeCells[n]){var d=jexcel.getIdFromColumnName(n,!0);obj.records[d[1]][d[0]].removeAttribute("colspan"),obj.records[d[1]][d[0]].removeAttribute("rowspan"),obj.records[d[1]][d[0]].removeAttribute("data-merged");for(var E=obj.options.mergeCells[n],R=0,W=0;W<E[1];W++)for(var j=0;j<E[0];j++)(W>0||j>0)&&(obj.records[d[1]+W][d[0]+j]=E[2][R],obj.records[d[1]+W][d[0]+j].style.display="",l&&l[R]&&obj.updateCell(d[0]+j,d[1]+W,l[R]),R++);obj.updateSelection(obj.records[d[1]][d[0]],obj.records[d[1]+W-1][d[0]+j-1]),c||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var l=Object.keys(obj.options.mergeCells),c=0;c<l.length;c++)obj.removeMerge(l[c],null,n)}},obj.isColMerged=function(n,l){var c=[];if(obj.options.mergeCells)for(var d=Object.keys(obj.options.mergeCells),E=0;E<d.length;E++){var R=jexcel.getIdFromColumnName(d[E],!0),W=obj.options.mergeCells[d[E]][0],j=R[0],u=R[0]+(W>1?W-1:0);l==null?j<=n&&u>=n&&c.push(d[E]):l?j<n&&u>=n&&c.push(d[E]):j<=n&&u>n&&c.push(d[E])}return c},obj.isRowMerged=function(n,l){var c=[];if(obj.options.mergeCells)for(var d=Object.keys(obj.options.mergeCells),E=0;E<d.length;E++){var R=jexcel.getIdFromColumnName(d[E],!0),W=obj.options.mergeCells[d[E]][1],j=R[1],u=R[1]+(W>1?W-1:0);l==null?j<=n&&u>=n&&c.push(d[E]):l?j<n&&u>=n&&c.push(d[E]):j<=n&&u>n&&c.push(d[E])}return c},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var l=[];if(obj.options.columns[n].type=="checkbox")l.push({id:"true",name:"True"}),l.push({id:"false",name:"False"});else{for(var c=[],d=!1,E=0;E<obj.options.data.length;E++){var R=obj.options.data[E][n],W=obj.records[E][n].innerHTML;R&&W?c[R]=W:d=!0}var j=Object.keys(c);for(l=[],E=0;E<j.length;E++)l.push({id:j[E],name:c[j[E]]});d&&l.push({value:"",id:"",name:"(Blanks)"})}var u=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(u),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var f={data:l,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(k){obj.resetFilters(),obj.filters[n]=k.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=k.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(u,f)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var l=0;l<obj.filter.children.length;l++)obj.filters[l]&&(n=l);var c=function(R,W,j){for(var u=0;u<R.length;u++){var f=""+obj.options.data[j][W],k=""+obj.records[j][W].innerHTML;if(R[u]==f||R[u]==k)return!0}return!1},d=obj.filters[n];obj.results=[];for(var E=0;E<obj.options.data.length;E++)c(d,n,E)&&obj.results.push(E);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,l,c){var d=n.getAttribute("data-y"),E=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,E,d),E>0&&(obj.records[d][E-1].style.overflow="hidden");var R=function(T){var I=n.getBoundingClientRect(),_=document.createElement(T);return _.style.width=I.width+"px",_.style.height=I.height-2+"px",_.style.minHeight=I.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(_),obj.dispatch("oncreateeditor",el,n,E,d,_),_};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[d][E],obj.records[d][E].innerHTML,E,d],obj.options.columns[E].editor)obj.options.columns[E].editor.openEditor(n,el,l,c);else if(obj.options.columns[E].type!="hidden")if(obj.options.columns[E].type=="checkbox"||obj.options.columns[E].type=="radio"){var W=!n.children[0].checked;obj.setValue(n,W),obj.edition=null}else if(obj.options.columns[E].type=="dropdown"||obj.options.columns[E].type=="autocomplete"){if(W=obj.options.data[d][E],obj.options.columns[E].multiple&&!Array.isArray(W)&&(W=W.split(";")),typeof obj.options.columns[E].filter=="function")var j=obj.options.columns[E].filter(el,n,E,d,obj.options.columns[E].source);else j=obj.options.columns[E].source;for(var u=[],f=0;f<j.length;f++)u.push(j[f]);var k=R("div"),P={data:u,multiple:!!obj.options.columns[E].multiple,autocomplete:!(!obj.options.columns[E].autocomplete&&obj.options.columns[E].type!="autocomplete"),opened:!0,value:W,width:"100%",height:k.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[E].options&&obj.options.columns[E].options.type&&(P.type=obj.options.columns[E].options.type),jSuites.dropdown(k,P)}else if(obj.options.columns[E].type=="calendar"||obj.options.columns[E].type=="color")W=obj.options.data[d][E],(k=R("input")).value=W,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[E].options.position=!0),obj.options.columns[E].options.value=obj.options.data[d][E],obj.options.columns[E].options.opened=!0,obj.options.columns[E].options.onclose=function(T,I){obj.closeEditor(n,!0)},obj.options.columns[E].type=="color"?jSuites.color(k,obj.options.columns[E].options):jSuites.calendar(k,obj.options.columns[E].options),k.focus();else if(obj.options.columns[E].type=="html"){W=obj.options.data[d][E],(k=R("div")).style.position="relative",(g=document.createElement("div")).classList.add("jexcel_richtext"),k.appendChild(g),jSuites.editor(g,{focus:!0,value:W});var b=n.getBoundingClientRect(),o=g.getBoundingClientRect();window.innerHeight<b.bottom+o.height?g.style.top=b.top-(o.height+2)+"px":g.style.top=b.top+"px"}else if(obj.options.columns[E].type=="image"){var g,m=n.children[0];(k=R("div")).style.position="relative",(g=document.createElement("div")).classList.add("jclose"),m&&m.src&&g.appendChild(m),k.appendChild(g),jSuites.image(g,obj.options.imageOptions),b=n.getBoundingClientRect(),o=g.getBoundingClientRect(),window.innerHeight<b.bottom+o.height?g.style.top=b.top-(o.height+2)+"px":g.style.top=b.top+"px"}else{W=l==1?"":obj.options.data[d][E],obj.options.columns[E].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[E].wordWrap!=1?k=R("input"):k=R("textarea"),k.focus(),k.value=W,P=obj.options.columns[E];var p=null;if(!isFormula(W)&&(p=getMask(P))){if(!P.disabledMaskOnEdition)if(P.mask){var C=P.mask.split(";");k.setAttribute("data-mask",C[0])}else P.locale&&k.setAttribute("data-locale",P.locale);p.input=k,k.mask=p,jSuites.mask.render(W,p,!1)}k.onblur=function(){obj.closeEditor(n,!0)},k.scrollLeft=k.scrollWidth}}},obj.closeEditor=function(n,l){var c=parseInt(n.getAttribute("data-x")),d=parseInt(n.getAttribute("data-y"));if(l==1){if(obj.options.columns[c].editor)var E=obj.options.columns[c].editor.closeEditor(n,l);else if(!(obj.options.columns[c].type=="checkbox"||obj.options.columns[c].type=="radio"||obj.options.columns[c].type=="hidden"))if(obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete")E=n.children[0].dropdown.close(!0);else if(obj.options.columns[c].type=="calendar")E=n.children[0].calendar.close(!0);else if(obj.options.columns[c].type=="color")E=n.children[0].color.close(!0);else if(obj.options.columns[c].type=="html")E=n.children[0].children[0].editor.getData();else if(obj.options.columns[c].type=="image"){var R=n.children[0].children[0].children[0];E=R&&R.tagName=="IMG"?R.src:""}else if(obj.options.columns[c].type=="numeric")(""+(E=n.children[0].value)).substr(0,1)!="="&&E==""&&(E=obj.options.columns[c].allowEmpty?"":0),n.children[0].onblur=null;else{E=n.children[0].value,n.children[0].onblur=null;var W,j=obj.options.columns[c];if((W=getMask(j))&&E!==""&&!isFormula(E)&&typeof E!="number"){var u=jSuites.mask.extract(E,W,!0);u&&u.value!==""&&(E=u.value)}}obj.options.data[d][c]==E?n.innerHTML=obj.edition[1]:obj.setValue(n,E)}else obj.options.columns[c].editor?obj.options.columns[c].editor.closeEditor(n,l):obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[c].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[c].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,c,d,E,l),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var l=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][l]},obj.getColumnOptions=function(n,l){var c=obj.options.columns[n];return c||(c={type:"text"}),c},obj.getCellFromCoords=function(n,l){return obj.records[l][n]},obj.getLabel=function(n){var l=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][l].innerHTML},obj.getLabelFromCoords=function(n,l){return obj.records[l][n].innerHTML},obj.getValue=function(n,l){if(typeof n=="object")var c=n.getAttribute("data-x"),d=n.getAttribute("data-y");else c=(n=jexcel.getIdFromColumnName(n,!0))[0],d=n[1];var E=null;return c!=null&&d!=null&&(obj.records[d]&&obj.records[d][c]&&(l||obj.options.copyCompatibility==1)?E=obj.records[d][c].innerHTML:obj.options.data[d]&&obj.options.data[d][c]!="undefined"&&(E=obj.options.data[d][c])),E},obj.getValueFromCoords=function(n,l,c){var d=null;return n!=null&&l!=null&&(obj.records[l]&&obj.records[l][n]&&c||obj.options.copyCompatibility==1?d=obj.records[l][n].innerHTML:obj.options.data[l]&&obj.options.data[l][n]!="undefined"&&(d=obj.options.data[l][n])),d},obj.setValue=function(n,l,c){var d=[];if(typeof n=="string"){var E=(u=jexcel.getIdFromColumnName(n,!0))[0],R=u[1];d.push(obj.updateCell(E,R,l,c)),obj.updateFormulaChain(E,R,d)}else if(E=null,R=null,n&&n.getAttribute&&(E=n.getAttribute("data-x"),R=n.getAttribute("data-y")),E!=null&&R!=null)d.push(obj.updateCell(E,R,l,c)),obj.updateFormulaChain(E,R,d);else{var W=Object.keys(n);if(W.length>0)for(var j=0;j<W.length;j++){var u;typeof n[j]=="string"?(E=(u=jexcel.getIdFromColumnName(n[j],!0))[0],R=u[1]):n[j].x!=null&&n[j].y!=null?(E=n[j].x,R=n[j].y,n[j].newValue!=null?l=n[j].newValue:n[j].value!=null&&(l=n[j].value)):(E=n[j].getAttribute("data-x"),R=n[j].getAttribute("data-y")),E!=null&&R!=null&&(d.push(obj.updateCell(E,R,l,c)),obj.updateFormulaChain(E,R,d))}}obj.setHistory({action:"setValue",records:d,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,d)},obj.setValueFromCoords=function(n,l,c,d){var E=[];E.push(obj.updateCell(n,l,c,d)),obj.updateFormulaChain(n,l,E),obj.setHistory({action:"setValue",records:E,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,E)},obj.setCheckRadioValue=function(){for(var n=[],l=Object.keys(obj.highlighted),c=0;c<l.length;c++){var d=obj.highlighted[c].getAttribute("data-x"),E=obj.highlighted[c].getAttribute("data-y");obj.options.columns[d].type!="checkbox"&&obj.options.columns[d].type!="radio"||n.push(obj.updateCell(d,E,!obj.options.data[E][d]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var l=new Option;l.innerHTML=n;var c=null;for(n=l.getElementsByTagName("script");c=n[0];)c.parentNode.removeChild(c);return l.innerHTML};obj.updateCell=function(n,l,c,d){if(obj.records[l][n].classList.contains("readonly")!=1||d){var E;(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1&&(E=secureFormula(c))!=c&&(c=E),(E=obj.dispatch("onbeforechange",el,obj.records[l][n],n,l,c))!=null&&(c=E),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(c=obj.options.columns[n].editor.updateCell(obj.records[l][n],c,d)),k={x:n,y:l,col:n,row:l,newValue:c,oldValue:obj.options.data[l][n]};let P=obj.options.columns[n].editor;if(P)obj.options.data[l][n]=c,typeof P.setValue=="function"&&P.setValue(obj.records[l][n],c);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var R=0;R<obj.options.data.length;R++)obj.options.data[R][n]=!1;obj.records[l][n].children[0].checked=c==1||c==1||c=="true"||c=="TRUE",obj.options.data[l][n]=obj.records[l][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[l][n]=c,obj.records[l][n].textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="calendar"){var W=null;if(!validDate(c)){var j=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);j&&(W=j)}obj.options.data[l][n]=c,obj.records[l][n].textContent=jSuites.calendar.getDateString(W||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[l][n]=c,obj.options.columns[n].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=c,obj.records[l][n].textContent="",obj.records[l][n].appendChild(u)}else obj.records[l][n].style.color=c,obj.records[l][n].textContent=c;else if(obj.options.columns[n].type=="image"){if(c=""+c,obj.options.data[l][n]=c,obj.records[l][n].innerHTML="",c&&c.substr(0,10)=="data:image"){var f=document.createElement("img");f.src=c,obj.records[l][n].appendChild(f)}}else obj.options.data[l][n]=c,obj.options.columns[n].type=="html"?obj.records[l][n].innerHTML=stripScript(obj.parseValue(n,l,c)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[l][n].innerHTML=stripScript(obj.parseValue(n,l,c,obj.records[l][n])):obj.records[l][n].textContent=obj.parseValue(n,l,c,obj.records[l][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[l][n].innerHTML.length>200)?obj.records[l][n].style.whiteSpace="pre-wrap":obj.records[l][n].style.whiteSpace="";n>0&&(obj.records[l][n-1].style.overflow=c?"hidden":""),obj.dispatch("onchange",el,obj.records[l]&&obj.records[l][n]?obj.records[l][n]:null,n,l,c,k.oldValue)}else var k={x:n,y:l,col:n,row:l};return k},obj.copyData=function(n,l){var c=obj.getData(!0,!0),d=obj.selectedContainer,E=parseInt(n.getAttribute("data-x")),R=parseInt(n.getAttribute("data-y")),W=parseInt(l.getAttribute("data-x")),j=parseInt(l.getAttribute("data-y")),u=[],f=!1;if(d[0]==E){if(R<d[1])var k=R-d[1];else k=1;var P=0}else P=E<d[0]?E-d[0]:1,k=0;for(var b=0,o=0,g=R;g<=j;g++)if(!obj.rows[g]||obj.rows[g].style.display!="none"){c[o]==null&&(o=0),b=0,d[0]!=E&&(P=E<d[0]?E-d[0]:1);for(var m=E;m<=W;m++){if(obj.records[g][m]&&!obj.records[g][m].classList.contains("readonly")&&obj.records[g][m].style.display!="none"&&f==0){if(!obj.selection.length&&obj.options.data[g][m]!=""){f=!0;continue}(c[o]==null||c[o][b]==null)&&(b=0);var p=c[o][b];if(p&&!c[1]&&obj.options.autoIncrement==1){if(obj.options.columns[m].type=="text"||obj.options.columns[m].type=="number")if((""+p).substr(0,1)=="="){var C=p.match(/([A-Z]+[0-9]+)/g);if(C){for(var T=[],I=0;I<C.length;I++){var _=jexcel.getIdFromColumnName(C[I],1);_[0]+=P,_[1]+=k,_[1]<0&&(_[1]=0);var O=jexcel.getColumnNameFromId([_[0],_[1]]);O!=C[I]&&(T[C[I]]=O)}T&&(p=obj.updateFormula(p,T))}}else p==Number(p)&&(p=Number(p)+k);else if(obj.options.columns[m].type=="calendar"){var M=new Date(p);M.setDate(M.getDate()+k),p=M.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(M.getMonth()+1))+"-"+jexcel.doubleDigitFormat(M.getDate())+" 00:00:00"}}u.push(obj.updateCell(m,g,p)),obj.updateFormulaChain(m,g,u)}b++,d[0]!=E&&P++}o++,k++}obj.setHistory({action:"setValue",records:u,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,u)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,l,c){if(n==1){if(obj.selectedCell&&(l>=obj.selectedCell[1]&&l<=obj.selectedCell[3]||c>=obj.selectedCell[1]&&c<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(l>=obj.selectedCell[0]&&l<=obj.selectedCell[2]||c>=obj.selectedCell[0]&&c<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){f=1;for(var l=0;l<obj.highlighted.length;l++){obj.highlighted[l].classList.remove("highlight"),obj.highlighted[l].classList.remove("highlight-left"),obj.highlighted[l].classList.remove("highlight-right"),obj.highlighted[l].classList.remove("highlight-top"),obj.highlighted[l].classList.remove("highlight-bottom"),obj.highlighted[l].classList.remove("highlight-selected");var c=parseInt(obj.highlighted[l].getAttribute("data-x")),d=parseInt(obj.highlighted[l].getAttribute("data-y"));if(obj.highlighted[l].getAttribute("data-merged"))var E=parseInt(obj.highlighted[l].getAttribute("colspan")),R=parseInt(obj.highlighted[l].getAttribute("rowspan")),W=E>0?c+(E-1):c,j=R>0?d+(R-1):d;else W=c,j=d;for(var u=c;u<=W;u++)obj.headers[u]&&obj.headers[u].classList.remove("selected");for(u=d;u<=j;u++)obj.rows[u]&&obj.rows[u].classList.remove("selected")}}else var f=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&f==1&&obj.dispatch("onblur",el),f},obj.updateSelection=function(n,l,c){var d=n.getAttribute("data-x"),E=n.getAttribute("data-y");if(l)var R=l.getAttribute("data-x"),W=l.getAttribute("data-y");else R=d,W=E;obj.updateSelectionFromCoords(d,E,R,W,c)},obj.updateSelectionFromCoords=function(n,l,c,d,E){var R=obj.resetSelection();if(l==null&&(l=0,d=obj.rows.length-1),c==null&&(c=n),d==null&&(d=l),n>=obj.headers.length&&(n=obj.headers.length-1),l>=obj.rows.length&&(l=obj.rows.length-1),c>=obj.headers.length&&(c=obj.headers.length-1),d>=obj.rows.length&&(d=obj.rows.length-1),obj.selectedCell=[n,l,c,d],n!=null){if(obj.records[l][n]&&obj.records[l][n].classList.add("highlight-selected"),parseInt(n)<parseInt(c))var W=parseInt(n),j=parseInt(c);else W=parseInt(c),j=parseInt(n);if(parseInt(l)<parseInt(d))var u=parseInt(l),f=parseInt(d);else u=parseInt(d),f=parseInt(l);for(var k=W;k<=j;k++)for(var P=u;P<=f;P++)if(obj.records[P][k]&&obj.records[P][k].getAttribute("data-merged")){var b=parseInt(obj.records[P][k].getAttribute("data-x")),o=parseInt(obj.records[P][k].getAttribute("data-y")),g=parseInt(obj.records[P][k].getAttribute("colspan")),m=parseInt(obj.records[P][k].getAttribute("rowspan"));g>1&&(b<W&&(W=b),b+g>j&&(j=b+g-1)),m&&(o<u&&(u=o),o+m>f&&(f=o+m-1))}var p=null,C=null,T=null,I=null;for(P=u;P<=f;P++)obj.rows[P].style.display!="none"&&(T==null&&(T=P),I=P);for(k=W;k<=j;k++){for(P=u;P<=f;P++)obj.rows[P].style.display!="none"&&obj.records[P][k].style.display!="none"&&(obj.records[P][k].classList.add("highlight"),obj.highlighted.push(obj.records[P][k]));obj.options.columns[k].type!="hidden"&&(p==null&&(p=k),C=k)}for(p||(p=0),C||(C=0),k=p;k<=C;k++)obj.options.columns[k].type!="hidden"&&obj.colgroup[k].style&&obj.colgroup[k].style.display!="none"&&(obj.records[T]&&obj.records[T][k]&&obj.records[T][k].classList.add("highlight-top"),obj.records[I]&&obj.records[I][k]&&obj.records[I][k].classList.add("highlight-bottom"),obj.headers[k].classList.add("selected"));for(P=T;P<=I;P++)obj.rows[P]&&obj.rows[P].style.display!="none"&&(obj.records[P][p].classList.add("highlight-left"),obj.records[P][C].classList.add("highlight-right"),obj.rows[P].classList.add("selected"));obj.selectedContainer=[p,T,C,I]}R==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,p,T,C,I,E),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,l){obj.removeCopySelection();var c=obj.selectedContainer[0],d=obj.selectedContainer[1],E=obj.selectedContainer[2],R=obj.selectedContainer[3];if(n!=null&&l!=null){if(n-E>0)var W=parseInt(E)+1,j=parseInt(n);else W=parseInt(n),j=parseInt(c)-1;if(l-R>0)var u=parseInt(R)+1,f=parseInt(l);else u=parseInt(l),f=parseInt(d)-1;j-W<=f-u?(W=parseInt(c),j=parseInt(E)):(u=parseInt(d),f=parseInt(R));for(var k=u;k<=f;k++)for(var P=W;P<=j;P++)obj.records[k][P]&&obj.rows[k].style.display!="none"&&obj.records[k][P].style.display!="none"&&(obj.records[k][P].classList.add("selection"),obj.records[u][P].classList.add("selection-top"),obj.records[f][P].classList.add("selection-bottom"),obj.records[k][W].classList.add("selection-left"),obj.records[k][j].classList.add("selection-right"),obj.selection.push(obj.records[k][P]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],l=n.getAttribute("data-x"),c=obj.content.getBoundingClientRect(),d=c.left,E=c.top,R=n.getBoundingClientRect(),W=R.left,j=R.top,u=R.width,f=R.height,k=W-d+obj.content.scrollLeft+u-4,P=j-E+obj.content.scrollTop+f-4;if(obj.corner.style.top=P+"px",obj.corner.style.left=k+"px",obj.options.freezeColumns){var b=obj.getFreezeWidth();l>obj.options.freezeColumns-1&&W-d+u<b?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var l=obj.content.getBoundingClientRect(),c=l.left,d=l.top,E=l.width,R=l.height,W=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),j=W.left,u=W.top,f=W.width,k=W.height;if(n==0||n==1)var P=j-c+obj.content.scrollLeft,b=u-d+obj.content.scrollTop-2;else P=j-c+obj.content.scrollLeft+f,b=u-d+obj.content.scrollTop+k;b>obj.content.scrollTop+30&&b<obj.content.scrollTop+R||(b<obj.content.scrollTop+30?obj.content.scrollTop=b-k:obj.content.scrollTop=b-(R-2));var o=obj.getFreezeWidth();P>obj.content.scrollLeft+o&&P<obj.content.scrollLeft+E||(P<obj.content.scrollLeft+30?(obj.content.scrollLeft=P,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):P<obj.content.scrollLeft+o?obj.content.scrollLeft=P-o-1:obj.content.scrollLeft=P-(E-20))},obj.getWidth=function(n){if(n===void 0)for(var l=[],c=0;c<obj.headers.length;c++)l.push(obj.options.columns[c].width);else typeof n=="object"&&(n=n.getAttribute("data-x")),l=obj.colgroup[n].getAttribute("width");return l},obj.setWidth=function(n,l,c){if(l){if(Array.isArray(n)){c||(c=[]);for(var d=0;d<n.length;d++){c[d]||(c[d]=obj.colgroup[n[d]].getAttribute("width"));var E=Array.isArray(l)&&l[d]?l[d]:l;obj.colgroup[n[d]].setAttribute("width",E),obj.options.columns[n[d]].width=E}}else c||(c=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",l),obj.options.columns[n].width=l;obj.setHistory({action:"setWidth",column:n,oldValue:c,newValue:l}),obj.dispatch("onresizecolumn",el,n,l,c),obj.updateCornerPosition()}},obj.setHeight=function(n,l,c){l>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),c||(c=obj.rows[n].getAttribute("height"))||(c=obj.rows[n].getBoundingClientRect().height),l=parseInt(l),obj.rows[n].style.height=l+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=l,obj.setHistory({action:"setHeight",row:n,oldValue:c,newValue:l}),obj.dispatch("onresizerow",el,n,l,c),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var l=[],c=0;c<obj.rows.length;c++){var d=obj.rows[c].style.height;d&&(l[c]=d)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),l=obj.rows[n].style.height;return l},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var l=0;l<obj.options.footers.length;l++){if(obj.tfoot.children[l])var c=obj.tfoot.children[l];else{c=document.createElement("tr");var d=document.createElement("td");c.appendChild(d),obj.tfoot.appendChild(c)}for(var E=0;E<obj.headers.length;E++){if(obj.options.footers[l][E]||(obj.options.footers[l][E]=""),obj.tfoot.children[l].children[E+1])d=obj.tfoot.children[l].children[E+1];else{d=document.createElement("td"),c.appendChild(d);var R=obj.options.columns[E].align?obj.options.columns[E].align:"center";d.style.textAlign=R}d.textContent=obj.parseValue(+obj.records.length+E,l,obj.options.footers[l][E]),d.style.display=obj.colgroup[E].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,l){if(obj.headers[n]){var c=obj.headers[n].textContent;l||(l=prompt(obj.options.text.columnName,c)),l&&(obj.headers[n].textContent=l,obj.headers[n].setAttribute("title",l),obj.options.columns[n].title=l),obj.setHistory({action:"setHeader",column:n,oldValue:c,newValue:l}),obj.dispatch("onchangeheader",el,n,c,l)}},obj.getHeaders=function(n){for(var l=[],c=0;c<obj.headers.length;c++)l.push(obj.getHeader(c));return n?l:l.join(obj.options.csvDelimiter)},obj.getMeta=function(n,l){return n?l?obj.options.meta[n]&&obj.options.meta[n][l]?obj.options.meta[n][l]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,l,c){if(obj.options.meta||(obj.options.meta={}),l&&c)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][l]=c;else for(var d=Object.keys(n),E=0;E<d.length;E++){obj.options.meta[d[E]]||(obj.options.meta[d[E]]={});for(var R=Object.keys(n[d[E]]),W=0;W<R.length;W++)obj.options.meta[d[E]][R[W]]=n[d[E]][R[W]]}obj.dispatch("onchangemeta",el,n,l,c)},obj.updateMeta=function(n){if(obj.options.meta){for(var l={},c=Object.keys(obj.options.meta),d=0;d<c.length;d++)n[c[d]]?l[n[c[d]]]=obj.options.meta[c[d]]:l[c[d]]=obj.options.meta[c[d]];obj.options.meta=l}},obj.getStyle=function(n,l){if(n)return n=jexcel.getIdFromColumnName(n,!0),l?obj.records[n[1]][n[0]].style[l]:obj.records[n[1]][n[0]].getAttribute("style");for(var c={},d=obj.options.data[0].length,E=obj.options.data.length,R=0;R<E;R++)for(var W=0;W<d;W++){var j=l?obj.records[R][W].style[l]:obj.records[R][W].getAttribute("style");j&&(c[jexcel.getColumnNameFromId([W,R])]=j)}return c},obj.resetStyle=function(n,l){for(var c=Object.keys(n),d=0;d<c.length;d++){var E=jexcel.getIdFromColumnName(c[d],!0);obj.records[E[1]]&&obj.records[E[1]][E[0]]&&obj.records[E[1]][E[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,l)},obj.setStyle=function(n,l,c,d,E){var R={},W={},j=function(p,C,T){var I=jexcel.getIdFromColumnName(p,!0);if(obj.records[I[1]]&&obj.records[I[1]][I[0]]&&(obj.records[I[1]][I[0]].classList.contains("readonly")==0||d)){var _=obj.records[I[1]][I[0]].style[C];_!=T||d?obj.records[I[1]][I[0]].style[C]=T:(T="",obj.records[I[1]][I[0]].style[C]=""),W[p]||(W[p]=[]),R[p]||(R[p]=[]),W[p].push([C+":"+_]),R[p].push([C+":"+T])}};if(l&&c)if(typeof n=="string")j(n,l,c);else for(var u=[],f=0;f<n.length;f++){var k=n[f].getAttribute("data-x"),P=n[f].getAttribute("data-y"),b=jexcel.getColumnNameFromId([k,P]);u[b]||(j(b,l,c),u[b]=!0)}else{var o=Object.keys(n);for(f=0;f<o.length;f++){var g=n[o[f]];typeof g=="string"&&(g=g.split(";"));for(var m=0;m<g.length;m++)typeof g[m]=="string"&&(g[m]=g[m].split(":")),g[m][0].trim()&&j(o[f],g[m][0].trim(),g[m][1])}}for(o=Object.keys(W),f=0;f<o.length;f++)W[o[f]]=W[o[f]].join(";");for(o=Object.keys(R),f=0;f<o.length;f++)R[o[f]]=R[o[f]].join(";");E||obj.setHistory({action:"setStyle",oldValue:W,newValue:R}),obj.dispatch("onchangestyle",el,n,l,c)},obj.getComments=function(n,l){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),l?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var c={},d=0;d<obj.options.data.length;d++)for(var E=0;E<obj.options.columns.length;E++){var R=obj.records[d][E].getAttribute("title");R&&(c[n=jexcel.getColumnNameFromId([E,d])]=R)}return c},obj.setComments=function(n,l,c){if(typeof n=="string")var d=jexcel.getIdFromColumnName(n,!0);else d=n;var E=obj.records[d[1]][d[0]].getAttribute("title"),R=[E,c=obj.records[d[1]][d[0]].getAttribute("data-author")];obj.records[d[1]][d[0]].setAttribute("title",l||""),obj.records[d[1]][d[0]].setAttribute("data-author",c||""),l?obj.records[d[1]][d[0]].classList.add("jexcel_comments"):obj.records[d[1]][d[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[l,c],oldValue:R}),obj.dispatch("oncomments",el,l,E,d,d[0],d[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,l){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}l=l==null?obj.headers[n].classList.contains("arrow-down")?1:0:l?1:0;var c=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var d=0;d<obj.options.data.length;d++)c[d]=[d,Number(obj.options.data[d][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(d=0;d<obj.options.data.length;d++)c[d]=[d,obj.options.data[d][n]];else for(d=0;d<obj.options.data.length;d++)c[d]=[d,obj.records[d][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(R){return function(W,j){var u=W[1],f=j[1];return R?u===""&&f!==""?1:u!==""&&f===""||u>f?-1:u<f?1:0:u===""&&f!==""?1:u!==""&&f===""?-1:u>f?1:u<f?-1:0}}),c=c.sort(obj.options.sorting(l));var E=[];for(d=0;d<c.length;d++)E[d]=c[d][0];return obj.setHistory({action:"orderBy",rows:E,column:n,order:l}),obj.updateOrderArrow(n,l),obj.updateOrder(E),obj.dispatch("onsort",el,n,l),!0}},obj.updateOrderArrow=function(n,l){for(var c=0;c<obj.headers.length;c++)obj.headers[c].classList.remove("arrow-up"),obj.headers[c].classList.remove("arrow-down");l?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var l=[],c=0;c<n.length;c++)l[c]=obj.options.data[n[c]];for(obj.options.data=l,l=[],c=0;c<n.length;c++)l[c]=obj.records[n[c]];for(obj.records=l,l=[],c=0;c<n.length;c++)l[c]=obj.rows[n[c]];if(obj.rows=l,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(c=0;c<obj.rows.length;c++)obj.tbody.appendChild(obj.rows[c])},obj.moveRow=function(n,l,c){if(Object.keys(obj.options.mergeCells).length>0){if(n>l)var d=1;else d=0;if(obj.isRowMerged(n).length||obj.isRowMerged(l,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}c||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[l])>=0?n>l?obj.tbody.insertBefore(obj.rows[n],obj.rows[l]):obj.tbody.insertBefore(obj.rows[n],obj.rows[l].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(l,0,obj.rows.splice(n,1)[0]),obj.records.splice(l,0,obj.records.splice(n,1)[0]),obj.options.data.splice(l,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:l}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,l)},obj.insertRow=function(n,l,c){if(obj.options.allowInsertRow==1){var d=[];if(n>0)var E=n;else E=1,n&&(d=n);c=!!c;var R=obj.options.data.length-1;if((l==null||l>=parseInt(R)||l<0)&&(l=R),obj.dispatch("onbeforeinsertrow",el,l,E,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var W=c?l:l+1,j=obj.records.splice(W),u=obj.options.data.splice(W),f=obj.rows.splice(W),k=[],P=[],b=[],o=W;o<E+W;o++){obj.options.data[o]=[];for(var g=0;g<obj.options.columns.length;g++)obj.options.data[o][g]=d[g]?d[g]:"";var m=obj.createRow(o,obj.options.data[o]);f[0]?Array.prototype.indexOf.call(obj.tbody.children,f[0])>=0&&obj.tbody.insertBefore(m,f[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[l])>=0&&obj.tbody.appendChild(m),k.push(obj.records[o]),P.push(obj.options.data[o]),b.push(m)}Array.prototype.push.apply(obj.records,j),Array.prototype.push.apply(obj.options.data,u),Array.prototype.push.apply(obj.rows,f),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:l,numOfRows:E,insertBefore:c,rowRecords:k,rowData:P,rowNode:b}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,l,E,k,c)}},obj.deleteRow=function(n,l){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var c=obj.getSelectedRows();c[0]?(n=parseInt(c[0].getAttribute("data-y")),l=c.length):(n=obj.options.data.length-1,l=1)}var d=obj.options.data.length-1;if((n==null||n>d||n<0)&&(n=d),l||(l=1),n+l>=obj.options.data.length&&(l=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,l)===!1)return!1;if(parseInt(n)>-1){var E=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=n;R<n+l;R++)obj.isRowMerged(R,!1).length&&(E=!0);if(E){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&d+1===l&&(l--,console.error("Jspreadsheet: It is not possible to delete the last row")),R=n;R<n+l;R++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[R])>=0&&(obj.rows[R].className="",obj.rows[R].parentNode.removeChild(obj.rows[R]));var W=obj.records.splice(n,l),j=obj.options.data.splice(n,l),u=obj.rows.splice(n,l);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+l-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:l,insertBefore:1,rowRecords:W,rowData:j,rowNode:u}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,l,W)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,l){if(Object.keys(obj.options.mergeCells).length>0){if(n>l)var c=1;else c=0;if(obj.isColMerged(n).length||obj.isColMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(l=parseInt(l))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[l]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[l]);for(var d=0;d<obj.rows.length;d++)obj.rows[d].insertBefore(obj.records[d][n],obj.records[d][l])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[l].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[l].nextSibling),d=0;d<obj.rows.length;d++)obj.rows[d].insertBefore(obj.records[d][n],obj.records[d][l].nextSibling);for(obj.options.columns.splice(l,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(l,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(l,0,obj.colgroup.splice(n,1)[0]),d=0;d<obj.rows.length;d++)obj.options.data[d].splice(l,0,obj.options.data[d].splice(n,1)[0]),obj.records[d].splice(l,0,obj.records[d].splice(n,1)[0]);if(obj.options.footers)for(d=0;d<obj.options.footers.length;d++)obj.options.footers[d].splice(l,0,obj.options.footers[d].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:l}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,l)},obj.insertColumn=function(n,l,c,d){if(obj.options.allowInsertColumn==1){var E=[];if(n>0)var R=n;else R=1,n&&(E=n);c=!!c;var W=obj.options.columns.length-1;if((l==null||l>=parseInt(W)||l<0)&&(l=W),obj.dispatch("onbeforeinsertcolumn",el,l,R,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}d||(d=[]);for(var j=0;j<R;j++)d[j]||(d[j]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var u=c?l:l+1;obj.options.columns=jexcel.injectArray(obj.options.columns,u,d);for(var f=obj.headers.splice(u),k=obj.colgroup.splice(u),P=[],b=[],o=[],g=[],m=[],p=u;p<R+u;p++)obj.createCellHeader(p),obj.headerContainer.insertBefore(obj.headers[p],obj.headerContainer.children[p+1]),obj.colgroupContainer.insertBefore(obj.colgroup[p],obj.colgroupContainer.children[p+1]),P.push(obj.headers[p]),b.push(obj.colgroup[p]);if(obj.options.footers)for(var C=0;C<obj.options.footers.length;C++){for(m[C]=[],j=0;j<R;j++)m[C].push("");obj.options.footers[C].splice(u,0,m[C])}for(var T=0;T<obj.options.data.length;T++){var I=obj.options.data[T].splice(u),_=obj.records[T].splice(u);for(g[T]=[],o[T]=[],p=u;p<R+u;p++){var O=E[T]?E[T]:"";obj.options.data[T][p]=O;var M=obj.createCell(p,T,obj.options.data[T][p]);obj.records[T][p]=M,obj.rows[T]&&obj.rows[T].insertBefore(M,obj.rows[T].children[p+1]),g[T].push(O),o[T].push(M)}Array.prototype.push.apply(obj.options.data[T],I),Array.prototype.push.apply(obj.records[T],_)}if(Array.prototype.push.apply(obj.headers,f),Array.prototype.push.apply(obj.colgroup,k),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(C=0;C<obj.options.nestedHeaders.length;C++){var D=parseInt(obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan)+R;obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan=D,obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("colspan",D);var Z=obj.thead.children[C].children[obj.thead.children[C].children.length-1].getAttribute("data-column");for(Z=Z.split(","),p=u;p<R+u;p++)Z.push(p);obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("data-column",Z)}else D=parseInt(obj.options.nestedHeaders[0].colspan)+R,obj.options.nestedHeaders[0].colspan=D,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",D);obj.setHistory({action:"insertColumn",columnNumber:l,numOfColumns:R,insertBefore:c,columns:d,headers:P,colgroup:b,records:o,footers:m,data:g}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,l,R,o,c)}},obj.deleteColumn=function(n,l){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var c=obj.getSelectedColumns(!0);c.length?(n=parseInt(c[0]),l=parseInt(c.length)):(n=obj.headers.length-1,l=1)}var d=obj.options.data[0].length-1;if((n==null||n>d||n<0)&&(n=d),l||(l=1),l>obj.options.data[0].length-n&&(l=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,l)===!1)return!1;if(parseInt(n)>-1){var E=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=n;R<n+l;R++)obj.isColMerged(R,!1).length&&(E=!0);if(E){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var W=obj.options.columns.splice(n,l);for(R=n;R<n+l;R++)obj.colgroup[R].className="",obj.headers[R].className="",obj.colgroup[R].parentNode.removeChild(obj.colgroup[R]),obj.headers[R].parentNode.removeChild(obj.headers[R]);for(var j=obj.headers.splice(n,l),u=obj.colgroup.splice(n,l),f=[],k=[],P=[],b=0;b<obj.options.data.length;b++)for(R=n;R<n+l;R++)obj.records[b][R].className="",obj.records[b][R].parentNode.removeChild(obj.records[b][R]);for(b=0;b<obj.options.data.length;b++)k[b]=obj.options.data[b].splice(n,l),f[b]=obj.records[b].splice(n,l);if(obj.options.footers)for(b=0;b<obj.options.footers.length;b++)P[b]=obj.options.footers[b].splice(n,l);if(obj.conditionalSelectionUpdate(0,n,n+l-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var o=0;o<obj.options.nestedHeaders.length;o++){var g=parseInt(obj.options.nestedHeaders[o][obj.options.nestedHeaders[o].length-1].colspan)-l;obj.options.nestedHeaders[o][obj.options.nestedHeaders[o].length-1].colspan=g,obj.thead.children[o].children[obj.thead.children[o].children.length-1].setAttribute("colspan",g)}else g=parseInt(obj.options.nestedHeaders[0].colspan)-l,obj.options.nestedHeaders[0].colspan=g,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",g);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:l,insertBefore:1,columns:W,headers:j,colgroup:u,records:f,footers:P,data:k}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,l,f)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var l=[],c=0;c<obj.rows.length;c++)obj.rows[c].classList.contains("selected")&&(n?l.push(c):l.push(obj.rows[c]));return l},obj.getSelectedColumns=function(){for(var n=[],l=0;l<obj.headers.length;l++)obj.headers[l].classList.contains("selected")&&n.push(l);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(R=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var l=0;l<obj.rows.length;l++)obj.rows[l]&&(W=obj.rows[l].getAttribute("data-y"))!=l&&(obj.rows[l].setAttribute("data-y",l),obj.rows[l].children[0].setAttribute("data-y",l),obj.rows[l].children[0].innerHTML=l+1);var c=[],d=[],E=function(o,g,m,p){if(o!=m&&obj.records[p][m].setAttribute("data-x",m),g!=p&&obj.records[p][m].setAttribute("data-y",p),o!=m||g!=p){var C=jexcel.getColumnNameFromId([o,g]),T=jexcel.getColumnNameFromId([m,p]);c[C]=T}};for(l=0;l<obj.records.length;l++)for(n=0;n<obj.records[0].length;n++)if(obj.records[l][n]){var R=obj.records[l][n].getAttribute("data-x"),W=obj.records[l][n].getAttribute("data-y");if(obj.records[l][n].getAttribute("data-merged")){var j=jexcel.getColumnNameFromId([R,W]),u=jexcel.getColumnNameFromId([n,l]);if(d[j]==null)if(j==u)d[j]=!1;else{var f=parseInt(n-R),k=parseInt(l-W);d[j]=[u,f,k]}}else E(R,W,n,l)}var P=Object.keys(d);if(P.length){for(n=0;n<P.length;n++)if(d[P[n]]){var b=jexcel.getIdFromColumnName(P[n],!0);for(E(R=b[0],W=b[1],R+d[P[n]][1],W+d[P[n]][2]),j=P[n],u=d[P[n]][0],l=0;l<obj.options.mergeCells[j][2].length;l++)R=parseInt(obj.options.mergeCells[j][2][l].getAttribute("data-x")),W=parseInt(obj.options.mergeCells[j][2][l].getAttribute("data-y")),obj.options.mergeCells[j][2][l].setAttribute("data-x",R+d[P[n]][1]),obj.options.mergeCells[j][2][l].setAttribute("data-y",W+d[P[n]][2]);obj.options.mergeCells[u]=obj.options.mergeCells[j],delete obj.options.mergeCells[j]}}obj.updateFormulas(c),obj.updateMeta(c),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,l=obj.rows.length-1;l>=0;l--){for(var c=!1,d=0;d<obj.headers.length;d++)obj.options.data[l][d]&&(c=!0);if(c)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var E=0;for(d=obj.headers.length-1;d>=0;d--){for(c=!1,l=0;l<obj.rows.length;l++)obj.options.data[l][d]&&(c=!0);if(c)break;E++}obj.options.minSpareCols-E>0&&obj.insertColumn(obj.options.minSpareCols-E)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),l=0;l<obj.rows.length;l++)for(d=0;d<obj.headers.length;d++)obj.options.updateTable(el,obj.records[l][d],d,l,obj.options.data[l][d],obj.records[l][d].textContent,jexcel.getColumnNameFromId([d,l]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,l){(n=obj.getCell(n))&&(l?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var l=0;l<obj.options.data.length;l++)obj.records[l][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var l=0;l<obj.options.data.length;l++)obj.records[l][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,l,c){var d=jexcel.getColumnNameFromId([n,l]);if(obj.formula[d]&&obj.formula[d].length>0)if(chainLoopProtection[d])obj.records[l][n].innerHTML="#ERROR",obj.formula[d]="";else{chainLoopProtection[d]=!0;for(var E=0;E<obj.formula[d].length;E++){var R=jexcel.getIdFromColumnName(obj.formula[d][E],!0),W=""+obj.options.data[R[1]][R[0]];W.substr(0,1)=="="?c.push(obj.updateCell(R[0],R[1],W,!0)):Object.keys(obj.formula)[E]=null,obj.updateFormulaChain(R[0],R[1],c)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var l=0;l<obj.options.data.length;l++)for(var c=0;c<obj.options.data[0].length;c++)if((j=""+obj.options.data[l][c]).substr(0,1)=="="){var d=obj.updateFormula(j,n);d!=j&&(obj.options.data[l][c]=d)}var E=[],R=Object.keys(obj.formula);for(l=0;l<R.length;l++){var W=R[l],j=obj.formula[W];for(n[W]&&(W=n[W]),E[W]=[],c=0;c<j.length;c++){var u=j[c];n[u]&&(u=n[u]),E[W].push(u)}}obj.formula=E},obj.updateFormula=function(n,l){for(var c=/[A-Z]/,d=/[0-9]/,E="",R=null,W=null,j="",u=0;u<n.length;u++)c.exec(n[u])?(R=1,W=0,j+=n[u]):d.exec(n[u])?(W=R?1:0,j+=n[u]):(R&&W&&(j=l[j]?l[j]:j),E+=j,E+=n[u],R=0,W=0,j="");return j&&(R&&W&&(j=l[j]?l[j]:j),E+=j),E};var secureFormula=function(n){for(var l="",c=0,d=0;d<n.length;d++)n[d]=='"'&&(c=c==0?1:0),l+=c==1?n[d]:n[d].toUpperCase();return l};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var l=0;l<n.length;l++){var c=[],d=n[l].split(":"),E=jexcel.getIdFromColumnName(d[0],!0),R=jexcel.getIdFromColumnName(d[1],!0);if(E[0]<=R[0])var W=E[0],j=R[0];else W=R[0],j=E[0];if(E[1]<=R[1])var u=E[1],f=R[1];else u=R[1],f=E[1];for(var k=u;k<=f;k++)for(var P=W;P<=j;P++)c.push(jexcel.getColumnNameFromId([P,k]));expression=expression.replace(n[l],c.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,l){var c=l&&obj.options.columns[l].decimal?obj.options.columns[l].decimal:".",d=""+n;return(d=d.split(c))[0]=d[0].match(/[+-]?[0-9]/g),d[0]&&(d[0]=d[0].join("")),d[1]&&(d[1]=d[1].match(/[0-9]*/g).join("")),d[0]&&Number.isInteger(Number(d[0]))?d[1]?n=+(d[0]+"."+d[1]):n=+(d[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,l){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,l?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-c<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}obj.updateScroll(1)},obj.up.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),d=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),d=parseInt(obj.selectedCell[3]);if(l==0){for(var E=0;E<d;E++)if(obj.records[E][c].style.display!="none"&&obj.rows[E].style.display!="none"){d=E;break}}else d=obj.up.get(c,d);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=d):(obj.selectedCell[2]=c,obj.selectedCell[3]=d)},obj.up.get=function(n,l){n=parseInt(n);for(var c=(l=parseInt(l))-1;c>=0;c--)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[l][n])continue;l=c;break}return l},obj.down=function(n,l){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,l?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}obj.updateScroll(3)},obj.down.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),d=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),d=parseInt(obj.selectedCell[3]);if(l==0){for(var E=obj.rows.length-1;E>d;E--)if(obj.records[E][c].style.display!="none"&&obj.rows[E].style.display!="none"){d=E;break}}else d=obj.down.get(c,d);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=d):(obj.selectedCell[2]=c,obj.selectedCell[3]=d)},obj.down.get=function(n,l){n=parseInt(n);for(var c=(l=parseInt(l))+1;c<obj.rows.length;c++)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[l][n])continue;l=c;break}return l},obj.right=function(n,l){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,l?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),d=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),d=parseInt(obj.selectedCell[3]);if(l==0){for(var E=obj.headers.length-1;E>c;E--)if(obj.records[d][E].style.display!="none"){c=E;break}}else c=obj.right.get(c,d);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=d):(obj.selectedCell[2]=c,obj.selectedCell[3]=d)},obj.right.get=function(n,l){n=parseInt(n),l=parseInt(l);for(var c=n+1;c<obj.headers.length;c++)if(obj.records[l][c].style.display!="none"){if(obj.records[l][c].getAttribute("data-merged")&&obj.records[l][c]==obj.records[l][n])continue;n=c;break}return n},obj.left=function(n,l){n?obj.selectedCell[2]>0&&obj.left.visible(1,l?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),d=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),d=parseInt(obj.selectedCell[3]);if(l==0){for(var E=0;E<c;E++)if(obj.records[d][E].style.display!="none"){c=E;break}}else c=obj.left.get(c,d);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=d):(obj.selectedCell[2]=c,obj.selectedCell[3]=d)},obj.left.get=function(n,l){n=parseInt(n),l=parseInt(l);for(var c=n-1;c>=0;c--)if(obj.records[l][c].style.display!="none"){if(obj.records[l][c].getAttribute("data-merged")&&obj.records[l][c]==obj.records[l][n])continue;n=c;break}return n},obj.first=function(n,l){if(n?l?obj.selectedCell[3]=0:obj.left.visible(1,0):(l?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,l){if(n?l?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(l?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)l=obj.rows;else var l=obj.results;var c=100;n!=null&&n!=-1||(n=Math.ceil(l.length/c)-1);var d=n*c,E=n*c+c;E>l.length&&(E=l.length),(d=E-100)<0&&(d=0);for(var R=d;R<E;R++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[R]):obj.tbody.appendChild(obj.rows[l[R]]),obj.tbody.children.length>c&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var l=0;if(n.length>100){var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c>0)for(var d=0;d<30;d++)(c-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[c],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[c]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),l=1))}return l},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var l=0;if(n.length>100){var c=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c<obj.rows.length-1)for(var d=0;d<=30;d++)c<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[c]):obj.tbody.appendChild(obj.rows[n[c]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),l=1)),c+=1}return l},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,l=parseInt(obj.selectedCell[3]/100),c=parseInt(obj.rows.length/100);if(n!=l&&l<=c&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(l),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var l=function(d){obj.results.indexOf(d)==-1&&obj.results.push(d)},c=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c=new RegExp(c,"i"),obj.options.data.forEach(function(d,E){if(function(f,k,P){for(var b=0;b<f.length;b++)if((""+f[b]).toLowerCase().search(k)>=0||(""+obj.records[P][b].innerHTML).toLowerCase().search(k)>=0)return!0;return!1}(d,c,E)){var R=obj.isRowMerged(E);if(R.length)for(var W=0;W<R.length;W++)for(var j=jexcel.getIdFromColumnName(R[W],!0),u=0;u<obj.options.mergeCells[R[W]][1];u++)l(j[1]+u);else l(E)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,l=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var c=0;c<obj.rows.length;c++)!obj.results||obj.results.indexOf(c)>-1?(l<n&&(obj.tbody.appendChild(obj.rows[c]),l++),obj.rows[c].style.display=""):obj.rows[c].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var l=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)c=obj.rows;else var c=obj.results;var d=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(c.length/d)-1),obj.pageNumber=n;var E=n*d,R=n*d+d;for(R>c.length&&(R=c.length),E<0&&(E=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var W=E;W<R;W++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[W]):obj.tbody.appendChild(obj.rows[c[W]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,l)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var l=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var c=1,d=l<10?l:10;else l-obj.pageNumber<5?(d=l,(c=l-9)<1&&(c=1)):(c=obj.pageNumber-4,d=obj.pageNumber+5);c>1&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML="<",R.title=1,obj.pagination.children[1].appendChild(R));for(var E=c;E<=d;E++){var R;(R=document.createElement("div")).className="jexcel_page",R.innerHTML=E,obj.pagination.children[1].appendChild(R),obj.pageNumber==E-1&&R.classList.add("jexcel_page_selected")}d<l&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML=">",R.title=l,obj.pagination.children[1].appendChild(R)),obj.pagination.children[0].innerHTML=function(W){var j=Array.prototype.slice.call(arguments,1);return W.replace(/{(\d+)}/g,function(u,f){return j[f]!==void 0?j[f]:u})}(obj.options.text.showingPage,obj.pageNumber+1,l)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var l="";l+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var c=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(c,obj.options.csvFileName+".csv");else{var d=document.createElement("a"),E=URL.createObjectURL(c);d.href=E,d.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(d),d.click(),d.parentNode.removeChild(d)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var l=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,l+1),obj.history[l]=n}},obj.copy=function(n,l,c,d,E){l||(l="	");for(var R=new RegExp(l,"ig"),W=[],j=[],u=[],f=[],k=[],P=obj.options.data[0].length,b=obj.options.data.length,o="",g=!1,m="",p="",C=0,T=0,I=0,_=0,O=!0,M=0;M<b;M++)for(var D=0;D<P;D++)n&&!obj.records[M][D].classList.contains("highlight")||(I<=D&&(I=D),_<=M&&(_=M));if(P===I+1&&b===_+1&&(O=!1),E&&obj.options.includeHeadersOnDownload==1||!E&&obj.options.includeHeadersOnCopy==1&&!O||d){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(o=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],M=0;M<o.length;M++){var Z=[];for(D=0;D<o[M].length;D++){var q=parseInt(o[M][D].colspan);Z.push(o[M][D].title);for(var ae=0;ae<q-1;ae++)Z.push("")}p+=Z.join(l)+`\r
`}g=!0}for(obj.style=[],M=0;M<b;M++){for(j=[],u=[],D=0;D<P;D++)if(!n||obj.records[M][D].classList.contains("highlight")){g==1&&W.push(obj.headers[D].textContent);var he=obj.options.data[M][D];if(he.match&&(he.match(R)||he.match(/,/g)||he.match(/\n/)||he.match(/\"/))&&(he='"'+(he=he.replace(new RegExp('"',"g"),'""'))+'"'),j.push(he),obj.options.columns[D].type=="checkbox"||obj.options.columns[D].type=="radio")var se=he;else(se=obj.options.stripHTMLOnCopy==1?obj.records[M][D].textContent:obj.records[M][D].innerHTML).match&&(se.match(R)||se.match(/,/g)||se.match(/\n/)||se.match(/\"/))&&(se='"'+(se=se.replace(new RegExp('"',"g"),'""'))+'"');u.push(se),o=(o=obj.records[M][D].getAttribute("style")).replace("display: none;",""),obj.style.push(o||"")}j.length&&(g&&(C=j.length,f.push(W.join(l))),f.push(j.join(l))),u.length&&(T++,g&&(k.push(W.join(l)),g=!1),k.push(u.join(l)))}P==C&&b==T&&(m=p);var be=m+f.join(`\r
`),Le=m+k.join(`\r
`);if(c||(obj.options.copyCompatibility==1?obj.textarea.value=Le:obj.textarea.value=be,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Le:obj.data=be,obj.hashString=obj.hash(obj.data),!c){if(obj.removeCopyingSelection(),obj.highlighted)for(D=0;D<obj.highlighted.length;D++)obj.highlighted[D].classList.add("copying"),obj.highlighted[D].classList.contains("highlight-left")&&obj.highlighted[D].classList.add("copying-left"),obj.highlighted[D].classList.contains("highlight-right")&&obj.highlighted[D].classList.add("copying-right"),obj.highlighted[D].classList.contains("highlight-top")&&obj.highlighted[D].classList.add("copying-top"),obj.highlighted[D].classList.contains("highlight-bottom")&&obj.highlighted[D].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?k:f,obj.hashString)}return obj.data},obj.paste=function(n,l,c){var d=parseInt(n),E=parseInt(l),R=parseInt(obj.selectedCell[2]),W=parseInt(obj.selectedCell[3]),j=R-d+1,u=W-E+1;R<d&&(n=R.toString(),j=d-R+1),W<E&&(l=W.toString(),u=E-W+1);var f=obj.dispatch("onbeforepaste",el,c,n,l);if(f===!1)return!1;f&&(c=f);var k=obj.hash(c),P=k==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&k==obj.hashString&&(c=obj.data),c=obj.parseCSV(c,"	"),j>1&Number.isInteger(j/c[0].length)){P=null,o=j/c[0].length;var b=c.map(function(q,ae){var he=Array.apply(null,{length:o*q.length}).map(function(se,be){return q[be%q.length]});return he});c=b}if(u>1&Number.isInteger(u/c.length)){P=null;var o=u/c.length;b=Array.apply(null,{length:o*c.length}).map(function(q,ae){return c[ae%c.length]}),c=b}if(n!=null&&l!=null&&c){for(var g=0,m=0,p=[],C={},T={},I=0,_=parseInt(n),O=parseInt(l),M=null;M=c[m];){for(g=0,_=parseInt(n);M[g]!=null;){var D=obj.updateCell(_,O,M[g]);if(p.push(D),obj.updateFormulaChain(_,O,p),P&&P[I]){var Z=jexcel.getColumnNameFromId([_,O]);C[Z]=P[I],T[Z]=obj.getStyle(Z),obj.records[O][_].setAttribute("style",P[I]),I++}if(M[++g]!=null){if(_>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}_=obj.right.get(_,O)}}if(m++,c[m]){if(O>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}O=obj.down.get(n,O)}}obj.updateSelectionFromCoords(n,l,_,O),obj.setHistory({action:"setValue",records:p,selection:obj.selectedCell,newStyle:C,oldStyle:T}),obj.updateTable(),obj.dispatch("onpaste",el,c),obj.onafterchanges(el,p)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),l=0;l<n.length;l++)n[l].classList.remove("copying"),n[l].classList.remove("copying-left"),n[l].classList.remove("copying-right"),n[l].classList.remove("copying-top"),n[l].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,l){var c=l.insertBefore?+l.rowNumber:l.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var d=l.numOfRows,E=c;E<d+c;E++)obj.rows[E].parentNode.removeChild(obj.rows[E]);obj.records.splice(c,d),obj.options.data.splice(c,d),obj.rows.splice(c,d),obj.conditionalSelectionUpdate(1,c,d+c-1)}else{obj.records=jexcel.injectArray(obj.records,c,l.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,c,l.rowData),obj.rows=jexcel.injectArray(obj.rows,c,l.rowNode);var R=0;for(E=c;E<l.numOfRows+c;E++)obj.tbody.insertBefore(l.rowNode[R],obj.tbody.children[E]),R++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,l){var c=l.insertBefore?l.columnNumber:l.columnNumber+1;if(n==1){var d=l.numOfColumns;obj.options.columns.splice(c,d);for(var E=c;E<d+c;E++)obj.headers[E].parentNode.removeChild(obj.headers[E]),obj.colgroup[E].parentNode.removeChild(obj.colgroup[E]);obj.headers.splice(c,d),obj.colgroup.splice(c,d);for(var R=0;R<l.data.length;R++){for(E=c;E<d+c;E++)obj.records[R][E].parentNode.removeChild(obj.records[R][E]);obj.records[R].splice(c,d),obj.options.data[R].splice(c,d)}if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R].splice(c,d)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,c,l.columns),obj.headers=jexcel.injectArray(obj.headers,c,l.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,c,l.colgroup);var W=0;for(E=c;E<l.numOfColumns+c;E++)obj.headerContainer.insertBefore(l.headers[W],obj.headerContainer.children[E+1]),obj.colgroupContainer.insertBefore(l.colgroup[W],obj.colgroupContainer.children[E+1]),W++;for(R=0;R<l.data.length;R++)for(obj.options.data[R]=jexcel.injectArray(obj.options.data[R],c,l.data[R]),obj.records[R]=jexcel.injectArray(obj.records[R],c,l.records[R]),W=0,E=c;E<l.numOfColumns+c;E++)obj.rows[R].insertBefore(l.records[R][W],obj.rows[R].children[E+1]),W++;if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R]=jexcel.injectArray(obj.options.footers[R],c,l.footers[R])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(R=0;R<obj.options.nestedHeaders.length;R++){if(n==1)var j=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)-l.numOfColumns;else j=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)+l.numOfColumns;obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan=j,obj.thead.children[R].children[obj.thead.children[R].children.length-1].setAttribute("colspan",j)}else j=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-l.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+l.numOfColumns,obj.options.nestedHeaders[0].colspan=j,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",j);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,l=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var c=[];if(obj.historyIndex>=0){var d=obj.history[obj.historyIndex--];if(d.action=="insertRow")obj.historyProcessRow(1,d);else if(d.action=="deleteRow")obj.historyProcessRow(0,d);else if(d.action=="insertColumn")obj.historyProcessColumn(1,d);else if(d.action=="deleteColumn")obj.historyProcessColumn(0,d);else if(d.action=="moveRow")obj.moveRow(d.newValue,d.oldValue);else if(d.action=="moveColumn")obj.moveColumn(d.newValue,d.oldValue);else if(d.action=="setMerge")obj.removeMerge(d.column,d.data);else if(d.action=="setStyle")obj.setStyle(d.oldValue,null,null,1);else if(d.action=="setWidth")obj.setWidth(d.column,d.oldValue);else if(d.action=="setHeight")obj.setHeight(d.row,d.oldValue);else if(d.action=="setHeader")obj.setHeader(d.column,d.oldValue);else if(d.action=="setComments")obj.setComments(d.column,d.oldValue[0],d.oldValue[1]);else if(d.action=="orderBy"){for(var E=[],R=0;R<d.rows.length;R++)E[d.rows[R]]=R;obj.updateOrderArrow(d.column,d.order?0:1),obj.updateOrder(E)}else if(d.action=="setValue"){for(var W=0;W<d.records.length;W++)c.push({x:d.records[W].x,y:d.records[W].y,newValue:d.records[W].oldValue}),d.oldStyle&&obj.resetStyle(d.oldStyle);obj.setValue(c),d.selection&&obj.updateSelectionFromCoords(d.selection[0],d.selection[1],d.selection[2],d.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=l,obj.dispatch("onundo",el,d)},obj.redo=function(){var n=!!obj.ignoreEvents,l=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var c=obj.history[++obj.historyIndex];if(c.action=="insertRow")obj.historyProcessRow(0,c);else if(c.action=="deleteRow")obj.historyProcessRow(1,c);else if(c.action=="insertColumn")obj.historyProcessColumn(0,c);else if(c.action=="deleteColumn")obj.historyProcessColumn(1,c);else if(c.action=="moveRow")obj.moveRow(c.oldValue,c.newValue);else if(c.action=="moveColumn")obj.moveColumn(c.oldValue,c.newValue);else if(c.action=="setMerge")obj.setMerge(c.column,c.colspan,c.rowspan,1);else if(c.action=="setStyle")obj.setStyle(c.newValue,null,null,1);else if(c.action=="setWidth")obj.setWidth(c.column,c.newValue);else if(c.action=="setHeight")obj.setHeight(c.row,c.newValue);else if(c.action=="setHeader")obj.setHeader(c.column,c.newValue);else if(c.action=="setComments")obj.setComments(c.column,c.newValue[0],c.newValue[1]);else if(c.action=="orderBy")obj.updateOrderArrow(c.column,c.order),obj.updateOrder(c.rows);else if(c.action=="setValue"){obj.setValue(c.records);for(var d=0;d<c.records.length;d++)c.oldStyle&&obj.resetStyle(c.newStyle);c.selection&&obj.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=l,obj.dispatch("onredo",el,c)},obj.getDropDownValue=function(n,l){var c=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var d=[],E=obj.options.columns[n].source,R=0;R<E.length;R++)typeof E[R]=="object"?d[E[R].id]=E[R].name:d[E[R]]=E[R];var W=Array.isArray(l)?l:(""+l).split(";");for(R=0;R<W.length;R++)typeof W[R]=="object"?c.push(d[W[R].id]):d[W[R]]&&c.push(d[W[R]])}else console.error("Invalid column");return c.length>0?c.join("; "):""},obj.parseCSV=function(n,l){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),l=l||",";for(var c=[],d=!1,E=0,R=0,W=0;W<n.length;W++){var j=n[W],u=n[W+1];c[E]=c[E]||[],c[E][R]=c[E][R]||"",j=='"'&&d&&u=='"'?(c[E][R]+=j,++W):j!='"'?j!=l||d?j!="\r"||u!=`
`||d?j==`
`&&!d||j=="\r"&&!d?(++E,R=0):c[E][R]+=j:(++E,R=0,++W):++R:d=!d}return c},obj.hash=function(n){var l,c=0;if(n.length===0)return c;for(l=0;l<n.length;l++)c=(c<<5)-c+n.charCodeAt(l),c|=0;return c},obj.onafterchanges=function(n,l){obj.dispatch("onafterchanges",n,l)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var l=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&l.length>0)for(var c=l.shift(),d=0;d<c.length;d++)obj.options.columns[d]||(obj.options.columns[d]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[d].title===void 0&&(obj.options.columns[d].title=c[d]);obj.options.data=l,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,l,c,d){var E=[];if(c==null)obj.options.allowInsertColumn==1&&E.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(l),1)}}),obj.options.allowInsertColumn==1&&E.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(l),0)}}),obj.options.allowDeleteColumn==1&&E.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(l))}}),obj.options.allowRenameColumn==1&&E.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(l)}}),obj.options.columnSorting==1&&(E.push({type:"line"}),E.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(l,0)}}),E.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(l,1)}}));else if(obj.options.allowInsertRow==1&&(E.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(c),1)}}),E.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(c))}})),obj.options.allowDeleteRow==1&&E.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(c))}}),l&&obj.options.allowComments==1){E.push({type:"line"});var R=obj.records[c][l].getAttribute("title")||"";E.push({title:R?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var W=prompt(obj.options.text.comments,R);W&&obj.setComments([l,c],W)}}),R&&E.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([l,c],"")}})}return E.push({type:"line"}),E.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&E.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(W){W&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],W)})}}),obj.options.allowExport&&E.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&E.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),E},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var l=0;l<obj.options.freezeColumns;l++)n+=parseInt(obj.options.columns[l].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var l=0;l<obj.options.freezeColumns;l++){l>0&&obj.options.columns[l-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[l-1].width)),obj.headers[l].classList.add("jexcel_freezed"),obj.headers[l].style.left=n+"px";for(var c=0;c<obj.rows.length;c++)if(obj.rows[c]&&obj.records[c][l]){var d=scrollLeft+(l>0?obj.records[c][l-1].style.width:0)-51+"px";obj.records[c][l].classList.add("jexcel_freezed"),obj.records[c][l].style.left=d}}else for(l=0;l<obj.options.freezeColumns;l++)for(obj.headers[l].classList.remove("jexcel_freezed"),obj.headers[l].style.left="",c=0;c<obj.rows.length;c++)obj.records[c][l]&&(obj.records[c][l].classList.remove("jexcel_freezed"),obj.records[c][l].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var l=Object.keys(n),c=0;c<l.length;c++)typeof n[l[c]]=="function"&&(jexcel[l[c]]=n[l[c]],jexcel.license&&typeof n[l[c]].license=="function"&&n[l[c]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,l){if(n.jexcel){var c=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",l&&(destroyEvents(c),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var l=jexcel.current.edition[0].children[0],c=jexcel.current.edition[0].children[0].value,d=l.selectionStart;c=c.slice(0,d)+`
`+c.slice(d),l.value=c,l.focus(),l.selectionStart=d+1,l.selectionEnd=d+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46||n.which==8)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var E=jexcel.current.selectedCell[1],R=jexcel.current.selectedCell[0];jexcel.current.options.columns[R].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[R].type=="checkbox"||jexcel.current.options.columns[R].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[E][R],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[E][R],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[E][R],!0),jexcel.current.options.columns[R].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;var c=jexcel.getElement(n.target);if(c[0]?jexcel.current!=c[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=c[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&l==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(c[1]==1){if(o=n.target.getAttribute("data-x")){var d=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&d.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:o,width:d.width},jexcel.current.headers[o].classList.add("resizing");for(var E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][o]&&jexcel.current.records[E][o].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&d.height-n.offsetY<6)if(jexcel.current.isColMerged(o).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:o,destination:o},jexcel.current.headers[o].classList.add("dragging"),E=0;E<jexcel.current.records.length;E++)jexcel.current.records[E][o]&&jexcel.current.records[E][o].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var R=jexcel.current.selectedHeader,W=o;else jexcel.current.selectedHeader==o&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(o)},800)),jexcel.current.selectedHeader=o,R=o,W=o;jexcel.current.updateSelectionFromCoords(R,0,W,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var j=n.target.getAttribute("data-column").split(","),u=parseInt(j[0]),f=parseInt(j[j.length-1]);else u=0,f=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(u,0,f,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(c[1]==2){var k=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))d=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&d.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:k,height:d.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&d.width-n.offsetX<6?jexcel.current.isRowMerged(k).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:k,destination:k},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(R=jexcel.current.selectedRow,W=k):(jexcel.current.selectedRow=k,R=k,W=k),jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,W));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var P=function(g){var m=g.getAttribute("data-x"),p=g.getAttribute("data-y");return m&&p?[m,p]:g.parentNode?P(g.parentNode):void 0},b=P(n.target);if(b){var o=b[0];k=b[1],jexcel.current.edition&&(jexcel.current.edition[2]==o&&jexcel.current.edition[3]==k||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,k):jexcel.current.updateSelectionFromCoords(o,k)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var l=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),c=jexcel.current.getSelectedColumns();if(c.length>1){for(var d=[],E=0;E<c.length;E++)d.push(parseInt(jexcel.current.colgroup[c[E]].getAttribute("width")));d[c.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(c,l,d)}else jexcel.current.setWidth(jexcel.current.resizing.column,l,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var R=0;R<jexcel.current.records.length;R++)jexcel.current.records[R][jexcel.current.resizing.column]&&jexcel.current.records[R][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var W=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,W,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var j=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),R=0;R<jexcel.current.rows.length;R++)jexcel.current.records[R][jexcel.current.dragging.column]&&jexcel.current.records[R][jexcel.current.dragging.column].classList.remove("dragging");for(E=0;E<jexcel.current.headers.length;E++)jexcel.current.headers[E].classList.remove("dragging-left"),jexcel.current.headers[E].classList.remove("dragging-right");j&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var u=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<u&&(u-=1)}else u=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,u,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;if(l||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var c=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+c>0){var d=jexcel.current.resizing.width+c;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",d),jexcel.current.updateCornerPosition()}}else{var E=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+E>0){var R=jexcel.current.resizing.height+E;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",R),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var W=n.target.getAttribute("data-x");if(W)if(jexcel.current.isColMerged(W).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var j=0;j<jexcel.current.headers.length;j++)jexcel.current.headers[j].classList.remove("dragging-left"),jexcel.current.headers[j].classList.remove("dragging-right");jexcel.current.dragging.column==W?jexcel.current.dragging.destination=parseInt(W):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<W?jexcel.current.dragging.destination=parseInt(W)-1:jexcel.current.dragging.destination=parseInt(W),jexcel.current.headers[W].classList.add("dragging-left")):(jexcel.current.dragging.column<W?jexcel.current.dragging.destination=parseInt(W):jexcel.current.dragging.destination=parseInt(W)+1,jexcel.current.headers[W].classList.add("dragging-right"))}}else{var u=n.target.getAttribute("data-y");if(u)if(jexcel.current.isRowMerged(u).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var f=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=f&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,f),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var k=n.target.getAttribute("data-x"),P=n.target.getAttribute("data-y"),b=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&k&&!P&&b.width-(n.clientX-b.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!k&&P&&b.height-(n.clientY-b.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!k&&P&&b.width-(n.clientX-b.left)<6||n.target&&k&&!P&&b.height-(n.clientY-b.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;if(l||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var c=jexcel.getElement(n.target);if(c[0]){if(jexcel.current!=c[0].jexcel&&jexcel.current)return!1;var d=n.target.getAttribute("data-x"),E=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(c[1]==1&&jexcel.current.selectedHeader){d=n.target.getAttribute("data-x");var R=jexcel.current.selectedHeader,W=d;jexcel.current.updateSelectionFromCoords(R,0,W,jexcel.current.options.data.length-1)}c[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(R=jexcel.current.selectedRow,W=E,jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,W)):jexcel.current.edition||d&&E&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(d,E):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],d,E)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var l=jexcel.current.highlighted[0].getAttribute("data-x"),c=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,d=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),E=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[c][l],jexcel.current.records[E][d])}}else if(n.target.classList.contains("jexcel_column_filter")){var R=n.target.getAttribute("data-x");jexcel.current.openFilter(R)}else{var W=jexcel.getElement(n.target);if(W[1]==1&&jexcel.current.options.columnSorting==1&&(R=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(R),W[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var j=function(f){if(f.parentNode){var k=f.getAttribute("data-x"),P=f.getAttribute("data-y");return k&&P?f:j(f.parentNode)}},u=j(n.target);u&&u.classList.contains("highlight")&&jexcel.current.openEditor(u)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var l=n.target.getAttribute("data-x"),c=n.target.getAttribute("data-y");if(l||c){(l<parseInt(jexcel.current.selectedCell[0])||l>parseInt(jexcel.current.selectedCell[2])||c<parseInt(jexcel.current.selectedCell[1])||c>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(l,c,l,c);var d=jexcel.current.options.contextMenu(jexcel.current,l,c,n);jexcel.current.contextMenu.contextmenu.open(n,d),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var l=jexcel.getElement(n.target);if(l[0]?jexcel.current!=l[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=l[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var c=n.target.getAttribute("data-x"),d=n.target.getAttribute("data-y");c&&d&&(jexcel.current.updateSelectionFromCoords(c,d),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[c].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,l){var c=[];if(n.classList.contains("jexcel_tabs"))E=n.children[0],R=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var d=document.createElement("div"),E=n.appendChild(d),R=(d=document.createElement("div"),n.appendChild(d))}for(var W=[],j=[],u=0;u<l.length;u++){W[u]=document.createElement("div"),W[u].classList.add("jexcel_tab");var f=jexcel(W[u],l[u]);R.appendChild(W[u]),c[u]=n.jexcel.push(f),j[u]=document.createElement("div"),j[u].classList.add("jexcel_tab_link"),j[u].setAttribute("data-spreadsheet",n.jexcel.length-1),j[u].innerHTML=l[u].sheetName,j[u].onclick=function(){for(var P=0;P<E.children.length;P++)E.children[P].classList.remove("selected"),R.children[P].style.display="none";var b=this.getAttribute("data-spreadsheet");R.children[b].style.display="block",E.children[b].classList.add("selected")},E.appendChild(j[u])}for(var k=0;k<E.children.length;k++)E.children[k].classList.remove("selected"),R.children[k].style.display="none";return E.children[E.children.length-1].classList.add("selected"),R.children[E.children.length-1].style.display="block",c},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,l){var c,d=function(E){var R=[];return E.SheetNames.forEach(function(W){var j={rows:[],columns:[],data:[],style:{}};if(j.sheetName=W,(p=E.Sheets[W]["!cols"])&&p.length)for(var u=0;u<p.length;u++)j.columns[u]={},p[u]&&p[u].wpx&&(j.columns[u].width=p[u].wpx+"px");if((p=E.Sheets[W]["!rows"])&&p.length)for(u=0;u<p.length;u++)p[u]&&p[u].hpx&&(j.rows[u]={},j.rows[u].height=p[u].hpx+"px");if((p=E.Sheets[W]["!merges"])&&p.length>0)for(j.mergeCells=[],u=0;u<p.length;u++){var f=p[u].s.c,k=p[u].s.r,P=p[u].e.c,b=p[u].e.r,o=jexcel.getColumnNameFromId([f,k]);j.mergeCells[o]=[P-f+1,b-k+1]}var g=0,m=0,p=Object.keys(E.Sheets[W]);for(u=0;u<p.length;u++)if(p[u].substr(0,1)!="!"){var C=E.Sheets[W][p[u]],T=jexcel.getIdFromColumnName(p[u],!0);j.data[T[1]]||(j.data[T[1]]=[]),j.data[T[1]][T[0]]=C.f?"="+C.f:C.w,g<T[0]&&(g=T[0]),m<T[1]&&(m=T[1]),C.style&&Object.keys(C.style).length>0&&(j.style[p[u]]=C.style),C.s&&C.s.fgColor&&(j.style[p[u]]&&(j.style[p[u]]+=";"),j.style[p[u]]+="background-color:#"+C.s.fgColor.rgb)}for(var I=j.columns,_=0;_<=m;_++)for(u=0;u<=g;u++)j.data[_]||(j.data[_]=[]),j.data[_][u]||I<u&&(j.data[_][u]="");R.push(j)}),R};(c=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array<"u"?(c.responseType="arraybuffer",c.onload=function(E){var R=c.response,W=new Uint8Array(R),j=XLSX.read(W,{type:"array",cellFormula:!0,cellStyles:!0});l(d(j))}):(c.setRequestHeader("Accept-Charset","x-user-defined"),c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var E=convertResponseBodyToText(c.responseBody),R=XLSX.read(E,{type:"binary",cellFormula:!0,cellStyles:!0});l(d(R))}}),c.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,l,c){return n.slice(0,l).concat(c).concat(n.slice(l))},jexcel.getColumnName=function(n){return jexcel.helpers.getColumnName(n)},jexcel.getIdFromColumnName=function(n,l){var c=/^[a-zA-Z]+/.exec(n);if(c){for(var d=0,E=0;E<c[0].length;E++)d+=parseInt(c[0].charCodeAt(E)-64)*Math.pow(26,c[0].length-1-E);--d<0&&(d=0);var R=parseInt(/[0-9]+$/.exec(n));R>0&&R--,n=l==1?[d,R]:d+"-"+R}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var l=0,c=0;return function d(E){E.className&&E.classList.contains("jexcel_container")&&(c=E),E.tagName=="THEAD"?l=1:E.tagName=="TBODY"&&(l=2),E.parentNode&&(c||d(E.parentNode))}(n),[c,l]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,l){if(n.tagName=="TABLE"){l||(l={}),l.columns=[],l.data=[];var c=n.querySelectorAll("colgroup > col");if(c.length)for(var d=0;d<c.length;d++){if(!(E=c[d].style.width))var E=c[d].getAttribute("width");E&&(l.columns[d]||(l.columns[d]={}),l.columns[d].width=E)}var R=function(be){var Le=be.getBoundingClientRect(),me=Le.width>50?Le.width:50;l.columns[d]||(l.columns[d]={}),be.getAttribute("data-celltype")?l.columns[d].type=be.getAttribute("data-celltype"):l.columns[d].type="text",l.columns[d].width=me+"px",l.columns[d].title=be.innerHTML,l.columns[d].align=be.style.textAlign||"center",(Le=be.getAttribute("name"))&&(l.columns[d].name=Le),(Le=be.getAttribute("id"))&&(l.columns[d].id=Le),(Le=be.getAttribute("data-mask"))&&(l.columns[d].mask=Le)},W=[],j=n.querySelectorAll(":scope > thead > tr");if(j.length){for(var u=0;u<j.length-1;u++){var f=[];for(d=0;d<j[u].children.length;d++){var k={title:j[u].children[d].textContent,colspan:j[u].children[d].getAttribute("colspan")||1};f.push(k)}W.push(f)}for(j=j[j.length-1].children,d=0;d<j.length;d++)R(j[d])}var P=0,b={},o={},g={},m={},p=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(u=0;u<p.length;u++)if(l.data[P]=[],l.parseTableFirstRowAsHeader!=1||j.length||u!=0){for(d=0;d<p[u].children.length;d++){if(C=p[u].children[d].getAttribute("data-formula"))C.substr(0,1)!="="&&(C="="+C);else var C=p[u].children[d].innerHTML;l.data[P].push(C);var T=jexcel.getColumnNameFromId([d,u]),I=p[u].children[d].getAttribute("class");I&&(m[T]=I);var _=parseInt(p[u].children[d].getAttribute("colspan"))||0,O=parseInt(p[u].children[d].getAttribute("rowspan"))||0;(_||O)&&(b[T]=[_||1,O||1]),p[u].children[d].style&&p[u].children[d].style.display=="none"&&(p[u].children[d].style.display="");var M=p[u].children[d].getAttribute("style");M&&(g[T]=M),p[u].children[d].classList.contains("styleBold")&&(g[T]?g[T]+="; font-weight:bold;":g[T]="font-weight:bold;")}p[u].style&&p[u].style.height&&(o[u]={height:p[u].style.height}),P++}else for(d=0;d<p[u].children.length;d++)R(p[u].children[d]);if(Object.keys(W).length>0&&(l.nestedHeaders=W),Object.keys(g).length>0&&(l.style=g),Object.keys(b).length>0&&(l.mergeCells=b),Object.keys(o).length>0&&(l.rows=o),Object.keys(m).length>0&&(l.classes=m),(p=n.querySelectorAll("tfoot tr")).length){var D=[];for(u=0;u<p.length;u++){var Z=[];for(d=0;d<p[u].children.length;d++)Z.push(p[u].children[d].textContent);D.push(Z)}Object.keys(D).length>0&&(l.footers=D)}if(l.parseTableAutoCellType==1){var q=[];for(d=0;d<l.columns.length;d++){var ae=!0,he=!0;for(q[d]=[],u=0;u<l.data.length;u++)C=l.data[u][d],q[d][C]||(q[d][C]=0),q[d][C]++,C.length>25&&(ae=!1),C.length==10&&C.substr(4,1)=="-"&&C.substr(7,1)=="-"||(he=!1);var se=Object.keys(q[d]).length;he?l.columns[d].type="calendar":ae==1&&se>1&&se<=parseInt(.1*l.data.length)&&(l.columns[d].type="dropdown",l.columns[d].source=Object.keys(q[d]))}}return l}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var l=this.config.root;else l=window;var c=0,d=l.getSelection();if(d&&d.rangeCount!==0){var E=d.getRangeAt(0),R=E.cloneRange();R.selectNodeContents(n),R.setEnd(E.endContainer,E.endOffset),c=R.toString().length}return c},invert:function(n){for(var l=[],c=Object.keys(n),d=0;d<c.length;d++)l[n[c[d]]]=c[d];return l},getColumnName:function(n){let l,c=n+1,d="";for(;c>0;)l=(c-1)%26,d=String.fromCharCode(65+l).toString()+d,c=parseInt((c-l)/26);return d},getColumnNameFromCoords:function(n,l){return component.getColumnName(parseInt(n))+(parseInt(l)+1)},getCoordsFromColumnName:function(n){var l=/^[a-zA-Z]+/.exec(n);if(l){for(var c=0,d=0;d<l[0].length;d++)c+=parseInt(l[0].charCodeAt(d)-64)*Math.pow(26,l[0].length-1-d);--c<0&&(c=0);var E=parseInt(/[0-9]+$/.exec(n))||null;return E>0&&E--,[c,E]}},createFromTable:function(){},injectArray:function(n,l,c){return n.slice(0,l).concat(c).concat(n.slice(l))},parseCSV:function(n,l){l=l||",";for(var c=0,d=0,E=[[]],R=0,W=null,j=!1,u=!1,f=0;f<n.length;f++)if(E[d]||(E[d]=[]),E[d][c]||(E[d][c]=""),n[f]!="\r")if(n[f]!=`
`&&n[f]!=l||j!=0&&u!=1&&W){if(n[f]=='"'&&(j=!j),W===null){if((W=j)==1)continue}else if(W===!0&&!u&&n[f]=='"'){n[f+1]=='"'?(j=!0,E[d][c]+=n[f],f++):u=!0;continue}E[d][c]+=n[f]}else{if(W=null,j=!1,u=!1,E[d][c][0]=='"'){var k=E[d][c].trim();k[k.length-1]=='"'&&(E[d][c]=k.substr(1,k.length-2))}n[f]==`
`?(c=0,d++):++c>R&&(R=c)}for(var P=0;P<E.length;P++)for(f=0;f<=R;f++)E[P][f]===void 0&&(E[P][f]="");return E}},component),typeof jQuery<"u"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(l){var c=n(this).get(0);return c.jexcel?Array.isArray(c.jexcel)?c.jexcel[l][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):c.jexcel[l].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(n){var l=__webpack_module_cache__[n];if(l!==void 0)return l.exports;var c=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(c.exports,c,c.exports,__webpack_require__),c.exports}var __webpack_exports__=__webpack_require__(44);jspreadsheet=__webpack_exports__}(),jspreadsheet})}(dist$1)),dist$1.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs(distExports),_hoisted_1={class:"grid grid-rows-[55px,1fr]"},_hoisted_2={class:"flex-grow mt-10"},docId=167,_sfc_main={__name:"Documents",setup(n){const l=ref(new Date),c=ref(null),d=ref([]);let E=null;const R=async o=>{try{const{data:g}=await axios.get(`/selectResultBlogs/${docId}/${f(o)}`);d.value=g}catch(g){console.error(g)}};function W(){if(!d.value||typeof d.value!="object")return"";const o=Object.keys(d.value||{});if(!o.length)return"";const g=d.value[o[0]];if(!g)return"";const m=Object.keys(g);if(!m.length)return"";const p=g[m[0]];if(!p)return"";const C=Object.keys(p);if(!C.length)return"";const T=p[C[0]];return!T||!T.length?"":T[0].group_name||""}const j=W();E&&j&&E.setValue("A3",j);const u={A1:"border-left:2px solid #000;border-right:1px solid #fff;border-top:1px solid #000;border-bottom:1px solid #000;w-200;",A2:"background:yellow",B2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",C2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",D2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",E2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",F2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",G2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",H2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",I2:"border-right:none;border-left:none;background:yellow;font-weight: bold;",A3:"border-right:none;border-left:none;font-weight: bold;",B3:"border-right:none;border-left:none;font-weight: bold;",C3:"border-right:none;border-left:none;font-weight: bold;",A4:"font-weight: bold;",B4:"font-weight: bold;",C4:"color:red;font-weight: bold;"};function f(o){if(!o)return"";const g=new Date(o),m=String(g.getDate()).padStart(2,"0"),p=String(g.getMonth()+1).padStart(2,"0"),C=g.getFullYear();return`${m}.${p}.${C}`}onMounted(()=>{R(l.value);const o=[[f(l.value),...Array(18).fill("")],Array(300).fill("")];function g(p){let C="",T=p;for(;T>=0;)C=String.fromCharCode(T%26+65)+C,T=Math.floor(T/26)-1;return C}const m=Array.from({length:300},(p,C)=>({title:g(C),width:C===0?150:100}));E=jspreadsheet(c.value,{data:o,style:u,columns:m,minDimensions:[300,150],merge:[{row:0,col:0,rowspan:1,colspan:14},{row:1,col:0,rowspan:1,colspan:14}],onchange:(p,C,T,I,_)=>{P(T)}}),E.setValue("A1",f(l.value)),E.setValue("C2","OTK"),E.setValue("D2",""),E.setValue("E2","laboratoriyasi"),E.setValue("G2","tahlili")});function k(o){if(!o)return"";const g=o.split(":");return g[0]+":"+g[1]}function P(o){let g="",m=o;for(;m>=0;)g=String.fromCharCode(m%26+65)+g,m=Math.floor(m/26)-1;return g}function b(o,g,m,p,C,T="#d10000"){const I=g+p-1,_=m+C-1;let O={};for(let M=g;M<=I;M++)O[`${P(m)}${M+1}`]=`border-left: 2px solid ${T};`,O[`${P(_)}${M+1}`]=`border-right: 2px solid ${T};`;for(let M=m;M<=_;M++){const D=P(M);O[`${D}${g+1}`]=`border-top: 2px solid ${T};`,O[`${D}${I+1}`]=`border-bottom: 2px solid ${T};`}o.setStyle(O)}return watch(l,o=>{E&&(E.setValue("A1",f(o)),R(o))}),watch(d,()=>{console.log("Qabul qilingan rowData:",d.value);let o=W();console.log("Aniqlangan groupName:",o),E&&o&&E.setValue("A3",o)}),watch(d,()=>{const o=Object.keys(d.value||{});if(!E||!o.length)return;let g=2,m=0,p=0;o.forEach(C=>{const T=d.value[C],I=Object.keys(T);let _=0;I.forEach(O=>{var me,ie;const M=T[O],D=Object.keys(M),Z=new Set;D.forEach(Re=>{(M[Re]||[]).forEach(Be=>Z.add(Be.parameter_name))});const q=Array.from(Z),ae=Array.from(new Set(D.map(Re=>{var Be;return((Be=(M[Re]||[])[0])==null?void 0:Be.time_name)||""}))).sort(),he=q.length+1,se=ae.length+3;_=Math.max(_,se),E.setValueFromCoords(m,g,((ie=(me=M[D[0]])==null?void 0:me[0])==null?void 0:ie.group_name)||""),E.setValueFromCoords(m,g+1,`${O}-Smena`);const be={};for(let Re=0;Re<he;Re++){const _e=`${P(m+Re)}${g+1}`;be[_e]="background: #c7efc4; font-weight: bold;";const Be=`${P(m+Re)}${g+2}`;be[Be]="background: #cfe2f3; font-weight: bold;";const He=`${P(m+Re)}${g+3}`;be[He]="background: #c9b2d6; font-weight: bold;"}setTimeout(()=>E.setStyle(be),10),E.setValueFromCoords(m,g+2,"Vaqt"),q.forEach((Re,_e)=>{E.setValueFromCoords(m+1+_e,g+2,Re)});const Le=new Map;q.forEach((Re,_e)=>Le.set(Re,_e)),ae.forEach((Re,_e)=>{const Be=g+3+_e;E.setValueFromCoords(m,Be,k(Re));const He=E.getCellFromCoords(m,Be);He&&(He.style.backgroundColor="#bbfcc1",He.style.fontWeight="bold");const lt=[];D.forEach(Y=>{var qe;const Me=M[Y]||[];((qe=Me[0])==null?void 0:qe.time_name)===Re&&lt.push(...Me)}),lt.forEach(Y=>{const Me=Y.parameter_name,qe=Le.get(Me);if(qe===void 0)return;const pt=m+1+qe,Ze=Number(Y.Value);E.setValueFromCoords(pt,Be,isNaN(Ze)?Y.Value:Ze);const Ae=Number(Y.Min),Ne=E.getCellFromCoords(pt,Be);Ne&&!isNaN(Ze)&&!isNaN(Ae)&&Ze<Ae&&(Ne.style.backgroundColor="yellow",Ne.style.color="red",Ne.style.fontWeight="bold"),Y.WithFormula==="1"&&Ne&&(Ne.style.border="1px dashed #444")})}),setTimeout(()=>b(E,g,m,se,he,"#d10000"),10),p+=1,p%2===0?(g+=_+2,m=0):m+=he+2}),p%2!==0&&(g+=_+2,m=0,p=0)})}),(o,g)=>{const m=resolveComponent("VaDateInput");return openBlock(),createElementBlock("div",_hoisted_1,[g[1]||(g[1]=createBaseVNode("main",null,null,-1)),createBaseVNode("main",_hoisted_2,[createVNode(m,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=p=>l.value=p),class:"mb-10",onchange:"fetchData(value)"},null,8,["modelValue"]),createBaseVNode("div",{ref_key:"sheetEl",ref:c,style:{width:"100vw",height:"100vh"}},null,512)])])}}};export{_sfc_main as default};
