import{u as k,r as f,G as R,d as B,c as M,f as v,g as U,h as H,k as r,j as o,D as P,l as w,i as p,t as I,V as F,m as h,H as O,x as L,o as q,B as J}from"./app-e6aecf6e.js";/* empty css                   */import{f as $}from"./format-45c98358.js";const z={class:"h-full w-full text-center content-center"},K={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},Q={class:"grid grid-cols-2 md:grid-cols-3 gap-3 items-end"},W={__name:"EditGraphicTimesModal",props:["params"],setup(y){const{init:_}=k(),t=y,g=f(!1),b=f([]),T=f([]),V=R("onupdated"),s=B({GraphicId:"",ChangeId:"",Name:"",StartTime:"",EndTime:null,id:t.params.data.id}),{t:d}=M();function l(i){const[n,e,a]=i.split(":"),m=new Date;return m.setHours(parseInt(n,10)),m.setMinutes(parseInt(e,10)),m.setSeconds(parseInt(a,10)),m}function x(i){return i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}const C={StartTime:"08:00:00.0000000",EndTime:"08:05:00.0000000"},G=l(C.StartTime),D=l(C.EndTime);x(G),x(D);const E=async()=>{try{const i=await h.get("/graphics"),n=await h.get("/changes");b.value=i.data.map(a=>({value:a.id,text:a.Name})),T.value=n.data.map(a=>({value:a.Change,text:a.Change}));const e=await h.get(`graphictimes/${t.params.data.id}`);s.GraphicId=+e.data.Gid,s.ChangeId=+e.data.Chid}catch(i){console.error("Error fetching data:",i)}},N=async()=>{try{const{data:i}=await h.put("/graphictimes",s);i.status===200?(g.value=!1,V(t.params.node,i.unit),_({message:d("login.successMessage"),color:"success"})):console.error("Error saving data:",i.message)}catch(i){console.error("Error saving data:",i)}};return(i,n)=>{const e=v("VaSelect"),a=v("VaTimeInput"),m=v("VaModal");return U(),H("main",z,[r(o(P),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:n[0]||(n[0]=u=>g.value=!0)}),r(m,{modelValue:g.value,"onUpdate:modelValue":n[6]||(n[6]=u=>g.value=u),"ok-text":o(d)("modals.apply"),"cancel-text":o(d)("modals.cancel"),onOk:N,onClose:n[7]||(n[7]=u=>g.value=!1),"close-button":""},{default:w(()=>[p("h3",{class:"va-h3",onVnodeMounted:E},I(o(d)("modals.editFactory")),513),p("div",null,[r(o(F),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:w(()=>[p("div",K,[r(e,{modelValue:s.GraphicId,"onUpdate:modelValue":n[1]||(n[1]=u=>s.GraphicId=u),"value-by":"value",class:"mb-6",label:o(d)("form.selectGraphic"),options:b.value,clearable:""},null,8,["modelValue","label","options"]),r(e,{modelValue:s.ChangeId,"onUpdate:modelValue":n[2]||(n[2]=u=>s.ChangeId=u),"value-by":"value",class:"mb-6",label:o(d)("form.selectChange"),options:T.value,clearable:""},null,8,["modelValue","label","options"])]),p("div",Q,[r(a,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(d)("form.name"),modelValue:s.Name,"onUpdate:modelValue":n[3]||(n[3]=u=>s.Name=u)},null,8,["label","modelValue"]),r(a,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(d)("form.startTime"),modelValue:s.Name,"onUpdate:modelValue":n[4]||(n[4]=u=>s.Name=u)},null,8,["label","modelValue"]),r(a,{modelValue:s.EndTime,"onUpdate:modelValue":n[5]||(n[5]=u=>s.EndTime=u),clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(d)("form.endTime")},null,8,["modelValue","label"])])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},X={class:"h-full w-full text-center content-center"},Y={class:"va-h3"},Z={__name:"DeleteGraphicTimesModal",props:["params"],setup(y){const{init:_}=k(),{t}=M(),g=f(!1),b=y,T=R("ondeleted"),V=async()=>{try{const{data:s}=await h.delete(`/graphictimes/${b.params.data.id}`);s.status===200?(T(b.params.data),_({message:t("login.successMessage"),color:"success"}),g.value=!1):console.error("Error deleting data:",s.message)}catch(s){console.error("Error deleting data:",s)}};return(s,d)=>{const l=v("VaModal");return U(),H("main",X,[r(o(P),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:d[0]||(d[0]=x=>g.value=!0)}),r(l,{modelValue:g.value,"onUpdate:modelValue":d[1]||(d[1]=x=>g.value=x),"ok-text":o(t)("modals.apply"),"cancel-text":o(t)("modals.cancel"),onClose:d[2]||(d[2]=x=>g.value=!1),onOk:V,"close-button":""},{default:w(()=>[p("h3",Y,I(o(t)("modals.title")),1),p("p",null,I(o(t)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}};const ee={class:"grid grid-rows-[55px,1fr]"},ae={class:"flex justify-between"},te=p("span",{class:"flex w-full"},null,-1),le={class:"va-h3"},oe={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},se={class:"grid grid-cols-2 md:grid-cols-3 gap-3 items-end"},ne={class:"flex-grow"},ce={__name:"GraphicTimesPage",setup(y){const{locale:_,t}=M(),{init:g}=k(),b=f([]),T=f(null),V=f(!1),s=f([]),d=f([]),l=B({GraphicId:"",ChangeId:"",Name:"",StartTime:"",EndTime:"",Current:!1});function x(e){T.value.applyTransaction({remove:[e]})}function C(e,a){e.setData(a)}O("ondeleted",x),O("onupdated",C);const G=()=>{console.log(l.Current)},D=L(()=>[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:"ID",field:"id",width:80},{headerName:t("table.change"),field:"Change",width:120},{headerName:t("table.graphicName"),field:"GName",flex:1},{headerName:t("table.name"),field:"Name",flex:1,valueFormatter:e=>$(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.startTime"),field:"StartTime",valueFormatter:e=>$(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.endTime"),field:"EndTime",valueFormatter:e=>$(new Date(`1970-01-01T${e.value}`),"HH:mm")},{headerName:t("table.comment"),field:"Comment",flex:1},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:W},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:Z}]),E={sortable:!0,filter:!0},N=async()=>{try{const e=await h.get("/graphictimes");b.value=Array.isArray(e.data)?e.data:e.data.items}catch(e){console.error("Error fetching data:",e)}},i=async()=>{try{const e=await h.get("/graphics"),a=await h.get("/changes");s.value=e.data.map(m=>({value:m.id,text:m.Name})),d.value=a.data.map(m=>({value:m.Change,text:m.Change}))}catch(e){console.error("Error fetching graphics data:",e)}},n=async()=>{try{const{data:e}=await h.post("/graphictimes",l);e.status===200?(V.value=!1,l.GraphicId="",l.ChangeId="",l.Name="",l.StartTime="",l.EndTime="",l.Current=!1,await N(),g({message:t("login.successMessage"),color:"success"})):console.error("Error saving data:",e.message)}catch(e){console.error("Error saving data:",e)}};return q(()=>{const e=localStorage.getItem("locale");e&&(_.value=e),N(),i()}),(e,a)=>{const m=v("VaSelect"),u=v("VaSwitch"),S=v("VaTimeInput"),j=v("VaModal"),A=v("ag-grid-vue");return U(),H("div",ee,[p("main",null,[p("div",ae,[te,r(o(P),{onClick:a[0]||(a[0]=c=>V.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),r(j,{modelValue:V.value,"onUpdate:modelValue":a[7]||(a[7]=c=>V.value=c),"ok-text":o(t)("buttons.save"),"cancel-text":o(t)("buttons.cancel"),onOk:n,"close-button":""},{default:w(()=>[p("h3",le,I(o(t)("modals.addGraphicTimesTitle")),1),p("div",null,[r(o(F),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:w(()=>[p("div",oe,[r(m,{modelValue:l.GraphicId,"onUpdate:modelValue":a[1]||(a[1]=c=>l.GraphicId=c),"value-by":"value",class:"mb-6",label:o(t)("form.selectGraphic"),options:s.value,clearable:""},null,8,["modelValue","label","options"]),r(m,{modelValue:l.ChangeId,"onUpdate:modelValue":a[2]||(a[2]=c=>l.ChangeId=c),"value-by":"value",class:"mb-6",label:o(t)("form.selectChange"),options:d.value,clearable:""},null,8,["modelValue","label","options"]),r(u,{modelValue:l.Current,"onUpdate:modelValue":a[3]||(a[3]=c=>l.Current=c),class:"mb-2",onChange:G},{innerLabel:w(()=>[J(" Joriy vaqtda ")]),_:1},8,["modelValue"])]),p("div",se,[r(S,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(t)("form.name"),modelValue:l.Name,"onUpdate:modelValue":a[4]||(a[4]=c=>l.Name=c)},null,8,["label","modelValue"]),r(S,{clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(t)("form.startTime"),modelValue:l.Name,"onUpdate:modelValue":a[5]||(a[5]=c=>l.Name=c)},null,8,["label","modelValue"]),r(S,{modelValue:l.EndTime,"onUpdate:modelValue":a[6]||(a[6]=c=>l.EndTime=c),clearable:"","clearable-icon":"cancel",color:"textPrimary",label:o(t)("form.endTime")},null,8,["modelValue","label"])])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),p("main",ne,[r(A,{rowData:b.value,columnDefs:D.value,defaultColDef:E,animateRows:"true",class:"ag-theme-material h-full",onGridReady:a[8]||(a[8]=c=>T.value=c.api)},null,8,["rowData","columnDefs"])])])}}};export{ce as default};
