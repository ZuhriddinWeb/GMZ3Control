import{u as B,c as M,r as m,d as $,H as N,x as b,o as G,f as i,g as O,h as T,i as n,k as r,j as s,l as w,m as f,D as A,t as j,V as q,n as x}from"./app-d6fd952f.js";/* empty css                   */import{_ as H,a as L}from"./EditBlog-56eeab7d.js";import{_ as J}from"./Calculator-15222654.js";const K={class:"grid grid-rows-[55px,1fr]"},Q={class:"flex justify-between"},W=n("span",{class:"flex w-full"},null,-1),X={class:"va-h3"},Y={class:"grid grid-cols-1 md:grid-cols-1 gap-2 items-end w-full"},Z={class:"grid grid-cols-1 md:grid-cols-1 gap-2 items-end w-full"},ee={class:"flex-grow"},re={__name:"FormulaPage",setup(ae){const{init:y}=B(),{locale:u,t:o}=M(),p=m([]),g=m(null),c=m(!1),v=m([]),_=m([]),t=$({StructureID:"",Name:"",NameRus:"",ParametersId:"",Comment:""});function D(a){g.value.applyTransaction({remove:[a]})}function R(a,e){a.setData(e)}N("ondeleted",D),N("onupdated",R);const C=b(()=>[{headerName:o("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:o("table.structure"),field:k(),flex:1},{headerName:o("table.Name"),field:S(),flex:1},{headerName:o("table.Comment"),field:"Comment"},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:J},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:H},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:L}]),I={sortable:!0,filter:!0},S=()=>u.value==="uz"?"Name":"NameRus",k=()=>u.value==="uz"?"SName":"NameRus",V=async()=>{try{const a=await f.get("/formula");p.value=Array.isArray(a.data)?a.data:a.data.items}catch(a){console.error("Error fetching data:",a)}},h=async()=>{try{const a=await f.get("/structure");v.value=a.data.map(e=>({value:e.id,text:u.value==="uz"?e.Name:e.NameRus}))}catch(a){console.error("Error fetching graphics data:",a)}};async function F(a){try{const e=await f.get(`/get-graph-with-params/${a}`);_.value=e.data.map(d=>({value:d.ParametersID,text:d.Name}))}catch(e){console.error("Error fetching data:",e)}}const P=async()=>{try{const{data:a}=await f.post("/formula",t);a.status===200?(c.value=!1,t.StructureID="",t.Name="",t.NameRus="",t.ParametersId="",t.Comment="",await V(),y({message:o("login.successMessage"),color:"success"})):console.error("Error saving data:",a.message)}catch(a){console.error("Error saving data:",a)}};return G(()=>{const a=localStorage.getItem("locale");a&&(u.value=a),V(),h()}),b(()=>u.value==="uz"?"Русский":"O‘zbek"),(a,e)=>{const d=i("VaSelect"),E=i("VaTextarea"),U=i("VaModal"),z=i("ag-grid-vue");return O(),T("div",K,[n("main",null,[n("div",Q,[W,r(s(A),{onClick:e[0]||(e[0]=l=>(c.value=!0,h)),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),r(U,{modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=l=>c.value=l),"ok-text":s(o)("buttons.save"),"cancel-text":s(o)("buttons.cancel"),onOk:P,"close-button":""},{default:w(()=>[n("h3",X,j(s(o)("modals.addFormula")),1),n("div",null,[r(s(q),{ref:"formRef",class:"flex flex-col items-baseline gap-1"},{default:w(()=>[n("div",Y,[r(d,{modelValue:t.StructureID,"onUpdate:modelValue":[e[1]||(e[1]=l=>t.StructureID=l),F],"value-by":"value",class:"mb-1",label:s(o)("form.structureName"),options:v.value,clearable:""},null,8,["modelValue","label","options"])]),r(s(x),{class:"w-full",modelValue:t.Name,"onUpdate:modelValue":e[2]||(e[2]=l=>t.Name=l),rules:[l=>l&&l.length>0||s(o)("validation.requiredField")],label:s(o)("form.name")},null,8,["modelValue","rules","label"]),r(s(x),{class:"w-full",modelValue:t.NameRus,"onUpdate:modelValue":e[3]||(e[3]=l=>t.NameRus=l),rules:[l=>l&&l.length>0||s(o)("validation.requiredField")],label:s(o)("form.nameRus")},null,8,["modelValue","rules","label"]),n("div",Z,[r(d,{modelValue:t.ParametersId,"onUpdate:modelValue":e[4]||(e[4]=l=>t.ParametersId=l),"value-by":"value",class:"mb-1",label:s(o)("form.structureName"),options:_.value,multiple:""},null,8,["modelValue","label","options"])]),r(E,{class:"w-full",modelValue:t.Comment,"onUpdate:modelValue":e[5]||(e[5]=l=>t.Comment=l),"max-length":"125",label:s(o)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),n("main",ee,[r(z,{rowData:p.value,columnDefs:C.value,defaultColDef:I,animateRows:"true",class:"ag-theme-material h-full",onGridReady:e[7]||(e[7]=l=>g.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{re as default};
