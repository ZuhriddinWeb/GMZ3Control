import{u as k,c as T,r as x,E as W,f as y,g as q,h as S,j as m,k as e,z as $,l as M,i as c,t as I,n as w,d as O,o as B,V as G,m as f,a as L,s as D,F as Q,G as X,H as F}from"./app-BErtTtAL.js";/* empty css                   */const Y={class:"h-full w-full text-center content-center"},Z={class:"va-h3"},ee={__name:"DeleteParam",props:["params"],setup(R){const{init:U}=k(),{t:d}=T(),s=x(!1),V=R,C=W("ondeleted"),v=async()=>{try{const{data:g}=await w.delete(`/param/${V.params.data.Uuid}`);g.status===200?(C(V.params.data),s.value=!1,U({message:d("login.successMessage"),color:"success"})):console.error("Error deleting data:",g.message)}catch(g){console.error("Error deleting data:",g)}};return(g,t)=>{const n=y("VaModal");return S(),q("main",Y,[m(e($),{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:t[0]||(t[0]=h=>s.value=!0)}),m(n,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=h=>s.value=h),"ok-text":e(d)("modals.apply"),"cancel-text":e(d)("modals.cancel"),onClose:t[2]||(t[2]=h=>s.value=!1),onOk:v,"close-button":""},{default:M(()=>[c("h3",Z,I(e(d)("modals.title")),1),c("p",null,I(e(d)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ae={class:"h-full w-full text-center content-center"},le={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},te={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},se={__name:"EditParam",props:["params"],setup(R){const{init:U}=k(),{t:d}=T(),s=R,V=x(!1),C=W("onupdated"),v=x([]),g=x([]),t=O({Name:"",NameRus:"",ShortNameRus:"",ShortName:"",WinCC:"",ParamsTypeID:"",UnitsID:"",Min:"",Max:"",Comment:"",id:s.params.data.Uuid}),n=async()=>{try{const[p,r,i]=await Promise.all([w.get("/paramtypes"),w.get("/units"),w.get(`param/${s.params.data.Uuid}`)]);console.log(i),v.value=p.data.map(N=>({value:N.id,text:N.Name})),g.value=r.data.map(N=>({value:N.id,text:N.Name})),t.Name=i.data.Name,t.NameRus=i.data.NameRus,t.ShortNameRus=i.data.ShortNameRus,t.ShortName=i.data.ShortName,t.WinCC=i.data.WinCC,t.ParamsTypeID=+i.data.Pid,t.UnitsID=+i.data.Uid,t.Min=+i.data.Min,t.Max=+i.data.Max,t.Comment=i.data.Comment}catch(p){console.error("Error fetching data:",p)}},h=async()=>{try{const{data:p}=await w.put("/param",t);p.status===200?(C(s.params.node,p.unit),V.value=!1,U({message:d("login.successMessage"),color:"success"})):console.error("Error saving data:",p.message)}catch(p){console.error("Error saving data:",p)}};return B(()=>{}),(p,r)=>{const i=y("VaSelect"),N=y("VaTextarea"),P=y("VaModal");return S(),q("main",ae,[m(e($),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:r[0]||(r[0]=a=>V.value=!0)}),m(P,{modelValue:V.value,"onUpdate:modelValue":r[11]||(r[11]=a=>V.value=a),"ok-text":e(d)("modals.apply"),"cancel-text":e(d)("modals.cancel"),onOk:h,onClose:r[12]||(r[12]=a=>V.value=!1),"close-button":""},{default:M(()=>[c("h3",{class:"va-h3",onVnodeMounted:n},I(e(d)("modals.editFactory")),513),c("div",null,[m(e(G),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:M(()=>[m(e(f),{class:"w-full",modelValue:t.Name,"onUpdate:modelValue":r[1]||(r[1]=a=>t.Name=a),rules:[a=>a&&a.length>0||e(d)("form.requiredField")],label:e(d)("form.name")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:t.NameRus,"onUpdate:modelValue":r[2]||(r[2]=a=>t.NameRus=a),rules:[a=>a&&a.length>0||e(d)("form.requiredField")],label:e(d)("form.nameRus")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:t.ShortName,"onUpdate:modelValue":r[3]||(r[3]=a=>t.ShortName=a),rules:[a=>a&&a.length>0||e(d)("form.requiredField")],label:e(d)("form.shortName")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:t.ShortNameRus,"onUpdate:modelValue":r[4]||(r[4]=a=>t.ShortNameRus=a),rules:[a=>a&&a.length>0||e(d)("form.requiredField")],label:e(d)("form.shortNameRus")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:t.WinCC,"onUpdate:modelValue":r[5]||(r[5]=a=>t.WinCC=a),rules:[a=>a&&a.length>0||e(d)("form.requiredField")],label:e(d)("form.wincc")},null,8,["modelValue","rules","label"]),c("div",le,[m(e(f),{class:"w-full",modelValue:t.Min,"onUpdate:modelValue":r[6]||(r[6]=a=>t.Min=a),rules:[a=>a&&a.length>0||e(d)("form.requiredField")],label:e(d)("table.min")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:t.Max,"onUpdate:modelValue":r[7]||(r[7]=a=>t.Max=a),rules:[a=>a&&a.length>0||e(d)("form.requiredField")],label:e(d)("table.max")},null,8,["modelValue","rules","label"])]),c("div",te,[m(i,{modelValue:t.ParamsTypeID,"onUpdate:modelValue":r[8]||(r[8]=a=>t.ParamsTypeID=a),"value-by":"value",class:"mb-6",label:e(d)("menu.paramtypes"),options:v.value,clearable:""},null,8,["modelValue","label","options"]),m(i,{modelValue:t.UnitsID,"onUpdate:modelValue":r[9]||(r[9]=a=>t.UnitsID=a),"value-by":"value",class:"mb-6",label:e(d)("menu.units"),options:g.value,clearable:""},null,8,["modelValue","label","options"])]),m(N,{class:"w-full",modelValue:t.Comment,"onUpdate:modelValue":r[10]||(r[10]=a=>t.Comment=a),"max-length":"125",label:e(d)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},oe={class:"grid grid-rows-[55px,1fr]"},ne={class:"flex justify-between"},re={class:"va-h3"},de={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},me={class:"grid grid-cols-2 md:grid-cols-2 gap-2 items-end w-full"},ue={class:"flex-grow"},ce={__name:"ParametersPage",setup(R){const U=L(),{init:d}=k(),{t:s}=T(),V=x([]),C=x(null),v=x(!1),g=x([]),t=x([]),n=O({Name:"",NameRus:"",ShortNameRus:"",ShortName:"",WinCC:"",ParamsTypeID:"",UnitsID:"",Min:"",Max:"",Comment:""}),h=D(()=>U.state.user.roles[10]),p=u=>{var o,b;return((b=(o=h.value)==null?void 0:o.pivot)==null?void 0:b[u])==="1"},r=D(()=>p("create")),i=D(()=>p("update")),N=D(()=>p("delete"));function P(u){C.value.applyTransaction({remove:[u]})}function a(u,o){u.setData(o)}F("ondeleted",P),F("onupdated",a);const _=D(()=>{const u=[{headerName:s("table.headerRow"),valueGetter:"node.rowIndex + 1",width:80},{headerName:s("table.id"),field:"Uuid",hide:!0,flex:1},{headerName:s("table.name"),field:"Name",flex:1},{headerName:s("table.shortName"),field:"ShortName"},{headerName:s("menu.paramtypes"),hide:!0,field:"PName"},{headerName:s("menu.units"),field:"UName"},{headerName:s("table.min"),field:"Min"},{headerName:s("table.max"),field:"Max"},{headerName:s("table.comment"),field:"Comment",flex:1}];return i.value&&u.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:se}),N.value&&u.push({cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:ee}),u}),j={sortable:!0,filter:!0},E=async()=>{try{const u=await w.get("/param");V.value=Array.isArray(u.data)?u.data:u.data.items}catch(u){console.error("Error fetching data:",u)}},A=async()=>{try{const u=await w.get("/paramtypes"),o=await w.get("/units");g.value=u.data.map(b=>({value:b.id,text:b.Name})),t.value=o.data.map(b=>({value:b.id,text:b.Name}))}catch(u){console.error("Error fetching graphics data:",u)}},z=async()=>{try{const{data:u}=await w.post("/param",n);u.status===200?(v.value=!1,n.Name="",n.NameRus="",n.ShortNameRus="",n.ShortName="",n.ParamsTypeID="",n.UnitsID="",n.Min="",n.Max="",n.Comment="",await E(),d({message:s("login.successMessage"),color:"success"})):console.error("Error saving data:",u.message)}catch(u){console.error("Error saving data:",u)}};return B(()=>{E(),A()}),(u,o)=>{const b=y("VaSelect"),H=y("VaTextarea"),J=y("VaModal"),K=y("ag-grid-vue");return S(),q("div",oe,[c("main",null,[c("div",ne,[o[13]||(o[13]=c("span",{class:"flex w-full"},null,-1)),r.value?(S(),Q(e($),{key:0,onClick:o[0]||(o[0]=l=>v.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})):X("",!0)]),m(J,{modelValue:v.value,"onUpdate:modelValue":o[11]||(o[11]=l=>v.value=l),"ok-text":e(s)("modals.apply"),"cancel-text":e(s)("modals.cancel"),onOk:z,"close-button":""},{default:M(()=>[c("h3",re,I(e(s)("modals.addParamsTitle")),1),c("div",null,[m(e(G),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:M(()=>[m(e(f),{class:"w-full",modelValue:n.Name,"onUpdate:modelValue":o[1]||(o[1]=l=>n.Name=l),rules:[l=>l&&l.length>0||e(s)("validation.required")],label:e(s)("form.name")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:n.NameRus,"onUpdate:modelValue":o[2]||(o[2]=l=>n.NameRus=l),rules:[l=>l&&l.length>0||e(s)("validation.required")],label:e(s)("form.nameRus")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:n.ShortName,"onUpdate:modelValue":o[3]||(o[3]=l=>n.ShortName=l),rules:[l=>l&&l.length>0||e(s)("validation.required")],label:e(s)("form.shortName")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:n.ShortNameRus,"onUpdate:modelValue":o[4]||(o[4]=l=>n.ShortNameRus=l),rules:[l=>l&&l.length>0||e(s)("validation.required")],label:e(s)("form.shortNameRus")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:n.WinCC,"onUpdate:modelValue":o[5]||(o[5]=l=>n.WinCC=l),rules:[l=>l&&l.length>0||e(s)("validation.required")],label:e(s)("form.wincc")},null,8,["modelValue","rules","label"]),c("div",de,[m(e(f),{class:"w-full",modelValue:n.Min,"onUpdate:modelValue":o[6]||(o[6]=l=>n.Min=l),rules:[l=>l&&l.length>0||e(s)("validation.required")],label:e(s)("table.min")},null,8,["modelValue","rules","label"]),m(e(f),{class:"w-full",modelValue:n.Max,"onUpdate:modelValue":o[7]||(o[7]=l=>n.Max=l),rules:[l=>l&&l.length>0||e(s)("validation.required")],label:e(s)("table.max")},null,8,["modelValue","rules","label"])]),c("div",me,[m(b,{modelValue:n.ParamsTypeID,"onUpdate:modelValue":o[8]||(o[8]=l=>n.ParamsTypeID=l),"value-by":"value",class:"mb-6",label:e(s)("menu.paramtypes"),options:g.value,clearable:""},null,8,["modelValue","label","options"]),m(b,{modelValue:n.UnitsID,"onUpdate:modelValue":o[9]||(o[9]=l=>n.UnitsID=l),"value-by":"value",class:"mb-6",label:e(s)("menu.units"),options:t.value,clearable:""},null,8,["modelValue","label","options"])]),m(H,{class:"w-full",modelValue:n.Comment,"onUpdate:modelValue":o[10]||(o[10]=l=>n.Comment=l),"max-length":"125",label:e(s)("form.comment")},null,8,["modelValue","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),c("main",ue,[m(K,{rowData:V.value,columnDefs:_.value,defaultColDef:j,animateRows:"true",class:"ag-theme-material h-full",onGridReady:o[12]||(o[12]=l=>C.value=l.api)},null,8,["rowData","columnDefs"])])])}}};export{ce as default};
