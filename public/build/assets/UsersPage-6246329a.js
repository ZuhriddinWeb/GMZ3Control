import{r as h,c as U,G as M,f as _,g as x,h as y,k as u,l as N,i as d,t as $,j as a,m as b,d as R,o as I,D as L,V as A,n as P,u as T,I as j,J as z,M as S,H as F,x as H}from"./app-c42d8acf.js";/* empty css                   */import J from"./CreateDocument-b6661907.js";import"./data-grid-fe70ca1b.js";const Y={class:"h-full w-full text-center content-center"},K={class:"va-h3"},Q={__name:"DeleteUserModal",props:["params"],setup(C){const v=h(!1),t=C,{t:f}=U(),w=M("ondeleted"),g=async()=>{try{const{data:o}=await b.delete(`/units/${t.params.data.id}`);o.status===200?(w(t.params.data),v.value=!1):console.error("Error deleting data:",o.message)}catch(o){console.error("Error deleting data:",o)}};return(o,s)=>{const V=_("VaButton"),m=_("VaModal");return x(),y("main",Y,[u(V,{round:"",icon:"delete",preset:"primary",class:"mt-1",onClick:s[0]||(s[0]=r=>v.value=!0)}),u(m,{modelValue:v.value,"onUpdate:modelValue":s[1]||(s[1]=r=>v.value=r),"ok-text":a(f)("modals.apply"),"cancel-text":a(f)("modals.cancel"),onClose:s[2]||(s[2]=r=>v.value=!1),onOk:g,"close-button":""},{default:N(()=>[d("h3",K,$(a(f)("modals.title")),1),d("p",null,$(a(f)("modals.message")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}};const W={class:"h-full w-full text-center content-center"},X={class:"va-h3"},Z={class:"grid grid-cols-1 md:grid-cols-1 gap-2 items-end w-full"},ee={__name:"EditUserModal",setup(C){const{locale:v,t}=U();h([]),h(null);const f=h(!1),w=h([]),g=h(!1),o=R({Name:"",Phone:"",Login:"",Password:""}),s=async()=>{try{const m=await b.get("/structure");w.value=m.data.map(r=>({value:r.id,text:r.Name}))}catch(m){console.error("Error fetching graphics data:",m)}},V=async()=>{try{const{data:m}=await b.put("/users",o);m.status===200?(f.value=!1,o.Name="",o.Phone="",o.Login="",o.Password="",o.StructureID=[],await fetchData()):console.error("Error saving data:",m.message)}catch(m){console.error("Error saving data:",m)}};return I(()=>{const m=localStorage.getItem("locale");m&&(v.value=m),s()}),(m,r)=>{const D=_("VaSelect"),k=_("VaModal");return x(),y("main",W,[u(a(L),{round:"",icon:"edit",preset:"primary",class:"mt-1",onClick:r[0]||(r[0]=e=>g.value=!0)}),u(k,{modelValue:g.value,"onUpdate:modelValue":r[6]||(r[6]=e=>g.value=e),"ok-text":a(t)("modals.apply"),"cancel-text":a(t)("modals.cancel"),onOk:V,onClose:r[7]||(r[7]=e=>g.value=!1),"close-button":""},{default:N(()=>[d("h3",X,$(a(t)("modals.addUserTitle")),1),d("div",null,[u(a(A),{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:N(()=>[d("div",Z,[u(D,{modelValue:o.StructureID,"onUpdate:modelValue":r[1]||(r[1]=e=>o.StructureID=e),label:a(t)("form.structureName"),options:w.value,multiple:""},null,8,["modelValue","label","options"])]),u(a(P),{class:"w-full",modelValue:o.Name,"onUpdate:modelValue":r[2]||(r[2]=e=>o.Name=e),rules:[e=>e&&e.length>0||a(t)("form.requiredField")],label:a(t)("form.userName")},null,8,["modelValue","rules","label"]),u(a(P),{class:"w-full",modelValue:o.Phone,"onUpdate:modelValue":r[3]||(r[3]=e=>o.Phone=e),rules:[e=>e&&e.length>0||a(t)("form.requiredField")],type:"tel",label:a(t)("form.userPhone"),placeholder:"597****"},null,8,["modelValue","rules","label"]),u(a(P),{class:"w-full",modelValue:o.Login,"onUpdate:modelValue":r[4]||(r[4]=e=>o.Login=e),rules:[e=>e&&e.length>0||a(t)("form.requiredField")],label:a(t)("form.login")},null,8,["modelValue","rules","label"]),u(a(P),{class:"w-full",modelValue:o.Password,"onUpdate:modelValue":r[5]||(r[5]=e=>o.Password=e),rules:[e=>e&&e.length>0||a(t)("form.requiredField")],label:a(t)("form.password")},null,8,["modelValue","rules","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}};const te={class:"h-full w-full text-center content-center"},ae={class:"va-h3"},le={class:"va-table-responsive"},oe={class:"va-table va-table--clickable w-full"},se=d("thead",null,[d("tr",null,[d("th",null,"Nomi"),d("th",null,"Ruxsat"),d("th",null,"Yaratish"),d("th",null,"O'zgartirish"),d("th",null,"O'chirish")])],-1),ne={key:0},re={key:1},de={key:2},ue={__name:"RolesComponent",props:["params"],setup(C){const v=C,t=h(!1);M("onupdated");const f=h([]),{init:w}=T(),{locale:g,t:o}=U(),s=R({id:v.params.data.id,userName:v.params.data.name}),V=(e,n)=>{e[n]=!e[n],console.log(`${n} for ${e.name} changed to ${e[n]}`)},m=e=>e?"success":"danger";async function r(){b.get(`/user_role/${v.params.data.id}`).then(e=>{e.data.forEach(n=>{const l=f.value.find(i=>i.id==n.role_id);l!=null&&(l.view=n.view,l.create=n.create,l.update=n.update,l.delete=n.delete)})})}async function D(){try{const e=await b.get("/role");f.value=Array.isArray(e.data)?e.data:e.data.items,f.value.forEach(n=>{n.id=n.id,n.view=n.view||!1,n.create=n.create||!1,n.update=n.update||!1,n.delete=n.delete||!1})}catch(e){console.error("Error fetching data:",e)}}const k=async()=>{try{const e=f.value.map(l=>({id:l.id,name:l.name,view:l.view,create:l.create,edit:l.update,delete:l.delete})),{data:n}=await b.post("/user_role",{...s,roles:e});n.status===200?(t.value=!1,w({message:o("login.successMessage"),color:"success"})):console.error("Error saving data:",n.message)}catch(e){console.error("Error saving data:",e)}};return I(async()=>{await D(),r()}),(e,n)=>{const l=_("VaSwitch"),i=_("VaModal");return x(),y("main",te,[u(a(L),{round:"",icon:"settings",preset:"primary",class:"mt-1",onClick:n[0]||(n[0]=p=>t.value=!0)}),u(i,{"max-width":"45%",modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=p=>t.value=p),"ok-text":a(o)("modals.apply"),"cancel-text":a(o)("modals.cancel"),onOk:k,onClose:n[2]||(n[2]=p=>t.value=!1),"close-button":""},{default:N(()=>[d("h3",null,[d("span",ae,$(a(o)("table.user"))+" : "+$(s.userName),1)]),d("div",null,[d("div",le,[d("table",oe,[se,d("tbody",null,[(x(!0),y(j,null,z(f.value,p=>(x(),y("tr",{key:p.id},[d("td",null,$(a(o)(`${p.name}`)),1),d("td",null,[u(l,{"model-value":p.view,onChange:()=>V(p,"view"),color:m(p.view)},null,8,["model-value","onChange","color"])]),p.view?(x(),y("td",ne,[u(l,{"model-value":p.create,onChange:()=>V(p,"create"),color:m(p.create)},null,8,["model-value","onChange","color"])])):S("",!0),p.view?(x(),y("td",re,[u(l,{"model-value":p.update,onChange:()=>V(p,"update"),color:m(p.update)},null,8,["model-value","onChange","color"])])):S("",!0),p.view?(x(),y("td",de,[u(l,{"model-value":p.delete,onChange:()=>V(p,"delete"),color:m(p.delete)},null,8,["model-value","onChange","color"])])):S("",!0)]))),128))])])])])]),_:1},8,["modelValue","ok-text","cancel-text"])])}}},ce={class:"h-full w-full text-center content-center"},ie={class:"va-h3"},me={__name:"RestartPassword",props:["params"],setup(C){const v=C,{t}=U(),f=h(!1),w=M("onupdated"),g=async()=>{try{const{data:o}=await b.get(`/restart-password/${v.params.data.id}`);o.status===200?(w(v.params.node,o.unit),f.value=!1):console.error("Error deleting data:",o.message)}catch(o){console.error("Error deleting data:",o)}};return(o,s)=>{const V=_("VaButton"),m=_("VaModal");return x(),y("main",ce,[u(V,{round:"",icon:"restart_alt",preset:"primary",class:"mt-1",onClick:s[0]||(s[0]=r=>f.value=!0)}),u(m,{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=r=>f.value=r),"ok-text":a(t)("modals.apply"),"cancel-text":a(t)("modals.cancel"),onClose:s[2]||(s[2]=r=>f.value=!1),onOk:g,"close-button":""},{default:N(()=>[d("h3",ie,$(a(t)("modals.restart")),1),d("p",null,$(a(t)("modals.messageRestart")),1)]),_:1},8,["modelValue","ok-text","cancel-text"])])}}};const pe={class:"grid grid-rows-[55px,1fr]"},fe={class:"flex justify-between"},ve=d("span",{class:"flex w-full"},null,-1),ge={class:"va-h3"},_e={class:"grid grid-cols-1 md:grid-cols-1 gap-2 items-end w-full"},he={class:"flex-grow"},be={__name:"UsersPage",setup(C){const{locale:v,t}=U(),f=h([]),w=h(null),g=h(!1),o=h([]),s=R({Name:"",Phone:"",Login:"",Password:"",StructureID:[]});function V(l){w.value.applyTransaction({remove:[l]})}function m(l,i){l.setData(i)}F("ondeleted",V),F("onupdated",m);const r=H(()=>[{headerName:t("table.headerRow"),valueGetter:"node.rowIndex + 1"},{headerName:t("table.userName"),field:"name",flex:1},{headerName:t("table.login"),field:"login",flex:1},{headerName:t("table.phone"),field:"phone"},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:J},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:ee},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:ue},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:me},{cellClass:["px-0"],headerName:"",field:"",width:70,cellRenderer:Q}]),D={sortable:!0,filter:!0},k=async()=>{try{const l=await b.get("/users");f.value=Array.isArray(l.data)?l.data:l.data.items}catch(l){console.error("Error fetching data:",l)}},e=async()=>{try{const l=await b.get("/structure");o.value=l.data.map(i=>({value:i.id,text:i.Name}))}catch(l){console.error("Error fetching graphics data:",l)}},n=async()=>{try{const{data:l}=await b.post("/users",s);l.status===200?(g.value=!1,s.Name="",s.Phone="",s.Login="",s.Password="",s.StructureID=[],await k()):console.error("Error saving data:",l.message)}catch(l){console.error("Error saving data:",l)}};return I(()=>{const l=localStorage.getItem("locale");l&&(v.value=l),k(),e()}),(l,i)=>{const p=_("VaButton"),B=_("VaSelect"),E=_("VaInput"),O=_("VaForm"),q=_("VaModal"),G=_("ag-grid-vue");return x(),y("div",pe,[d("main",null,[d("div",fe,[ve,u(p,{onClick:i[0]||(i[0]=c=>g.value=!0),class:"w-14 h-12 mt-1 mr-1",icon:"add"})]),u(q,{modelValue:g.value,"onUpdate:modelValue":i[6]||(i[6]=c=>g.value=c),"ok-text":a(t)("buttons.save"),"cancel-text":a(t)("buttons.cancel"),onOk:n,"close-button":""},{default:N(()=>[d("h3",ge,$(a(t)("modals.addUserTitle")),1),d("div",null,[u(O,{ref:"formRef",class:"flex flex-col items-baseline gap-2"},{default:N(()=>[d("div",_e,[u(B,{modelValue:s.StructureID,"onUpdate:modelValue":i[1]||(i[1]=c=>s.StructureID=c),label:a(t)("form.structureName"),options:o.value,multiple:""},null,8,["modelValue","label","options"])]),u(E,{class:"w-full",modelValue:s.Name,"onUpdate:modelValue":i[2]||(i[2]=c=>s.Name=c),rules:[c=>c&&c.length>0||a(t)("form.requiredField")],label:a(t)("form.userName")},null,8,["modelValue","rules","label"]),u(E,{class:"w-full",modelValue:s.Phone,"onUpdate:modelValue":i[3]||(i[3]=c=>s.Phone=c),rules:[c=>c&&c.length>0||a(t)("form.requiredField")],type:"tel",label:a(t)("form.userPhone"),placeholder:"597****"},null,8,["modelValue","rules","label"]),u(E,{class:"w-full",modelValue:s.Login,"onUpdate:modelValue":i[4]||(i[4]=c=>s.Login=c),rules:[c=>c&&c.length>0||a(t)("form.requiredField")],label:a(t)("form.login")},null,8,["modelValue","rules","label"]),u(E,{class:"w-full",modelValue:s.Password,"onUpdate:modelValue":i[5]||(i[5]=c=>s.Password=c),rules:[c=>c&&c.length>0||a(t)("form.requiredField")],label:a(t)("form.password")},null,8,["modelValue","rules","label"])]),_:1},512)])]),_:1},8,["modelValue","ok-text","cancel-text"])]),d("main",he,[u(G,{rowData:f.value,columnDefs:r.value,defaultColDef:D,animateRows:"true",class:"ag-theme-material h-full",onGridReady:i[7]||(i[7]=c=>w.value=c.api)},null,8,["rowData","columnDefs"])])])}}};export{be as default};
